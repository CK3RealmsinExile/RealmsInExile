namespace = mirkwood_corruption

################################
## MIRKWOOD CORRUPTION EVENTS ##
################################

mirkwood_corruption.0001 = {
    content_source = realms_dlc
    type = character_event
    window = fullscreen_event
    title = mirkwood_corruption.0001.t
    desc = mirkwood_corruption.0001.desc
    theme = realm
    trigger = { # we need to prevent this from firing for all players when a new player joins in MP
        is_ai = no
        NOT = { has_variable = mirkwood_corruption_0001_var }
    }
    override_background = { reference = mirkwood_situation_fullscreen }
    override_sound = { reference = "event:/DLC/FP2/SFX/UI/fp2_struggle_ui_intro_animate" }

    cooldown = { years = 100 }

    widgets = {
        widget = {
            gui = "event_window_widget_situation_info_elven_hope"
            container = "dynamic_content_widget"
            controller = situation_info
            setup_scope = { situation:mirkwood_corruption_situation = { save_scope_as = situation } }
        }
    }
    immediate = {
        set_variable = mirkwood_corruption_0001_var
        save_scope_value_as = {
            name = start
            value = yes
        }
    }
    option = {
        name = mirkwood_corruption.0001.a
        clicksound = "event:/DLC/FP2/SFX/UI/fp2_struggle_start_select"
    }
}


mirkwood_corruption.0015 = { # Lose realm to wilderness at maximum corruption
    type = character_event
    title = mirkwood_corruption.0015.t
    desc = mirkwood_corruption.0015.desc
    theme = dread
    override_background = { reference = wilderness_forest }
    cooldown = { days = 31 }
    left_portrait = {
        character = root
        animation = fear
    }
    immediate = {
        custom_tooltip = mirkwood_corruption.0015.tt
    }
    option = {
        name = mirkwood_corruption.0015.a
        scope:my_subregion = {
            every_situation_sub_region_county = {
                if = {
                    limit = {
                        this.holder = root
                    }
                    add_to_list = corrupted_counties
                }
            }
            every_in_list = {
                list = corrupted_counties
                if = {
                    limit = { NOT = { title_province = { has_holding_type = wastelands_holding } } }
                    make_settlement_county_wilderness = { COUNTY = this }
                    title_province = { add_building = shadow_of_mirkwood }
                }
            }
        }
    }
}