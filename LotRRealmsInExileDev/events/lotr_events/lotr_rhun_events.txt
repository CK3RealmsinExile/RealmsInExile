namespace = rhun

### Rhûn Events ###

rhun.0013 = { # Hûz starting event part 2
	content_source = realms_dlc
	type = character_event
	title = rhun.0013.t
	desc = rhun.0013.desc
	theme = learning_scholarship_focus
	override_background = corridor_night
	left_portrait = {
		character = root
		animation = lantern
	}
	right_portrait = {
		character = character:lineofhuz181
		animation = chancellor
	}
	option = { # 
		name = rhun.0013.a
		custom_tooltip = rhun.0013.a.tt
		character:lineofzhamian3 = {
			trigger_event = {
				id = rhun.0014	
				years = 14
			}	
		}	
	}
}

rhun.0014 = {
	content_source = realms_dlc
	type = character_event
	hidden = yes
	
	immediate = {
        death = {
			death_reason = death_mysterious
		}
	}
	
}

rhun.0015 = { # Dorwinion taken
	content_source = realms_dlc
	type = character_event
	title = rhun.0015.t
	desc = rhun.0015.desc
	theme = dread
	#override_background = corridor_night
	left_portrait = {
		character = root
		animation = laugh
	}
	right_portrait = {
		character = title:d_folyavuld.holder
		animation = beg
	}

	immediate = {
		get_title = title:c_szrel_kain
	}

	option = { # maintain local elites, yet force them to help fund the seat of tyrants
		name = rhun.0015.a
		custom_tooltip = rhun.0015.a.tt
		ai_chance = {
			base = 0 # LotR: This should be tied to WotR mode.

			modifier = { # Game Rule
				has_game_rule = default_ai_behavior
				add = 100
			}

			modifier = { # Game Rule
				has_game_rule = weighted_ai_behavior
				add = 70
			}

			modifier = { # Game Rule
				has_game_rule = random_ai_behavior
				add = 34
			}
		}
		add_gold = 800
		title:d_folyavuld.holder = {
                vassal_contract_set_obligation_level = {
                    type = title_revocation_rights
                    level = 1
                }
                vassal_contract_set_obligation_level = {
                    type = religious_rights 
                    level = 1
               }
            #   vassal_contract_set_obligation_level = {
            #       type = special_contract_scutage 
            #       level = 1
            #   }
				vassal_contract_set_obligation_level = {
                    type = special_contract 
                    level = 1
                }
            }
			title:d_folyavuld.holder = { get_title = title:k_dorwinion }
		trigger_event = {
			id = rhun.0016	
			years = 5
		}
	}			
	option = { # dismantle dorwinion power structure
	name = rhun.0015.b
	custom_tooltip = rhun.0015.b.tt
	ai_chance = {
			base = 0 # LotR: This should be tied to WotR mode.

			modifier = { # Game Rule
				has_game_rule = default_ai_behavior
				add = 0
			}

			modifier = { # Game Rule
				has_game_rule = weighted_ai_behavior
				add = 30
			}

			modifier = { # Game Rule
				has_game_rule = random_ai_behavior
				add = 66
			}
		}
	remove_short_term_gold = 150						
	add_dread = 100
	hidden_effect = {
	get_title = title:c_riavod	get_title = title:c_carasanor	get_title = title:c_urusvuld get_title = title:c_econiva 	get_title = title:c_aldenavi		get_title = title:c_caradsurga		get_title = title:c_rinnavod			get_title = title:c_ilanin		get_title = title:c_eldrast		get_title = title:c_gyula		get_title = title:c_bennek		get_title = title:c_yselvod			get_title = title:c_ost_gailnen		get_title = title:c_minovuld		get_title = title:c_aklerina		get_title = title:c_aldanira		get_title = title:c_caras_sant	get_title = title:c_arasant		get_title = title:c_kelperia		get_title = title:c_aldena	get_title = title:c_pargeltir		get_title = title:c_eryn_gwinion		get_title = title:c_saelin		get_title = title:c_maribor		get_title = title:c_lugos		get_title = title:c_visegrod		get_title = title:c_maethgannen		get_title = title:c_ladhirolk		get_title = title:c_kardavan		get_title = title:c_iaurgobel	get_title = title:c_kelperia		get_title = title:c_aldena	get_title = title:c_pargeltir		get_title = title:c_eryn_gwinion		get_title = title:c_saelin		get_title = title:c_maribor		get_title = title:c_lugos		get_title = title:c_visegrod		get_title = title:c_maethgannen		get_title = title:c_ladhirolk		get_title = title:c_kardavan		get_title = title:c_dannavuld	
	destroy_title = title:k_dorwinion
	}
	trigger_event = {
		id = rhun.0016	
		years = 5
		}	
	}
}
	
rhun.0016 = {	#Sauron influences Huz-Margoz to attack Nelornieth
	content_source = realms_dlc
	type = character_event
	title = rhun.0016.t
	desc =  rhun.0016.desc
	theme = dread
	override_background = dungeon
	left_portrait = {
		character = root
		animation = spymaster
	}
	#right_portrait = {
		#character = character:lineofsauron
		#animation = chancellor
	#}
	trigger = {
		sauron_is_alive = yes
		is_landed = yes
	}
	option = { # enables decision to cleanse nelornieth
		name = rhun.0016.a
		custom_tooltip = rhun.0016.a.tt
		ai_chance = {
			base = 0 # LotR: This should be tied to WotR mode.

			modifier = { # Game Rule
				has_game_rule = default_ai_behavior
				add = 100
			}

			modifier = { # Game Rule
				has_game_rule = weighted_ai_behavior
				add = 70
			}

			modifier = { # Game Rule
				has_game_rule = random_ai_behavior
				add = 34
			}
		}
		add_character_flag = huz_learn_of_nelornieth
		trigger = {
			has_trait = zealous
		}
		trigger_event = {
		id = rhun.0017	
		}	
	}
	option = { # Flee from the malign presense and fail the quest chain
		name = rhun.0016.b
		custom_tooltip = rhun.0016.b.tt
		add_stress = 125	
		add_trait = craven
	}	
}

rhun.0017 = {	#Sauron influences Huz-Margoz to attack Nelornieth part 2
	content_source = realms_dlc
	type = character_event
	title = rhun.0017.t
	desc = rhun.0017.desc
	theme = mental_break
	override_background = fangorn
	left_portrait = {
		character = root
		animation = lunatic
	}
	#right_portrait = {
		#character = character:lineofsauron
		#animation = chancellor
	#}
	option = { # enables decision to cleanse nelornieth
		name = rhun.0017.a
		add_trait = zealous
		custom_tooltip = rhun.0017.a.tt
		add_unpressed_claim = title:k_nelornieth
		hidden_effect = {
			make_claim_strong = title:k_nelornieth
		}
		primary_heir = { 
			add_character_flag = huz_learn_of_nelornieth
			add_unpressed_claim = title:k_nelornieth
		}	
	}	
	after = {
		add_stress = 69
	}
}

rhun.0018 = { # huz family joins szrel
	hidden = yes
	content_source = realms_dlc
	type = character_event
	title = umbar.1001.t
	desc = umbar.1001.desc
	theme = stewardship_duty_focus
	left_portrait = {
		character = root
		animation = personality_rational
	}
	
	trigger = {
		root.dynasty = dynasty:dynasty_szrel
	}

	immediate = {
		dynasty = { # Ancestors
			every_dynasty_member = {
				even_if_dead = yes
				limit = {
					NOT = {
						any_in_list = {
							list = huz_members
							this = prev
						}
					}
				}
				every_ancestor = {
					even_if_dead = yes
					limit = { dynasty = dynasty:dynasty_szrel }
					add_to_list = huz_members
					every_ancestor = {
						even_if_dead = yes
						limit = { dynasty = dynasty:dynasty_szrel }
						add_to_list = huz_members
						every_ancestor = {
							even_if_dead = yes
							limit = { dynasty = dynasty:dynasty_szrel }
							add_to_list = huz_members
							every_ancestor = {
								even_if_dead = yes
								limit = { dynasty = dynasty:dynasty_szrel }
								add_to_list = huz_members
								every_ancestor = {
									even_if_dead = yes
									limit = { dynasty = house:huz }
									add_to_list = huz_members
								}
							}
						}
					}
				}
			}
		}
		dynasty = { # Current alive members
			every_dynasty_member = {
				limit = { 
					NOT = {
						any_in_list = {
							list = huz_members
							this = prev
						}
					}
				}
				add_to_list = huz_members
			}
		}
	}
	
	option = {
		name = umbar.1001.a #The huz become szrel
		hidden_effect = {
			every_in_list = {
				list = huz_members
				set_house = character:lineofszrel1.house
			}
		}
		set_house = character:lineofszrel1.house

		dynasty = { add_dynasty_prestige_level = 6 }
		dynasty = { add_dynasty_prestige = 6000 }
	}	
}

rhun.0019 = { # Check on Szreldor controlling Nelornieth
	hidden = yes
	option = {
		if = {
			limit = { completely_controls = title:k_nelornieth}
			title:k_nelornieth= { set_de_jure_liege_title = title:e_szreldor }
		}
		else_if = {
			limit = { 
				NOT = { completely_controls = title:k_nelornieth} 
			}
			title:e_szreldor.holder = {
				trigger_event = { # Check status on Adunaim conquests
					id = rhun.0019
					years = 1
				}
			}
		}
	}
}

rhun.0022 = { #ai forms szreldor after taking either nelornieth or dale
	hidden = yes
	orphan = yes
	option = {
		if = {
			# limit = {is_ai = yes}
			# give_nickname = nick_gilded_star
			# get_title = title:e_szreldor
			# set_house = character:lineofszrel1.house
			# Kingdoms around the Sea of Rhun or in Rhovanion completely controlled are integrated into Szreldor
			hidden_effect = { # Kingdoms around the Sea of Rhun or in Rhovanion completely controlled are integrated into Szreldor
				if = {
					limit = { completely_controls = title:k_usrievar }
					title:k_usrievar = { set_de_jure_liege_title = title:e_szreldor }
					title:k_nurunkizdin = { set_de_jure_liege_title = title:e_szreldor }
				}
				if = {
					limit = { completely_controls = title:k_logathavuld }
					title:k_logathavuld = { set_de_jure_liege_title = title:e_szreldor }
				}
				if = {
					limit = { completely_controls = title:d_subi_khand }
					title:d_subi_khand = { set_de_jure_liege_title = title:k_usrievar }
				}
				if = {
					limit = { 
						OR = { # If you either completely hold Dorwinion, or if you or a vassal hold the title, integrate
							completely_controls = title:k_dorwinion 
							OR = {
								title:k_dorwinion.holder = root
								title:k_dorwinion.holder.top_liege = root
							}
						}
					}
					title:k_dorwinion = { set_de_jure_liege_title = title:e_szreldor }
				}
				if = { # Can be integrated via conquest of all of Dale (see rhun.0018)
					limit = { completely_controls = title:k_dale }
					title:k_dale= { set_de_jure_liege_title = title:e_szreldor }
					title:k_logathavuld = { set_de_jure_liege_title = title:e_szreldor }
				}
				if = { # Can be integrated via conquest of all of Nelornieth (see rhun.0019)
					limit = { completely_controls = title:k_nelornieth }
					title:k_nelornieth = { set_de_jure_liege_title = title:e_szreldor }
				}
				if = {
					limit = { completely_controls = title:d_tumcelon }
					title:k_brownlands = { set_de_jure_liege_title = title:e_szreldor }
				}
				# if = {
				# 	limit = { completely_controls = title:k_south_rhovanion }
				# 	title:k_south_rhovanion = { set_de_jure_liege_title = title:e_szreldor }
				# }
				# if = {
				# 	limit = { completely_controls = title:k_ehwathrumavuld }
				# 	title:k_ehwathrumavuld = { set_de_jure_liege_title = title:e_szreldor }
				# }
				if = {
					limit = { 
						title:e_szreldor.holder = root
					}
					title:k_south_rhovanion = { set_de_jure_liege_title = title:e_szreldor }
					title:k_ehwathrumavuld = { set_de_jure_liege_title = title:e_szreldor }
					title:k_nurunkizdin = { set_de_jure_liege_title = title:e_szreldor }
					set_realm_capital = title:c_szrel_kain
				}
			}
		# set_primary_title_to = title:e_szreldor
		# destroy_title = title:e_golden_realm_rhun
		# change_government = feudal_government
		}
	}
}

rhun.0023 = { # Hûz takes "decision_margoz_prepare_easterling_host" to prepare for war on Dorwinion
	content_source = realms_dlc
	type = character_event
	title = rhun.0023.t
	desc = rhun.0023.desc
	theme = claim_throne_scheme
	#override_background = corridor_night
	left_portrait = {
		character = root
		animation = 	chess_certain_win
	}
	right_portrait = {
		character = title:k_dorwinion.holder
		animation = 	stress
	}
	option = { # 
		name = rhun.0023.a
		custom_tooltip = rhun.0023.a.tt
		#character:lineofzhamian3 = {
			#trigger_event = {
				# id = rhun.0014	
				#years = 14
			#}	
		#}	
	}
}

# rhun.0024 = { # Hûz takes "decision_margoz_election_choice" and determines wether to go for the Szreldor, or Golden Realm Route
# 	content_source = realms_dlc
# 	type = character_event
# 	title = rhun.0024.t
# 	desc = rhun.0024.desc
# 	theme = claim_throne_scheme
# 	#override_background = corridor_night
# 	left_portrait = {
# 		character = root
# 		animation = personality_callous
# 	}
# 	right_portrait = {
# 		character = character:lineofvronkhar36
# 		animation = personality_coward
# 	}
# 	lower_center_portrait = {
# 		character = title:k_dragon_knights.holder
# 	}
# 	option = { # 
# 		name = rhun.0024.a
# 		custom_tooltip = rhun.0024.a.tt
# 		add_to_global_variable_list = {
# 			name = unavailable_unique_decisions
# 			target = flag:decision_margoz_election_choice_golden_realm
# 		}	
# 	}
# 	option = { # 
# 		name = rhun.0024.b
# 		custom_tooltip = rhun.0024.b.tt
# 		add_to_global_variable_list = {
# 			name = unavailable_unique_decisions
# 			target = flag:decision_margoz_election_choice_szreldor
# 		}	
# 	}
# }

rhun.0025 = { # The dragon knights join the war in the north
	content_source = realms_dlc
	type = character_event
	title = rhun.0025.t
	desc = rhun.0025.desc
	theme = war
	#override_background = corridor_night
	left_portrait = {
		character = root
		animation = sword_coup_degrace
	}
	right_portrait = {
		character = title:e_golden_realm_rhun.holder
		animation = laugh
	}
	lower_center_portrait = {
		character = title:k_dale.holder
	}
	option = { # 
		name = rhun.0025.a
		custom_tooltip = rhun.0025.a.tt
		title:e_golden_realm_rhun.holder = {
			spawn_army = {		 
				uses_supply = no
				inheritable = yes
				name = Loke_Rim_Host
				men_at_arms = {
					type = easterling_pikemen
					stacks = 4
				}
				men_at_arms = {
					type = loke_innas_rim
					stacks = 10
				}
				location = capital_province
			}
  			random_character_war = { # 
			  limit = { using_cb = war_in_the_north_cb } # In-case the random head of the attackers has other wars hes currently engaged in
			  save_scope_as = war_in_the_north
  			}
		}
		every_character_war = {
			limit = { using_cb = war_in_the_north_cb } # In-case the random head of the attackers has other wars hes currently engaged in
			save_scope_as = war_in_the_north
		}
		scope:war_in_the_north = {
			add_attacker = root
		}
		title:e_golden_realm_rhun.holder = {
			every_character_war = {
				limit = {
					#is_attacker = title:e_golden_realm_rhun.holder
					any_war_defender = { highest_held_title_tier = tier_kingdom }
				}
				add_attacker = root
			}
		#add_to_global_variable_list = {
		#	name = unavailable_unique_decisions
		#	target = flag:decision_margoz_election_choice_golden_realm
		#}	
	}
	#option = { # 
	#	name = rhun.0024.b
	#	custom_tooltip = rhun.0024.b.tt
	#	add_to_global_variable_list = {
	#		name = unavailable_unique_decisions
	#		target = flag:decision_margoz_election_choice_szreldor
	#	}	
	#}
	}
}

rhun.0026 = { # Margoz reacts to Hawin's death
	content_source = realms_dlc
	type = character_event
	title = rhun.0026.t
	desc = rhun.0026.desc
	theme = murder_scheme
	left_portrait = {
		character = root
		animation = laugh
	}
	right_portrait = {
		character = character:lineofbarvadinian35
		animation = scheme
	}
	option = {
		name = rhun.0026.a
		custom_tooltip = rhun.0026.a.tt
		# character:lineofcassimir22 = {
		# 	# trigger_event = {
		# 	# 	id = umbar.0202
		# 	# 	days = 14
		# 	# }
		# }
	}
}

rhun.0027 = { # Hawin dies of death
	content_source = realms_dlc
	type = character_event
	title = rhun.0027.t
	desc = rhun.0027.desc
	theme = death
	left_portrait = {
		character = character:lineofkoldana98
		animation = fear 
	}
	right_portrait = {
		character = character:lineofbarvadinian35
		animation = scheme
	}
	option = {
		name = rhun.0027.a
		death = { 		
			death_reason = death_murder	
			killer = character:lineofbarvadinian35
		}
		# character:lineblackqueen9 = {
		# 	trigger_event = {
		# 		id = umbar.0203
		# 	}
		# }
	}
}

rhun.0030 = {
	hidden = yes

	immediate = {
		title:k_dale.holder = {
			random_character_war = {
				limit = { using_cb = war_in_the_north_cb }
				save_scope_as = war_in_the_north
			}
		}
		scope:war_in_the_north = {
			add_defender = title:k_erebor.holder
		}
	}
}