namespace = khand

### Khand Events ###

#		khand.0100 #Introduction
#		khand.0210-0260 #Challenges
#		khand.0300 #Conclusion
#       khand.0999 # Finish with no result

khand.0001 = { # The Name of a King / Queen
	content_source = realms_dlc
	type = character_event
	title = khand.0001.t
	desc = {
		triggered_desc = { # Male
			trigger = { 
				is_male = yes
			} 
			desc = khand.0001.desc.male
		}
		triggered_desc = { # Female
			trigger = { 
				is_male = no
			} 
			desc = khand.0001.desc.female
		}
	}
	theme = realm

	left_portrait = {
		character = root
		animation = personality_bold
	}
	right_portrait = {
		character = scope:heir
		animation = personality_bold
	}

    trigger = { NOT = { has_character_flag = ovatha_ready_for_war } }

    immediate = {
        if = {
            limit = {
                culture = { has_cultural_tradition = tradition_variag_succession}
                NOT = { has_trait = conqueror }
            }
            add_trait = conqueror
        }
    }

	option = { # Ôvatha
		trigger = { is_male = yes }
		name = khand.0001.a
		#change_first_name = "O_O_vatha"
		custom_tooltip = {
			text = change_name_to_ovatha
			change_first_name = { template_character = character:nazgul9 }
		}
	    if = {
	    	limit = {
                has_dlc_feature = legends
                NOT = {
                    dynasty = {
                        has_variable = ovatha_legend_seed
                        var:ovatha_legend_seed ?= yes
                    }
                }
            }
	    	legend_seed_new_title_effect = yes
            dynasty = {
                set_variable = {
					name = ovatha_legend_seed
					value = yes
				}
            }
	    }
		ai_chance = {
			base = 100
		}
	}

	option = { # Ôvaizha
		trigger = { is_male = no }	
		name = khand.0001.b
		custom_tooltip = {
			text = change_name_to_ovaizha
			change_first_name = "O_O_vaizha"
		}
	    if = {
	    	limit = {
                has_dlc_feature = legends
                NOT = {
                    dynasty = {
                        has_variable = ovatha_legend_seed
                        var:ovatha_legend_seed ?= yes
                    }
                }
            }
	    	legend_seed_new_title_effect = yes
            dynasty = {
                set_variable = {
					name = ovatha_legend_seed
					value = yes
				}
            }
	    }
		ai_chance = {
			base = 100
		}
	}

	option = { # I'll keep my name
		name = khand.0001.c
		ai_chance = {
			base = 0
		}
	}
}

# Introduce Heir to Vassals Decision - Events

khand.0100 = { # Khand: Introduction of "Presenting the Heir"
	content_source = realms_dlc
	type = character_event
	title = khand.0100.t
	desc = khand.0100.desc
	theme = realm

	left_portrait = {
		character = root
		animation = personality_bold
	}
	right_portrait = {
		character = scope:heir
		animation = personality_bold
	}

	immediate = {
		scope:heir = {
			set_variable = {
				name = trial_wins
				value = 0
			}
            set_variable = {
				name = trial_losses
				value = 0
			}
			set_variable = {
				name = trials_had
				value = 0
			}
		}
		random_powerful_vassal = {
			limit = {
				is_available_ai_adult = yes
			}
			save_scope_as = challenge_setter
		}
		clear_variable_list = challenge_setter_list
		scope:challenge_setter ?= {
			add_to_list = challenge_setter_list
		}
	}

	option = { # Proceed with the first trial
		name = khand.0100.a
		scope:heir = { add_character_flag = has_been_introduced_as_heir }
		trigger_event = {
			on_action = introduce_the_heir_event_pool
			days = 10
		}
	}
	option = { # Last chance to back out
		name = khand.0100.b
        remove_decision_cooldown = decision_introduce_the_heir
	}
}

khand.0101 = { # Maintenance - pick next challenge setter
	hidden = yes

	immediate = {
		if = { #First try to use powerful vassals
			limit = {
				any_powerful_vassal = {
					is_available_ai_adult = yes
					NOT = { is_in_list = challenge_setter_list } #Check they haven't offered a challenge before
				}
			}
			random_powerful_vassal = {
				limit = {
					is_available_ai_adult = yes
					NOT = { is_in_list = challenge_setter_list } #Check they haven't offered a challenge before
				}
				add_to_list = challenge_setter_list
				save_scope_as = challenge_setter
			}
		}
		else_if = { #Then try to use normal vassals
			limit = {
				any_vassal = {
					is_available_ai_adult = yes
					NOT = { is_in_list = challenge_setter_list } #Check they haven't offered a challenge before
				}
			}
			random_vassal = {
				limit = {
					is_available_ai_adult = yes
					NOT = { is_in_list = challenge_setter_list } #Check they haven't offered a challenge before
				}
				add_to_list = challenge_setter_list
				save_scope_as = challenge_setter
			}
		}
		else = { #Use courtiers as last resort! (should almost certainly never trigger!
			random_courtier = {
				limit = {
					is_available_ai_adult = yes
					NOT = { is_in_list = challenge_setter_list } #Check they haven't offered a challenge before
				}
				add_to_list = challenge_setter_list
				save_scope_as = challenge_setter
			}
		}
		
		trigger_event = {
			on_action = introduce_the_heir_event_pool
			days = 10
		}
	}
}

khand.0210 = { # Wargames - Martial / Learning - Battlefield Planning
	content_source = realms_dlc
	type = character_event
	title = khand.0210.t
	desc = khand.0210.desc
	theme = realm

	left_portrait = {
		character = scope:heir
		animation = personality_rational
	}
	right_portrait = {
		character = scope:challenge_setter
        trigger = { exists = scope:challenge_setter }
		animation = personality_bold
	}

	trigger = {
		NOT = {
			has_character_flag = khand_0210_done
		}
	}

	weight_multiplier = {
		base = 0.5
		modifier = {
			add = 5
			scope:challenge_setter ?= { highest_skill = martial }
		}
	}

	immediate = {
		add_character_flag = {
			flag = khand_0210_done
			years = 1
		}
	}
	
	option = { # Martial
		name = khand.0210.a
		skill = martial
		scope:heir = {
			change_variable = { 
				name = trials_had
				add = 1
			}
			duel = {
				skill = martial 
				value = 10
				50 = { 
					compare_modifier = {
						value = scope:duel_value
						multiplier = 5
						min = -49
					}
					desc = khand.0210.a.duel_success
					change_variable = { 
						name = trial_wins
						add = 1
					}
					root = {
						send_interface_toast = {
							left_icon = scope:heir
							right_icon = scope:challenge_setter
							title = khand.0210.success
							custom_tooltip = khand.impressed_vassals
						}
					}
				}
				50 = {
					compare_modifier = {
						value = scope:duel_value
						multiplier = -5
						min = -49
					}
					desc = khand.0210.a.duel_failure
					root = {
						send_interface_toast = {
							left_icon = scope:heir
							right_icon = scope:challenge_setter
							title = khand.0210.failure
							custom_tooltip = khand.unimpressed_vassals
						}
					}
				}
			}
		}
		if = {
			limit = {
				scope:heir = {
					has_variable = trials_had
					var:trials_had = 5
				}
			}
            if = {
                limit = {
                    scope:heir = {
                        has_variable = trial_wins
                        var:trial_wins < 2
                    }
                }
                trigger_event = {
                    id = khand.0300 # Bad Result
                    days = 10
                }
            }
            else_if = {
                limit = {
                    scope:heir = {
                        has_variable = trial_wins
                        var:trial_wins < 4
                    }
                }
                trigger_event = {
                    id = khand.0301 # Average Result
                    days = 10
                }
            }
            else = {
                trigger_event = {
                    id = khand.0302 # Good Result
                    days = 10
                }
            }
		}
		else = {
			trigger_event = khand.0101
		}
	}

	option = { # Learning
		name = khand.0210.b
		skill = learning
		scope:heir = {
			change_variable = { 
				name = trials_had
				add = 1
			}
			duel = {
				skill = learning 
				value = 10
				50 = { 
					compare_modifier = {
						value = scope:duel_value
						multiplier = 5
						min = -49
					}
					desc = khand.0210.b.duel_success
					
					change_variable = { 
						name = trial_wins
						add = 1
					}
					root = {
						send_interface_toast = {
							left_icon = scope:heir
							right_icon = scope:challenge_setter
							title = khand.0210.success
							custom_tooltip = khand.impressed_vassals
						}
					}
				}
				50 = {
					compare_modifier = {
						value = scope:duel_value
						multiplier = -5
						min = -49
					}
					desc = khand.0210.b.duel_failure
					change_variable = { 
						name = trial_losses
						add = 1
					}
					root = {
						send_interface_toast = {
							left_icon = scope:heir
							right_icon = scope:challenge_setter
							title = khand.0210.failure
							custom_tooltip = khand.unimpressed_vassals
						}
					}
				}
			}
		}
		if = {
			limit = {
				scope:heir = {
					has_variable = trials_had
					var:trials_had = 5
				}
			}
            if = {
                limit = {
                    scope:heir = {
                        has_variable = trial_wins
                        var:trial_wins < 2
                    }
                }
                trigger_event = {
                    id = khand.0300 # Bad Result
                    days = 10
                }
            }
            else_if = {
                limit = {
                    scope:heir = {
                        has_variable = trial_wins
                        var:trial_wins < 4
                    }
                }
                trigger_event = {
                    id = khand.0301 # Average Result
                    days = 10
                }
            }
            else = {
                trigger_event = {
                    id = khand.0302 # Good Result
                    days = 10
                }
            }
		}
		else = {
			trigger_event = khand.0101
		}
	}

	option = { # Bribe
		name = khand.0210.c
		custom_tooltip = introduce_the_heir.bribe_effect_desc
        save_scope_as = actor
		scope:challenge_setter ?= {
			save_scope_as = recipient
		}
		pay_short_term_gold = {
			gold = gift_value
			target = scope:recipient
		}
		add_prestige = {
			value = gift_value
			multiply = -1
		}
		trigger_event = khand.0211
	}

	option = { # Hook
		name = khand.0210.d
		custom_tooltip = introduce_the_heir.hook_effect_desc
		trigger = {
            exists = scope:challenge_setter
			has_hook = scope:challenge_setter
		}
		use_hook = scope:challenge_setter
		trigger_event = khand.0211
	}

}

khand.0211 = { # Wargames - Martial / Learning - Battlefield Planning - Going Easy on Heir
	content_source = realms_dlc
	type = character_event
	title = khand.0211.t
	desc = khand.0211.desc
	theme = realm

	left_portrait = {
		character = scope:heir
		animation = personality_rational
	}
	right_portrait = {
		character = scope:challenge_setter
        trigger = { exists = scope:challenge_setter }
		animation = personality_bold
	}
	
	option = { # Martial
		name = khand.0211.a
		skill = martial
		scope:heir = {
			change_variable = { 
				name = trials_had
				add = 1
			}
			duel = {
				skill = martial 
				value = 5
				50 = { 
					compare_modifier = {
						value = scope:duel_value
						multiplier = 5
						min = -49
					}
					desc = khand.0210.a.duel_success
					change_variable = { 
						name = trial_wins
						add = 1
					}
					root = {
						send_interface_toast = {
							left_icon = scope:heir
							right_icon = scope:challenge_setter
							title = khand.0210.success
							custom_tooltip = khand.impressed_vassals
						}
					}
				}
				50 = {
					compare_modifier = {
						value = scope:duel_value
						multiplier = -5
						min = -49
					}
					desc = khand.0210.a.duel_failure
					root = {
						send_interface_toast = {
							left_icon = scope:heir
							right_icon = scope:challenge_setter
							title = khand.0210.failure
							custom_tooltip = khand.unimpressed_vassals
						}
					}
				}
			}
		}
	}

	option = { # Learning
		name = khand.0211.b
		skill = learning
		scope:heir = {
			change_variable = { 
				name = trials_had
				add = 1
			}
			duel = {
				skill = learning 
				value = 5
				50 = { 
					compare_modifier = {
						value = scope:duel_value
						multiplier = 5
						min = -49
					}
					desc = khand.0210.b.duel_success					
					change_variable = { 
						name = trial_wins
						add = 1
					}
					root = {
						send_interface_toast = {
							left_icon = scope:heir
							right_icon = scope:challenge_setter
							title = khand.0210.success
							custom_tooltip = khand.impressed_vassals
						}
					}
				}
				50 = {
					compare_modifier = {
						value = scope:duel_value
						multiplier = -5
						min = -49
					}
					desc = khand.0210.b.duel_failure
					change_variable = { 
						name = trial_losses
						add = 1
					}
					root = {
						send_interface_toast = {
							left_icon = scope:heir
							right_icon = scope:challenge_setter
							title = khand.0210.failure
							custom_tooltip = khand.unimpressed_vassals
						}
					}
				}
			}
		}
	}

	after = {
		if = {
			limit = {
				scope:heir = {
					has_variable = trials_had
					var:trials_had = 5
				}
			}
            if = {
                limit = {
                    scope:heir = {
                        has_variable = trial_wins
                        var:trial_wins < 2
                    }
                }
                trigger_event = {
                    id = khand.0300 # Bad Result
                    days = 10
                }
            }
            else_if = {
                limit = {
                    scope:heir = {
                        has_variable = trial_wins
                        var:trial_wins < 4
                    }
                }
                trigger_event = {
                    id = khand.0301 # Average Result
                    days = 10
                }
            }
            else = {
                trigger_event = {
                    id = khand.0302 # Good Result
                    days = 10
                }
            }
		}
		else = {
			trigger_event = khand.0101
		}
	}
}

khand.0220 = { # The Laws of Gods and Clans - Learning / Stewardship
	content_source = realms_dlc
	type = character_event
    title = khand.0220.t
    desc = khand.0220.desc
    theme = realm

    left_portrait = {
        character = scope:heir
        animation = personality_rational
    }
    right_portrait = {
        character = scope:challenge_setter
        trigger = { exists = scope:challenge_setter }
        animation = schadenfreude
    }

    trigger = {
        NOT = {
            has_character_flag = khand_0220_done
        }
    }

	weight_multiplier = {
		base = 0.5
		modifier = {
			add = 5
			scope:challenge_setter ?= { highest_skill = learning }
		}
	}

    immediate = {
        add_character_flag = {
            flag = khand_0220_done
            years = 1
        }
    }

    option = { # Learning
        name = khand.0220.a
        skill = learning
        scope:heir = {
            change_variable = { 
                name = trials_had
                add = 1
            }
            duel = {
                skill = learning 
                value = 10
                50 = { 
                    compare_modifier = {
                        value = scope:duel_value
                        multiplier = 5
                        min = -49
                    }
                    desc = khand.0220.a.duel_success
                    change_variable = { 
                        name = trial_wins
                        add = 1
                    }
                    root = {
                        send_interface_toast = {
                            left_icon = scope:heir
                            right_icon = scope:challenge_setter
                            title = khand.0210.success
                            custom_tooltip = khand.impressed_vassals
                        }
                    }
                }
                50 = {
                    compare_modifier = {
                        value = scope:duel_value
                        multiplier = -5
                        min = -49
                    }
                    desc = khand.0220.a.duel_failure
                    root = {
                        send_interface_toast = {
                            left_icon = scope:heir
                            right_icon = scope:challenge_setter
                            title = khand.0210.failure
                            custom_tooltip = khand.unimpressed_vassals
                        }
                    }
                }
            }
        }
        if = {
			limit = {
				scope:heir = {
					has_variable = trials_had
					var:trials_had = 5
				}
			}
            if = {
                limit = {
                    scope:heir = {
                        has_variable = trial_wins
                        var:trial_wins < 2
                    }
                }
                trigger_event = {
                    id = khand.0300 # Bad Result
                    days = 10
                }
            }
            else_if = {
                limit = {
                    scope:heir = {
                        has_variable = trial_wins
                        var:trial_wins < 4
                    }
                }
                trigger_event = {
                    id = khand.0301 # Average Result
                    days = 10
                }
            }
            else = {
                trigger_event = {
                    id = khand.0302 # Good Result
                    days = 10
                }
            }
		}
        else = {
            trigger_event = khand.0101
        }
    }

    option = { # Stewardship
        name = khand.0220.b
        skill = stewardship
        scope:heir = {
            change_variable = { 
                name = trials_had
                add = 1
            }
            duel = {
                skill = stewardship 
                value = 10
                50 = { 
                    compare_modifier = {
                        value = scope:duel_value
                        multiplier = 5
                        min = -49
                    }
                    desc = khand.0220.b.duel_success
                    
                    change_variable = { 
                        name = trial_wins
                        add = 1
                    }
                    root = {
                        send_interface_toast = {
                            left_icon = scope:heir
                            right_icon = scope:challenge_setter
                            title = khand.0210.success
                            custom_tooltip = khand.impressed_vassals
                        }
                    }
                }
                50 = {
                    compare_modifier = {
                        value = scope:duel_value
                        multiplier = -5
                        min = -49
                    }
                    desc = khand.0220.b.duel_failure
                    change_variable = { 
                        name = trial_losses
                        add = 1
                    }
                    root = {
                        send_interface_toast = {
                            left_icon = scope:heir
                            right_icon = scope:challenge_setter
                            title = khand.0210.failure
                            custom_tooltip = khand.unimpressed_vassals
                        }
                    }
                }
            }
        }
        if = {
			limit = {
				scope:heir = {
					has_variable = trials_had
					var:trials_had = 5
				}
			}
            if = {
                limit = {
                    scope:heir = {
                        has_variable = trial_wins
                        var:trial_wins < 2
                    }
                }
                trigger_event = {
                    id = khand.0300 # Bad Result
                    days = 10
                }
            }
            else_if = {
                limit = {
                    scope:heir = {
                        has_variable = trial_wins
                        var:trial_wins < 4
                    }
                }
                trigger_event = {
                    id = khand.0301 # Average Result
                    days = 10
                }
            }
            else = {
                trigger_event = {
                    id = khand.0302 # Good Result
                    days = 10
                }
            }
		}
        else = {
            trigger_event = khand.0101
        }
    }

    option = { # Bribe
        name = khand.0220.c
        custom_tooltip = introduce_the_heir.bribe_effect_desc
        save_scope_as = actor
        scope:challenge_setter ?= {
            save_scope_as = recipient
        }
        pay_short_term_gold = {
            gold = gift_value
            target = scope:recipient
        }
        add_prestige = {
            value = gift_value
            multiply = -1
        }
        trigger_event = khand.0221
    }

    option = { # Hook
        name = khand.0220.d
        custom_tooltip = introduce_the_heir.hook_effect_desc
        trigger = {
            exists = scope:challenge_setter
            has_hook = scope:challenge_setter
        }
        use_hook = scope:challenge_setter
        trigger_event = khand.0221
    }
}

khand.0221 = { # The Laws of Gods and Clans - Learning / Stewardship - Going Easy on Heir
	content_source = realms_dlc
	type = character_event
    title = khand.0221.t
    desc = khand.0221.desc
    theme = realm

    left_portrait = {
        character = scope:heir
        animation = personality_forgiving
    }
    right_portrait = {
        character = scope:challenge_setter
        trigger = { exists = scope:challenge_setter }
        animation = personality_compassionate
    }
    
    option = { # Learning
        name = khand.0221.a
        skill = learning
        scope:heir = {
            change_variable = { 
                name = trials_had
                add = 1
            }
            duel = {
                skill = learning 
                value = 5
                50 = { 
                    compare_modifier = {
                        value = scope:duel_value
                        multiplier = 5
                        min = -49
                    }
                    desc = khand.0220.a.duel_success
                    change_variable = { 
                        name = trial_wins
                        add = 1
                    }
                    root = {
                        send_interface_toast = {
                            left_icon = scope:heir
                            right_icon = scope:challenge_setter
                            title = khand.0210.success
                            custom_tooltip = khand.impressed_vassals
                        }
                    }
                }
                50 = {
                    compare_modifier = {
                        value = scope:duel_value
                        multiplier = -5
                        min = -49
                    }
                    desc = khand.0220.a.duel_failure
                    root = {
                        send_interface_toast = {
                            left_icon = scope:heir
                            right_icon = scope:challenge_setter
                            title = khand.0210.failure
                            custom_tooltip = khand.unimpressed_vassals
                        }
                    }
                }
            }
        }
    }

    option = { # Stewardship
        name = khand.0221.b
        skill = stewardship
        scope:heir = {
            change_variable = { 
                name = trials_had
                add = 1
            }
            duel = {
                skill = stewardship 
                value = 5
                50 = { 
                    compare_modifier = {
                        value = scope:duel_value
                        multiplier = 5
                        min = -49
                    }
                    desc = khand.0220.b.duel_success                    
                    change_variable = { 
                        name = trial_wins
                        add = 1
                    }
                    root = {
                        send_interface_toast = {
                            left_icon = scope:heir
                            right_icon = scope:challenge_setter
                            title = khand.0210.success
                            custom_tooltip = khand.impressed_vassals
                        }
                    }
                }
                50 = {
                    compare_modifier = {
                        value = scope:duel_value
                        multiplier = -5
                        min = -49
                    }
                    desc = khand.0220.b.duel_failure
                    change_variable = { 
                        name = trial_losses
                        add = 1
                    }
                    root = {
                        send_interface_toast = {
                            left_icon = scope:heir
                            right_icon = scope:challenge_setter
                            title = khand.0210.failure
                            custom_tooltip = khand.unimpressed_vassals
                        }
                    }
                }
            }
        }
    }

    after = {
        if = {
			limit = {
				scope:heir = {
					has_variable = trials_had
					var:trials_had = 5
				}
			}
            if = {
                limit = {
                    scope:heir = {
                        has_variable = trial_wins
                        var:trial_wins < 2
                    }
                }
                trigger_event = {
                    id = khand.0300 # Bad Result
                    days = 10
                }
            }
            else_if = {
                limit = {
                    scope:heir = {
                        has_variable = trial_wins
                        var:trial_wins < 4
                    }
                }
                trigger_event = {
                    id = khand.0301 # Average Result
                    days = 10
                }
            }
            else = {
                trigger_event = {
                    id = khand.0302 # Good Result
                    days = 10
                }
            }
		}
        else = {
            trigger_event = khand.0101
        }
    }
}

khand.0230 = { # A War of Words - Diplomacy / Intrigue
	content_source = realms_dlc
	type = character_event
	title = khand.0230.t
	desc = khand.0230.desc
	theme = realm

	left_portrait = {
		character = scope:heir
		animation = personality_cynical
	}
	right_portrait = {
		character = scope:challenge_setter
        trigger = { exists = scope:challenge_setter }
		animation = flirtation
	}

	trigger = {
		NOT = {
			has_character_flag = khand_0230_done
		}
	}

	weight_multiplier = {
		base = 0.5
		modifier = {
			add = 5
			scope:challenge_setter ?= { highest_skill = diplomacy }
		}
	}

	immediate = {
		add_character_flag = {
			flag = khand_0230_done
			years = 1
		}
	}

	option = { # Diplomacy
		name = khand.0230.a
		skill = diplomacy
		scope:heir = {
			change_variable = { 
				name = trials_had
				add = 1
			}
			duel = {
				skill = diplomacy 
				value = 10
				50 = { 
					compare_modifier = {
						value = scope:duel_value
						multiplier = 5
						min = -49
					}
					desc = khand.0230.a.duel_success
					change_variable = { 
						name = trial_wins
						add = 1
					}
					root = {
						send_interface_toast = {
							left_icon = scope:heir
							right_icon = scope:challenge_setter
							title = khand.0210.success
							custom_tooltip = khand.impressed_vassals
						}
					}
				}
				50 = {
					compare_modifier = {
						value = scope:duel_value
						multiplier = -5
						min = -49
					}
					desc = khand.0230.a.duel_failure
					root = {
						send_interface_toast = {
							left_icon = scope:heir
							right_icon = scope:challenge_setter
							title = khand.0210.failure
							custom_tooltip = khand.unimpressed_vassals
						}
					}
				}
			}
		}
		if = {
			limit = {
				scope:heir = {
					has_variable = trials_had
					var:trials_had = 5
				}
			}
            if = {
                limit = {
                    scope:heir = {
                        has_variable = trial_wins
                        var:trial_wins < 2
                    }
                }
                trigger_event = {
                    id = khand.0300 # Bad Result
                    days = 10
                }
            }
            else_if = {
                limit = {
                    scope:heir = {
                        has_variable = trial_wins
                        var:trial_wins < 4
                    }
                }
                trigger_event = {
                    id = khand.0301 # Average Result
                    days = 10
                }
            }
            else = {
                trigger_event = {
                    id = khand.0302 # Good Result
                    days = 10
                }
            }
		}
		else = {
			trigger_event = khand.0101
		}
	}

	option = { # Intrigue
		name = khand.0230.b
		skill = intrigue
		scope:heir = {
			change_variable = { 
				name = trials_had
				add = 1
			}
			duel = {
				skill = intrigue 
				value = 10
				50 = { 
					compare_modifier = {
						value = scope:duel_value
						multiplier = 5
						min = -49
					}
					desc = khand.0230.b.duel_success
					
					change_variable = { 
						name = trial_wins
						add = 1
					}
					root = {
						send_interface_toast = {
							left_icon = scope:heir
							right_icon = scope:challenge_setter
							title = khand.0210.success
							custom_tooltip = khand.impressed_vassals
						}
					}
				}
				50 = {
					compare_modifier = {
						value = scope:duel_value
						multiplier = -5
						min = -49
					}
					desc = khand.0230.b.duel_failure
					change_variable = {
						name = trial_losses
						add = 1
					}
					root = {
						send_interface_toast = {
							left_icon = scope:heir
							right_icon = scope:challenge_setter
							title = khand.0210.failure
							custom_tooltip = khand.unimpressed_vassals
						}
					}
				}
			}
		}
		if = {
			limit = {
				scope:heir = {
					has_variable = trials_had
					var:trials_had = 5
				}
			}
            if = {
                limit = {
                    scope:heir = {
                        has_variable = trial_wins
                        var:trial_wins < 2
                    }
                }
                trigger_event = {
                    id = khand.0300 # Bad Result
                    days = 10
                }
            }
            else_if = {
                limit = {
                    scope:heir = {
                        has_variable = trial_wins
                        var:trial_wins < 4
                    }
                }
                trigger_event = {
                    id = khand.0301 # Average Result
                    days = 10
                }
            }
            else = {
                trigger_event = {
                    id = khand.0302 # Good Result
                    days = 10
                }
            }
		}
		else = {
			trigger_event = khand.0101
		}
	}

	option = { # Bribe
		name = khand.0230.c
		custom_tooltip = introduce_the_heir.bribe_effect_desc
        save_scope_as = actor
		scope:challenge_setter ?= {
			save_scope_as = recipient
		}
		pay_short_term_gold = {
			gold = gift_value
			target = scope:recipient
		}
		add_prestige = {
			value = gift_value
			multiply = -1
		}
		trigger_event = khand.0231
	}

	option = { # Hook
		name = khand.0230.d
		custom_tooltip = introduce_the_heir.hook_effect_desc
		trigger = {
            exists = scope:challenge_setter
			has_hook = scope:challenge_setter
		}
		use_hook = scope:challenge_setter
		trigger_event = khand.0231
	}
}

khand.0231 = { # A War of Words - Diplomacy / Intrigue - Going Easy on Heir
	content_source = realms_dlc
	type = character_event
	title = khand.0231.t
	desc = khand.0231.desc
	theme = realm

	left_portrait = {
		character = scope:heir
		animation = schadenfreude
	}
	right_portrait = {
		character = scope:standin
		animation = disbelief
	}
	
    immediate = {
        random_vassal = {
            limit = {
                is_available_ai_adult = yes
                NOT = { is_in_list = challenge_setter_list } #Check they haven't offered a challenge before
                NOT = { highest_skill = diplomacy }
            }
            save_scope_as = standin
        }
    }

	option = { # Diplomacy
		name = khand.0231.a
		skill = diplomacy
		scope:heir = {
			change_variable = { 
				name = trials_had
				add = 1
			}
			duel = {
				skill = diplomacy 
				value = 5
				50 = { 
					compare_modifier = {
						value = scope:duel_value
						multiplier = 5
						min = -49
					}
					desc = khand.0230.a.duel_success
					change_variable = { 
						name = trial_wins
						add = 1
					}
					root = {
						send_interface_toast = {
							left_icon = scope:heir
							right_icon = scope:challenge_setter
							title = khand.0210.success
							custom_tooltip = khand.impressed_vassals
						}
					}
				}
				50 = {
					compare_modifier = {
						value = scope:duel_value
						multiplier = -5
						min = -49
					}
					desc = khand.0230.a.duel_failure
					root = {
						send_interface_toast = {
							left_icon = scope:heir
							right_icon = scope:challenge_setter
							title = khand.0210.failure
							custom_tooltip = khand.unimpressed_vassals
						}
					}
				}
			}
		}
	}

	option = { # Intrigue
		name = khand.0231.b
		skill = intrigue
		scope:heir = {
			change_variable = { 
				name = trials_had
				add = 1
			}
			duel = {
				skill = intrigue 
				value = 5
				50 = { 
					compare_modifier = {
						value = scope:duel_value
						multiplier = 5
						min = -49
					}
					desc = khand.0230.b.duel_success					
					change_variable = { 
						name = trial_wins
						add = 1
					}
					root = {
						send_interface_toast = {
							left_icon = scope:heir
							right_icon = scope:challenge_setter
							title = khand.0210.success
							custom_tooltip = khand.impressed_vassals
						}
					}
				}
				50 = {
					compare_modifier = {
						value = scope:duel_value
						multiplier = -5
						min = -49
					}
					desc = khand.0230.b.duel_failure
					change_variable = { 
						name = trial_losses
						add = 1
					}
					root = {
						send_interface_toast = {
							left_icon = scope:heir
							right_icon = scope:challenge_setter
							title = khand.0210.failure
							custom_tooltip = khand.unimpressed_vassals
						}
					}
				}
			}
		}
	}

	after = {
		if = {
			limit = {
				scope:heir = {
					has_variable = trials_had
					var:trials_had = 5
				}
			}
            if = {
                limit = {
                    scope:heir = {
                        has_variable = trial_wins
                        var:trial_wins < 2
                    }
                }
                trigger_event = {
                    id = khand.0300 # Bad Result
                    days = 10
                }
            }
            else_if = {
                limit = {
                    scope:heir = {
                        has_variable = trial_wins
                        var:trial_wins < 4
                    }
                }
                trigger_event = {
                    id = khand.0301 # Average Result
                    days = 10
                }
            }
            else = {
                trigger_event = {
                    id = khand.0302 # Good Result
                    days = 10
                }
            }
		}
		else = {
			trigger_event = khand.0101
		}
	}
}

khand.0240 = { # Deal or No Deal - Stewardship / Diplomacy
	content_source = realms_dlc
	type = character_event
    title = khand.0240.t
    desc = khand.0240.desc
    theme = realm

    left_portrait = {
        character = scope:heir
        animation = shame
    }
    right_portrait = {
        character = scope:challenge_setter
        trigger = { exists = scope:challenge_setter }
        animation = personality_forgiving
    }

    trigger = {
        NOT = {
            has_character_flag = khand_0240_done
        }
    }

	weight_multiplier = {
		base = 0.5
		modifier = {
			add = 5
			scope:challenge_setter ?= { highest_skill = stewardship }
		}
	}

    immediate = {
        add_character_flag = {
            flag = khand_0240_done
            years = 1
        }
    }

    option = { # Stewardship
        name = khand.0240.a
        skill = stewardship
        scope:heir = {
            change_variable = { 
                name = trials_had
                add = 1
            }
            duel = {
                skill = stewardship 
                value = 10
                50 = { 
                    compare_modifier = {
                        value = scope:duel_value
                        multiplier = 5
                        min = -49
                    }
                    desc = khand.0240.a.duel_success
                    change_variable = { 
                        name = trial_wins
                        add = 1
                    }
                    root = {
                        send_interface_toast = {
                            left_icon = scope:heir
                            right_icon = scope:challenge_setter
                            title = khand.0210.success
                            custom_tooltip = khand.impressed_vassals
                        }
                    }
                }
                50 = {
                    compare_modifier = {
                        value = scope:duel_value
                        multiplier = -5
                        min = -49
                    }
                    desc = khand.0240.a.duel_failure
                    root = {
                        send_interface_toast = {
                            left_icon = scope:heir
                            right_icon = scope:challenge_setter
                            title = khand.0210.failure
                            custom_tooltip = khand.unimpressed_vassals
                        }
                    }
                }
            }
        }
        if = {
			limit = {
				scope:heir = {
					has_variable = trials_had
					var:trials_had = 5
				}
			}
            if = {
                limit = {
                    scope:heir = {
                        has_variable = trial_wins
                        var:trial_wins < 2
                    }
                }
                trigger_event = {
                    id = khand.0300 # Bad Result
                    days = 10
                }
            }
            else_if = {
                limit = {
                    scope:heir = {
                        has_variable = trial_wins
                        var:trial_wins < 4
                    }
                }
                trigger_event = {
                    id = khand.0301 # Average Result
                    days = 10
                }
            }
            else = {
                trigger_event = {
                    id = khand.0302 # Good Result
                    days = 10
                }
            }
		}
        else = {
            trigger_event = khand.0101
        }
    }

    option = { # Diplomacy
        name = khand.0240.b
        skill = diplomacy
        scope:heir = {
            change_variable = { 
                name = trials_had
                add = 1
            }
            duel = {
                skill = diplomacy 
                value = 10
                50 = { 
                    compare_modifier = {
                        value = scope:duel_value
                        multiplier = 5
                        min = -49
                    }
                    desc = khand.0240.b.duel_success
                    
                    change_variable = { 
                        name = trial_wins
                        add = 1
                    }
                    root = {
                        send_interface_toast = {
                            left_icon = scope:heir
                            right_icon = scope:challenge_setter
                            title = khand.0210.success
                            custom_tooltip = khand.impressed_vassals
                        }
                    }
                }
                50 = {
                    compare_modifier = {
                        value = scope:duel_value
                        multiplier = -5
                        min = -49
                    }
                    desc = khand.0240.b.duel_failure
                    change_variable = { 
                        name = trial_losses
                        add = 1
                    }
                    root = {
                        send_interface_toast = {
                            left_icon = scope:heir
                            right_icon = scope:challenge_setter
                            title = khand.0210.failure
                            custom_tooltip = khand.unimpressed_vassals
                        }
                    }
                }
            }
        }
        if = {
			limit = {
				scope:heir = {
					has_variable = trials_had
					var:trials_had = 5
				}
			}
            if = {
                limit = {
                    scope:heir = {
                        has_variable = trial_wins
                        var:trial_wins < 2
                    }
                }
                trigger_event = {
                    id = khand.0300 # Bad Result
                    days = 10
                }
            }
            else_if = {
                limit = {
                    scope:heir = {
                        has_variable = trial_wins
                        var:trial_wins < 4
                    }
                }
                trigger_event = {
                    id = khand.0301 # Average Result
                    days = 10
                }
            }
            else = {
                trigger_event = {
                    id = khand.0302 # Good Result
                    days = 10
                }
            }
		}
        else = {
            trigger_event = khand.0101
        }
    }

    option = { # Bribe
        name = khand.0240.c
        custom_tooltip = introduce_the_heir.bribe_effect_desc
        save_scope_as = actor
        scope:challenge_setter ?= {
            save_scope_as = recipient
        }
        pay_short_term_gold = {
            gold = gift_value
            target = scope:recipient
        }
        add_prestige = {
            value = gift_value
            multiply = -1
        }
        trigger_event = khand.0241
    }

    option = { # Hook
        name = khand.0240.d
        custom_tooltip = introduce_the_heir.hook_effect_desc
        trigger = {
            exists = scope:challenge_setter
            has_hook = scope:challenge_setter
        }
        use_hook = scope:challenge_setter
        trigger_event = khand.0241
    }
}

khand.0241 = { # Deal or No Deal - Stewardship / Diplomacy - Going Easy on Heir
	content_source = realms_dlc
	type = character_event
    title = khand.0241.t
    desc = khand.0241.desc
    theme = realm

    left_portrait = {
        character = scope:heir
        animation = personality_content
    }
    right_portrait = {
        character = scope:challenge_setter
        trigger = { exists = scope:challenge_setter }
        animation = happiness
    }

    override_background = {
        reference = market
    }
    
    option = { # Stewardship
        name = khand.0241.a
        skill = stewardship
        scope:heir = {
            change_variable = { 
                name = trials_had
                add = 1
            }
            duel = {
                skill = stewardship 
                value = 5
                50 = { 
                    compare_modifier = {
                        value = scope:duel_value
                        multiplier = 5
                        min = -49
                    }
                    desc = khand.0240.a.duel_success
                    change_variable = { 
                        name = trial_wins
                        add = 1
                    }
                    root = {
                        send_interface_toast = {
                            left_icon = scope:heir
                            right_icon = scope:challenge_setter
                            title = khand.0210.success
                            custom_tooltip = khand.impressed_vassals
                        }
                    }
                }
                50 = {
                    compare_modifier = {
                        value = scope:duel_value
                        multiplier = -5
                        min = -49
                    }
                    desc = khand.0240.a.duel_failure
                    root = {
                        send_interface_toast = {
                            left_icon = scope:heir
                            right_icon = scope:challenge_setter
                            title = khand.0210.failure
                            custom_tooltip = khand.unimpressed_vassals
                        }
                    }
                }
            }
        }
    }

    option = { # Diplomacy
        name = khand.0241.b
        skill = diplomacy
        scope:heir = {
            change_variable = { 
                name = trials_had
                add = 1
            }
            duel = {
                skill = diplomacy 
                value = 5
                50 = { 
                    compare_modifier = {
                        value = scope:duel_value
                        multiplier = 5
                        min = -49
                    }
                    desc = khand.0240.b.duel_success                    
                    change_variable = { 
                        name = trial_wins
                        add = 1
                    }
                    root = {
                        send_interface_toast = {
                            left_icon = scope:heir
                            right_icon = scope:challenge_setter
                            title = khand.0210.success
                            custom_tooltip = khand.impressed_vassals
                        }
                    }
                }
                50 = {
                    compare_modifier = {
                        value = scope:duel_value
                        multiplier = -5
                        min = -49
                    }
                    desc = khand.0240.b.duel_failure
                    change_variable = { 
                        name = trial_losses
                        add = 1
                    }
                    root = {
                        send_interface_toast = {
                            left_icon = scope:heir
                            right_icon = scope:challenge_setter
                            title = khand.0210.failure
                            custom_tooltip = khand.unimpressed_vassals
                        }
                    }
                }
            }
        }
    }

    after = {
        if = {
			limit = {
				scope:heir = {
					has_variable = trials_had
					var:trials_had = 5
				}
			}
            if = {
                limit = {
                    scope:heir = {
                        has_variable = trial_wins
                        var:trial_wins < 2
                    }
                }
                trigger_event = {
                    id = khand.0300 # Bad Result
                    days = 10
                }
            }
            else_if = {
                limit = {
                    scope:heir = {
                        has_variable = trial_wins
                        var:trial_wins < 4
                    }
                }
                trigger_event = {
                    id = khand.0301 # Average Result
                    days = 10
                }
            }
            else = {
                trigger_event = {
                    id = khand.0302 # Good Result
                    days = 10
                }
            }
		}
        else = {
            trigger_event = khand.0101
        }
    }
}

khand.0250 = { # Return My Precious! - Intrigue / Martial
	content_source = realms_dlc
	type = character_event
    title = khand.0250.t
    desc = khand.0250.desc
    theme = realm

    left_portrait = {
        character = scope:heir
        animation = personality_cynical
    }
    right_portrait = {
        character = scope:challenge_setter
        trigger = { exists = scope:challenge_setter }
        animation = scheme
    }

    trigger = {
        NOT = {
            has_character_flag = khand_0250_done
        }
    }

	weight_multiplier = {
		base = 0.5
		modifier = {
			add = 5
			scope:challenge_setter ?= { highest_skill = intrigue }
		}
	}

    immediate = {
        add_character_flag = {
            flag = khand_0250_done
            years = 1
        }
    }

    option = { # Intrigue
        name = khand.0250.a
        skill = intrigue
        scope:heir = {
            change_variable = { 
                name = trials_had
                add = 1
            }
            duel = {
                skill = intrigue 
                value = 10
                50 = { 
                    compare_modifier = {
                        value = scope:duel_value
                        multiplier = 5
                        min = -49
                    }
                    desc = khand.0250.a.duel_success
                    change_variable = { 
                        name = trial_wins
                        add = 1
                    }
                    root = {
                        send_interface_toast = {
                            left_icon = scope:heir
                            right_icon = scope:challenge_setter
                            title = khand.0210.success
                            custom_tooltip = khand.impressed_vassals
                        }
                    }
                }
                50 = {
                    compare_modifier = {
                        value = scope:duel_value
                        multiplier = -5
                        min = -49
                    }
                    desc = khand.0250.a.duel_failure
                    root = {
                        send_interface_toast = {
                            left_icon = scope:heir
                            right_icon = scope:challenge_setter
                            title = khand.0210.failure
                            custom_tooltip = khand.unimpressed_vassals
                        }
                    }
                }
            }
        }
        if = {
			limit = {
				scope:heir = {
					has_variable = trials_had
					var:trials_had = 5
				}
			}
            if = {
                limit = {
                    scope:heir = {
                        has_variable = trial_wins
                        var:trial_wins < 2
                    }
                }
                trigger_event = {
                    id = khand.0300 # Bad Result
                    days = 10
                }
            }
            else_if = {
                limit = {
                    scope:heir = {
                        has_variable = trial_wins
                        var:trial_wins < 4
                    }
                }
                trigger_event = {
                    id = khand.0301 # Average Result
                    days = 10
                }
            }
            else = {
                trigger_event = {
                    id = khand.0302 # Good Result
                    days = 10
                }
            }
		}
        else = {
            trigger_event = khand.0101
        }
    }

    option = { # Martial
        name = khand.0250.b
        skill = martial
        scope:heir = {
            change_variable = { 
                name = trials_had
                add = 1
            }
            duel = {
                skill = martial 
                value = 10
                50 = { 
                    compare_modifier = {
                        value = scope:duel_value
                        multiplier = 5
                        min = -49
                    }
                    desc = khand.0250.b.duel_success
                    
                    change_variable = { 
                        name = trial_wins
                        add = 1
                    }
                    root = {
                        send_interface_toast = {
                            left_icon = scope:heir
                            right_icon = scope:challenge_setter
                            title = khand.0210.success
                            custom_tooltip = khand.impressed_vassals
                        }
                    }
                }
                50 = {
                    compare_modifier = {
                        value = scope:duel_value
                        multiplier = -5
                        min = -49
                    }
                    desc = khand.0250.b.duel_failure
                    change_variable = { 
                        name = trial_losses
                        add = 1
                    }
                    root = {
                        send_interface_toast = {
                            left_icon = scope:heir
                            right_icon = scope:challenge_setter
                            title = khand.0210.failure
                            custom_tooltip = khand.unimpressed_vassals
                        }
                    }
                }
            }
        }
        if = {
			limit = {
				scope:heir = {
					has_variable = trials_had
					var:trials_had = 5
				}
			}
            if = {
                limit = {
                    scope:heir = {
                        has_variable = trial_wins
                        var:trial_wins < 2
                    }
                }
                trigger_event = {
                    id = khand.0300 # Bad Result
                    days = 10
                }
            }
            else_if = {
                limit = {
                    scope:heir = {
                        has_variable = trial_wins
                        var:trial_wins < 4
                    }
                }
                trigger_event = {
                    id = khand.0301 # Average Result
                    days = 10
                }
            }
            else = {
                trigger_event = {
                    id = khand.0302 # Good Result
                    days = 10
                }
            }
		}
        else = {
            trigger_event = khand.0101
        }
    }

    option = { # Bribe
        name = khand.0250.c
        custom_tooltip = introduce_the_heir.bribe_effect_desc
        save_scope_as = actor
        scope:challenge_setter ?= {
            save_scope_as = recipient
        }
        pay_short_term_gold = {
            gold = gift_value
            target = scope:recipient
        }
        add_prestige = {
            value = gift_value
            multiply = -1
        }
        trigger_event = khand.0251
    }

    option = { # Hook
        name = khand.0250.d
        custom_tooltip = introduce_the_heir.hook_effect_desc
        trigger = {
            exists = scope:challenge_setter
            has_hook = scope:challenge_setter
        }
        use_hook = scope:challenge_setter
        trigger_event = khand.0251
    }
}

khand.0251 = { # Return My Precious! - Intrigue / Martial - Going Easy on Heir
	content_source = realms_dlc
	type = character_event
    title = khand.0251.t
    desc = khand.0251.desc
    theme = realm

    left_portrait = {
        character = scope:heir
        animation = stress
    }
    right_portrait = {
        character = scope:challenge_setter
        trigger = { exists = scope:challenge_setter }
        animation = schadenfreude
    }
    
    option = { # Intrigue
        name = khand.0251.a
        skill = intrigue
        scope:heir = {
            change_variable = { 
                name = trials_had
                add = 1
            }
            duel = {
                skill = intrigue 
                value = 5
                50 = { 
                    compare_modifier = {
                        value = scope:duel_value
                        multiplier = 5
                        min = -49
                    }
                    desc = khand.0250.a.duel_success
                    change_variable = { 
                        name = trial_wins
                        add = 1
                    }
                    root = {
                        send_interface_toast = {
                            left_icon = scope:heir
                            right_icon = scope:challenge_setter
                            title = khand.0210.success
                            custom_tooltip = khand.impressed_vassals
                        }
                    }
                }
                50 = {
                    compare_modifier = {
                        value = scope:duel_value
                        multiplier = -5
                        min = -49
                    }
                    desc = khand.0250.a.duel_failure
                    root = {
                        send_interface_toast = {
                            left_icon = scope:heir
                            right_icon = scope:challenge_setter
                            title = khand.0210.failure
                            custom_tooltip = khand.unimpressed_vassals
                        }
                    }
                }
            }
        }
    }

    option = { # Martial
        name = khand.0251.b
        skill = martial
        scope:heir = {
            change_variable = { 
                name = trials_had
                add = 1
            }
            duel = {
                skill = martial 
                value = 5
                50 = { 
                    compare_modifier = {
                        value = scope:duel_value
                        multiplier = 5
                        min = -49
                    }
                    desc = khand.0250.b.duel_success                    
                    change_variable = { 
                        name = trial_wins
                        add = 1
                    }
                    root = {
                        send_interface_toast = {
                            left_icon = scope:heir
                            right_icon = scope:challenge_setter
                            title = khand.0210.success
                            custom_tooltip = khand.impressed_vassals
                        }
                    }
                }
                50 = {
                    compare_modifier = {
                        value = scope:duel_value
                        multiplier = -5
                        min = -49
                    }
                    desc = khand.0250.b.duel_failure
                    change_variable = { 
                        name = trial_losses
                        add = 1
                    }
                    root = {
                        send_interface_toast = {
                            left_icon = scope:heir
                            right_icon = scope:challenge_setter
                            title = khand.0210.failure
                            custom_tooltip = khand.unimpressed_vassals
                        }
                    }
                }
            }
        }
    }

    after = {
        if = {
			limit = {
				scope:heir = {
					has_variable = trials_had
					var:trials_had = 5
				}
			}
            if = {
                limit = {
                    scope:heir = {
                        has_variable = trial_wins
                        var:trial_wins < 2
                    }
                }
                trigger_event = {
                    id = khand.0300 # Bad Result
                    days = 10
                }
            }
            else_if = {
                limit = {
                    scope:heir = {
                        has_variable = trial_wins
                        var:trial_wins < 4
                    }
                }
                trigger_event = {
                    id = khand.0301 # Average Result
                    days = 10
                }
            }
            else = {
                trigger_event = {
                    id = khand.0302 # Good Result
                    days = 10
                }
            }
		}
        else = {
            trigger_event = khand.0101
        }
    }
}

khand.0260 = { # Single Combat - Prowess
	content_source = realms_dlc
	type = character_event
    title = khand.0260.t
    desc = khand.0260.desc
    theme = realm

    left_portrait = {
        character = scope:heir
        animation = war_attacker
    }
    right_portrait = {
        character = scope:challenge_setter
        trigger = { exists = scope:challenge_setter }
        animation = war_defender
    }

    trigger = {
        NOT = {
            has_character_flag = khand_0260_done
        }
    }

	weight_multiplier = {
		base = 0.5
		modifier = {
			add = 5
			scope:challenge_setter ?= { highest_skill_including_prowess = prowess }
		}
	}

    immediate = {
        add_character_flag = {
            flag = khand_0260_done
            years = 1
        }
    }

    option = { # Prowess
        name = khand.0260.a
        skill = prowess
        scope:heir = {
            change_variable = { 
                name = trials_had
                add = 1
            }
            duel = {
                skill = prowess 
                value = 10
                50 = { 
                    compare_modifier = {
                        value = scope:duel_value
                        multiplier = 5
                        min = -49
                    }
                    desc = khand.0260.a.duel_success
                    change_variable = { 
                        name = trial_wins
                        add = 1
                    }
                    root = {
                        send_interface_toast = {
                            left_icon = scope:heir
                            right_icon = scope:challenge_setter
                            title = khand.0210.success
                            custom_tooltip = khand.impressed_vassals
                        }
                    }
                }
                50 = {
                    compare_modifier = {
                        value = scope:duel_value
                        multiplier = -5
                        min = -49
                    }
                    desc = khand.0260.a.duel_failure
                    root = {
                        send_interface_toast = {
                            left_icon = scope:heir
                            right_icon = scope:challenge_setter
                            title = khand.0210.failure
                            custom_tooltip = khand.unimpressed_vassals
                        }
                    }
                }
            }
        }
        if = {
			limit = {
				scope:heir = {
					has_variable = trials_had
					var:trials_had = 5
				}
			}
            if = {
                limit = {
                    scope:heir = {
                        has_variable = trial_wins
                        var:trial_wins < 2
                    }
                }
                trigger_event = {
                    id = khand.0300 # Bad Result
                    days = 10
                }
            }
            else_if = {
                limit = {
                    scope:heir = {
                        has_variable = trial_wins
                        var:trial_wins < 4
                    }
                }
                trigger_event = {
                    id = khand.0301 # Average Result
                    days = 10
                }
            }
            else = {
                trigger_event = {
                    id = khand.0302 # Good Result
                    days = 10
                }
            }
		}
        else = {
            trigger_event = khand.0101
        }
    }
}

khand.0300 = {  # Khand: Conclusion - Bad
	content_source = realms_dlc
	type = character_event
	title = khand.0300.t
	desc = khand.0300.desc
	theme = realm
	left_portrait = {
		character = root
		animation = stress
	}
	right_portrait = {
		character = root.player_heir
		animation = sadness
	}
	
	option = { # Finish
		name = khand.0300.a
		if = {
			limit = {
				scope:heir = {
					var:trial_wins = 0
				}
			}
			add_prestige = major_prestige_loss
			root.player_heir = {
				add_character_modifier = {
					modifier = khand_heir_0_successes
				}
			}
		}
		else_if = {
			limit = {
				scope:heir = {
					var:trial_wins = 1
				}
			}
			add_prestige = medium_prestige_loss
			root.player_heir = {
				add_character_modifier = {
					modifier = khand_heir_1_successes
				}
			}
		}
		else_if = {
			limit = {
				scope:heir = {
					var:trial_wins = 2
				}
			}
			add_prestige = minor_prestige_loss
			root.player_heir = {
				add_character_modifier = {
					modifier = khand_heir_2_successes
				}
			}
		}
		else_if = {
			limit = {
				scope:heir = {
					var:trial_wins = 3
				}
			}
			add_prestige = minor_prestige_gain
			root.player_heir = {
				add_character_modifier = khand_heir_3_successes
			}
		}
		else_if = {
			limit = {
				scope:heir = {
					var:trial_wins = 4
				}
			}
			add_prestige = medium_prestige_gain
			root.player_heir = {
				add_character_modifier = khand_heir_4_successes
			}
		}
		else_if = {
			limit = {
				scope:heir = {
					var:trial_wins = 5
				}
			}
			
			add_prestige = major_prestige_gain
			root.player_heir = {
				add_character_modifier = khand_heir_5_successes
			}
		}
	}
}

khand.0301 = {  # Khand: Conclusion - Average
	content_source = realms_dlc
	type = character_event
	title = khand.0301.t
	desc = khand.0301.desc
	theme = realm
	left_portrait = {
		character = root
		animation = personality_cynical
	}
	right_portrait = {
		character = root.player_heir
		animation = personality_coward
	}
	
	option = { # Finish
		name = khand.0301.a
		if = {
			limit = {
				scope:heir = {
					var:trial_wins = 0
				}
			}
			add_prestige = major_prestige_loss
			root.player_heir = {
				add_character_modifier = {
					modifier = khand_heir_0_successes
				}
			}
		}
		else_if = {
			limit = {
				scope:heir = {
					var:trial_wins = 1
				}
			}
			add_prestige = medium_prestige_loss
			root.player_heir = {
				add_character_modifier = {
					modifier = khand_heir_1_successes
				}
			}
		}
		else_if = {
			limit = {
				scope:heir = {
					var:trial_wins = 2
				}
			}
			add_prestige = minor_prestige_loss
			root.player_heir = {
				add_character_modifier = {
					modifier = khand_heir_2_successes
				}
			}
		}
		else_if = {
			limit = {
				scope:heir = {
					var:trial_wins = 3
				}
			}
			add_prestige = minor_prestige_gain
			root.player_heir = {
				add_character_modifier = khand_heir_3_successes
			}
		}
		else_if = {
			limit = {
				scope:heir = {
					var:trial_wins = 4
				}
			}
			add_prestige = medium_prestige_gain
			root.player_heir = {
				add_character_modifier = khand_heir_4_successes
			}
		}
		else_if = {
			limit = {
				scope:heir = {
					var:trial_wins = 5
				}
			}
			
			add_prestige = major_prestige_gain
			root.player_heir = {
				add_character_modifier = khand_heir_5_successes
			}
		}
	}
}

khand.0302 = {  # Khand: Conclusion - Good
	content_source = realms_dlc
	type = character_event
	title = khand.0302.t
	desc = khand.0302.desc
	theme = realm
	left_portrait = {
		character = root
		animation = personality_bold
	}
	right_portrait = {
		character = root.player_heir
		animation = happiness
	}
	
	option = { # Finish
		name = khand.0302.a
		if = {
			limit = {
				scope:heir = {
					var:trial_wins = 0
				}
			}
			add_prestige = major_prestige_loss
			root.player_heir = {
				add_character_modifier = {
					modifier = khand_heir_0_successes
				}
			}
		}
		else_if = {
			limit = {
				scope:heir = {
					var:trial_wins = 1
				}
			}
			add_prestige = medium_prestige_loss
			root.player_heir = {
				add_character_modifier = {
					modifier = khand_heir_1_successes
				}
			}
		}
		else_if = {
			limit = {
				scope:heir = {
					var:trial_wins = 2
				}
			}
			add_prestige = minor_prestige_loss
			root.player_heir = {
				add_character_modifier = {
					modifier = khand_heir_2_successes
				}
			}
		}
		else_if = {
			limit = {
				scope:heir = {
					var:trial_wins = 3
				}
			}
			add_prestige = minor_prestige_gain
			root.player_heir = {
				add_character_modifier = khand_heir_3_successes
			}
		}
		else_if = {
			limit = {
				scope:heir = {
					var:trial_wins = 4
				}
			}
			add_prestige = medium_prestige_gain
			root.player_heir = {
				add_character_modifier = khand_heir_4_successes
			}
		}
		else_if = {
			limit = {
				scope:heir = {
					var:trial_wins = 5
				}
			}
			
			add_prestige = major_prestige_gain
			root.player_heir = {
				add_character_modifier = khand_heir_5_successes
			}
		}
	}
}