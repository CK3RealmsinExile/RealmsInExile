namespace = harad

### Harad Events ###

# 		harad.0014-0099 #Flavor Events
# 		harad.0100-0299 #Haruzan Event Chain
#		harad.0300-0399 #Arysis/Maresh Prosperity Quest Chain
#		harad.0500		#Purchase Mûmakil decision
#		harad.0550		#Mud Mason Decision
#		harad.0600		#Trans-Haradric Merchant System
#		harad.0700		#Namâlo Spice Trade
#		harad.1000 		#Unify Harad
#		harad.2000		#Long Winter Content

###############################
###############################
######## FLAVOR EVENTS ########
###############################
###############################


##########################################
# Mumak at Large!
# by BaelishPasta
# 0014
##########################################

#Decide what to do with a rampaging Mumak
harad.0014 = {
	content_source = realms_dlc
	type = character_event
	title = harad.0014.t
	desc = harad.0014.desc
	
	theme = realm
	left_portrait = {
		character = root
		animation = stress
	}

	trigger = {
		NOT = { is_orc = yes }
		NOT = { is_elf = yes }
		capital_county.title_province = {
			OR = {
				geographical_region = middleearth_harad
				geographical_region = middleearth_uttersouth
			}
		}
		is_independent_ruler = yes
		NOT = { has_character_flag = had_event_harad_0014 }	
	}

	immediate = {
		add_character_flag = {
			flag = had_event_harad_0014
			years = 5
		}
	}


	#Option 1: Let the beast be.
	option = {
		name = harad.0014.a

		#No cost, county gets angry
		add_prestige = minor_prestige_loss
		capital_county = {
			add_county_modifier = {
				modifier = harad_0014_mumak_at_large_modifier
				days = 730
			}		
		}
		stress_impact = {
			compassionate = major_stress_impact_gain
			sadistic = medium_stress_impact_loss
		}
		ai_chance = {
			base = 100
			ai_value_modifier = {
				ai_rationality = 2
			}
		}
	}
	
	
	#Option 2: Have the beast put down.
	option = {
		name = harad.0014.b
		remove_short_term_gold = minor_gold_value_check
		duel = {
			skill = martial
			value = medium_skill_rating
			30 = {		
				compare_modifier = {
					value = scope:duel_value
					multiplier = 1
				}
				desc = harad.0014.b.message_1
				send_interface_toast = {
					type = event_toast_effect_good
					left_icon = scope:capital
					title = harad.0014.b.message_1
					add_prestige = minor_prestige_gain
					capital_county = {
						add_county_modifier = {
							modifier = harad_0014_mumak_dead_modifier
							days = 730
						}
					}
				}
				modifier = {
					culture = { has_innovation = innovation_mumakil_domestication }
					factor = 1.5
				}
			}
				
		
			10 = {
				desc = harad.0014.b.message_2
				send_interface_toast = {
					type = event_toast_effect_bad
					left_icon = scope:capital
					title = harad.0014.b.message_2
					add_prestige = miniscule_prestige_loss
					add_stress = minor_stress_gain
					capital_county = {
						add_county_modifier = {
							modifier = harad_0014_mumak_at_large_modifier
							days = 730
					
						}		
					}
				}
			}
		}
		
		stress_impact = {
			greedy = medium_stress_impact_gain
			}

		ai_chance = {
			base = 100
			ai_value_modifier = {
				ai_rationality = 2
				}
			}
		}

	#Option 3: Have the beast tamed.
	option = {
		name = harad.0014.c

		remove_short_term_gold = medium_gold_value_check
		duel = {
			skill = stewardship
			value = high_skill_rating
			20 = {		
				compare_modifier = {
					value = scope:duel_value
					multiplier = 1
				}
				desc = harad.0014.c.message_1
				send_interface_toast = {
					type = event_toast_effect_good
					left_icon = scope:capital
					title = harad.0014.c.message_1
					add_prestige = medium_prestige_gain
					capital_county = {
						add_county_modifier = {
							modifier = harad_0014_mumak_tamed_modifier
							days = 730
						}
					}
				}
				modifier = {
					culture = { has_innovation = innovation_mumakil_domestication }
					factor = 1.5
				}
			}
				
		
			30 = {
				desc = harad.0014.c.message_2
				send_interface_toast = {
					type = event_toast_effect_bad
					left_icon = scope:capital
					title = harad.0014.c.message_2
					add_prestige = miniscule_prestige_loss
					add_stress = minor_stress_gain
					capital_county = {
						add_county_modifier = {
							modifier = harad_0014_mumak_at_large_modifier
							days = 730
					
						}		
					}
				}
			}
		}		
		
		stress_impact = {
			greedy = major_stress_impact_gain
		}
		ai_chance = {
			base = 50
			ai_value_modifier = {
				ai_greed = -3
			}
		}			
	}
}


################################
# A Mighty Mumak
# by BaelishPasta
# Based on "A Mighty Elephant" by Emil Tisander
################################

harad.0015 = {
	content_source = realms_dlc
	type = character_event
	title = harad.0015.t
	desc = harad.0015.desc
	theme = martial
	override_background = {
		reference = throne_room
	}
	
	left_portrait = {
		character = root
	}
	right_portrait = scope:marshal #cp:councillor_marshal
	
	trigger = {
		NOT = { has_character_flag = had_event_harad_0015 }
		NOT = { has_character_modifier = harad_0015_personal_war_mumak_modifier }
		is_available_adult = yes
		is_at_war = no
		number_maa_regiments_of_type = {
			type = war_mumak
			value > 0
		}
		exists = cp:councillor_marshal
		is_independent_ruler = yes
		NOT = { is_orc = yes }
		NOT = { is_elf = yes }
		capital_county.title_province = {
			OR = {
				geographical_region = middleearth_harad
				geographical_region = middleearth_uttersouth
			}
		}
	}
	
	immediate = {
		add_character_flag = {
			flag = had_event_harad_0015
			years = 25
		}
		
		cp:councillor_marshal = {
			save_scope_as = marshal
		}
		
	}
	
	option = { #Keep it yourself
		name = harad.0015.a
		
		add_character_modifier = {
			modifier = harad_0015_personal_war_mumak_modifier
			years = 40
		}
		add_prestige = minor_prestige_gain
		stress_impact = {
			generous = minor_stress_impact_gain
		}
		
		ai_chance = {
			base = 100
			modifier = {
				add = 50
				has_trait = greedy
			}
			modifier = {
				add = 50
				prowess = 10
			}
		}
	}
	option = { #Gift it to your Marshal
		name = harad.0015.b
		
		trigger = {
			exists = scope:marshal
			scope:marshal = {
				NOT = { has_character_modifier = harad_0015_personal_war_mumak_modifier }
			}
		}
		
		scope:marshal = {
			add_character_modifier = {
				modifier = harad_0015_personal_war_mumak_modifier
				years = 40
			}
			add_opinion = {
				modifier = respect_opinion
				target = root
				opinion = 20
			}
		}
		
		ai_chance = {
			base = 100
			modifier = {
				add = 200
				reverse_opinion = {
					target = scope:marshal
					value <= 0
				}
			}
		}
	}
	option = { #Sell it
		name = harad.0015.c
		
		add_gold = minor_gold_max_value
			
		scope:marshal = {
			add_opinion = {
				modifier = respect_opinion
				target = root
				opinion = -20
			}
		}
		
		ai_chance = {
			base = 200
		}
	}
	
}


##########################################
# Heatwave
# by BaelishPasta
# 0016
##########################################

#A heatwave strikes your capital
harad.0016 = {
	content_source = realms_dlc
	type = character_event
	title = harad.0016.t
	desc = harad.0016.desc
	
	theme = realm
	override_background = {
		reference = wilderness_desert
	}
	
	left_portrait = {
		character = root
		animation = pain
	}

	trigger = {
		is_independent_ruler = yes
		capital_county.title_province = {
			terrain = dune_sea
		}
		NOT = { has_character_flag = had_event_harad_0016 }	
	}

	immediate = {
		add_character_flag = {
			flag = had_event_harad_0016
			years = 5
		}
	}

	#Option 1: What do you want me to do?
	option = {
		name = harad.0016.a

		add_prestige = minor_prestige_loss
		add_stress = minor_stress_gain
		stress_impact = {
			compassionate = major_stress_impact_gain
			sadistic = medium_stress_impact_loss
		}		
		duel = {
			skill = stewardship
			value = high_skill_rating
			10 = {		
				compare_modifier = {
					value = scope:duel_value
					multiplier = 1
				}
				desc = harad.0016.a.message_1
				send_interface_toast = {
					type = event_toast_effect_good
					left_icon = scope:capital
					title = harad.0016.a_1
					capital_county = {
						add_county_modifier = {
							modifier = harad_0016_mild_heatwave_modifier
							days = 365
							}
						}
					}
				}
				
		
			30 = {
				desc = harad.0016.a.message_2
				send_interface_toast = {
					type = event_toast_effect_bad
					left_icon = scope:capital
					title = harad.0016.a_2
					capital_county = {
						add_county_modifier = {
							modifier = harad_0016_major_heatwave_modifier
							days = 365
					
						}		
					}
				}
			}
			
			
			50 = {
				desc = harad.0016.a.message_3
				send_interface_toast = {
					type = event_toast_effect_bad
					left_icon = scope:capital
					title = harad.0016.a_3
					capital_county = {
						add_county_modifier = {
							modifier = harad_0016_severe_heatwave_modifier
							days = 365
					
						}		
					}
				}
			}
		}

		ai_chance = {
			base = 100
			ai_value_modifier = {
				ai_greed = 0.25
			}
			modifier = {	
				add = 30
				has_trait = sadistic
			}
			modifier = {	
				add = 30
				has_trait = arbitrary
			}
			modifier = {	
				add = -30
				has_trait = compassionate
			}
		}
	}
	
	#Option 2: Minor preparations
	option = {
		name = harad.0016.b

		remove_short_term_gold = minor_gold_value_check
		add_prestige = minor_prestige_gain
		add_stress = minor_stress_gain
		stress_impact = {
			greedy = major_stress_impact_gain
		}		
		duel = {
			skill = stewardship
			value = high_skill_rating
			30 = {		
				compare_modifier = {
					value = scope:duel_value
					multiplier = 1
				}
				desc = harad.0016.b.message_1
				send_interface_toast = {
					type = event_toast_effect_good
					left_icon = scope:capital
					title = harad.0016.b_1
					capital_county = {
						add_county_modifier = {
							modifier = harad_0016_mild_heatwave_modifier
							days = 365
							}
						}
					}
				}
				
		
			30 = {
				desc = harad.0016.b.message_2
				send_interface_toast = {
					type = event_toast_effect_bad
					left_icon = scope:capital
					title = harad.0016.b_2
					capital_county = {
						add_county_modifier = {
							modifier = harad_0016_major_heatwave_modifier
							days = 365
					
						}		
					}
				}
			}
			
			
			30 = {
				desc = harad.0016.b.message_3
				send_interface_toast = {
					type = event_toast_effect_bad
					left_icon = scope:capital
					title = harad.0016.b_3
					capital_county = {
						add_county_modifier = {
							modifier = harad_0016_severe_heatwave_modifier
							days = 365
					
						}		
					}
				}
			}
		}

		ai_chance = {
			base = 100
			ai_value_modifier = {
				ai_greed = -0.25
			}
			modifier = {	
				add = 30
				has_trait = compassionate
			}
			modifier = {	
				add = -30
				has_trait = greedy
			}
		}
	}	

	#Option 3: All prepare
	option = {
		name = harad.0016.c

		remove_short_term_gold = medium_gold_value_check
		add_prestige = medium_prestige_gain
		add_stress = 0
		stress_impact = {
			greedy = major_stress_impact_gain
		}		
		duel = {
			skill = stewardship
			value = high_skill_rating
			60 = {		
				compare_modifier = {
					value = scope:duel_value
					multiplier = 1
				}
				desc = harad.0016.c.message_1
				send_interface_toast = {
					type = event_toast_effect_good
					left_icon = scope:capital
					title = harad.0016.c_1
					capital_county = {
						add_county_modifier = {
							modifier = harad_0016_mild_heatwave_modifier
							days = 365
							}
						}
					}
				}
				
		
			30 = {
				desc = harad.0016.c.message_2
				send_interface_toast = {
					type = event_toast_effect_bad
					left_icon = scope:capital
					title = harad.0016.c_2
					capital_county = {
						add_county_modifier = {
							modifier = harad_0016_major_heatwave_modifier
							days = 365
					
						}		
					}
				}
			}
			
			
			10 = {
				desc = harad.0016.c.message_3
				send_interface_toast = {
					type = event_toast_effect_bad
					left_icon = scope:capital
					title = harad.0016.c_3
					capital_county = {
						add_county_modifier = {
							modifier = harad_0016_severe_heatwave_modifier
							days = 365
					
						}		
					}
				}
			}
		}

		ai_chance = {
			base = 100
			ai_value_modifier = {
				ai_greed = -0.25
			}
			modifier = {	
				add = 30
				has_trait = compassionate
			}
			modifier = {	
				add = -30
				has_trait = greedy
			}
		}
	}
}


##########################################
# Lódenûly Date Farms Flavor Events
# by Juke (based on RICE)
# 0017-0018
##########################################

# Eating Lódenûly dates (Khy)
harad.0017 = {
	content_source = realms_dlc
	type = character_event
	title = harad.0017.t
	desc = harad.0017.desc
	theme = feast_activity
	
	right_portrait = {
		character = root
		animation = happiness
	}
	
	trigger = {
		OR = {
			top_liege ?= {
				any_realm_county = {
					has_county_modifier = lodenuly_date_farms_modifier
				}
			}
			any_realm_county = {
				has_county_modifier = lodenuly_date_farms_modifier
			}
			capital_county.title_province ?= {
				OR = {
					geographical_region = middleearth_harad_bayoformal_khy
					geographical_region = middleearth_harad_bayoformal_harshandatt
					geographical_region = middleearth_harad_dunesea_arysis
				}
			}
		}
	}

	weight_multiplier = {
		base = 1
		modifier = {
			add = -0.5
			capital_county.title_province ?= {
				OR = {
					geographical_region = middleearth_harad_bayoformal_khy
					geographical_region = middleearth_harad_dunesea_arysis
				}
			}
		}
	}
	
	cooldown = { years = 25 }

	option = { # Ok
		name = harad.0017.a
		if = {
			limit = { NOT = { has_character_modifier = lodenuly_date_longevity_modifier } }
			random = {
				chance = 1
				add_character_modifier = lodenuly_date_longevity_modifier
			}
		}
		stress_impact = {
			base = minor_stress_impact_loss
			gluttonous = minor_stress_impact_loss
			lazy = miniscule_stress_impact_loss
			temperate = miniscule_stress_impact_gain
		}
	}
}

# Second Lódenûly Date Harvest
harad.0018 = {
	content_source = realms_dlc
	type = character_event
	title = harad.0018.t
	desc = {
		first_valid = {
			# Early Second Harvest!
			triggered_desc = {
				trigger = {
					current_month >= 1
					current_month < 7
				}
				desc = harad.0018.desc.early
			}
			# Extended Late Harvest!	
			desc = harad.0018.desc.late		
		}
		desc = harad.0018.desc
	}
	theme = court

	left_portrait = {
		character = ROOT
		animation = personality_rational
	}
	
	right_portrait = {
		character = scope:date_farmer
		animation = happiness
	}
	
	trigger = {
		is_landed = yes
		# Can trigger for any level ruler
		any_realm_county = {
			has_county_modifier = lodenuly_date_farms_modifier
		}
	}
	
	cooldown = { years = 25 }

	immediate = {
		random_realm_county = {
			limit = {
				has_county_modifier = lodenuly_date_farms_modifier
			}
			save_scope_as = date_county
		}
		create_character = {
			location = root.location
			template = generic_peasant_character
			gender_female_chance = root_soldier_female_chance
			culture = scope:date_county.culture
			faith = scope:date_county.faith
			save_scope_as = date_farmer
		}
	}

	option = { # Tomorrow we feast!
		name = harad.0018.a
		stress_impact = {
			base = medium_stress_impact_loss
			gluttonous = minor_stress_impact_loss
			lazy = miniscule_stress_impact_loss
			temperate = miniscule_stress_impact_gain
		}
	}

	option = { # Dry and sell the dates
		name = harad.0018.b
		stress_impact = {
			gluttonous = miniscule_stress_impact_gain
			generous = miniscule_stress_impact_gain
		}
		add_gold = {
			value = minor_gold_value
			multiply = 0.8
			max = 100
		}
	}

	option = { # Distribute them to the commoners
		name = harad.0018.c
		stress_impact = {
			gluttonous = miniscule_stress_impact_gain
			greedy = minor_stress_impact_gain
			compassionate = miniscule_stress_impact_loss
		}
		capital_county = {
			add_county_modifier = {
				modifier = hunt_aided_peasants_modifier
				years = 10
			}
		}
	}
}


##########################################
# Antelope Hide Merchant Flavor Event
# by Juke (based on RICE)
# 0019
##########################################

# Sîrayni merchant sells antelope hides
harad.0019 = {
	content_source = realms_dlc
	type = character_event
	title = harad.0019.t
	desc = harad.0019.desc
	theme = martial
	override_background = { reference = market }
	
	left_portrait = {
		character = ROOT
	}

	right_portrait = {
		character = scope:trans_haradric_merchant_spawn
		animation = personality_greedy
	}
	
	trigger = {
		any_county_in_region = {
			region = middleearth_harad_bayoformal_harshandatt
			OR = {
				culture = { has_cultural_parameter = heritage_group_apysaic }
				culture = { has_cultural_pillar = heritage_south_khailuza }
			}
		}
	}
	
	cooldown = { years = 25 }

	weight_multiplier = {
		base = 1
		# Less common, but still possible, in larger Harad
		modifier = {
			add = -0.5
			capital_county.title_province ?= {
				NOR = {
					geographical_region = middleearth_harad_dunesea_arysis
					geographical_region = middleearth_harad_far
					geographical_region = middleearth_harad_bayoformal
				}
			}
		}
		# Even more common in Sîrayn itself
		modifier = {
			add = 0.5
			capital_county.title_province = { geographical_region = middleearth_harad_bayoformal_sirayn }
		}
	}

	immediate = {
		if = {
			limit = {
				any_county_in_region = {
					region = middleearth_harad_bayoformal_sirayn
					culture = { has_cultural_parameter = heritage_group_apysaic }
				}
			}
			every_county_in_region = {
				region = middleearth_harad_bayoformal_sirayn
				limit = {
					culture = { has_cultural_parameter = heritage_group_apysaic }
				}
				add_to_list = merchant_counties
			}
			random_in_list = {
				list = merchant_counties
				save_scope_as = home_county
				weight = {
					base = 1
					modifier = {
						add = 1
						NOT = { title_province = { has_holding_type = tribal_holding } }
					}
					modifier = {
						add = 1
						title_province = { has_special_building = yes }
					}
					modifier = {
						add = 1
						culture = { has_cultural_tradition = tradition_trans_haradric_traders }
					}
					modifier = { # Cultures we want to see more commonly as dune sea merchants
						add = 0.3
						OR = {
							culture = { has_cultural_pillar = heritage_new_sirayni }
							culture = { has_cultural_pillar = heritage_old_sirayni }
						}
					}
				}
			}
			create_character = {
				location = root.location
				template = trans_haradric_merchant_template
				save_scope_as = trans_haradric_merchant_spawn
				culture = scope:home_county.culture
				faith = scope:home_county.faith
			}
		}

		# Backup in case no such county can be found
		else = { # Will have to update start date checks in the future
			religion:sirayn_religion = {
				random_faith = { #Find a taye faith
					limit = { has_doctrine = tenet_sirayn_syncretism }
					save_scope_as = merchant_faith
				}
			}
			random_list = {
				15 = {
					trigger = { game_start_date < 4000 }
					create_character = {
						location = root.location
						template = trans_haradric_merchant_template
						save_scope_as = trans_haradric_merchant_spawn
						culture = culture:old_sirayni
						faith = scope:merchant_faith
					}
				}
				15 = {
					trigger = {
						game_start_date > 4000
						game_start_date < 6500
					}
					create_character = {
						location = root.location
						template = trans_haradric_merchant_template
						save_scope_as = trans_haradric_merchant_spawn
						culture = culture:new_sirayni
						faith = scope:merchant_faith
					}				
				}
				15 = {
					trigger = { game_start_date > 3511 }
					create_character = {
						location = root.location
						template = trans_haradric_merchant_template
						save_scope_as = trans_haradric_merchant_spawn
						culture = culture:ayten
						faith = scope:merchant_faith
					}				
				}
				30 = {
					trigger = { game_start_date > 4496 }
					create_character = {
						location = root.location
						template = trans_haradric_merchant_template
						save_scope_as = trans_haradric_merchant_spawn
						culture = culture:poan
						faith = scope:merchant_faith
					}				
				}
				15 = {
					trigger = { game_start_date > 5983 }
					create_character = {
						location = root.location
						template = trans_haradric_merchant_template
						save_scope_as = trans_haradric_merchant_spawn
						culture = culture:chennacatti
						faith = scope:merchant_faith
					}				
				}
				15 = {
					trigger = { game_start_date > 7597 }
					create_character = {
						location = root.location
						template = trans_haradric_merchant_template
						save_scope_as = trans_haradric_merchant_spawn
						culture = culture:tyari
						faith = scope:merchant_faith
					}				
				}
			}
		}
	}

	option = { # No
		name = harad.0019.a
	}
	option = { # Ok
		name = harad.0019.b
		trigger = {
			OR = {
				is_ai = no
				gold >= 75
			}
		}
		remove_short_term_gold = 75
		add_character_modifier = {
			modifier = lotr_antelope_gear_modifier
			years = 10
		}
	}
	option = { # Better price
		name = harad.0019.c
		trigger = {
			OR = {
				is_ai = no
				gold >= 50
			}
			diplomacy >= medium_skill_rating
		}
		skill = diplomacy
		remove_short_term_gold = 50
		add_character_modifier = {
			modifier = lotr_antelope_gear_modifier
			years = 10
		}
	}

	after = {
		hidden_effect = {
			scope:trans_haradric_merchant_spawn = { silent_disappearance_effect = yes }
		}
	}
}


##########################################
# Arani Outposts Flavor Event
# by Juke (based on RICE)
# 0020
##########################################
# Arani Nomads often accompany trade caravans around the Dune Sea
# Some will set up more permanent outposts near local trade routes
scripted_trigger valid_for_arani_outposts_trigger = {
	OR = {
		title_province = { geographical_region = middleearth_harad_dunesea }
		AND = {
			title_province = { geographical_region = middleearth_harad }
			any_county_province = {
				OR = {
					terrain = desert
					terrain = dune_sea
					terrain = red_desert
					terrain = drylands
					terrain = savanna
					terrain = oasis
					terrain = saltflats
					terrain = desert_mountains
				}
			}
		}
	}
	NOT = { has_county_modifier = arani_outposts_modifier }
}

# Arani Outposts
harad.0020 = {
	content_source = realms_dlc
	type = character_event
	title = harad.0020.t
	desc = {
		first_valid = {
			triggered_desc = {
				trigger = {
					culture = { has_cultural_pillar = heritage_middle_apysaic }
				}
				desc = harad.0020.desc.arani
			}
			desc = harad.0020.desc
		}
	}
	theme = realm
	override_background = { reference = harad_drylands }
	
	left_portrait = {
		character = root
		animation = war_defender
	}
	
	trigger = {
		is_landed = yes
		any_held_county = {
			valid_for_arani_outposts_trigger = yes
		}
	}
	
	cooldown = { years = 25 }

	immediate = {
		random_held_county = {
			limit = {
				valid_for_arani_outposts_trigger = yes
			}
			save_scope_as = arani_county
		}
	}

	option = { # Ok
		name = harad.0020.a
		scope:arani_county = {
			add_county_modifier = {
				modifier = arani_outposts_modifier
				years = 10
			}
		}
	}
}


##########################################
# Qanat Flavor Events
# by Juke (based on RICE)
# 0021-0022
##########################################
# Qanats are large underground water canals common in arid areas
scripted_trigger valid_for_qanats_trigger = {
	any_county_province = {
		geographical_region = middleearth_harad
		OR = {
			terrain = desert
			terrain = red_desert
			terrain = drylands
			terrain = savanna
			terrain = oasis
			terrain = saltflats
			terrain = hills
			terrain = plains
		}
	}
}

# New Qanat
harad.0021 = {
	content_source = realms_dlc
	type = character_event
	title = harad.0021.t
	desc = harad.0021.desc
	theme = stewardship
	override_background = { reference = harad_drylands }
	
	right_portrait = root
	
	trigger = {
		is_landed = yes
		any_held_county = {
			valid_for_qanats_trigger = yes
		}
	}

	weight_multiplier = {
		base = 1
		modifier = {
			add = 0.2
			culture = { has_cultural_parameter = unlocks_qanat_building }
		}
	}

	cooldown = { years = 25 }

	immediate = {
		random_held_county = {
			limit = {
				valid_for_qanats_trigger = yes
			}
			save_scope_as = qanat_county
		}
	}

	option = { # Ok
		name = harad.0021.a
		scope:qanat_county = {
			add_county_modifier = {
				modifier = new_qanat_modifier
				years = 10
			}
		}
	}
}

# Qanat repairs
harad.0022 = {
	content_source = realms_dlc
	type = character_event
	title = harad.0022.t
	desc = harad.0022.desc
	theme = stewardship
	override_background = { reference = harad_drylands }
	
	left_portrait = root
	
	trigger = {
		is_landed = yes
		any_held_county = {
			valid_for_qanats_trigger = yes
		}
	}

	weight_multiplier = {
		base = 1
		modifier = {
			add = 0.2
			culture = { has_cultural_parameter = unlocks_qanat_building }
		}
	}

	cooldown = { years = 25 }

	immediate = {
		random_held_county = {
			limit = {
				valid_for_qanats_trigger = yes
			}
			save_scope_as = qanat_county
		}
	}

	option = { # Ok
		name = harad.0022.a
		stress_impact = {
			diligent = miniscule_stress_impact_gain
			paranoid = miniscule_stress_impact_gain
			just = minor_stress_impact_gain
		}
	}
	option = { # Ok
		name = harad.0022.b	
		trigger = {
			OR = {
				is_ai = no
				gold >= minor_gold_value
			}
		}
		remove_short_term_gold = minor_gold_value
		add_character_modifier = {
			modifier = repaired_qanat_character_modifier
			years = 10
		}	
		scope:qanat_county = {
			add_county_modifier = {
				modifier = local_qanat_repaired_modifier
				years = 10
			}		
		}	
	}
	option = { # Ok
		name = harad.0022.c
		trigger = {
			OR = {
				is_ai = no
				gold >= {
					value = minor_gold_value
					multiply = 1.2
				}
			}
		}
		remove_short_term_gold = {
			value = minor_gold_value
			multiply = 1.2
		}
		add_character_modifier = {
			modifier = expanded_qanat_character_modifier
			years = 10
		}	
		scope:qanat_county = {
			add_county_modifier = {
				modifier = local_qanat_expanded_modifier
				years = 10
			}		
		}	
	}
}


##########################################
# Ksar Flavor Events
# by Juke (based on RICE)
# 0023-0025
##########################################
# Ksars are fortified villages in arid areas of Harad
# The buildings are very close together and they protect local trade routes
scripted_trigger valid_for_ksars_trigger = {
	title_province = {
		OR = {
			geographical_region = middleearth_harad_near
			geographical_region = middleearth_harad_far_bellakar
			geographical_region = middleearth_harad_dunesea
			geographical_region = middleearth_harad_bayoformal_harshandatt
			geographical_region = middleearth_harad_bayoformal_sirayn
		}
	}
}

# Impressed by ksar
harad.0023 = {
	content_source = realms_dlc
	type = character_event
	title = harad.0023.t
	desc = harad.0023.desc
	theme = realm
	override_background = { reference = harad_2 }
	
	right_portrait = {
		character = root
		animation = admiration
	}
	
	trigger = {
		is_landed = yes
		any_held_county = {
			valid_for_ksars_trigger = yes
		}
	}

	cooldown = { years = 25 }

	immediate = {
		random_held_county = {
			limit = {
				valid_for_ksars_trigger = yes
			}
			save_scope_as = ksar_county
		}
		scope:ksar_county = {
			if = {
				limit = { county_control < 100 }
				change_county_control = 5
			}
		}
	}

	option = { # Ok
		name = harad.0023.a
		add_prestige = miniscule_prestige_gain
		add_martial_lifestyle_xp = minor_lifestyle_xp
	}
	option = { # Ok
		name = harad.0023.b
		add_piety = miniscule_piety_gain
		add_stewardship_lifestyle_xp = minor_lifestyle_xp
	}
}

# Ksar maintenance
harad.0024 = {
	content_source = realms_dlc
	type = character_event
	title = harad.0024.t
	desc = harad.0024.desc
	theme = realm
	override_background = { reference = harad_2 }
	
	left_portrait = root
	
	trigger = {
		is_landed = yes
		any_held_county = {
			valid_for_ksars_trigger = yes
		}
	}

	cooldown = { years = 25 }

	immediate = {
		random_held_county = {
			limit = {
				valid_for_ksars_trigger = yes
			}
			save_scope_as = ksar_county
		}
	}
	
	option = { # Ok
		name = harad.0024.a	
		scope:ksar_county = {
			add_county_modifier = {
				modifier = lotr_ksar_maintenance_issues
				years = 10
			}		
		}
		stress_impact = {
			diligent = miniscule_stress_impact_gain
			paranoid = miniscule_stress_impact_gain
			just = miniscule_stress_impact_gain
		}
		ai_chance = {
			base = 50
		}
	}
	option = { # Ok
		name = harad.0024.b	
		remove_short_term_gold = minor_gold_value
		add_prestige = 50
		ai_chance = {
			base = 100
			modifier = {
				add = -100
				gold < minor_gold_value
			}
		}
	}
}

# Ksar visit
harad.0025 = {
	content_source = realms_dlc
	type = character_event
	title = harad.0025.t
	desc = harad.0025.desc
	theme = realm
	override_background = { reference = harad_2 }
	
	right_portrait = root
	
	trigger = {
		is_landed = yes
		any_held_county = {
			valid_for_ksars_trigger = yes
		}
	}

	cooldown = { years = 25 }

	immediate = {
		random_held_county = {
			limit = {
				valid_for_ksars_trigger = yes
			}
			save_scope_as = ksar_county
		}
		scope:ksar_county = {
			change_development_progress = minor_development_progress_gain
		}
	}

	option = { # Ok
		name = harad.0025.a
		ai_chance = {
			base = 100
		}
	}
	option = { # Ok
		name = harad.0025.b
		add_prestige = -50
		add_piety = 50
		stress_impact = {
			arrogant = minor_stress_impact_gain
			callous = miniscule_stress_impact_gain
			paranoid = miniscule_stress_impact_gain
		}
		ai_chance = {
			base = 100
		}
	}
	option = { # Ok
		name = harad.0025.c	
		remove_short_term_gold = tiny_gold_value
		add_prestige = 100
		stress_impact = {
			compassionate = minor_stress_impact_gain
			humble = minor_stress_impact_gain
		}
		ai_chance = {
			base = 100
			modifier = {
				add = -100
				gold < tiny_gold_value
			}
		}
	}
}


##########################################
# Maresh Flavor Events
# by Juke (based on RICE)
# 0026-0029
##########################################
# Maresh is  key site of trade in Arysis between Near Harad and Khy
# In the Maresh Prosperity decision chain, players can slowly build it up over several generations

# Inspecting the Mekhor
harad.0026 = {
	content_source = realms_dlc
	type = character_event
	title = harad.0026.t
	desc = harad.0026.desc
	theme = stewardship
	override_background = { reference = harad_1 }
	
	left_portrait = root
	
	trigger = {
		is_landed = yes
		NOT = { is_orc = yes }
		NOT = { is_elf = yes }
		has_title = title:c_maresh
	}
	
	cooldown = { years = 25 }
	
	immediate = {
		title:c_maresh = { #For loc.
			save_scope_as = maresh_county
		}
	}

	option = { # Ok
		name = harad.0026.a
		title:c_maresh = {
			add_county_modifier = {
				modifier = maresh_canal_issues
				years = 5
			}
		}
		stress_impact = {
			diligent = minor_stress_impact_gain
			just = minor_stress_impact_gain
		}
		
	}
	option = { # Ok
		name = harad.0026.b	
		trigger = {
			OR = {
				is_ai = no
				gold >= 60
			}
		}
		show_as_tooltip = {
			title:c_maresh = {
				remove_county_modifier = maresh_canal_issues
			}
		}
		remove_short_term_gold = 60
		add_prestige = 100
		stress_impact = {
			arbitrary = minor_stress_impact_gain
		}
	}
}

# Maresh's coins are praised
harad.0027 = {
	content_source = realms_dlc
	type = character_event
	title = harad.0027.t
	desc = harad.0027.desc
	theme = realm
	override_background = { reference = market }
	
	cooldown = { years = 25 }
	
	left_portrait = root

	right_portrait = {
		character = scope:praising_merchant
		animation = steward
	}
	
	trigger = {
		is_landed = yes
		NOT = { is_orc = yes }
		NOT = { is_elf = yes }
		has_title = title:c_maresh
		has_global_variable = maresh_mint_created
		title:b_arsasak.title_province = { has_building_or_higher = arsasan_mints_01 }
		# We need someplace to generate merchants
		any_county_in_region = {
			region = middleearth_harad
			OR = {
				culture = { has_cultural_parameter = heritage_group_apysaic }
				culture = { has_cultural_parameter = heritage_group_haladin }
				culture = { has_cultural_parameter = heritage_group_numenorean }
				culture = { has_cultural_pillar = heritage_south_khailuza }
			}
		}
	}

	immediate = {
		title:c_maresh = { #For loc.
			save_scope_as = maresh_county
		}

		hidden_effect = {
			every_county_in_region = {
				region = middleearth_harad
				limit = {
					OR = {
						culture = { has_cultural_parameter = heritage_group_apysaic }
						culture = { has_cultural_parameter = heritage_group_haladin }
						culture = { has_cultural_parameter = heritage_group_numenorean }
						culture = { has_cultural_pillar = heritage_south_khailuza }
					}
				}
				add_to_list = merchant_counties
			}
			random_in_list = {
				list = merchant_counties
				save_scope_as = home_county
				weight = {
					base = 1
					modifier = {
						add = 1
						NOT = { title_province = { has_holding_type = tribal_holding } }
					}
					modifier = {
						add = 1
						title_province = { has_special_building = yes }
					}
					modifier = {
						add = 1
						culture = { has_cultural_tradition = tradition_trans_haradric_traders }
					}
					modifier = { # Cultures we want to see more commonly as dune sea merchants
						add = 0.5
						OR = {
							culture = culture:harondorim
							culture = { has_cultural_pillar = heritage_northern_apysaic }
							culture = { has_cultural_pillar = heritage_middle_apysaic }
							culture = { has_cultural_pillar = heritage_southern_apysaic }
							culture = { has_cultural_pillar = heritage_south_khailuza }
							culture = { has_cultural_pillar = heritage_bellakari }
							culture = { has_cultural_pillar = heritage_new_sirayni }
							culture = { has_cultural_pillar = heritage_old_sirayni }
						}
					}
					modifier = { # Cultures we want to boost even more cause theyre cool to encounter
						add = 1
						OR = {
							culture = culture:harondorim
							culture = culture:bellanarud
							culture = culture:poan
							culture = culture:kindilar
							culture = culture:arysisani
						}
					}
				}
			}
			create_character = {
				location = root.location
				template = trans_haradric_merchant_template
				save_scope_as = praising_merchant
				culture = scope:home_county.culture
				faith = scope:home_county.faith
			}
		}
	}

	option = { # Ok
		name = harad.0027.a
		custom_tooltip = harad.0027.a.tt
		add_gold = 1 #He tosses me a coin
		add_prestige = 50
	}

	after = {
		hidden_effect = {
			scope:praising_merchant = { silent_disappearance_effect = yes }
		}
	}
}

# Goldsmiths settle in Maresh
harad.0028 = {
	content_source = realms_dlc
	type = character_event
	title = harad.0028.t
	desc = harad.0028.desc
	theme = realm
	override_background = { reference = market }
	
	right_portrait = root
	
	trigger = {
		is_landed = yes
		NOT = { is_orc = yes }
		NOT = { is_elf = yes }
		has_title = title:c_maresh
	}
	
	cooldown = { years = 25 }
	
	immediate = {
		title:c_maresh = { #For loc.
			save_scope_as = maresh_county
		}
	}

	option = { # Ok
		name = harad.0028.a
		title:c_maresh = {
			add_county_modifier = {
				modifier = maresh_goldsmiths
				years = 5
			}
		}
	}

	option = { # I can craft myself!
		name = harad.0028.b
		trigger = { has_trait = lifestyle_artifact_crafting }
		show_as_unavailable = { NOT = { has_trait = lifestyle_artifact_crafting } }
		trait = lifestyle_artifact_crafting
		create_metal_gem_artifact = {
			METAL = gold
			MODIFIER = artifact_monthly_minor_prestige_2_modifier
		}
		set_metal_gem_variable = { METAL = gold }
	}
}

# Ceramics from Maresh
harad.0029 = {
	content_source = realms_dlc
	type = character_event
	title = harad.0029.t
	desc = harad.0029.desc
	theme = realm
	override_background = { reference = harad_1 }
	
	right_portrait = root
	
	trigger = {
		is_landed = yes
		NOT = { is_orc = yes }
		NOT = { is_elf = yes }
		has_title = title:c_maresh
	}
	
	cooldown = { years = 25 }
	
	immediate = {
		title:c_maresh = { #For loc.
			save_scope_as = maresh_county
		}
	}

	option = { # Ok
		name = harad.0029.a
		title:c_maresh = {
			add_county_modifier = {
				modifier = maresh_glazed_ceramics
				years = 5
			}
		}
	}
}


##########################################
# Kjhana Flavor Events
# by Juke (based on RICE)
# 0030-0031
###########################################
# Kjhana (MERP: Xana) is a tree native only to northern Harshandatt
# Its small red fruit can be processed to create oil, or eaten
# Its bark and sap also carry great healing properties

# Learning about Kjhana
harad.0030 = {
	content_source = realms_dlc
	type = character_event
	title = harad.0030.t
	desc = harad.0030.desc
	theme = stewardship
	override_background = { reference = drylands }
	
	left_portrait = {
		character = root
		animation = personality_rational
	}
	
	trigger = {
		is_landed = yes
		OR = {
			is_independent_ruler = yes
			is_ai = no
		}
		NOT = { is_orc = yes }
		NOT = { is_elf = yes }
		OR = {
			completely_controls = title:c_memphet
			completely_controls = title:c_oshymir
			completely_controls = title:c_vyrasun
		}
	}
	
	cooldown = { years = 25 }

	option = { # How quaint.
		name = {
			text = {
				first_valid = {
					triggered_desc = {
						trigger = {
							has_trait = arrogant
						}
						desc = harad.0030.a.arrogant
					}
					triggered_desc = {
						trigger = {
							has_trait = cynical
						}
						desc = harad.0030.a.cynical
					}
					desc = harad.0030.a
				}
			}
		}
		trait = arrogant
		trait = cynical
		stress_impact = {
			base = minor_stress_impact_loss
			arrogant = minor_stress_impact_loss
			cynical = minor_stress_impact_loss
		}

		ai_chance = {
			base = 100
			modifier = {
				add = 400
				has_trait = arrogant
			}
			modifier = {
				add = 100
				has_trait = cynical
			}
			modifier = {
				add = 300
				has_trait = lazy
			}
		}
	}

	option = { # Let me help you!
		name = harad.0030.b
		add_diplomacy_lifestyle_xp = medium_lifestyle_xp
		stress_impact = {
			arrogant = minor_stress_impact_gain
			lazy = minor_stress_impact_gain
		}

		ai_chance = {
			base = 100
			modifier = {
				add = -70
				has_trait = arrogant
			}
		}
	}

	option = { # Show me the goats
		name = harad.0030.c
		add_stewardship_lifestyle_xp = medium_lifestyle_xp
		stress_impact = {
			lazy = minor_stress_impact_gain
		}

		ai_chance = {
			base = 100
		}
	}

	option = { # How do I use it medicinally?
		name = harad.0030.d
		add_learning_lifestyle_xp = medium_lifestyle_xp
		stress_impact = {
			lazy = minor_stress_impact_gain
		}

		ai_chance = {
			base = 100
		}
	}
}

# Gift of Kjhana Oil
harad.0031 = {
	content_source = realms_dlc
	type = character_event
	title = harad.0031.t
	desc = harad.0031.desc
	theme = stewardship
	override_background = { reference = market }
	
	left_portrait = root
	
	right_portrait = scope:kjhana_merchant
	
	trigger = {
		is_landed = yes
		NOT = { is_orc = yes }
		NOT = { is_elf = yes }
		OR = {
			capital_county.title_province = { geographical_region = special_region_greater_harad }
			completely_controls = title:c_memphet
			completely_controls = title:c_oshymir
			completely_controls = title:c_vyrasun
		}
		any_county_in_region = {
			region = middleearth_harad_bayoformal_harshandatt
			OR = {
				culture = { has_cultural_parameter = heritage_group_apysaic }
				culture = { has_cultural_pillar = heritage_south_khailuza }
			}
		}
	}
	
	cooldown = { years = 25 }

	weight_multiplier = {
		base = 1
		# Less common, but still possible, in larger Harad
		modifier = {
			add = -0.5
			capital_county.title_province ?= {
				NOR = {
					geographical_region = middleearth_harad_far
					geographical_region = custom_greater_bayoformal
					geographical_region = middleearth_harad_dunesea
				}
			}
		}
		# More common in Bay of Ormal
		modifier = {
			add = 0.5
			capital_county.title_province = { geographical_region = custom_greater_bayoformal }
		}
		# Even more common in Harshandatt itself
		modifier = {
			add = 0.5
			capital_county.title_province = { geographical_region = middleearth_harad_bayoformal_harshandatt }
		}
	}

	immediate = {
		# Save one of the forest counties as origin
		random_list = {
			10 = { title:c_memphet = { save_scope_as = kjhana_county } }
			10 = { title:c_oshymir = { save_scope_as = kjhana_county } }
			10 = { title:c_vyrasun = { save_scope_as = kjhana_county } }
		}
		# Create a Harshandatti Merchant
		hidden_effect = {
			every_county_in_region = {
				region = middleearth_harad_bayoformal_harshandatt
				limit = {
					OR = {
						culture = { has_cultural_parameter = heritage_group_apysaic }
						culture = { has_cultural_pillar = heritage_south_khailuza }
					}
				}
				add_to_list = merchant_counties
			}
			random_in_list = {
				list = merchant_counties
				save_scope_as = home_county
				weight = {
					base = 1
					modifier = {
						add = 5
						culture = { has_cultural_pillar = heritage_harshandatt }
					}
					modifier = {
						add = 2
						title_province = { has_building_or_higher = kjhana_forest_01 }
					}
				}
			}
			create_character = {
				location = root.location
				template = trans_haradric_merchant_template
				save_scope_as = kjhana_merchant
				culture = scope:home_county.culture
				faith = scope:home_county.faith
			}
		}
	}

	option = { # Maybe this will heal me
		name = harad.0031.a
		trigger = {
			OR = {
				has_trait = ill
				has_trait = pneumonic
			}
		}
		trait = ill
		trait = pneumonic
		if = {
			limit = { has_trait = pneumonic }
			random = {
				chance = 40
				recover_from_disease_effect = { DISEASE = pneumonic }
			}
		}
		if = {
			limit = { has_trait = ill }
			random = {
				chance = 60
				recover_from_disease_effect = { DISEASE = ill }
			}
		}
	}

	option = { # Thank you
		name = harad.0031.b
		add_character_modifier = {
			modifier = kjhana_oil_gift
			years = 5
		}
	}

	option = { # Enjoy it together!
		name = harad.0031.c
		duel = {
			skill = diplomacy
			target = scope:kjhana_merchant
			10 = {
				min = 2
				compare_modifier = {
					value = scope:duel_value
					multiplier = 3.5
				}
				desc = harad.0031.c.success
				send_interface_toast = {
					type = event_toast_effect_good
					title = harad.0031.c.success
					right_icon = scope:kjhana_merchant
					scope:kjhana_merchant = { 
						set_employer = ROOT
						add_character_flag = dont_disappear
					}
					stress_impact = {
						base = minor_stress_impact_loss
						gluttonous = medium_stress_impact_loss
						gregarious = minor_stress_impact_loss
						shy = minor_stress_impact_gain
					}
				}
				modifier = {
					add = 2
					has_trait = gregarious
				}
				modifier = {
					add = -2
					has_trait = shy
				}
			}
			10 = {
				min = 2
				compare_modifier = {
					value = scope:duel_value
					multiplier = -3.5
				}
				desc = harad.0031.c.failure
				send_interface_toast = {
					type = event_toast_effect_bad
					title = harad.0031.c.failure
					right_icon = scope:kjhana_merchant
					custom_tooltip = harad.0031.c.failure.tt
					stress_impact = {
						base = miniscule_stress_impact_loss
						gluttonous = medium_stress_impact_loss
						gregarious = minor_stress_impact_gain
						shy = medium_stress_impact_gain
					}
				}
				modifier = {
					add = -2
					has_trait = gregarious
				}
				modifier = {
					add = 2
					has_trait = shy
				}
			}
		}
	}

	after = {
		# If we recruited them, remove the flag
		if = {
			limit = {
				scope:kjhana_merchant = { has_character_flag = dont_disappear }
			}
			scope:kjhana_merchant = {
				remove_character_flag = dont_disappear
			}
		}
		# If we didnt recruit them, make them disappear
		else = {
			scope:kjhana_merchant = {
				silent_disappearance_effect = yes
			}
		}
	}
}


##########################################
# Mud Mason Tradition Flavor Events
# by Juke (based on RICE)
# 0032-0035
##########################################
# Mud Masonry is practiced in some areas of Sîrayn, mainly around Chennacatt
# The City of Selena is their most important site

# Maintenance for mud structure
harad.0032 = {
	content_source = realms_dlc
	type = character_event
	title = harad.0032.t
	desc = harad.0032.desc
	theme = stewardship_wealth_focus
	override_background = {	reference = market }
	
	right_portrait = root
	
	trigger = {
		is_landed = yes
		is_wastelands = no
		is_orc = no
		# Subjects have Mud Masons
		any_held_county = {
			culture = { has_cultural_tradition = tradition_mud_masons }
		}
	}
	
	cooldown = { years = 10 }

	weight_multiplier = {
		base = 1
		modifier = {
			add = 0.3
			culture = { has_cultural_tradition = tradition_mud_masons }
		}
		modifier = {
			add = 0.2
			AND = {
				has_title = title:c_selena
				title:c_selena.title_province = {
					has_building_or_higher = selena_mud_masons_01
				}
			}
		}
	}

	immediate = {
		random_held_county = {
			limit = {
				culture = { has_cultural_tradition = tradition_mud_masons }
			}
			save_scope_as = mason_county
			culture = { save_scope_as = mason_culture }
			weight = {
				base = 1
				modifier = {
					add = 10
					culture = ROOT.culture
				}
			}
		}
	}

	option = { # Architect - Focus on these load bearing parts
		name = harad.0032.a
		trigger =  { has_trait = architect }
		show_as_unavailable = { always = yes }
		trait = architect
		custom_tooltip = harad.0032.resolved
	}

	option = { # Do the rites
		name = harad.0032.b
		remove_short_term_gold = minor_gold_value
		add_piety = 50
		custom_tooltip = harad.0032.resolved
	}

	option = { # Just do your job
		name = harad.0032.c
		random_list = {
			50 = {
				custom_tooltip = harad.0032.resolved
				modifier = {
					add = 25
					AND = {
						scope:mason_county = title:c_selena
						title:c_selena.title_province = {
							has_building_or_higher = selena_mud_masons_01
						}
					}
				}
			}
			50 = {
				add_piety = minor_piety_loss
				scope:mason_county = {
					add_county_modifier = {
						modifier = governance_1054_upset_peasants_modifier
						years = 5
					}
				}
				modifier = {
					add = -25
					AND = {
						scope:mason_county = title:c_selena
						title:c_selena.title_province = {
							has_building_or_higher = selena_mud_masons_01
						}
					}
				}
			}
		}
	}
}

# Secrets of the mud masons?
harad.0033 = {
	content_source = realms_dlc
	type = character_event
	title = harad.0033.t
	desc = harad.0033.desc
	theme = stewardship
	override_background = { reference = harad_2 }
	override_icon = { reference = "gfx/interface/icons/event_types/type_faith.dds" }
	
	left_portrait = {
		character = root
		animation = personality_cynical
	}
	
	trigger = {
		is_landed = yes
		is_wastelands = no
		is_orc = no
		# Subjects have Mud Masons
		any_held_county = {
			culture = { has_cultural_tradition = tradition_mud_masons }
		}
	}
	
	cooldown = { years = 10 }

	weight_multiplier = {
		base = 1
		modifier = {
			add = 0.3
			culture = { has_cultural_tradition = tradition_mud_masons }
		}
		modifier = {
			add = 0.2
			AND = {
				has_title = title:c_selena
				title:c_selena.title_province = {
					has_building_or_higher = selena_mud_masons_01
				}
			}
		}
	}

	immediate = {
		random_held_county = {
			limit = {
				culture = { has_cultural_tradition = tradition_mud_masons }
			}
			save_scope_as = mason_county
			title_province = { save_scope_as = mason_province }
			weight = {
				base = 1
				modifier = {
					add = 10
					culture = ROOT.culture
				}
			}
		}
	}

	option = { # Ok
		name = harad.0033.a
		add_piety = miniscule_piety_gain
		stress_impact = {
			cynical = minor_stress_impact_gain
			stubborn = miniscule_stress_impact_gain
			arrogant = miniscule_stress_impact_gain
		}
	}

	option = { # Ok
		name = harad.0033.b
		add_prestige = miniscule_prestige_gain
		stress_impact = {
			zealous = minor_stress_impact_gain
			fickle = miniscule_stress_impact_gain
			humble = miniscule_stress_impact_gain
		}
	}
}

# New mud mason contract
harad.0034 = {
	content_source = realms_dlc
	type = character_event
	title = harad.0034.t
	desc = harad.0034.desc
	theme = stewardship
	override_background = { reference = harad_drylands }
	override_icon = { reference = "gfx/interface/icons/event_types/type_faith.dds" }
	
	left_portrait = root
	
	trigger = {
		is_landed = yes
		is_wastelands = no
		is_orc = no
		# Has Mud Masons
		culture = { has_cultural_tradition = tradition_mud_masons }
	}
	
	cooldown = { years = 10 }

	weight_multiplier = {
		base = 1
		modifier = {
			add = 0.2
			AND = {
				has_title = title:c_selena
				title:c_selena.title_province = {
					has_building_or_higher = selena_mud_masons_01
				}
			}
		}
	}

	option = { # Ok
		name = harad.0034.a
		add_character_modifier = {
			modifier = lotr_new_mud_mason_contract
			years = 10
		}
	}
}

# Extra protection for mud mason construction
harad.0035 = {
	content_source = realms_dlc
	type = character_event
	title = harad.0035.t
	desc = harad.0035.desc
	theme = stewardship
	override_background = { reference = harad_2 }
	
	right_portrait = root
	
	left_portrait = root
	
	trigger = {
		is_landed = yes
		is_wastelands = no
		is_orc = no
		# Has Mud Masons
		culture = { has_cultural_tradition = tradition_mud_masons }
	}
	
	cooldown = { years = 10 }

	weight_multiplier = {
		base = 1
		modifier = {
			add = 0.2
			AND = {
				has_title = title:c_selena
				title:c_selena.title_province = {
					has_building_or_higher = selena_mud_masons_01
				}
			}
		}
	}

	option = { # Ok
		name = harad.0035.a
		if = {
			limit = {
				faith.religion = { is_in_family = rf_darkness }
			}
			stress_impact = {
				zealous = minor_stress_impact_gain
				paranoid = miniscule_stress_impact_gain
				humble = miniscule_stress_impact_gain
			}
		}
		else = {
			stress_impact = {
				paranoid = miniscule_stress_impact_gain
				humble = miniscule_stress_impact_gain
			}
		}
	}

	option = { # Ok
		name = harad.0035.b
		trigger = {
			OR = {
				gold >= minor_gold_value
				is_ai = no
			}
		}
		remove_short_term_gold = minor_gold_value
		add_character_modifier = {
			modifier = lotr_extra_protection_mud_masons
			years = 10
		}
		stress_impact = {
			cynical = minor_stress_impact_gain
			greedy = minor_stress_impact_gain
		}
	}

	option = { # Ok
		name = harad.0035.c
		trigger = {
			NOT = { faith.religion = { is_in_family = rf_darkness } }
		}
		reason = faith
		add_piety = 50
		add_prestige = -50
		stress_impact = {
			cynical = minor_stress_impact_gain
			humble = miniscule_stress_impact_gain
		}
	}
}


##########################################
# Ammu Bâj / Uljun Flavor Event
# by Juke (based on RICE)
# 0036
###########################################
# The Ammu Bâj is the largest forest in Khy, rumored to be haunted
# Black Uljun grow there, massive trees that are highly valued by shipbuilders

# Whispers of the Ammu Bâj
harad.0036 = {
	content_source = realms_dlc
	type = character_event
	title = harad.0036.t
	desc = harad.0036.desc
	theme = stewardship
	override_background = { reference = wilderness_forest_deep }
	
	left_portrait = {
		character = root
		animation = personality_rational
	}
	
	trigger = {
		is_landed = yes
		OR = {
			is_independent_ruler = yes
			is_ai = no
		}
		NOT = { is_orc = yes }
		NOT = { is_elf = yes }
		OR = {
			completely_controls = title:c_jaloryath
			completely_controls = title:c_osvalun
			completely_controls = title:c_marashul
			completely_controls = title:c_felysdan
		}
	}
	
	cooldown = { years = 25 }

	immediate = {
		random_realm_county = {
			limit = {
				OR = {
					this = title:c_jaloryath
					this = title:c_osvalun
					this = title:c_marashul
					this = title:c_felysdan
				}
			}
			save_scope_as = uljun_county
		}
	}

	option = { # Send Guards
		name = harad.0036.a
		add_prestige = minor_prestige_loss
		random_list = {
			60 = {
				scope:uljun_county = { add_county_modifier = governance_1054_satisfied_peasants_modifier }
			}
			40 = {
				scope:uljun_county = { add_county_modifier = governance_1054_upset_peasants_modifier }
			}
		}
	}

	option = { # Send Priests
		name = harad.0036.b
		add_piety = medium_piety_loss
		random_list = {
			80 = {
				scope:uljun_county = { add_county_modifier = governance_1054_satisfied_peasants_modifier }
			}
			20 = {
				scope:uljun_county = { add_county_modifier = governance_1054_upset_peasants_modifier }
			}
		}
	}

	option = { # Dont care
		name = harad.0036.c
		change_influence = minor_influence_loss
		add_legitimacy = minor_legitimacy_loss
		scope:uljun_county = { add_county_modifier = governance_1054_upset_peasants_modifier }
	}
}


##########################################
# Haradric Merchant Flavor Events
# by Juke
# 0037-40
###########################################
# Merchant Dispute
scripted_effect create_dispute_merchant_weighted_effect = {
	random_list = {
		# Merchant comes from elsewhere
		100 = {
			create_haradric_merchant_from_region_effect = { REGION = middleearth_harad }
		}
		# Merchant comes from general area, wherever that is
		200 = {
			trigger = { capital_county.title_province = { geographical_region = middleearth_harad_near } }
			create_haradric_merchant_from_region_effect = { REGION = middleearth_harad_near }
		}
		200 = {
			trigger = { capital_county.title_province = { geographical_region = middleearth_harad_far } }
			create_haradric_merchant_from_region_effect = { REGION = middleearth_harad_far }
		}
		200 = {
			trigger = { capital_county.title_province = { geographical_region = middleearth_harad_dunesea } }
			create_haradric_merchant_from_region_effect = { REGION = middleearth_harad_dunesea }
		}
		200 = {
			trigger = { capital_county.title_province = { geographical_region = middleearth_harad_bayoformal } }
			create_haradric_merchant_from_region_effect = { REGION = middleearth_harad_bayoformal }
		}
	}
}
scripted_effect attempt_to_calm_merchants_effect = {
	save_scope_as = negotiator
	scope:negotiator = {
		duel = {
			skill = diplomacy
			value = medium_skill_rating
			10 = {
				min = 2
				compare_modifier = {
					value = scope:duel_value
					multiplier = 2
				}
				desc = harad.0037.a.success
				ROOT = {
					send_interface_toast = {
						type = event_toast_effect_good
						title = harad.0037.a.success
						left_icon = scope:negotiator
						right_icon = scope:angry_merchant_1
						scope:negotiator = {
							add_diplomacy_lifestyle_xp = medium_lifestyle_xp
							if = {
								limit = { has_trait = lifestyle_trans_haradric_merchant }
								add_trait_xp = {
									trait = lifestyle_trans_haradric_merchant
									value = { 1 5 }
								}
							}
							else = {
								random = {
									chance = 20
									add_trait = lifestyle_trans_haradric_merchant
								}
							}
						}
						stress_impact = {
							base = minor_stress_impact_loss
							just = miniscule_stress_impact_loss
							compassionate = miniscule_stress_impact_loss
						}
					}
				}
				modifier = {
					add = 2
					has_trait = lifestyle_trans_haradric_merchant
				}
			}
			10 = {
				min = 2
				compare_modifier = {
					value = scope:duel_value
					multiplier = -2
				}
				desc = harad.0037.a.failure
				hidden_effect = {
					random_list = {
						# Merchant 1 kills Merchant 2
						10 = {
							scope:angry_merchant_2 = {
								death = {
									death_reason = death_battle
									killer = scope:angry_merchant_1
								}
							}
							scope:angry_merchant_1 = {
								random = {
									chance = 60
									increase_wounds_effect = { REASON = fight }
								}
								save_scope_as = survivor
							}
						}
						# Merchant 2 kills Merchant 1
						10 = {
							scope:angry_merchant_1 = {
								death = {
									death_reason = death_battle
									killer = scope:angry_merchant_1
								}
							}
							scope:angry_merchant_2 = {
								random = {
									chance = 60
									increase_wounds_effect = { REASON = fight }
								}
								save_scope_as = survivor
							}
						}
					}
				}
				ROOT = {
					send_interface_toast = {
						type = event_toast_effect_bad
						title = harad.0037.a.failure
						left_icon = scope:negotiator
						right_icon = scope:survivor
						capital_county = {
							change_county_control = minor_county_control_loss
						}
						scope:negotiator = {
							random = {
								chance = 50
								increase_wounds_effect = { REASON = fight }
							}
						}
						stress_impact = {
							base = minor_stress_impact_gain
							compassionate = miniscule_stress_impact_gain
							arbitrary = minor_stress_impact_loss
						}
					}
				}
				modifier = {
					add = -2
					has_trait = lifestyle_trans_haradric_merchant
				}
			}
		}
	}
}
harad.0037 = {
	content_source = realms_dlc
	type = character_event
	title = harad.0037.t
	desc = harad.0037.desc
	theme = stewardship
	override_background = { reference = market }
	
	left_portrait = {
		character = scope:angry_merchant_1
		scripted_animation = duel_wield_weapon
	}
	
	lower_center_portrait = {
		character = ROOT
	}
	
	right_portrait = {
		character = scope:angry_merchant_2
		animation = anger
	}
	
	trigger = {
		is_landed = yes
		NOT = { is_orc = yes }
		NOT = { is_elf = yes }
		# We are in Harad
		capital_county = {
			title_province = { geographical_region = middleearth_harad }
		}
		# We need someplace to generate merchants
		any_county_in_region = {
			region = middleearth_harad
			OR = {
				culture = { has_cultural_parameter = heritage_group_apysaic }
				culture = { has_cultural_parameter = heritage_group_haladin }
				culture = { has_cultural_parameter = heritage_group_numenorean }
				culture = { has_cultural_pillar = heritage_south_khailuza }
			}
		}
	}
	
	cooldown = { years = 25 }

	weight_multiplier = {
		base = 1
		modifier = {
			add = 0.5
			any_held_county = {
				title_province = {
					OR = {
						has_building_or_higher = wonder_hamat_maresh_01
						has_building_or_higher = wonder_souk_mazharath
					}
				}
			}
		}
		modifier = {
			add = 0.5
			culture = { has_cultural_tradition = tradition_trans_haradric_traders }
		}
		modifier = {
			add = 0.2
			has_trait = lifestyle_trans_haradric_merchant
		}
	}

	immediate = {
		# Create Merchant A
		create_dispute_merchant_weighted_effect = yes
		scope:trans_haradric_merchant_spawn = { save_scope_as = angry_merchant_1 }
		
		# Create Merchant B
		create_dispute_merchant_weighted_effect = yes
		scope:trans_haradric_merchant_spawn = { save_scope_as = angry_merchant_2 }

		# Make them rivals
		hidden_effect = {
			scope:angry_merchant_1 = {
				set_relation_rival = {
					target = scope:angry_merchant_2
					reason = rival_insulted_me
				}
			}
		}

		# Check if we have a steward
		cp:councillor_steward ?= { save_scope_as = steward }
	}

	option = { # I will negotiate
		name = harad.0037.a
		attempt_to_calm_merchants_effect = yes
	}

	option = { # Steward, negotiate
		name = harad.0037.b
		trigger = { exists = scope:steward }
		if = {
			limit = { exists = scope:steward }
			scope:steward = { attempt_to_calm_merchants_effect = yes }
		}
	}

	option = { # Take this outside
		name = harad.0037.c
		random_list = {
			40 = {
				send_interface_toast = {
					type = event_toast_effect_good
					title = harad.0037.a.success
					left_icon = ROOT
					right_icon = scope:angry_merchant_1
					stress_impact = {
						base = minor_stress_impact_loss
						just = miniscule_stress_impact_loss
						compassionate = miniscule_stress_impact_loss
					}
				}
			}
			60 = {
				hidden_effect = {
					random_list = {
						# Merchant 1 kills Merchant 2
						10 = {
							scope:angry_merchant_2 = {
								death = {
									death_reason = death_battle
									killer = scope:angry_merchant_1
								}
							}
							scope:angry_merchant_1 = {
								random = {
									chance = 60
									increase_wounds_effect = { REASON = fight }
								}
								save_scope_as = survivor
							}
						}
						# Merchant 2 kills Merchant 1
						10 = {
							scope:angry_merchant_1 = {
								death = {
									death_reason = death_battle
									killer = scope:angry_merchant_1
								}
							}
							scope:angry_merchant_2 = {
								random = {
									chance = 60
									increase_wounds_effect = { REASON = fight }
								}
								save_scope_as = survivor
							}
						}
					}
				}
				send_interface_toast = {
					type = event_toast_effect_bad
					title = harad.0037.a.failure
					left_icon = ROOT
					right_icon = scope:survivor
					capital_county = {
						change_county_control = minor_county_control_loss
					}
					stress_impact = {
						base = minor_stress_impact_gain
						just = miniscule_stress_impact_gain
						compassionate = miniscule_stress_impact_gain
						arbitrary = minor_stress_impact_loss
					}
				}
			}
		}
	}

	after = {
		# Make them disappear afterward
		hidden_effect = {
			scope:angry_merchant_1 ?= {
				if = {
					limit = { is_alive = yes	}
					silent_disappearance_effect = yes
				}
			}
			scope:angry_merchant_2 ?= {
				if = {
					limit = { is_alive = yes	}
					silent_disappearance_effect = yes
				}
			}
		}
	}
}



##################################################
##################################################
######## DECISIONS AND QUEST CHAIN EVENTS ########
##################################################
##################################################

##########################################
# TA 3000 Sûladan Event Chain
# 0101-0226
##########################################

harad.0101 = { # The War in Pezarsan
	content_source = realms_dlc
	type = character_event
	title = harad.0101.t
	desc = harad.0101.desc
	theme = war
	override_background = {
		reference = harad_drylands
	}
	left_portrait = {
		character = root
		animation = personality_zealous
	}
	right_portrait = {
		character = character:lineofarzagarnom7
		animation = anger
	}
	
	option = { # The encircling serpent shall have its neck cut off
		name = harad.0101.a
	}
}

harad.0202 = { #Victory in Pezarsan
	content_source = realms_dlc
	type = character_event
	title = harad.0202.t
	desc = harad.0202.desc
	theme = war
	left_portrait = {
		character = root
		animation = schadenfreude
	}
	right_portrait = {
		character = title:k_haruzan.holder
		animation = personality_bold
	}
	
	option = { # Of course I will keep my promise good cousin!
		name = harad.0202.a
		create_title_and_vassal_change = {
			type = created
			save_scope_as = change
			add_claim_on_loss = no
		}
		title:k_pezarsan = {
			change_title_holder = {
				holder = title:k_haruzan.holder
				change = scope:change
			}
		}
		title:d_haruzan = {
			change_title_holder = {
				holder = title:k_haruzan.holder
				change = scope:change
			}
		}
		title:c_argon = {
			change_title_holder = {
				holder = title:k_haruzan.holder
				change = scope:change
			}
		}
		title:c_nithagasag = {
			change_title_holder = {
				holder = title:k_haruzan.holder
				change = scope:change
			}
		}
		resolve_title_and_vassal_change = scope:change
		create_title_and_vassal_change = {
			type = swear_fealty
			save_scope_as = title_change
			add_claim_on_loss = no
		}
		change_liege = {
			liege = title:k_haruzan.holder
			change = scope:title_change
		}
		resolve_title_and_vassal_change = scope:title_change
		add_prestige = 200
		ai_chance = {
			base = 0 # LotR: This should be tied to WotR mode.
			modifier = { # Game Rule
				has_game_rule = default_ai_behavior
				add = 100
			}
			modifier = { # Game Rule
				has_game_rule = weighted_ai_behavior
				add = 80
			}
			modifier = { # Game Rule
				has_game_rule = random_ai_behavior
				add = 50
			}
		}
		title:k_haruzan.holder = { # Notify King of Haruzan (Suladan)
			trigger_event = {
				id = harad.0204
				days = 10
			}
		}
	}

	option = { # On second thoughts...
		name = harad.0202.b
		title:k_haruzan.holder = {
			add_pressed_claim = title:k_pezarsan
			set_relation_rival = root
		}
		add_prestige = -300
		add_piety_level = -1
		ai_chance = {
			base = 0 # LotR: This should be tied to WotR mode.
			modifier = { # Game Rule
				has_game_rule = default_ai_behavior
				add = 0
			}
			modifier = { # Game Rule
				has_game_rule = weighted_ai_behavior
				add = 20
			}
			modifier = { # Game Rule
				has_game_rule = random_ai_behavior
				add = 50
			}
		}
		root = {
			save_scope_as = perfidious_cousin
		}
		title:k_haruzan.holder = { # Notify King of Haruzan (Suladan)
			trigger_event = {
				id = harad.0205
				months = 3
			}
		}
	}
}

harad.0203 = { #Defeat in Pezarsan
	content_source = realms_dlc
	type = character_event
	title = harad.0203.t
	desc = harad.0203.desc
	theme = war
	left_portrait = {
		character = root
		animation = shame
	}
	right_portrait = {
		character = title:k_haruzan.holder
		animation = anger
	}
	
	option = { # Even in defeat, a debt must be repaid
		name = harad.0203.a
		create_title_and_vassal_change = {
			type = swear_fealty
			save_scope_as = title_change
			add_claim_on_loss = no
		}
		change_liege = {
			liege = title:k_haruzan.holder
			change = scope:title_change
		}
		resolve_title_and_vassal_change = scope:title_change
		if = {
			limit = {
				has_trait = ambitious
			}		
			remove_trait = ambitious
			add_trait_force_tooltip = content
		}			
	}
}

harad.0204 = {# Pezarsan secured - West or East?
	content_source = realms_dlc
	type = character_event
	title = harad.0204.t
	desc = harad.0204.desc
	theme = war
	left_portrait = {
		character = root
		animation = personality_bold
	}
	
	option = { # We must punish Chelkar! Unlocks decision to send ultimatum to Chelkar demanding submission
		name = harad.0204.a
		custom_tooltip = harad.0204.a.tt
		add_to_global_variable_list = {
			name = haruzan_expansion_routes
			target = flag:haruzan_eastern_expansion
		}
		ai_chance = {
			base = 0 # LotR: This should be tied to WotR mode.
			modifier = { # Game Rule
				has_game_rule = default_ai_behavior
				add = 30
			}
			modifier = { # Game Rule
				has_game_rule = weighted_ai_behavior
				add = 40
			}
			modifier = { # Game Rule
				has_game_rule = random_ai_behavior
				add = 33
			}
		}
	}
	option = { # Secure the West! Unlocks decisions to try to vassalize the Umbarean lords (prioritized by AI on account of the 'Race for Mirlond' effect)
		name = harad.0204.b
		custom_tooltip = harad.0204.b.tt
		add_to_global_variable_list = {
			name = haruzan_expansion_routes
			target = flag:haruzan_westward_expansion
		}
		ai_chance = {
			base = 0 # LotR: This should be tied to WotR mode.
			modifier = { # Game Rule
				has_game_rule = default_ai_behavior
				add = 70
			}
			modifier = { # Game Rule
				has_game_rule = weighted_ai_behavior
				add = 50
			}
			modifier = { # Game Rule
				has_game_rule = random_ai_behavior
				add = 33
			}
		}
	}
	option = { # Don't expand
		name = harad.0204.c
		custom_tooltip = harad.0204.c.tt # Will LOCK the decision/event expansion routes for Haruzan!
		ai_chance = {
			base = 0 # LotR: This should be tied to WotR mode.
			modifier = { # Game Rule
				has_game_rule = default_ai_behavior
				add = 0
			}
			modifier = { # Game Rule
				has_game_rule = weighted_ai_behavior
				add = 10
			}
			modifier = { # Game Rule
				has_game_rule = random_ai_behavior
				add = 33
			}
		}
	}
}

harad.0205 = {# Perfidious Cousin!
	content_source = realms_dlc
	type = character_event
	title = harad.0205.t
	desc = harad.0205.desc
	theme = war
	left_portrait = {
		character = root
		animation = anger
	}
	right_portrait = {
		character = scope:perfidious_cousin
		animation = schadenfreude
	}
	
	option = { # You will pay dearly for this!
		name = harad.0205.a
		title:k_haruzan.holder = {
			trigger_event = { # Check on if Pezarsan has been conquered by Haruzan
				id = harad.0217
				years = 1
			}
		}
	}
}

harad.0206 = { # Haruzan demands submission of Chelkar!
	content_source = realms_dlc
	type = character_event
	title = harad.0206.t
	desc = harad.0206.desc
	theme = war
	left_portrait = {
		character = title:k_haruzan.holder
		animation = anger
	}
	right_portrait = {
		character = root
		animation = disapproval
	}
	
	option = { # I will never submit!
		name = harad.0206.a
		custom_tooltip = harad.0206.a.tt # This might very well lead to an invasion!
		title:k_haruzan.holder = {
			trigger_event = harad.0207
		}
		ai_chance = {
			base = 0 # LotR: This should be tied to WotR mode.
			modifier = { # Game Rule
				has_game_rule = default_ai_behavior
				add = 80
			}
			modifier = { # Game Rule
				has_game_rule = weighted_ai_behavior
				add = 60
			}
			modifier = { # Game Rule
				has_game_rule = random_ai_behavior
				add = 33
			}
		}
	}
	option = { # Send him a counter-offer...
		name = harad.0206.b
		custom_tooltip = harad.0206.b.tt # Offer to bend the knee in exchange for religious protection and exemption from fighting in wars
		title:k_haruzan.holder = {
			trigger_event = harad.0208
		}
		ai_chance = {
			base = 0 # LotR: This should be tied to WotR mode.
			modifier = { # Game Rule
				has_game_rule = default_ai_behavior
				add = 20
			}
			modifier = { # Game Rule
				has_game_rule = weighted_ai_behavior
				add = 30
			}
			modifier = { # Game Rule
				has_game_rule = random_ai_behavior
				add = 33
			}
		}
	}
	option = { # We have no choice
		name = harad.0206.c
		create_title_and_vassal_change = {
			type = created
			save_scope_as = change
			add_claim_on_loss = no
		}
		title:k_chelkar = {
				change_title_holder = {
					holder = title:k_haruzan.holder
					change = scope:change
				}
			}
		title:d_huk_saromis.holder = {
			change_liege = {
				liege = title:k_haruzan.holder
				change = scope:change 
			}
		}
		resolve_title_and_vassal_change = scope:change

		title:k_haruzan.holder = {
			trigger_event = harad.0210
		}
		
		ai_chance = {
			base = 0 # LotR: This should be tied to WotR mode.
			modifier = { # Game Rule
				has_game_rule = default_ai_behavior
				add = 0
			}
			modifier = { # Game Rule
				has_game_rule = weighted_ai_behavior
				add = 20
			}
			modifier = { # Game Rule
				has_game_rule = random_ai_behavior
				add = 33
			}
		}
	}
}

harad.0207 = { # Chelkar refuses our demands!
	content_source = realms_dlc
	type = character_event
	title = harad.0207.t
	desc = harad.0207.desc
	theme = war
	left_portrait = {
		character = root 
		animation = anger
	}
	right_portrait = {
		character = title:k_chelkar.holder
		animation = dismissal
	}
	
	option = { # So you have chosen... death
		name = harad.0207.a
		start_war = { # Invade Chelkar!
			casus_belli = invasion_war 
			target = title:k_chelkar.holder 
			target_title = title:k_chelkar
		}
		root = {
			trigger_event = {
			id = harad.0211 # War status check
			months = 1
			}
		}
		ai_chance = {
			base = 0 # LotR: This should be tied to WotR mode.
			modifier = { # Game Rule
				has_game_rule = default_ai_behavior
				add = 90
			}
			modifier = { # Game Rule
				has_game_rule = weighted_ai_behavior
				add = 70
			}
			modifier = { # Game Rule
				has_game_rule = random_ai_behavior
				add = 50
			}
		}
	}
	option = { # He called our bluff
		name = harad.0207.b
		add_prestige = -500 # A humiliating defeat
		add_prestige_level = -1
		title:k_chelkar.holder = {
			trigger_event = harad.0209 # Haruzan backs down!
		}
		ai_chance = {
			base = 0 # LotR: This should be tied to WotR mode.
			modifier = { # Game Rule
				has_game_rule = default_ai_behavior
				add = 10
			}
			modifier = { # Game Rule
				has_game_rule = weighted_ai_behavior
				add = 30
			}
			modifier = { # Game Rule
				has_game_rule = random_ai_behavior
				add = 50
			}
		}
	}
}

harad.0208 = { # Chelkar gives a counter-offer
	content_source = realms_dlc
	type = character_event
	title = harad.0208.t
	desc = harad.0208.desc
	theme = war
	left_portrait = {
		character = root 
		animation = cynical
	}
	right_portrait = {
		character = title:k_chelkar.holder
		animation = dismissal
	}
	
	option = { # This is an insult!
		name = harad.0208.a
		start_war = { # Invade Chelkar!
			casus_belli = invasion_war 
			target = title:k_chelkar.holder 
			target_title = title:k_chelkar
		}
		root = {
			trigger_event = {
			id = harad.0211 # War status check
			months = 1
			}
		}
		ai_chance = {
			base = 0 # LotR: This should be tied to WotR mode.
			modifier = { # Game Rule
				has_game_rule = default_ai_behavior
				add = 70
			}
			modifier = { # Game Rule
				has_game_rule = weighted_ai_behavior
				add = 60
			}
			modifier = { # Game Rule
				has_game_rule = random_ai_behavior
				add = 50
			}
		}
	}
	option = { # Perhaps I can agree to this
		name = harad.0208.b
		create_title_and_vassal_change = {
            type = created
            save_scope_as = change
            add_claim_on_loss = no
        }
        if = { # On the very slim chance Haruzan has gained an imperial title, vassalize wholesale
            limit = { 
                highest_held_title_tier = tier_empire
            }
            title:k_chelkar.holder = {
                change_liege = {
                    liege = root
                    change = scope:change 
                }
            }
            
            resolve_title_and_vassal_change = scope:change
            
            title:k_chelkar.holder = {
                vassal_contract_set_obligation_level = {
                    type = title_revocation_rights
                    level = 1
                }
                vassal_contract_set_obligation_level = {
                    type = religious_rights 
                    level = 1
                }
            #	vassal_contract_set_obligation_level = {
            #		type = special_contract_scutage 
            #		level = 1
            #	}
				vassal_contract_set_obligation_level = {
                    type = special_contract 
                    level = 1
                }
            }
        }
        else = { # Otherwise, transfer vassals and vassalize
            title:k_chelkar = {
                change_title_holder_include_vassals = {
                    holder = root
                    change = scope:change
                }
            }
            title:d_huk_saromis.holder = {
                change_liege = {
                    liege = root
                    change = scope:change 
                }
            }
            
            resolve_title_and_vassal_change = scope:change
            
            title:d_huk_saromis.holder = {
                vassal_contract_set_obligation_level = {
                    type = title_revocation_rights
                    level = 1
                }
                vassal_contract_set_obligation_level = {
                    type = religious_rights 
                    level = 1
                }
            #	vassal_contract_set_obligation_level = {
            #		type = special_contract_scutage 
            #		level = 1
            #	}
				vassal_contract_set_obligation_level = {
                    type = special_contract 
                    level = 1
                }
            }
			title:d_azran.holder = {
                vassal_contract_set_obligation_level = {
                    type = title_revocation_rights
                    level = 1
                }
                vassal_contract_set_obligation_level = {
                    type = religious_rights 
                    level = 1
                }
            #	vassal_contract_set_obligation_level = {
            #		type = special_contract_scutage 
            #		level = 1
            #	}
				vassal_contract_set_obligation_level = {
                    type = special_contract 
                    level = 1
                }
            }
			title:d_kajbah.holder = {
                vassal_contract_set_obligation_level = {
                    type = title_revocation_rights
                    level = 1
                }
                vassal_contract_set_obligation_level = {
                    type = religious_rights 
                    level = 1
                }
            #	vassal_contract_set_obligation_level = {
            #		type = special_contract_scutage 
            #		level = 1
            #	}
				vassal_contract_set_obligation_level = {
                    type = special_contract 
                    level = 1
                }
            }
        }
		
		ai_chance = {
			base = 0 # LotR: This should be tied to WotR mode.
			modifier = { # Game Rule
				has_game_rule = default_ai_behavior
				add = 30
			}
			modifier = { # Game Rule
				has_game_rule = weighted_ai_behavior
				add = 40
			}
			modifier = { # Game Rule
				has_game_rule = random_ai_behavior
				add = 50
			}
		}
	}
}

harad.0209 = { # Haruzan backs down!
	content_source = realms_dlc
	type = character_event
	title = harad.0209.t
	desc = harad.0209.desc
	theme = war
	left_portrait = {
		character = root
		animation = personality_bold
	}
	right_portrait = {
		character = title:k_haruzan.holder 
		animation = grief
	}
	
	option = { # Run back to Amrun!
		name = harad.0209.a
		add_prestige = 500 # A great victory
		add_prestige_level = 1
	}
}

harad.0210 = { # Chelkar accepts submission!
	content_source = realms_dlc
	type = character_event
	title = harad.0210.t
	desc = harad.0210.desc
	theme = war
	left_portrait = {
		character = root
		animation = personality_bold
	}
	right_portrait = {
		character = title:k_chelkar.holder 
		animation = shame
	}
	
	option = { # Our Hegemony Grows!
		name = harad.0210.a
		add_prestige = 500 # A great victory
		add_prestige_level = 1
	}
}

harad.0211 = { # Status of the War check
	hidden = yes
	theme = war
	left_portrait = {
		character = root
		animation = personality_bold
	}
	
	option = { #War is Ongoing
        trigger = {
            title:k_haruzan.holder = {
                any_character_war = {
                    using_cb = invasion_war
                    primary_defender = title:k_chelkar.holder
                    primary_attacker = title:k_haruzan.holder
                }
            }
        }
        trigger_event = {
            id = harad.0211
            months = 1
        }
    }
    
    option = { #War is Done
        trigger = {
            title:k_haruzan.holder = {
                NOT = {
                    any_character_war = {
                        using_cb = invasion_war
                        primary_defender = title:k_chelkar.holder
                        primary_attacker = title:k_haruzan.holder
                    }
                }
            }
        }
        trigger_event = {
            id = harad.0212
        }
    }
}

harad.0212 = { # Fate of the Invasion of Chelkar
	hidden = yes
	theme = war
	left_portrait = {
		character = root
		animation = personality_bold
	}
	
	option = {
		if = {
			limit = {
				title:k_chelkar.holder = { # If the capital duchy has fallen, we can assume the war was won
					NOT = {
						completely_controls = title:d_huk_saromis
					}
				}
			}
			trigger_event = harad.0213 # Chelkar Crushed
		}
		else_if = {
			limit = {
				title:k_chelkar.holder = { # If the capital duchy hasn't fallen, we can assume the war was lost
					completely_controls = title:d_huk_saromis
				}
			}
			trigger_event = harad.0214 # Chelkar Endures
		}
	}
}

harad.0213 = { # Chelkar is beaten by Haruzan
	content_source = realms_dlc
	type = character_event
	title = harad.0213.t
	desc = harad.0213.desc
	theme = war
	left_portrait = {
		character = root
		animation = personality_bold
	}
	
	option = { # Our Hegemony Grows!
		name = harad.0210.a
		add_prestige = 500 # A great victory
		add_prestige_level = 1
		destroy_title = title:k_chelkar
	}
}

harad.0214 = { # Haruzan is defeated by Chelkar
	content_source = realms_dlc
	type = character_event
	title = harad.0214.t
	desc = harad.0214.desc
	theme = war
	left_portrait = {
		character = title:k_chelkar.holder
		animation = personality_bold
	}
	right_portrait = {
		character = root
		animation = grief
	}
	
	option = { # A humiliating defeat
		name = harad.0214.a
		add_prestige = -500 # A humiliating defeat
		add_prestige_level = -1
		title:k_chelkar.holder = { # Celebrations in Chelkar
			trigger_event = {
				id = harad.0215
				months = 1
			}
		}
	}
}

harad.0215 = { # Victorious Chelkar
	content_source = realms_dlc
	type = character_event
	title = harad.0215.t
	desc = harad.0215.desc
	theme = war
	left_portrait = {
		character = title:k_chelkar.holder
		animation = personality_bold
	}
	right_portrait = {
		character = root
		animation = grief
	}
	
	option = { # Run back to Amrun!
		name = harad.0215.a
		add_prestige = 500 # A great victory
		add_prestige_level = 1
	}
}

harad.0216 = { # Control over Chelkar accomplished?
	hidden = yes
	theme = diplomacy_majesty_focus
	left_portrait = {
		character = root
		animation = personality_honorable
	}
	
	option = {
		if = { # If successful
			limit = {
				title:k_haruzan.holder = {
					completely_controls = title:d_huk_saromis
					completely_controls = title:d_azran 
				}
			}
			title:k_haruzan.holder = {
				trigger_event = {
					id = harad.0217
				}
			}
		}
		else_if = {
			limit = {
				NOT = {
					title:k_haruzan.holder = {
						completely_controls = title:d_huk_saromis 
						completely_controls = title:d_azran 
					}
				}
			}
			title:k_haruzan.holder = {
				trigger_event = {
					id = harad.216
					years = 1
				}
			}
		}
	}
}

harad.0217 = { # Chelkar Reclaimed
	content_source = realms_dlc
	type = character_event
	title = harad.0217.t
	desc = harad.0217.desc
	theme = diplomacy_majesty_focus
	left_portrait = {
		character = root
		animation = personality_honorable
	}
	
	option = {
		name = harad.0217.a
		add_prestige = 500
		if = { # If not already taken, unlock the route to take the Western Coast 
			limit = {
				NOT = {
					is_target_in_global_variable_list = { 
						name = haruzan_expansion_routes
						target = flag:harnen_submission_demanded
					}	
				}
			}
			add_to_global_variable_list = {
				name = haruzan_expansion_routes
				target = flag:haruzan_westward_expansion
			}
			custom_tooltip = harad.0204.b.tt # Westward expansion unlocked
			if = {
				limit = { # If not taken through the decision, add to the list (bypass decision)
					NOT = {
						is_target_in_global_variable_list = { 
							name = haruzan_expansion_routes
							target = flag:chelkar_submission_demanded
						}	
					}
				}
				add_to_global_variable_list = {
					name = haruzan_expansion_routes
					target = flag:haruzan_eastern_expansion
				}
				add_to_global_variable_list = {
					name = haruzan_expansion_routes
					target = flag:chelkar_submission_demanded
				}
			}
		}
		else_if = { # If expansion east and west have been accomplished...
			limit = {
				AND = {
					is_target_in_global_variable_list = { # East
						name = haruzan_expansion_routes
						target = flag:chelkar_submission_demanded
					}
					is_target_in_global_variable_list = { # West
						name = haruzan_expansion_routes
						target = flag:harnen_submission_demanded
					}
				}
			}
			title:k_haruzan.holder = {
				trigger_event = {
					id = harad.0226 # Haradwaith Rises Anew
					years = 1
				}
			}
		}
	}
}

harad.0218 = { # Betrayed - control over Pezarsan established?
	hidden = yes
	theme = diplomacy_majesty_focus
	left_portrait = {
		character = root
		animation = personality_honorable
	}
	
	option = {
		if = { # If successful
			limit = {
				OR = { # If the King of Haruzan is the King of Pezarsan as well
					title:k_haruzan.holder = {
						has_title = title:k_pezarsan 
					}
					AND = { # If Perzarsan is held by nobody and the requisite land is controlled by the King of Haruzan
						title:k_pezarsan.holder = { exists = no }
						title:k_haruzan.holder = { # Pezarsan starting area + Perfidious Cousin land!
							completely_controls = title:d_haruzan
							completely_controls = title:c_hannan 
							completely_controls = title:c_khumar 
							completely_controls = title:c_parzee 
							completely_controls = title:c_mahur 
							completely_controls = title:c_enmahadh
						}
					}
				}
			}
			title:k_haruzan.holder = {
				trigger_event = {
					id = harad.0219
				}
			}
		}
		else_if = {
			limit = {
				NOT = {
					title:k_haruzan.holder = {
						has_title = title:k_pezarsan 
					}
				}
			}
			title:k_haruzan.holder = {
				trigger_event = {
					id = harad.218
					years = 1
				}
			}
		}
	}
}

harad.0219 = { # Perfidious Cousin punished! Which way to expand now?
	content_source = realms_dlc
	type = character_event
	title = harad.0219.t
	desc = harad.0219.desc
	theme = war
	left_portrait = {
		character = root
		animation = rage
	}
	right_portrait = {
		character = scope:perfidious_cousin
		animation = shock
	}
	
	option = { # We must punish Chelkar! Unlocks decision to send ultimatum to Chelkar demanding submission
		name = harad.0204.a
		custom_tooltip = harad.0204.a.tt
		add_to_global_variable_list = {
			name = haruzan_expansion_routes
			target = flag:haruzan_eastern_expansion
		}
		ai_chance = {
			base = 0 # LotR: This should be tied to WotR mode.
			modifier = { # Game Rule
				has_game_rule = default_ai_behavior
				add = 30
			}
			modifier = { # Game Rule
				has_game_rule = weighted_ai_behavior
				add = 40
			}
			modifier = { # Game Rule
				has_game_rule = random_ai_behavior
				add = 33
			}
		}
	}
	option = { # Secure the West! Unlocks decisions to try to vassalize the Umbarean lords (prioritized by AI on account of the 'Race for Mirlond' effect)
		name = harad.0204.b
		custom_tooltip = harad.0204.b.tt
		add_to_global_variable_list = {
			name = haruzan_expansion_routes
			target = flag:haruzan_westward_expansion
		}
		ai_chance = {
			base = 0 # LotR: This should be tied to WotR mode.
			modifier = { # Game Rule
				has_game_rule = default_ai_behavior
				add = 70
			}
			modifier = { # Game Rule
				has_game_rule = weighted_ai_behavior
				add = 50
			}
			modifier = { # Game Rule
				has_game_rule = random_ai_behavior
				add = 33
			}
		}
	}
	option = { # Don't expand
		name = harad.0204.c
		custom_tooltip = harad.0204.c.tt # Will LOCK the decision/event expansion routes for Haruzan!
		ai_chance = {
			base = 0 # LotR: This should be tied to WotR mode.
			modifier = { # Game Rule
				has_game_rule = default_ai_behavior
				add = 0
			}
			modifier = { # Game Rule
				has_game_rule = weighted_ai_behavior
				add = 10
			}
			modifier = { # Game Rule
				has_game_rule = random_ai_behavior
				add = 33
			}
		}
	}
}

### Westward Haruzan Expansion - submission of the Umbarean lords ###

harad.0220 = { # Haruzan demands submission of the Harnen
	content_source = realms_dlc
	type = character_event
	immediate = { # For localization to work
        title:k_haruzan.holder = { save_scope_as = haruzan_king }
    }
	title = harad.0220.t
	desc = harad.0220.desc
	theme = war
	left_portrait = {
		character = root
		animation = stress
	}
	right_portrait = {
		character = title:k_haruzan.holder
		animation = personality_callous
	}

	option = { # Scions of Numenor, bow to savages? Never!
		name = harad.0220.a
		root = {
			save_scope_as = defiant_umbarean
		}
		scope:haruzan_king = {
			trigger_event = {
				id = harad.0221
				days = { 30 90 }
			}
		}
		add_character_flag = harnen_subjugation_defied
		ai_chance = {
			base = 0 # LotR: This should be tied to WotR mode.
			modifier = { # Game Rule
				has_game_rule = default_ai_behavior
				add = 90
			}
			modifier = { # Game Rule
				has_game_rule = weighted_ai_behavior
				add = 70
			}
			modifier = { # Game Rule
				has_game_rule = random_ai_behavior
				add = 50
			}
			modifier = { # Haruze Culture
				has_culture = culture:haruze
				add = -70
			}
		}
	}
	
	option = { # We have no choice
		name = harad.0220.b
		create_title_and_vassal_change = {
			type = swear_fealty
			save_scope_as = title_change
			add_claim_on_loss = no
		}
		change_liege = {
			liege = title:k_haruzan.holder
			change = scope:title_change
		}
		resolve_title_and_vassal_change = scope:title_change
		root = {
			save_scope_as = submissive_umbarean
		}
		scope:haruzan_king = {
			trigger_event = {
				id = harad.0222
				days = { 30 90 }
			}
		}
		
		ai_chance = {
			base = 0 # LotR: This should be tied to WotR mode.
			modifier = { # Game Rule
				has_game_rule = default_ai_behavior
				add = 10
			}
			modifier = { # Game Rule
				has_game_rule = weighted_ai_behavior
				add = 30
			}
			modifier = { # Game Rule
				has_game_rule = random_ai_behavior
				add = 50
			}
			modifier = { # Haruze Culture
				has_culture = culture:haruze
				add = 70
			}
		}
	}
}

harad.0221 = { # The Umbarean Lord refuses!"
	content_source = realms_dlc
	type = character_event
	title = harad.0221.t
	desc = harad.0221.desc
	theme = war
	left_portrait = {
		character = title:k_haruzan.holder
		animation = anger
	}
	right_portrait = {
		character = scope:defiant_umbarean
		animation = personality_callous
	}
	
	option = { # Then you shall be pushed back into the sea!
		name = harad.0221.a
		scope:defiant_umbarean = {
			every_held_title = {
				limit = {
					OR = {
						this = title:d_forethir 
						this = title:c_mirlond 
						this = title:c_harthalond 
						this = title:c_korb_ugarta 
						this = title:c_menost 
						this = title:d_ramlond 
						this = title:c_ramlond 
						this = title:c_kiba 
						this = title:c_celebiant
					}
				}
				root = {
					add_pressed_claim = prev
				}
			}
		}
		ai_chance = {
			base = 0 # LotR: This should be tied to WotR mode.
			modifier = { # Game Rule
				has_game_rule = default_ai_behavior
				add = 90
			}
			modifier = { # Game Rule
				has_game_rule = weighted_ai_behavior
				add = 70
			}
			modifier = { # Game Rule
				has_game_rule = random_ai_behavior
				add = 50
			}
		}
	}
	option = { # We cannot hope to defeat them by strength of arms
		name = harad.0221.b
		add_prestige = -500 # A humiliating defeat
		#scope:defiant_umbarean = {
		#	trigger_event = {
		#		id = harad.0223 # Haruzan backs down!
		#		days = 30
		#	}
		#}
		ai_chance = {
			base = 0 # LotR: This should be tied to WotR mode.
			modifier = { # Game Rule
				has_game_rule = default_ai_behavior
				add = 10
			}
			modifier = { # Game Rule
				has_game_rule = weighted_ai_behavior
				add = 30
			}
			modifier = { # Game Rule
				has_game_rule = random_ai_behavior
				add = 50
			}
		}
	}
}
	
harad.0222 = { # The Umbarean Lord Accepts Submission
	content_source = realms_dlc
	type = character_event
	title = harad.0222.t
	desc = harad.0222.desc
	theme = diplomacy_majesty_focus
	left_portrait = {
		character = root
		animation = personality_honorable
	}
	right_portrait = {
		character = scope:submissive_umbarean
		animation = personality_content
	}
	
	option = { # A King honors his word
		name = harad.0222.a
		scope:submissive_umbarean = {
            vassal_contract_set_obligation_level = {
                type = title_revocation_rights
                level = 1
            }
		}
		ai_chance = {
			base = 0 # LotR: This should be tied to WotR mode.
			modifier = { # Game Rule
				has_game_rule = default_ai_behavior
				add = 90
			}
			modifier = { # Game Rule
				has_game_rule = weighted_ai_behavior
				add = 70
			}
			modifier = { # Game Rule
				has_game_rule = random_ai_behavior
				add = 50
			}
		}
	}
}
	
harad.0224 = { # Control over the Harnen established?
	hidden = yes
	theme = diplomacy_majesty_focus
	left_portrait = {
		character = root
		animation = personality_honorable
	}
	
	option = {
		if = { # If successful
			limit = {
				title:k_haruzan.holder = {
					completely_controls = title:c_mirlond 
					completely_controls = title:c_harthalond 
					completely_controls = title:c_korb_ugarta
					completely_controls = title:d_ramlond 
					completely_controls = title:c_ramlond 
					completely_controls = title:c_kiba 
					completely_controls = title:c_celebiant 
				}
			}
			trigger_event = harad.0225
		}
		else_if = {
			limit = {
				NOT = {
					title:k_haruzan.holder = {
						completely_controls = title:c_mirlond 
						completely_controls = title:c_harthalond 
						completely_controls = title:c_korb_ugarta
						completely_controls = title:d_ramlond 
						completely_controls = title:c_ramlond 
						completely_controls = title:c_kiba 
						completely_controls = title:c_celebiant
					}
				}
			}
			title:k_haruzan.holder = {
				trigger_event = {
					id = harad.0224
					years = 1
				}
			}
		}
	}
}

harad.0225 = { # The Harnen is secured!
	content_source = realms_dlc
	type = character_event
	title = harad.0225.t
	desc = harad.0225.desc
	theme = diplomacy_majesty_focus
	left_portrait = {
		character = root
		animation = personality_honorable
	}
	
	option = {
		name = harad.0225.a
		add_prestige = 500
		if = { # If not already taken, unlock the route to take Chelkar 
			limit = {
				NOT = {
					is_target_in_global_variable_list = { 
						name = haruzan_expansion_routes
						target = flag:chelkar_submission_demanded
					}
				}
			}
			add_to_global_variable_list = {
					name = haruzan_expansion_routes
					target = flag:haruzan_eastern_expansion
			}
			custom_tooltip = harad.0204.a.tt
			if = {
				limit = { # If not taken through the decision, add to the list (bypass decision)
					NOT = {
						is_target_in_global_variable_list = { 
							name = haruzan_expansion_routes
							target = flag:harnen_submission_demanded
						}	
					}
				}
				add_to_global_variable_list = {
					name = haruzan_expansion_routes
					target = flag:haruzan_westward_expansion
				}
				add_to_global_variable_list = {
					name = haruzan_expansion_routes
					target = flag:harnen_submission_demanded
				}
			}
		}
		else_if = { # If expansion east and west have been accomplished...
			limit = {
				AND = {
					is_target_in_global_variable_list = { # East
						name = haruzan_expansion_routes
						target = flag:haruzan_eastern_expansion
					}
					is_target_in_global_variable_list = { # West
						name = haruzan_expansion_routes
						target = flag:haruzan_westward_expansion
					}
				}
			}
			title:k_haruzan.holder = {
				trigger_event = {
					id = harad.0226 # Haradwaith Rises Anew
					years = 1
				}
			}
		}
	}
}

harad.0226 = { # Haradwaith Rises Anew
	content_source = realms_dlc
	type = character_event
	title = harad.0226.t
	desc = harad.0226.desc
	theme = diplomacy_majesty_focus
	left_portrait = {
		character = root
		animation = personality_honorable
	}
	
	option = {
		name = harad.0226.a
		if = {
			limit = {
				title:k_haruzan.holder = {
					realm_size > 35
				}
				NOT = { exists = title:e_haradwaith.holder }
			}
			#Create the title and make it primary
			create_title_and_vassal_change = {
				type = created
				save_scope_as = title_change
				add_claim_on_loss = yes
			}
			title:e_haradwaith = {
				change_title_holder = {
					holder = root
					change = scope:title_change
				}
			}
			resolve_title_and_vassal_change = scope:title_change
			set_primary_title_to = title:e_haradwaith
		}
		root.dynasty = {
			add_dynasty_prestige_level = 1
		}
		hidden_effect = { #Juke note: a little goodie to buff AI haruzan
			title:k_haruzan.holder = {
				if = {
					limit = {
						is_ai = yes
					}
					spawn_army = {	 
						uses_supply = yes
						inheritable = yes
						name = imported_mumakil
						men_at_arms = {
							type = war_mumak
							stacks = 1
						}
						location = capital_province
					}
				}
			}
		}
	}
}



############################################
### Arysis/Maresh Prosperity Quest Chain ###
############################################

# Attract settlers to Maresh
harad.0300 = {
	content_source = realms_dlc
	type = character_event
	title = harad.0300.t
	desc = harad.0300.desc
	theme = realm
	override_background = { reference = harad_1 }
	
	left_portrait = {
		character = root
		animation = personality_honorable
	}

	lower_left_portrait = {
		character = scope:maresh_settler_1
	}
	lower_center_portrait = {
		character = scope:maresh_settler_2
	}
	lower_right_portrait = {
		character = scope:maresh_settler_3
	}

	immediate = {
		title:c_maresh = { #For loc.
			save_scope_as = maresh_county
		}
		save_scope_as = maresh_ruler
		custom_tooltip = decision_maresh_attract_settlers_effect_tooltip_1
		lotr_attract_foreign_settlers_to_maresh_effect = yes
		play_music_cue = mx_cue_sacredrite
		create_character = {
			location = root.location
			template = trans_haradric_merchant_template
			culture = culture:bellanarud
			faith = faith:faith_ladnoca
			save_scope_as = maresh_settler_1
		}
		if = {
			limit = { title:c_carnesra.culture = { is_wastelands_culture = no } }
			create_character = { # Sirayni settler
				location = root.location
				template = trans_haradric_merchant_template
				culture = title:c_carnesra.culture
				faith = title:c_carnesra.faith
				save_scope_as = maresh_settler_2
			}
		}
		if = {
			limit = { title:c_pelepelplu.culture = { is_wastelands_culture = no } }
			create_character = { # Khyan settler
				location = root.location
				template = trans_haradric_merchant_template
				culture = title:c_pelepelplu.culture
				faith = title:c_pelepelplu.faith
				save_scope_as = maresh_settler_3
			}
		}
	}
	
	option = { # ok
		name = harad.0300.a
		add_courtier = scope:maresh_settler_1
		add_courtier = scope:maresh_settler_2
		add_courtier = scope:maresh_settler_3
		hidden_effect = {
			if = {
				limit = {
					scope:maresh_settler_1 = {
						NOR = {
							has_sexuality = asexual
							has_sexuality = homosexual
						}
					}
				}
				random = {
					chance = 50
					RICE_generate_small_family = { CHARACTER = scope:maresh_settler_1 }
				}
			}
			if = {
				limit = {
					scope:maresh_settler_2 = {
						NOR = {
							has_sexuality = asexual
							has_sexuality = homosexual
						}
					}
				}
				random = {
					chance = 50
					RICE_generate_small_family = { CHARACTER = scope:maresh_settler_2 }
				}
			}
			if = {
				limit = {
					scope:maresh_settler_3 = {
						NOR = {
							has_sexuality = asexual
							has_sexuality = homosexual
						}
					}
				}
				random = {
					chance = 50
					RICE_generate_small_family = { CHARACTER = scope:maresh_settler_3 }
				}
			}
		}
	}

	after = {
		if = {
			limit = { # Minor News, but also if regional
				NOT = { has_game_rule = no_news }
			}
			every_player = { #Global News Announcement
				limit = {
					is_ai = no
					#NOT = { this = scope:maresh_ruler }
					OR = { # Minor news, but also if regional
						has_game_rule = all_news
						capital_county.title_province ?= { geographical_region = middleearth_harad }
					}
				}
				trigger_event = news_event.0055
			}
		}
	}
}

# Restore order to Maresh
harad.0301 = {
	content_source = realms_dlc
	type = character_event
	title = harad.0301.t
	desc = harad.0301.desc
	theme = diplomacy
	override_background = { reference = harad_2 }
	
	left_portrait = {
		character = root
		animation = war_attacker
	}
	
	immediate = {
		title:c_maresh = { #For loc.
			save_scope_as = maresh_county
		}
		save_scope_as = maresh_ruler
		play_music_cue = mx_cue_sacredrite
	}
	
	option = { # ok
		name = harad.0301.a
		add_piety = 150
		increase_maresh_prosperity_effect = yes
	}

	after = {
		if = {
			limit = { # Minor News, but also if regional
				NOT = { has_game_rule = no_news }
			}
			every_player = { #Global News Announcement
				limit = {
					is_ai = no
					#NOT = { this = scope:maresh_ruler }
					OR = { # Minor news, but also if regional
						has_game_rule = all_news
						capital_county.title_province ?= { geographical_region = middleearth_harad }
					}
				}
				trigger_event = news_event.0056
			}
		}
	}
}

# Arsasan Mints established
harad.0302 = {
	content_source = realms_dlc
	type = character_event
	title = harad.0302.t
	desc = harad.0302.desc
	theme = stewardship
	override_background = { reference = harad_2 }
	
	left_portrait = {
		character = root
		animation = personality_greedy
	}
	
	immediate = {
		title:c_maresh = { #For loc.
			save_scope_as = maresh_county
		}
		save_scope_as = maresh_ruler
	}
	
	option = { # ok
		name = harad.0302.a
		lotr_create_maresh_mint_effect = yes
	}

	after = {
		if = {
			limit = { # Minor News, but also if regional
				NOT = { has_game_rule = no_news }
			}
			every_player = { #Global News Announcement
				limit = {
					is_ai = no
					#NOT = { this = scope:maresh_ruler }
					OR = { # Minor news, but also if regional
						has_game_rule = all_news
						capital_county.title_province ?= { geographical_region = middleearth_harad }
					}
				}
				trigger_event = news_event.0057
			}
		}
	}
}

# Rysis hydraulics projects
harad.0303 = {
	content_source = realms_dlc
	type = character_event
	title = harad.0303.t
	desc = harad.0303.desc
	theme = stewardship
	override_background = { reference = ce1_legendary_oasis }
	
	right_portrait = {
		character = root
		animation = personality_compassionate
	}
	
	immediate = {
		title:c_maresh = { #For loc.
			save_scope_as = maresh_county
		}
		save_scope_as = maresh_ruler
		lotr_maresh_hydraulics_effect = yes
	}
	
	option = { # ok
		name = harad.0303.a
        trigger = {
            OR = {
                faith = { has_doctrine = tenet_sacred_waters }
                any_realm_county = {
				    faith = { has_doctrine = tenet_sacred_waters }
				    kingdom ?= title:k_arysis
                }
                any_vassal = {
                    capital_county.kingdom ?= title:k_arysis
                    faith = { has_doctrine = tenet_sacred_waters }
                    NOT = { has_trait = cynical }
                }
            }
        }
		duel = {
			skills = { diplomacy learning }
			value = high_skill_rating
			# Victory! You are fine
			50 = {
				compare_modifier = {
					value = scope:duel_value
					multiplier = 3.5
					min = -49
				}
			}
			# Defeat! Everyone is upset
			50 = {
				compare_modifier = {
					value = scope:duel_value
					multiplier = -3.5
					min = -49
				}
                if = {
                	limit = {
                        faith = { has_doctrine = tenet_sacred_waters }
                	}
                    add_piety = -300
                    add_piety_level = -1
                }
                if = {
                	limit = {
                        OR = {
                		    has_any_nickname = no
                            has_bad_nickname = yes
                        }
                	}
                    give_nickname = nick_mokrysis
                }
		        every_realm_county = {
		        	limit = {
		        		faith = { has_doctrine = tenet_sacred_waters }
		        		kingdom ?= title:k_arysis
		        	}
		    	    add_county_modifier = governance_1054_upset_peasants_modifier
		        }
		        every_vassal = {
		        	limit = {
		        		capital_county.kingdom ?= title:k_arysis
		        		kingdom ?= title:k_arysis
                        NOT = { has_trait = cynical }
		        	}
					add_opinion = {
						target = ROOT
						modifier = disappointed_opinion
						opinion = {
                            value = -10
                            if = {
                                limit = { has_trait = zealous }
                                add = -10
                            }
                        }
					}
		        }
			}
		}
	}
	option = { # ok
		name = harad.0303.b
        trigger = {
            NOR = {
                faith = { has_doctrine = tenet_sacred_waters }
                any_realm_county = {
				    faith = { has_doctrine = tenet_sacred_waters }
				    kingdom ?= title:k_arysis
                }
                any_vassal = {
                    capital_county.kingdom ?= title:k_arysis
                    faith = { has_doctrine = tenet_sacred_waters }
                }
            }
        }
    }

	after = {
		if = {
			limit = { # Minor News, but also if regional
				NOT = { has_game_rule = no_news }
			}
			every_player = { #Global News Announcement
				limit = {
					is_ai = no
					#NOT = { this = scope:maresh_ruler }
					OR = { # Minor news, but also if regional
						has_game_rule = all_news
						capital_county.title_province ?= { geographical_region = middleearth_harad }
					}
				}
				trigger_event = news_event.0058
			}
		}
	}
}

# Wall the Oasis
harad.0304 = {
	content_source = realms_dlc
	type = character_event
	title = harad.0304.t
	desc = harad.0304.desc
	theme = realm
	override_background = { reference = harad_1 }
	
	right_portrait = {
		character = root
		animation = war_defender
	}
	
	immediate = {
		title:c_maresh = { #For loc.
			save_scope_as = maresh_county
		}
		save_scope_as = maresh_ruler
	}
	
	option = { # ok
		name = harad.0304.a
		lotr_walled_oasis_effect = yes
	}

	after = {
		if = {
			limit = { # Minor News, but also if regional
				NOT = { has_game_rule = no_news }
			}
			every_player = { #Global News Announcement
				limit = {
					is_ai = no
					#NOT = { this = scope:maresh_ruler }
					OR = { # Minor news, but also if regional
						has_game_rule = all_news
						capital_county.title_province ?= { geographical_region = middleearth_harad }
					}
				}
				trigger_event = news_event.0059
			}
		}
	}
}

# Solidify the Kingdom of Arysis
harad.0305 = {
	content_source = realms_dlc
	type = character_event
	title = harad.0305.t
	desc = harad.0305.desc
	theme = stewardship
	left_portrait = {
		character = root
		animation = personality_greedy
	}
	override_background = { reference = harad_2 }
	immediate = {
		title:c_maresh = { #For loc.
			save_scope_as = maresh_county
		}
		save_scope_as = maresh_ruler
		arysor_trade_dominance_decision_effect = yes
	}
	option = { # Hee hee boyii (We're gonna be rich)
		name = harad.0305.a
	}

	after = {
		if = {
			limit = { # Major News
				NOT = { has_game_rule = no_news }
			}
			every_player = { #Global News Announcement
				limit = {
					is_ai = no
					#NOT = { this = scope:maresh_ruler }
				}
				trigger_event = news_event.0060
			}
		}
	}
}

####################################################
### Purchase Mumakil Decision - Meet with Trader ###
####################################################

# Meeting with the Mumakil Traders
harad.0500 = {
	content_source = realms_dlc
	type = character_event
	immediate = {
		create_character = {
			template = pool_repopulate_stewardship #merchant_template
			location = scope:capital_barony
			save_scope_as = mumakil_merchant
		}
		#hidden_effect = {
		#	scope:mumakil_merchant = {
		#		IF = {
		#			limit = {
		#				NOR = { culture = { has_cultural_pillar = heritage_mumakan } } # The greatest traders are from distant Mumakan
		#			}
		#			random_list = {
		#				50 = { add_trait = lifestyle_gardener }
		#				50 = { add_trait = lifestyle_herbalist }
		#			}
		#		}
		#	}
		#}
	}
	title = harad.0500.t
	desc = harad.0500.desc
	theme = war
	override_background = { reference = harad_1 }
	left_portrait = {
		character = root
		animation = personality_honorable
	}
	right_portrait = { # Spawned Mumakil trader
		character = scope:mumakil_merchant
		animation = personality_greedy
	}
	
	option = { # I will pay the upfront cost
		name = {
			text = {
				first_valid = {
					triggered_desc = {
						trigger = {
							palace_of_haruzan_cheaper_purchase_mumakil_trigger = yes
						}
						desc = harad.0500.a.amrun
					}
					desc = harad.0500.a
				}
			}
		}
		if = {
			limit = {
				palace_of_haruzan_cheaper_purchase_mumakil_trigger = yes
			}
			custom_tooltip = harad.0500.discount.tt
		}
		remove_short_term_gold = mumakil_purchase_cost
		spawn_army = {		 
			uses_supply = yes
			inheritable = yes
			name = imported_mumakil
			men_at_arms = {
				type = war_mumak
				stacks = 1
			}
			location = capital_province
		}
	}
	
	option = { # I will haggle with the merchant
		name = {
			text = {
				first_valid = {
					triggered_desc = {
						trigger = {
							palace_of_haruzan_cheaper_purchase_mumakil_trigger = yes
						}
						desc = harad.0500.b.amrun
					}
					desc = harad.0500.b
				}
			}
		}
		if = {
			limit = {
				palace_of_haruzan_cheaper_purchase_mumakil_trigger = yes
			}
			custom_tooltip = harad.0500.discount.tt
		}
		duel = {
			skill = stewardship
			target = scope:mumakil_merchant
			# You successfully barter down the price of the Mumakil
			50 = {
				compare_modifier = {
					value = scope:duel_value
					multiplier = 3.5
					min = -49
				}
				desc = harad.0500.b.tt_success
				send_interface_toast = {
					title = harad.0500.b.tt_success
					left_icon = root
					add_prestige = minor_prestige_gain
					stress_impact = {
						greedy = medium_stress_impact_loss
					}
				}
				remove_short_term_gold = decreased_mumakil_purchase_cost
				spawn_army = {		 
					uses_supply = yes
					inheritable = yes
					name = imported_mumakil
					men_at_arms = {
						type = war_mumak
						stacks = 1
					}
					location = capital_province
				}
			}
			# You completely fail to barter with the merchant and end up paying a much higher price
			50 = {
				compare_modifier = {
					value = scope:duel_value
					multiplier = -3.5
					min = -49
				}
				desc = harad.0500.b.tt_failure
				send_interface_toast = {	
					title = harad.0500.b.tt_failure
					left_icon = root
					add_prestige = minor_prestige_loss
					add_stress = minor_stress_impact_gain
					stress_impact = {
						greedy = medium_stress_impact_gain
					}
				}
				remove_short_term_gold = increased_mumakil_purchase_cost
				spawn_army = {		 
					uses_supply = yes
					inheritable = yes
					name = imported_mumakil
					men_at_arms = {
						type = war_mumak
						stacks = 1
					}
					location = capital_province
				}
			}
		}
	}
	
	option = { # I've changed my mind
		name = harad.0500.c
		remove_decision_cooldown = decision_purchase_mumakil
	}
}


############################
### Mud Masonry Decision ###
############################

# Mud Mason decision event
harad.0550 = {
	content_source = realms_dlc
	type = character_event
	title = harad.0550.t
	desc = {
		desc = harad.0550.desc
		first_valid = {
			triggered_desc = {
				trigger = {
					culture = { has_cultural_tradition = tradition_mud_masons }
				}
				desc = harad.0550.desc.culture
			}
		}
		first_valid = {
			triggered_desc = {
				trigger = {
					var:mud_masonry_work_type = flag:castle
				}
				desc = harad.0550.desc.castle
			}
			triggered_desc = {
				trigger = {
					var:mud_masonry_work_type = flag:city
				}
				desc = harad.0550.desc.city
			}
			triggered_desc = {
				trigger = {
					var:mud_masonry_work_type = flag:church
				}
				desc = harad.0550.desc.church
			}
			triggered_desc = {
				trigger = {
					var:mud_masonry_work_type = flag:settlement
				}
				desc = harad.0550.desc.settlement
			}
			triggered_desc = {
				trigger = {
					var:mud_masonry_work_type = flag:general
				}
				desc = harad.0550.desc.general
			}
		}
	}
	theme = stewardship_wealth_focus
	
	left_portrait = root

	option = { # OK
		name = harad.0550.a
		if = {
			limit = {
				var:mud_masonry_work_type = flag:castle
			}
			add_prestige = 100
			if = {
				limit = {
					has_title = title:c_selena
				}
				add_character_modifier = {
					modifier = lotr_mud_masons_castle_modifier_jenne
					years = 10
				}
			}
			else = {
				add_character_modifier = {
					modifier = lotr_mud_masons_castle_modifier
					years = 10
				}
			}
		}
		else_if = {
			limit = {
				var:mud_masonry_work_type = flag:city
			}
			add_prestige = 50
			add_piety = 50
			if = {
				limit = {
					has_title = title:c_selena
				}
				add_character_modifier = {
					modifier = lotr_mud_masons_city_modifier_jenne
					years = 10
				}
			}
			else = {
				add_character_modifier = {
					modifier = lotr_mud_masons_city_modifier
					years = 10
				}
			}
		}
		else_if = {
			limit = {
				var:mud_masonry_work_type = flag:church
			}
			add_piety = 100
			if = {
				limit = {
					has_title = title:c_selena
				}
				add_character_modifier = {
					modifier = lotr_mud_masons_church_modifier_jenne
					years = 10
				}
			}
			else = {
				add_character_modifier = {
					modifier = lotr_mud_masons_church_modifier
					years = 10
				}
			}
		}
		else_if = {
			limit = {
				var:mud_masonry_work_type = flag:settlement
			}
			add_prestige = 100
			if = {
				limit = {
					has_title = title:c_selena
				}
				add_character_modifier = {
					modifier = lotr_mud_masons_settlement_modifier_jenne
					years = 10
				}
			}
			else = {
				add_character_modifier = {
					modifier = lotr_mud_masons_settlement_modifier
					years = 10
				}
			}
		}
		# General is the failsafe
		else = {
			add_prestige = 50
			add_piety = 50
			if = {
				limit = {
					has_title = title:c_selena
				}
				add_character_modifier = {
					modifier = lotr_mud_masons_general_modifier_jenne
					years = 10
				}
			}
			else = {
				add_character_modifier = {
					modifier = lotr_mud_masons_general_modifier
					years = 10
				}
			}
		}
	}

	after = {		
		if = {
			limit = { has_variable = mud_masonry_work_type }
			remove_variable = mud_masonry_work_type
		}
	}

}

##########################################
### Encounter Trans-Haradric merchants ###
##########################################

# Encounter Merchant during travel
scripted_trigger is_a_valid_merchant_in_location_trigger = {
	is_available_ai_adult = yes
	NOT = { this = ROOT }
	NOT = { liege = ROOT }
	save_temporary_scope_as = companion_check
	NOT = {
		ROOT.current_travel_plan ?= {
			any_entourage_character = {
				this = scope:companion_check
			}
		}
	}
	NOR = {
		has_relation_rival = root
		has_relation_nemesis = root 
	}
	OR = {
		has_trait = lifestyle_trans_haradric_merchant
		is_landless_adventurer = yes
		AND = {
			is_ruler = no
			has_trait = education_stewardship
		}
	}
	is_wastelands = no
}
harad.0600 = {
	content_source = realms_dlc
	type = character_event
	title = harad.0600.t
	desc = harad.0600.desc
	theme = travel
	
	left_portrait = root
	center_portrait = {
		character = scope:merchant
		animation = steward
	}
	right_portrait = scope:local_trader

	trigger = {
		current_travel_plan = {
			any_entourage_character = {
				count >= 1 
				NOT = { this = root }
				has_trait = lifestyle_trans_haradric_merchant
			}
		}
	}

	immediate = {
		current_travel_plan = {
			random_entourage_character = {
				limit = {
					NOT = { this = root }
					has_trait = lifestyle_trans_haradric_merchant
				}
				save_scope_as = merchant
			}
		}

		# Create a local trader or businessperson
		random_list = {
			200 = { # A preexisting local character
				trigger = {
					location = {
						any_character_in_location = {
							is_a_valid_merchant_in_location_trigger = yes
						}
					}
				}
				location = {
					random_character_in_location = {
						limit = { is_a_valid_merchant_in_location_trigger = yes }
						weight = {
							base = 1
							modifier = {
								has_trait = lifestyle_trans_haradric_merchant
								add = 10
							}
							modifier = {
								is_landless_adventurer = yes
								add = 10
							}
						}
						save_scope_as = local_trader
					}
				}
			}
			200 = { # A fellow Trans-Haradric Merchant
				trigger = {
					any_county_in_region = {
						region = middleearth_harad
						OR = {
							culture = { has_cultural_parameter = heritage_group_apysaic }
							culture = { has_cultural_parameter = heritage_group_haladin }
							culture = { has_cultural_parameter = heritage_group_numenorean }
							culture = { has_cultural_pillar = heritage_south_khailuza }
						}
					}
				}
				every_county_in_region = {
					region = middleearth_harad
					limit = {
						OR = {
							culture = { has_cultural_parameter = heritage_group_apysaic }
							culture = { has_cultural_parameter = heritage_group_haladin }
							culture = { has_cultural_parameter = heritage_group_numenorean }
							culture = { has_cultural_pillar = heritage_south_khailuza }
						}
					}
					add_to_list = merchant_counties
				}
				random_in_list = {
					list = merchant_counties
					save_scope_as = home_county
					weight = {
						base = 1
						modifier = {
							add = 1
							NOT = { title_province = { has_holding_type = tribal_holding } }
						}
						modifier = {
							add = 1
							title_province = { has_special_building = yes }
						}
						modifier = {
							add = 1
							culture = { has_cultural_tradition = tradition_trans_haradric_traders }
						}
						modifier = { # Cultures we want to see more commonly as dune sea merchants
							add = 0.5
							OR = {
								culture = culture:harondorim
								culture = { has_cultural_pillar = heritage_northern_apysaic }
								culture = { has_cultural_pillar = heritage_middle_apysaic }
								culture = { has_cultural_pillar = heritage_southern_apysaic }
								culture = { has_cultural_pillar = heritage_south_khailuza }
								culture = { has_cultural_pillar = heritage_bellakari }
								culture = { has_cultural_pillar = heritage_new_sirayni }
								culture = { has_cultural_pillar = heritage_old_sirayni }
							}
						}
						modifier = { # Cultures we want to boost even more cause theyre cool to encounter
							add = 1
							OR = {
								culture = culture:harondorim
								culture = culture:bellanarud
								culture = culture:poan
								culture = culture:kindilar
								culture = culture:arysisani
							}
						}
					}
				}
				create_character = {
					location = root.location
					template = trans_haradric_merchant_template
					save_scope_as = local_trader
					culture = scope:home_county.culture
					faith = scope:home_county.faith
				}
			}
			50 = { # Local Merchant
				create_character = {
					location = root.location
					template = merchant_template
					culture = location.culture
					faith = location.faith
					save_scope_as = local_trader
				}
			}
			50 = { # Village Leader
				create_character = {
					location = root.location
					template = generic_peasant_character
					gender_female_chance = root_faith_dominant_gender_adjusted_female_chance
					culture = location.culture
					faith = location.faith
					save_scope_as = local_trader
				}
			}
			
		}
	}

	option = { # OK
		name = harad.0600.a
		add_gold = { 10 50 }
		stress_impact = {
			greedy = minor_stress_impact_gain
		}

		if = {
			limit = {
				OR = {
					var:trans_haradric_merchant_success_count >= 10
					dynasty ?= {
						has_dynasty_perk = lotr_haradrim_legacy_5
					}
				}
				NOT = { has_trait = lifestyle_trans_haradric_merchant }
			}
			random = {
				chance = trans_haradric_merchant_trait_chance
				add_trait = lifestyle_trans_haradric_merchant
				custom_tooltip = trans_haradric_merchant_trait_gain_tooltip
			}
		}
		if = {
			limit = {
				has_trait = lifestyle_trans_haradric_merchant
			}
			add_trait_xp = {
				trait = lifestyle_trans_haradric_merchant
				value = { 1 5 } 
			}
		}

		hidden_effect = {
			if = {
				limit = {
					NOT = { exists = var:trans_haradric_merchant_success_count }
				}
				set_variable = {
					name = trans_haradric_merchant_success_count
					value = 1
				}
			}
			else = {
				change_variable = {
					name = trans_haradric_merchant_success_count
					add = 1
				}		
			}
		}

		if = {
			limit = {
				NOR = {
					var:trans_haradric_merchant_success_count >= 10
					dynasty ?= {
						has_dynasty_perk = lotr_haradrim_legacy_5
					}
				}
			}
			custom_tooltip = trans_haradric_number_of_successes_tooltip
		}
	}

	option = { # OK
		name = harad.0600.b
		if = {
			limit = { has_character_modifier = harad_merchant_tongue }
			custom_description_no_bullet = { # Haggling is easier with flavor modifier
				text = harad_merchant_tongue_easier_haggling
			}
		}
		duel = {
			skills = { diplomacy stewardship }
			value = decent_skill_rating
			# Success.
			30 = {
				compare_modifier = {
					value = scope:duel_value
					multiplier = 2.5
					min = -49
				}
				custom_tooltip = harad.0600.b.success
				show_as_tooltip = {
					if = {
						limit = {
							OR = {
								var:trans_haradric_merchant_success_count >= 10
								dynasty ?= {
									has_dynasty_perk = lotr_haradrim_legacy_5
								}
							}
							NOT = { has_trait = lifestyle_trans_haradric_merchant }
						}
						random = {
							chance = trans_haradric_merchant_trait_chance
							add_trait = lifestyle_trans_haradric_merchant
							custom_tooltip = trans_haradric_merchant_trait_gain_tooltip
						}
					}
					if = {
						limit = {
							has_trait = lifestyle_trans_haradric_merchant
						}
						add_trait_xp = {
							trait = lifestyle_trans_haradric_merchant
							value = { 1 5 } 
						}
					}
				}
				hidden_effect = {
					send_interface_toast = {
						type = event_toast_effect_good
						title = harad.0600.b.success
						left_icon = root
						add_gold = { 50 150 }
						if = {
							limit = {
								OR = {
									var:trans_haradric_merchant_success_count >= 10
									dynasty ?= {
										has_dynasty_perk = lotr_haradrim_legacy_5
									}
								}
								NOT = { has_trait = lifestyle_trans_haradric_merchant }
							}
							random = {
								chance = trans_haradric_merchant_trait_chance
								add_trait = lifestyle_trans_haradric_merchant
								custom_tooltip = trans_haradric_merchant_trait_gain_tooltip
							}
						}
						if = {
							limit = {
								has_trait = lifestyle_trans_haradric_merchant
							}
							add_trait_xp = {
								trait = lifestyle_trans_haradric_merchant
								value = { 1 5 } 
							}
						}
					}	
					if = {
						limit = {
							NOT = { exists = var:trans_haradric_merchant_success_count }
						}
						set_variable = {
							name = trans_haradric_merchant_success_count
							value = 1
						}
					}
					else = {
						change_variable = {
							name = trans_haradric_merchant_success_count
							add = 1
						}		
					}					
				}
				# Slightly more effective with flavor modifier
				modifier = {
					add = 15
					has_character_modifier = harad_merchant_tongue
				}
			}
			# Failure.
			70 = {
				compare_modifier = {
					value = scope:duel_value
					multiplier = -2.5
					min = -49
				}
				custom_tooltip = harad.0600.b.failure
				hidden_effect = {
					send_interface_toast = {
						type = event_toast_effect_bad
						title = harad.0600.b.failure
						left_icon = root
						add_prestige = -100
					}					
				}
				# Slightly more effective with flavor modifier
				modifier = {
					add = -15
					has_character_modifier = harad_merchant_tongue
				}
			}
		}
		if = {
			limit = {
				NOR = {
					trigger_if = {
						limit = { has_variable = trans_haradric_merchant_success_count }
						var:trans_haradric_merchant_success_count >= 10
					}
					dynasty ?= {
						has_dynasty_perk = lotr_haradrim_legacy_5
					}
				}
			}
			custom_tooltip = trans_haradric_number_of_successes_tooltip
		}		
	}

}

# Trans-Haradric Near Haradric Merchant offers services or at least a good deal (can spawn anywhere in harad)
harad.0601 = {
	content_source = realms_dlc
	type = character_event
	title = harad.0601.t
	desc = {
		first_valid = {
			triggered_desc = {
				trigger = {
					has_character_modifier = lotr_currently_trans_haradric_networking
				}
				desc = harad.0601.desc.intro_networker
			}		
			triggered_desc = {
				trigger = {
					NOT = { has_character_modifier = lotr_currently_trans_haradric_networking }
				}
				desc = harad.0601.desc.intro_normal
			}			
		}
		desc = harad.0601.desc
	}
	
	theme = stewardship_wealth_focus
	override_background = { reference = market }
	
	
	left_portrait = {
		character = scope:trans_haradric_merchant_spawn
		animation = steward
	}
	
	trigger = {
		capital_province = {
			geographical_region = middleearth_harad
		}
		NOT = { has_character_flag = trans_haradric_guaranteed_spawn }
	}
	
	weight_multiplier = {
		base = 1
		modifier = {
			add = 0.5
			capital_province = {
				geographical_region = middleearth_harad_near
			}			
		}
		modifier = {
			add = -0.4
			has_character_flag = trans_haradric_already_spawned_merchant
		}
		modifier = {
			add = -0.1
			AND = {
				is_ruler = yes
				government_has_flag = government_is_tribal
			}
		}
		modifier = {
			add = 1.1
			dynasty ?= {
				has_dynasty_perk = lotr_haradrim_legacy_1
			}
		}
		modifier = {
			add = 1.1
			any_held_county = {
				any_county_province = {
					has_building_or_higher = wonder_souk_mazharath
				}
			}
		}
		modifier = {
			add = 1.1
			culture = { has_cultural_tradition = tradition_trans_haradric_traders }
		}
		modifier = {
			add = 0.75
			has_character_flag = trans_haradric_networking_boost_tiny
		}
		modifier = {
			add = 1
			has_character_flag = trans_haradric_networking_boost_small
		}
		modifier = {
			add = 1.33
			has_character_flag = trans_haradric_networking_boost_medium
		}
		modifier = {
			add = 1.66
			has_character_flag = trans_haradric_networking_boost_large
		}
		modifier = {
			add = 2
			has_character_flag = trans_haradric_networking_boost_huge
		}
	}

	immediate = {
		capital_province = { save_scope_as = capital_province } #For loc.
		add_character_flag = trans_haradric_already_spawned_merchant

		if = {
			limit = {
				any_county_in_region = {
					region = middleearth_harad_near
					OR = {
						culture = { has_cultural_parameter = heritage_group_apysaic }
						culture = { has_cultural_parameter = heritage_group_haladin }
						culture = { has_cultural_parameter = heritage_group_numenorean }
					}
				}
			}
			every_county_in_region = {
				region = middleearth_harad_near
				limit = {
					OR = {
						culture = { has_cultural_parameter = heritage_group_apysaic }
						culture = { has_cultural_parameter = heritage_group_haladin }
						culture = { has_cultural_parameter = heritage_group_numenorean }
					}
				}
				add_to_list = merchant_counties
			}
			random_in_list = {
				list = merchant_counties
				save_scope_as = home_county
				weight = {
					base = 1
					modifier = {
						add = 1
						NOT = { title_province = { has_holding_type = tribal_holding } }
					}
					modifier = {
						add = 1
						title_province = { has_special_building = yes }
					}
					modifier = {
						add = 1
						culture = { has_cultural_tradition = tradition_trans_haradric_traders }
					}
					modifier = { # Cultures we want to see more commonly as dune sea merchants
						add = 0.3
						OR = {
							culture = { has_cultural_pillar = heritage_northern_apysaic }
							culture = culture:harondorim
						}
					}
				}
			}
			create_character = {
				location = root.location
				template = trans_haradric_merchant_template
				save_scope_as = trans_haradric_merchant_spawn
				culture = scope:home_county.culture
				faith = scope:home_county.faith
			}
		}

		# Backup in case no such county can be found
		else = {
			random_list = {
				20 = {
					create_character = {
						location = root.location
						template = trans_haradric_merchant_template
						save_scope_as = trans_haradric_merchant_spawn
						culture = culture:haruze
						faith = faith:faith_chelkar
					}
				}
				10 = {
					trigger = { game_start_date > 5844 }
					create_character = {
						location = root.location
						template = trans_haradric_merchant_template
						save_scope_as = trans_haradric_merchant_spawn
						culture = culture:chelkari
						faith = faith:faith_chelkar
					}
				}
				10 = {
					trigger = { game_start_date > 5200 }
					create_character = {
						location = root.location
						template = trans_haradric_merchant_template
						save_scope_as = trans_haradric_merchant_spawn
						culture = culture:pezarsani
						faith = faith:faith_chelkar
					}				
				}
				20 = {
					trigger = { game_start_date < 5620 }
					create_character = {
						location = root.location
						template = trans_haradric_merchant_template
						save_scope_as = trans_haradric_merchant_spawn
						culture = culture:karrani
						faith = faith:faith_legends_of_harwan
					}				
				}
				10 = {
					create_character = {
						location = root.location
						template = trans_haradric_merchant_template
						save_scope_as = trans_haradric_merchant_spawn
						culture = culture:lurmsakari
						faith = faith:faith_lurmsakun
					}				
				}
				30 = {
					trigger = { game_start_date > 5083 }
					create_character = {
						location = root.location
						template = trans_haradric_merchant_template
						save_scope_as = trans_haradric_merchant_spawn
						culture = culture:harondorim
						faith = faith:faith_edain
					}				
				}
				20 = {
					trigger = { game_start_date > 5620 }
					create_character = {
						location = root.location
						template = trans_haradric_merchant_template
						save_scope_as = trans_haradric_merchant_spawn
						culture = culture:jelut
						faith = faith:faith_jelut
					}				
				}
			}
		}
	}

	# Okay
	option = {
		name = harad.0601.a
		add_prestige = -150
		pay_short_term_gold = {
			target = scope:trans_haradric_merchant_spawn
			gold = medium_gold_value
		}
		add_courtier = scope:trans_haradric_merchant_spawn
		add_character_modifier = {
			modifier = trans_haradric_trade_deal_nearharad_merchants
			years = 10
		}
		hidden_effect = {
			if = {
				limit = {
					scope:trans_haradric_merchant_spawn = {
						NOR = {
							has_sexuality = asexual
							has_sexuality = homosexual
						}
					}
				}
				random = {
					chance = 50
					RICE_generate_small_family = { CHARACTER = scope:trans_haradric_merchant_spawn }
				}
			}
		}
		ai_chance = {
			base = 10
			modifier = {
				add = 10
				has_trait = greedy
			}
			modifier = {
				add = 10
				has_trait = ambitious
			}
		}
	}

	# Don't stay, but create a trade deal
	option = {
		name = harad.0601.b
		pay_short_term_gold = {
			target = scope:trans_haradric_merchant_spawn
			gold = medium_gold_value
		}
		add_character_modifier = {
			modifier = trans_haradric_trade_deal_nearharad_merchants
			years = 10
		}
		hidden_effect = {
			random = {
				chance = 75
				scope:trans_haradric_merchant_spawn = {
					death = {
						death_reason = death_disappearance
					}
				}
			}
		}
		ai_chance = {
			base = 40
			modifier = {
				add = 10
				has_trait = greedy
			}
			modifier = {
				add = 10
				has_trait = ambitious
			}
		}
	}

	# Not interested
	option = {
		name = harad.0601.c
		hidden_effect = {
			random = {
				chance = 75
				scope:trans_haradric_merchant_spawn = {
					death = {
						death_reason = death_disappearance
					}
				}
			}
		}
		ai_chance = {
			base = 25
		}
	}
	
	after = {
		if = {
			limit = {
				has_character_modifier = lotr_currently_trans_haradric_networking
			}
			clean_up_trans_haradric_merchant_effect = yes
		}
	}
}

# Trans-Haradric Far Haradric Merchant offers services or at least a good deal (can spawn anywhere in harad)
harad.0602 = {
	content_source = realms_dlc
	type = character_event
	title = harad.0602.t
	desc = {
		first_valid = {
			triggered_desc = {
				trigger = {
					has_character_modifier = lotr_currently_trans_haradric_networking
				}
				desc = harad.0601.desc.intro_networker
			}		
			triggered_desc = {
				trigger = {
					NOT = { has_character_modifier = lotr_currently_trans_haradric_networking }
				}
				desc = harad.0601.desc.intro_normal
			}			
		}
		desc = harad.0602.desc
	}
	
	theme = stewardship_wealth_focus
	override_background = { reference = market }
	
	
	left_portrait = {
		character = scope:trans_haradric_merchant_spawn
		animation = steward
	}
	
	trigger = {
		capital_province = {
			geographical_region = middleearth_harad
		}
		NOT = { has_character_flag = trans_haradric_guaranteed_spawn }
	}
	
	weight_multiplier = {
		base = 1
		modifier = {
			add = 0.5
			capital_province = {
				geographical_region = middleearth_harad_far
			}			
		}
		modifier = {
			add = -0.4
			has_character_flag = trans_haradric_already_spawned_merchant
		}
		modifier = {
			add = -0.1
			AND = {
				is_ruler = yes
				government_has_flag = government_is_tribal
			}
		}
		modifier = {
			add = 1.1
			dynasty ?= {
				has_dynasty_perk = lotr_haradrim_legacy_1
			}
		}
		modifier = {
			add = 1.1
			any_held_county = {
				any_county_province = {
					has_building_or_higher = wonder_souk_mazharath
				}
			}
		}
		modifier = {
			add = 1.1
			culture = { has_cultural_tradition = tradition_trans_haradric_traders }
		}
		modifier = {
			add = 0.75
			has_character_flag = trans_haradric_networking_boost_tiny
		}
		modifier = {
			add = 1
			has_character_flag = trans_haradric_networking_boost_small
		}
		modifier = {
			add = 1.33
			has_character_flag = trans_haradric_networking_boost_medium
		}
		modifier = {
			add = 1.66
			has_character_flag = trans_haradric_networking_boost_large
		}
		modifier = {
			add = 2
			has_character_flag = trans_haradric_networking_boost_huge
		}
	}

	immediate = {
		capital_province = { save_scope_as = capital_province } #For loc.
		add_character_flag = trans_haradric_already_spawned_merchant


		if = {
			limit = {
				OR = {
					any_county_in_region = {
						region = middleearth_harad_far
						OR = {
							culture = { has_cultural_parameter = heritage_group_apysaic }
							culture = { has_cultural_parameter = heritage_group_numenorean }
						}
					}
					any_county_in_region = {
						region = middleearth_harad_dunesea_qarsaaukar
						OR = {
							culture = { has_cultural_parameter = heritage_group_apysaic }
							culture = { has_cultural_parameter = heritage_group_numenorean }
						}
					}
				}
			}
			every_county_in_region = {
				region = middleearth_harad_far
				limit = {
					OR = {
						culture = { has_cultural_parameter = heritage_group_apysaic }
						culture = { has_cultural_parameter = heritage_group_numenorean }
					}
				}
				add_to_list = merchant_counties
			}
			every_county_in_region = {
				region = middleearth_harad_dunesea_qarsaaukar
				limit = {
					OR = {
						culture = { has_cultural_parameter = heritage_group_apysaic }
						culture = { has_cultural_parameter = heritage_group_numenorean }
					}
				}
				add_to_list = merchant_counties
			}
			every_county_in_region = {
				region = middleearth_harad_dunesea_mirroroffire
				limit = {
					culture = { has_cultural_parameter = heritage_group_apysaic }
					duchy ?= title:d_koanoz
				}
				add_to_list = merchant_counties
			}
			every_county_in_region = {
				region = middleearth_harad_dunesea_mirroroffire
				limit = {
					culture = { has_cultural_parameter = heritage_group_apysaic }
					duchy ?= title:d_darsalan
				}
				add_to_list = merchant_counties
			}
			random_in_list = {
				list = merchant_counties
				save_scope_as = home_county
				weight = {
					base = 1
					modifier = {
						add = 1
						NOT = { title_province = { has_holding_type = tribal_holding } }
					}
					modifier = {
						add = 1
						title_province = { has_special_building = yes }
					}
					modifier = {
						add = 1
						culture = { has_cultural_tradition = tradition_trans_haradric_traders }
					}
					modifier = { # Cultures we want to see more commonly as dune sea merchants
						add = 0.3
						OR = {
							culture = culture:bellanarud
							culture = { has_cultural_pillar = heritage_southern_apysaic }
						}
					}
					modifier = { # Account for small nomadic culture
						add = 1
						culture = culture:kindilar
					}
					modifier = {
						add = 2
						OR = {
							this = title:c_mazharath
							this = title:c_hidar
						}
					}
				}
			}
			create_character = {
				location = root.location
				template = trans_haradric_merchant_template
				save_scope_as = trans_haradric_merchant_spawn
				culture = scope:home_county.culture
				faith = scope:home_county.faith
			}
		}

		# Backup in case no such county can be found
		else = {
			random_list = {
				30 = {
					create_character = {
						location = root.location
						template = trans_haradric_merchant_template
						save_scope_as = trans_haradric_merchant_spawn
						culture = culture:bozishnarud
						faith = faith:faith_ray
					}
				}
				10 = {
					create_character = {
						location = root.location
						template = trans_haradric_merchant_template
						save_scope_as = trans_haradric_merchant_spawn
						culture = culture:narudbriyig
						faith = faith:faith_ray
					}				
				}
				30 = {
					create_character = {
						location = root.location
						template = trans_haradric_merchant_template
						save_scope_as = trans_haradric_merchant_spawn
						culture = culture:bellanarud
						faith = faith:faith_ladnoca
					}				
				}
				10 = {
					create_character = {
						location = root.location
						template = trans_haradric_merchant_template
						save_scope_as = trans_haradric_merchant_spawn
						culture = culture:bellakaze
						faith = faith:faith_infinite_wisdom
					}				
				}
				10 = {
					create_character = {
						location = root.location
						template = trans_haradric_merchant_template
						save_scope_as = trans_haradric_merchant_spawn
						culture = culture:arani
						faith = faith:faith_arani
					}				
				}
				5 = {
					create_character = {
						location = root.location
						template = trans_haradric_merchant_template
						save_scope_as = trans_haradric_merchant_spawn
						culture = culture:old_pust
						faith = faith:faith_arani
					}
				}
				10 = {
					trigger = { game_start_date > 4200 }
					create_character = {
						location = root.location
						template = trans_haradric_merchant_template
						save_scope_as = trans_haradric_merchant_spawn
						culture = culture:tedjin
						faith = faith:faith_easterling_war
					}
				}
				15 = {
					trigger = { game_start_date > 4983 }
					create_character = {
						location = root.location
						template = trans_haradric_merchant_template
						save_scope_as = trans_haradric_merchant_spawn
						culture = culture:soriyan
						faith = faith:faith_path_of_wisdom
					}				
				}
				10 = {
					trigger = { game_start_date > 6133 }
					create_character = {
						location = root.location
						template = trans_haradric_merchant_template
						save_scope_as = trans_haradric_merchant_spawn
						culture = culture:felayan
						faith = faith:faith_path_of_wisdom
					}				
				}
			}
		}
	}

	# Okay
	option = {
		name = harad.0601.a
		add_prestige = -150
		pay_short_term_gold = {
			target = scope:trans_haradric_merchant_spawn
			gold = medium_gold_value
		}
		add_courtier = scope:trans_haradric_merchant_spawn
		add_character_modifier = {
			modifier = trans_haradric_trade_deal_farharad_merchants
			years = 10
		}
		hidden_effect = {
			if = {
				limit = {
					scope:trans_haradric_merchant_spawn = {
						NOR = {
							has_sexuality = asexual
							has_sexuality = homosexual
						}
					}
				}
				random = {
					chance = 50
					RICE_generate_small_family = { CHARACTER = scope:trans_haradric_merchant_spawn }
				}
			}
		}
		ai_chance = {
			base = 10
			modifier = {
				add = 10
				has_trait = greedy
			}
			modifier = {
				add = 10
				has_trait = ambitious
			}
		}
	}

	# Don't stay, but create a trade deal
	option = {
		name = harad.0601.b
		pay_short_term_gold = {
			target = scope:trans_haradric_merchant_spawn
			gold = medium_gold_value
		}
		add_character_modifier = {
			modifier = trans_haradric_trade_deal_farharad_merchants
			years = 10
		}
		hidden_effect = {
			random = {
				chance = 75
				scope:trans_haradric_merchant_spawn = {
					death = {
						death_reason = death_disappearance
					}
				}
			}
		}
		ai_chance = {
			base = 40
			modifier = {
				add = 10
				has_trait = greedy
			}
			modifier = {
				add = 10
				has_trait = ambitious
			}
		}
	}

	# Not interested
	option = {
		name = harad.0601.c
		hidden_effect = {
			random = {
				chance = 75
				scope:trans_haradric_merchant_spawn = {
					death = {
						death_reason = death_disappearance
					}
				}
			}
		}
		ai_chance = {
			base = 25
		}
	}
	
	after = {
		if = {
			limit = {
				has_character_modifier = lotr_currently_trans_haradric_networking
			}
			clean_up_trans_haradric_merchant_effect = yes
		}
	}
}

# Trans-Haradric Khyan Merchant offers services or at least a good deal (can spawn anywhere in harad)
harad.0603 = {
	content_source = realms_dlc
	type = character_event
	title = harad.0603.t
	desc = {
		first_valid = {
			triggered_desc = {
				trigger = {
					has_character_modifier = lotr_currently_trans_haradric_networking
				}
				desc = harad.0601.desc.intro_networker
			}		
			triggered_desc = {
				trigger = {
					NOT = { has_character_modifier = lotr_currently_trans_haradric_networking }
				}
				desc = harad.0601.desc.intro_normal
			}			
		}
		desc = harad.0603.desc
	}
	
	theme = stewardship_wealth_focus
	override_background = { reference = market }
	
	
	left_portrait = {
		character = scope:trans_haradric_merchant_spawn
		animation = steward
	}
	
	trigger = {
		capital_province = {
			geographical_region = middleearth_harad
		}
		NOT = { has_character_flag = trans_haradric_guaranteed_spawn }
	}
	
	weight_multiplier = {
		base = 1
		modifier = {
			add = 0.5
			capital_province = {
				geographical_region = middleearth_harad_bayoformal_khy
			}			
		}
		modifier = {
			add = -0.4
			has_character_flag = trans_haradric_already_spawned_merchant
		}
		modifier = {
			add = -0.1
			AND = {
				is_ruler = yes
				government_has_flag = government_is_tribal
			}
		}
		modifier = {
			add = 1.1
			dynasty ?= {
				has_dynasty_perk = lotr_haradrim_legacy_1
			}
		}
		modifier = {
			add = 1.1
			any_held_county = {
				any_county_province = {
					has_building_or_higher = wonder_souk_mazharath
				}
			}
		}
		modifier = {
			add = 1.1
			culture = { has_cultural_tradition = tradition_trans_haradric_traders }
		}
		modifier = {
			add = 0.75
			has_character_flag = trans_haradric_networking_boost_tiny
		}
		modifier = {
			add = 1
			has_character_flag = trans_haradric_networking_boost_small
		}
		modifier = {
			add = 1.33
			has_character_flag = trans_haradric_networking_boost_medium
		}
		modifier = {
			add = 1.66
			has_character_flag = trans_haradric_networking_boost_large
		}
		modifier = {
			add = 2
			has_character_flag = trans_haradric_networking_boost_huge
		}
	}

	immediate = {
		capital_province = { save_scope_as = capital_province } #For loc.
		add_character_flag = trans_haradric_already_spawned_merchant

		if = {
			limit = {
				OR = {
					any_county_in_region = {
						region = middleearth_harad_bayoformal_khy
						OR = {
							culture = { has_cultural_parameter = heritage_group_apysaic }
							culture = { has_cultural_pillar = heritage_south_khailuza }
						}
					}
					any_county_in_region = {
						region = middleearth_harad_dunesea_arysis
						OR = {
							culture = { has_cultural_parameter = heritage_group_apysaic }
							culture = { has_cultural_pillar = heritage_south_khailuza }
						}
					}
				}
			}
			every_county_in_region = {
				region = middleearth_harad_bayoformal_khy
				limit = {
					OR = {
						culture = { has_cultural_parameter = heritage_group_apysaic }
						culture = { has_cultural_pillar = heritage_south_khailuza }
					}
				}
				add_to_list = merchant_counties
			}
			every_county_in_region = {
				region = middleearth_harad_dunesea_arysis
				limit = {
					OR = {
						culture = { has_cultural_parameter = heritage_group_apysaic }
						culture = { has_cultural_pillar = heritage_south_khailuza }
					}
				}
				add_to_list = merchant_counties
			}
			random_in_list = {
				list = merchant_counties
				save_scope_as = home_county
				weight = {
					base = 1
					modifier = {
						add = 1
						NOT = { title_province = { has_holding_type = tribal_holding } }
					}
					modifier = {
						add = 1
						title_province = { has_special_building = yes }
					}
					modifier = {
						add = 1
						culture = { has_cultural_tradition = tradition_trans_haradric_traders }
					}
					modifier = { # Cultures we want to see more commonly as dune sea merchants
						add = 0.3
						OR = {
							culture = { has_cultural_pillar = heritage_south_khailuza }
						}
					}
					modifier = {
						add = 2
						this = title:c_maresh
						OR = {
							has_county_modifier = maresh_prosperity_1
							has_county_modifier = maresh_prosperity_2
						}
					}
					modifier = {
						add = 3
						this = title:c_maresh
						OR = {
							has_county_modifier = maresh_prosperity_3
							has_county_modifier = maresh_prosperity_4
							has_county_modifier = maresh_prosperity_5
						}
					}
				}
			}
			create_character = {
				location = root.location
				template = trans_haradric_merchant_template
				save_scope_as = trans_haradric_merchant_spawn
				culture = scope:home_county.culture
				faith = scope:home_county.faith
			}
		}

		# Backup in case no such county can be found
		else = {
			random_list = {
				20 = {
					create_character = {
						location = root.location
						template = trans_haradric_merchant_template
						save_scope_as = trans_haradric_merchant_spawn
						culture = culture:khyan
						faith = faith:faith_arienism
					}				
				}
				20 = {
					create_character = {
						location = root.location
						template = trans_haradric_merchant_template
						save_scope_as = trans_haradric_merchant_spawn
						culture = culture:khyan
						faith = faith:faith_azianic
					}				
				}
				15 = {
					create_character = {
						location = root.location
						template = trans_haradric_merchant_template
						save_scope_as = trans_haradric_merchant_spawn
						culture = culture:arysisani
						faith = faith:faith_arysis
					}				
				}
				10 = {
					create_character = {
						location = root.location
						template = trans_haradric_merchant_template
						save_scope_as = trans_haradric_merchant_spawn
						culture = culture:muranian
						faith = faith:faith_nhazadh
					}				
				}
			}
		}
	}

	# Okay
	option = {
		name = harad.0601.a
		add_prestige = -150
		pay_short_term_gold = {
			target = scope:trans_haradric_merchant_spawn
			gold = medium_gold_value
		}
		add_courtier = scope:trans_haradric_merchant_spawn
		add_character_modifier = {
			modifier = trans_haradric_trade_deal_khy_merchants
			years = 10
		}
		hidden_effect = {
			if = {
				limit = {
					scope:trans_haradric_merchant_spawn = {
						NOR = {
							has_sexuality = asexual
							has_sexuality = homosexual
						}
					}
				}
				random = {
					chance = 50
					RICE_generate_small_family = { CHARACTER = scope:trans_haradric_merchant_spawn }
				}
			}
		}
		ai_chance = {
			base = 10
			modifier = {
				add = 10
				has_trait = greedy
			}
			modifier = {
				add = 10
				has_trait = ambitious
			}
		}
	}

	# Don't stay, but create a trade deal
	option = {
		name = harad.0601.b
		pay_short_term_gold = {
			target = scope:trans_haradric_merchant_spawn
			gold = medium_gold_value
		}
		add_character_modifier = {
			modifier = trans_haradric_trade_deal_khy_merchants
			years = 10
		}
		hidden_effect = {
			random = {
				chance = 75
				scope:trans_haradric_merchant_spawn = {
					death = {
						death_reason = death_disappearance
					}
				}
			}
		}
		ai_chance = {
			base = 40
			modifier = {
				add = 10
				has_trait = greedy
			}
			modifier = {
				add = 10
				has_trait = ambitious
			}
		}
	}

	# Not interested
	option = {
		name = harad.0601.c
		hidden_effect = {
			random = {
				chance = 75
				scope:trans_haradric_merchant_spawn = {
					death = {
						death_reason = death_disappearance
					}
				}
			}
		}
		ai_chance = {
			base = 25
		}
	}
	
	after = {
		if = {
			limit = {
				has_character_modifier = lotr_currently_trans_haradric_networking
			}
			clean_up_trans_haradric_merchant_effect = yes
		}
	}
	
}

# Trans-Haradric Sîrayni Merchant offers services or at least a good deal (can spawn anywhere in harad)
harad.0604 = {
	content_source = realms_dlc
	type = character_event
	title = harad.0604.t
	desc = {
		first_valid = {
			triggered_desc = {
				trigger = {
					has_character_modifier = lotr_currently_trans_haradric_networking
				}
				desc = harad.0601.desc.intro_networker
			}		
			triggered_desc = {
				trigger = {
					NOT = { has_character_modifier = lotr_currently_trans_haradric_networking }
				}
				desc = harad.0601.desc.intro_normal
			}			
		}
		desc = harad.0604.desc
	}
	
	theme = stewardship_wealth_focus
	override_background = { reference = market }
	
	
	left_portrait = {
		character = scope:trans_haradric_merchant_spawn
		animation = steward
	}
	
	trigger = {
		capital_province = {
			geographical_region = middleearth_harad
		}
		NOT = { has_character_flag = trans_haradric_guaranteed_spawn }
	}
	
	weight_multiplier = {
		base = 1
		modifier = {
			add = 0.5
			capital_province = {
				geographical_region = middleearth_harad_bayoformal_sirayn
			}			
		}
		modifier = {
			add = -0.4
			has_character_flag = trans_haradric_already_spawned_merchant
		}
		modifier = {
			add = -0.1
			AND = {
				is_ruler = yes
				government_has_flag = government_is_tribal
			}
		}
		modifier = {
			add = 1.1
			dynasty ?= {
				has_dynasty_perk = lotr_haradrim_legacy_1
			}
		}
		modifier = {
			add = 1.1
			any_held_county = {
				any_county_province = {
					has_building_or_higher = wonder_souk_mazharath
				}
			}
		}
		modifier = {
			add = 1.1
			culture = { has_cultural_tradition = tradition_trans_haradric_traders }
		}
		modifier = {
			add = 0.75
			has_character_flag = trans_haradric_networking_boost_tiny
		}
		modifier = {
			add = 1
			has_character_flag = trans_haradric_networking_boost_small
		}
		modifier = {
			add = 1.33
			has_character_flag = trans_haradric_networking_boost_medium
		}
		modifier = {
			add = 1.66
			has_character_flag = trans_haradric_networking_boost_large
		}
		modifier = {
			add = 2
			has_character_flag = trans_haradric_networking_boost_huge
		}
	}

	immediate = {
		capital_province = { save_scope_as = capital_province } #For loc.
		add_character_flag = trans_haradric_already_spawned_merchant

		if = {
			limit = {
				OR = {
					any_county_in_region = {
						region = middleearth_harad_bayoformal_sirayn
						culture = { has_cultural_parameter = heritage_group_apysaic }
					}
					any_county_in_region = {
						region = middleearth_harad_bayoformal_harshandatt
						culture = { has_cultural_parameter = heritage_group_apysaic }
					}
				}
			}
			every_county_in_region = {
				region = middleearth_harad_bayoformal_sirayn
				limit = {
					culture = { has_cultural_parameter = heritage_group_apysaic }
				}
				add_to_list = merchant_counties
			}
			every_county_in_region = {
				region = middleearth_harad_bayoformal_harshandatt
				limit = {
					culture = { has_cultural_parameter = heritage_group_apysaic }
				}
				add_to_list = merchant_counties
			}
			random_in_list = {
				list = merchant_counties
				save_scope_as = home_county
				weight = {
					base = 1
					modifier = {
						add = 1
						NOT = { title_province = { has_holding_type = tribal_holding } }
					}
					modifier = {
						add = 1
						title_province = { has_special_building = yes }
					}
					modifier = { # Less from Harshandatt
						add = -0.5
						title_province = { geographical_region = middleearth_harad_bayoformal_harshandatt }
					}
					modifier = {
						add = 1
						culture = { has_cultural_tradition = tradition_trans_haradric_traders }
					}
					modifier = { # Cultures we want to see more commonly as dune sea merchants
						add = 0.3
						OR = {
							culture = { has_cultural_pillar = heritage_new_sirayni }
							culture = { has_cultural_pillar = heritage_old_sirayni }
						}
					}
				}
			}
			create_character = {
				location = root.location
				template = trans_haradric_merchant_template
				save_scope_as = trans_haradric_merchant_spawn
				culture = scope:home_county.culture
				faith = scope:home_county.faith
			}
		}

		# Backup in case no such county can be found
		else = { # Will have to update start date checks in the future
			religion:sirayn_religion = {
				random_faith = { #Find a taye faith
					limit = { has_doctrine = tenet_sirayn_syncretism }
					save_scope_as = merchant_faith
				}
			}
			random_list = {
				15 = {
					trigger = { game_start_date < 4000 }
					create_character = {
						location = root.location
						template = trans_haradric_merchant_template
						save_scope_as = trans_haradric_merchant_spawn
						culture = culture:old_sirayni
						faith = scope:merchant_faith
					}
				}
				15 = {
					trigger = {
						game_start_date > 4000
						game_start_date < 6500
					}
					create_character = {
						location = root.location
						template = trans_haradric_merchant_template
						save_scope_as = trans_haradric_merchant_spawn
						culture = culture:new_sirayni
						faith = scope:merchant_faith
					}				
				}
				15 = {
					trigger = { game_start_date > 3511 }
					create_character = {
						location = root.location
						template = trans_haradric_merchant_template
						save_scope_as = trans_haradric_merchant_spawn
						culture = culture:ayten
						faith = scope:merchant_faith
					}				
				}
				30 = {
					trigger = { game_start_date > 4496 }
					create_character = {
						location = root.location
						template = trans_haradric_merchant_template
						save_scope_as = trans_haradric_merchant_spawn
						culture = culture:poan
						faith = scope:merchant_faith
					}				
				}
				15 = {
					trigger = { game_start_date > 5983 }
					create_character = {
						location = root.location
						template = trans_haradric_merchant_template
						save_scope_as = trans_haradric_merchant_spawn
						culture = culture:chennacatti
						faith = scope:merchant_faith
					}				
				}
				15 = {
					trigger = { game_start_date > 7597 }
					create_character = {
						location = root.location
						template = trans_haradric_merchant_template
						save_scope_as = trans_haradric_merchant_spawn
						culture = culture:tyari
						faith = scope:merchant_faith
					}				
				}
			}
		}
	}

	# Okay
	option = {
		name = harad.0601.a
		add_prestige = -150
		pay_short_term_gold = {
			target = scope:trans_haradric_merchant_spawn
			gold = medium_gold_value
		}
		add_courtier = scope:trans_haradric_merchant_spawn
		add_character_modifier = {
			modifier = trans_haradric_trade_deal_sirayn_merchants
			years = 10
		}
		hidden_effect = {
			if = {
				limit = {
					scope:trans_haradric_merchant_spawn = {
						NOR = {
							has_sexuality = asexual
							has_sexuality = homosexual
						}
					}
				}
				random = {
					chance = 50
					RICE_generate_small_family = { CHARACTER = scope:trans_haradric_merchant_spawn }
				}
			}
		}
		ai_chance = {
			base = 10
			modifier = {
				add = 10
				has_trait = greedy
			}
			modifier = {
				add = 10
				has_trait = ambitious
			}
		}
	}

	# Don't stay, but create a trade deal
	option = {
		name = harad.0601.b
		pay_short_term_gold = {
			target = scope:trans_haradric_merchant_spawn
			gold = medium_gold_value
		}
		add_character_modifier = {
			modifier = trans_haradric_trade_deal_sirayn_merchants
			years = 10
		}
		hidden_effect = {
			random = {
				chance = 75
				scope:trans_haradric_merchant_spawn = {
					death = {
						death_reason = death_disappearance
					}
				}
			}
		}
		ai_chance = {
			base = 40
			modifier = {
				add = 10
				has_trait = greedy
			}
			modifier = {
				add = 10
				has_trait = ambitious
			}
		}
	}

	# Not interested
	option = {
		name = harad.0601.c
		hidden_effect = {
			random = {
				chance = 75
				scope:trans_haradric_merchant_spawn = {
					death = {
						death_reason = death_disappearance
					}
				}
			}
		}
		ai_chance = {
			base = 25
		}
	}
	
	after = {
		if = {
			limit = {
				has_character_modifier = lotr_currently_trans_haradric_networking
			}
			clean_up_trans_haradric_merchant_effect = yes
		}
	}
}

#############################################
### Namâlo Events - Sîrayni Spice Traders ###
#############################################
# Adapted from RICE Wangara System
# Sîrayn Ruler may take a unique decision to Establish the Namâlo, unlocking the innovation for themselves
# Then, rulers elsewhere can take the decision to synergize with the Namâlo, unlocking their innovation too
# Innovation grants access to a unique minor synergy decision

# Establish the Namâlo traders
harad.0700 = {
	content_source = realms_dlc
	type = character_event
	title = harad.0700.t
	desc = harad.0700.desc
	theme = stewardship_wealth_focus
	override_background = { reference = harad_2 }
	
	right_portrait = {
		character = scope:namalo_founder
		animation = steward
	}

	option = { # OK
		name = harad.0700.a
		lotr_establish_namalo_effect = yes
		custom_tooltip = harad.0700.tt_1
		custom_tooltip = harad.0700.tt_2
	}

	after = {
		if = {
			limit = { # Minor News, but also if regional
				NOT = { has_game_rule = no_news }
			}
			every_player = { #Global News Announcement
				limit = {
					is_ai = no
					#NOT = { this = scope:maresh_ruler }
					OR = { # Minor news, but also if regional
						has_game_rule = all_news
						capital_county.title_province ?= { geographical_region = middleearth_harad }
						capital_county.title_province ?= { geographical_region = middleearth_mountains_yellow }
					}
				}
				trigger_event = news_event.0061
			}
		}
	}
}

# Bring Namâlo into our community
harad.0701 = {
	content_source = realms_dlc
	type = character_event
	title = harad.0701.t
	desc = harad.0701.desc
	theme = stewardship_wealth_focus
	override_background = { reference = harad_2 }
	
	left_portrait = {
		character = scope:namalo_inviter
		animation = steward
	}

	immediate = {
		if = {
			limit = {
				root = scope:namalo_inviter
			}
			lotr_gain_namalo_effect = yes
		}
		else = {
			show_as_tooltip = {
				scope:namalo_inviter = {
					lotr_gain_namalo_effect = yes					
				}
			}
		}
		custom_tooltip = harad.0701.tooltip
	}

	option = { # OK
		name = harad.0701.a
	}
}

# Synergize with Namâlo minor decision event
harad.0702 = {
	content_source = realms_dlc
	type = character_event
	title = harad.0702.t
	desc = {
		desc = harad.0702.desc
		first_valid = {
			triggered_desc = {
				trigger = {
					var:lotr_namalo_synergy_type = flag:political
				}
				desc = harad.0702.desc.political
			}
			triggered_desc = {
				trigger = {
					var:lotr_namalo_synergy_type = flag:commercial
				}
				desc = harad.0702.desc.commercial
			}
			triggered_desc = {
				trigger = {
					var:lotr_namalo_synergy_type = flag:cultural
				}
				desc = harad.0702.desc.cultural
			}
		}
	}
	theme = stewardship_wealth_focus
	override_background = { reference = harad_2 }
	
	left_portrait = root

	immediate = {
		# Remove all previous Namâlo modifiers and give a notifier
		if = {
			limit = {
				OR = {
					has_character_modifier = lotr_namalo_political_synergy
					has_character_modifier = lotr_namalo_commercial_synergy
					has_character_modifier = lotr_namalo_cultural_synergy
				}
			}
			custom_tooltip = looses_all_namalo_synergies_tt
			hidden_effect = {
				remove_character_modifier = lotr_namalo_political_synergy
				remove_character_modifier = lotr_namalo_commercial_synergy
				remove_character_modifier = lotr_namalo_cultural_synergy
			}
		}
		
		# Apply Character modifier
		if = {
			limit = {
				var:lotr_namalo_synergy_type = flag:political
			}
			add_character_modifier = {
				modifier = lotr_namalo_political_synergy
				years = 10
			}
		}
		else_if = {
			limit = {
				var:lotr_namalo_synergy_type = flag:commercial
			}
			add_character_modifier = {
				modifier = lotr_namalo_commercial_synergy
				years = 10
			}
		}
		else_if = {
			limit = {
				var:lotr_namalo_synergy_type = flag:cultural
			}
			add_character_modifier = {
				modifier = lotr_namalo_cultural_synergy
				years = 10
			}
		}
	
	
		# Build a list of affected counties
		every_held_county = {
			limit = {
				OR = {
					culture = { has_innovation = innovation_namalo }
					this = ROOT.capital_county
				}
			}
			add_to_list = county_list
		}
	
		# Apply County Effects
		every_in_list = {
			list = county_list
			add_county_modifier = {
				modifier = lotr_namalo_political_synergy_county
				years = 10
			}
	
			# Remove all previous Namâlo modifiers and give a notifier
			if = {
				limit = {
					OR = {
						has_county_modifier = lotr_namalo_political_synergy_county
						has_county_modifier = lotr_namalo_commercial_synergy_county
						has_county_modifier = lotr_namalo_cultural_synergy_county
					}
				}
				custom_tooltip = looses_all_namalo_synergies_tt
				hidden_effect = {
					remove_county_modifier = lotr_namalo_political_synergy_county
					remove_county_modifier = lotr_namalo_commercial_synergy_county
					remove_county_modifier = lotr_namalo_cultural_synergy_county
				}
			}
	
			# Add the synergy county modifier
			if = {
				limit = {
					root.var:lotr_namalo_synergy_type = flag:political
				}
				add_county_modifier = {
					modifier = lotr_namalo_political_synergy_county
					years = 10
				}
			}
			else_if = {
				limit = {
					root.var:lotr_namalo_synergy_type = flag:commercial
				}
				add_county_modifier = {
					modifier = lotr_namalo_commercial_synergy_county
					years = 10
				}
			}
			else_if = {
				limit = {
					root.var:lotr_namalo_synergy_type = flag:cultural
				}
				add_county_modifier = {
					modifier = lotr_namalo_cultural_synergy_county
					years = 10
				}
			}
	
			# Increase Development a random amount
			random_list = {
				10 = {
					change_development_progress_with_overflow = 5
				}
				10 = {
					change_development_progress_with_overflow = 10
				}
				10 = {
					change_development_progress_with_overflow = 15
				}
				10 = {
					change_development_progress_with_overflow = 20
				}
			}
		}
	}

	option = { # OK
		name = harad.0702.a

	}

	after = {		
		if = {
			limit = { has_variable = lotr_namalo_synergy_type }
			remove_variable = lotr_namalo_synergy_type
		}
	}

}


####################
### Unify Harad ####
####################

harad.1000 = { # Unify Harad
	content_source = realms_dlc
	type = character_event
	title = harad.1000.t
	desc = harad.1000.desc
	theme = crown
	override_background = {
		reference = throne_room_east
	}
	left_portrait = {
		character = root
		animation = personality_bold
	}
	
	option = { 
		name = harad.1000.a
		add_prestige = 1500
		add_character_modifier = unified_harad_modifier
		if = {
			limit = { prestige_level = 0 }
			add_prestige_level = 5
		}
		else_if = {
			limit = { prestige_level = 1 }
			add_prestige_level = 4
		}
		else_if = {
			limit = { prestige_level = 2 }
			add_prestige_level = 3
		}
		else_if = {
			limit = { prestige_level = 3 }
			add_prestige_level = 2
		}
		else_if = {
			limit = { prestige_level = 4 }
			add_prestige_level = 1
		}
		root.dynasty = {
			add_dynasty_prestige = 1000
			add_dynasty_prestige_level = 2
		}
	}
}

#################################
### Long Winter story content ###
#################################

harad.2000 = { ## Harwan Invades Gondor - The Harrying of the Coasts begins
	content_source = realms_dlc
	type = character_event
	title = harad.2000.t
	desc = harad.2000.desc
	theme = war
	override_background = {
		reference = throne_room_east
	}
	left_portrait = {
		character = root
		animation = personality_bold
	}
	immediate = {
		if = {
			limit = { 
				exists = title:e_gondor.holder
			}
			title:e_gondor.holder = { 
				save_scope_as = gondor 
			}
		}
		else_if = {
			limit = { 
				exists = title:e_gondor_steward.holder 
			}
			title:e_gondor_steward.holder = { 
				save_scope_as = gondor 
			}
		}
		else_if = {
			limit = { 
				exists = title:e_castamir.holder 
			}
			title:e_castamir.holder = { 
				save_scope_as = gondor 
			}
		}
		
		if = {
			limit = { 
				scope:gondor = { 
					any_vassal = { 
						any_held_title = { 
							target_is_de_jure_liege_or_above = title:k_harondor 
						} 
					} 
				} 
			}
			title:k_harondor = { 
				save_scope_as = target_kingdom 
			}
		}
	}
	
	option = {
		name = harad.2000.a 
		# Start War
		start_war = { # Harrying of the Coasts
			casus_belli = lotr_harrying_of_the_coasts_cb
			target = scope:gondor
			target_title = title:k_harondor
		}
		# Alert Gondor
		title:c_minas_tirith.holder.top_liege = {
			trigger_event = {
				id = gondor.3900
				days = 1
			}
		}
		# Invite Umbar
		if = {
			limit = { 
				and = {
					exists = title:k_umbar.holder 
					title:k_umbar.holder.liege = root
				}
			}
			title:k_umbar.holder = {
				trigger_event = {
					id = harad.2001
					days = 1
				}
			}
		}
		# Invite Harnendor
		if = {
			limit = { 
				and = {
					exists = title:k_mirlond.holder 
					title:k_mirlond.holder.liege = root
				}
			}
			title:k_mirlond.holder = {
				trigger_event = {
					id = harad.2001
					days = 1
				}
			}
		}
		if = {
			limit = { # Major News
				NOT = { has_game_rule = no_news }
			}
			every_player = { #Global News Announcement
				trigger_event = news_event.0040
			}
		}
	}
}

harad.2001 = { # Harrying of the Coasts - Umbar's invitation
	content_source = realms_dlc
	type = character_event
	title = harad.2001.t
	desc = harad.2001.desc
	theme = war
	override_background = {
		reference = black_ship
	}
	left_portrait = {
		character = root
		animation = personality_bold
	}
	immediate = {
		if = {
			limit = { exists = title:e_gondor.holder }
			title:e_gondor.holder = { save_scope_as = gondor }
		}
		else_if = {
			limit = { exists = title:e_gondor_steward.holder }
			title:e_gondor_steward.holder = { save_scope_as = gondor }
		}
		else_if = {
			limit = { exists = title:e_castamir.holder }
			title:e_castamir.holder = { save_scope_as = gondor }
		}
		
		if = {
			limit = { 
				scope:gondor = { 
					any_vassal = { 
						any_held_title = { 
							target_is_de_jure_liege_or_above = title:k_harondor 
						} 
					} 
				} 
			}
			title:k_harondor = { save_scope_as = target_kingdom }
		}
		root.liege = { 
			save_scope_as = liege 
		}
	}
	
	option = { # Join the war 
		name = harad.2001.a
		add_piety = 100
		add_prestige = 200 
		# Join the war
		scope:liege = {
			every_character_war = {
				limit = {
					OR = {
						is_defender = scope:gondor
					}
				}
				add_attacker = root
			}
		}
		# Modifiers
		if = {
			limit = { is_ai = yes }
			remove_character_modifier = lotr_preparing_the_fleets_modifier
			add_character_modifier = {
				modifier = lotr_fleets_long_prepared_umbar_ai_modifier
				years = 10
			}
		}
		else = {
			remove_character_modifier = lotr_preparing_the_fleets_modifier
			add_character_modifier = {
				modifier = lotr_fleets_long_prepared_umbar_modifier
				years = 5
			}
		}
		# Event troops
		if = {
			limit = {
				has_title = title:k_umbar
			}
			spawn_army = {
				levies = 1000
				men_at_arms = {
					type = corsair_warriors
					stacks = 6
				}
				men_at_arms = {
					type = abrazanim_warbows
					stacks = 2
				}
				location = capital_province
				inheritable = no
				uses_supply = no
				name = second_fleet		
			}
		}
		if = {
			limit = {
				has_title = title:k_mirlond
				completely_controls = title:c_mirlond
			}
			spawn_army = {
				levies = 2000
				men_at_arms = {
					type = corsair_warriors
					stacks = 2
				}
				men_at_arms = {
					type = haradrim_raiders
					stacks = 4
				}
				location = capital_province
				inheritable = no
				uses_supply = no
				name = third_fleet		
			}
		}
		if = {
			limit = {
				has_character_flag = lotr_further_preparations
			}
			spawn_army = {
				levies = 1000
				men_at_arms = {
					type = corsair_warriors
					stacks = 6
				}
				men_at_arms = {
					type = abrazanim_warbows
					stacks = 2
				}
				location = capital_province
				inheritable = no
				uses_supply = no
				name = fifth_fleet		
			}
		}
		# Let Harwan know
		if = {
			limit = {
				has_title = title:k_umbar
			}
			scope:liege = {
				trigger_event = {
					id = harad.2005
					days = 1
				}
			}
		}
		if = {
			limit = {
				has_title = title:k_mirlond
			}
			scope:liege = {
				trigger_event = {
					id = harad.2006
					days = 2
				}
			}
		}

		ai_chance = {
			base = 0 # LotR: This should be tied to WotR mode.
			modifier = { # Game Rule
				has_game_rule = default_ai_behavior
				add = 100
			}
			modifier = { # Game Rule
				has_game_rule = weighted_ai_behavior
				add = 90
			}
			modifier = { # Game Rule
				has_game_rule = random_ai_behavior
				add = 75
			}
		}
	}
	option = { # Refuse 
		name = harad.2001.b 
		add_prestige = -500
		add_piety = -250
		every_vassal = {
			limit = {
				faith = faith:faith_corsair
			}
			add_opinion = {
				modifier = didnt_raid_opinion
				target = root
			}
		}
		root.liege = {
			add_opinion = {
				modifier = dishonoured_oath_of_alliegeance_opinion
				target = root
			}
		}

		# Let Harwan know about the refusal
		if = {
			limit = {
				has_title = title:k_umbar
			}
			scope:liege = {
				trigger_event = {
					id = harad.2007
					days = 1
				}
			}
		}
		if = {
			limit = {
				has_title = title:k_mirlond
			}
			scope:liege = {
				trigger_event = {
					id = harad.2008
					days = 2
				}
			}
		}

		ai_chance = {
			base = 0 # LotR: This should be tied to WotR mode.
			modifier = { # Game Rule
				has_game_rule = default_ai_behavior
				add = 0
			}
			modifier = { # Game Rule
				has_game_rule = weighted_ai_behavior
				add = 10
			}
			modifier = { # Game Rule
				has_game_rule = random_ai_behavior
				add = 25
			}
		}
	}
}

# Make these trigger for Umbar too

harad.2002 = { # Harrying of the Coasts - victory
	content_source = realms_dlc
	type = character_event
	title = harad.2002.t
	desc = harad.2002.desc
	theme = war
	override_background = {
		reference = black_ship
	}
	left_portrait = {
		character = root
		animation = schadenfreude
	}
	
	# cooldown = { days = 5 }
	
	option = { # Harwan
		name = harad.2002.a

		trigger = {
			has_title = title:e_haradwaith
		}
		add_gold = 200
		add_prestige = medium_prestige_gain
		get_title = title:k_harondor

		remove_character_modifier = lotr_fleets_long_prepared_harwan_modifier

		title:k_umbar.holder = { #Trigger same event for Umbar
			trigger_event = harad.2002
		}
		title:k_mirlond.holder = { # Triger for Mirlond if kingdom
			trigger_event = harad.2002
		}
	}
	option = {  # Everyone who isn't Harwan
		name = harad.2002.b

		trigger = {
			NOT = {
				has_title = title:e_haradwaith
			}
		}

		add_gold = 1000
		add_prestige = medium_prestige_gain

		remove_character_modifier = lotr_fleets_long_prepared_umbar_modifier
	}
}

harad.2003 = { # Harrying of the Coasts - defeat
	content_source = realms_dlc
	type = character_event
	title = harad.2003.t
	desc = harad.2003.desc
	theme = war
	override_background = {
		reference = black_ship
	}
	left_portrait = {
		character = root
		animation = disbelief
	}

	option = { # Harwan
		name = harad.2003.a

		trigger = {
			has_title = title:e_haradwaith
		}
 
		every_vassal = { # Corsair vassals get angry 
			limit = {
				faith = faith:faith_corsair
			}
			add_opinion = {
				modifier = didnt_raid_opinion
				target = root
			}
		}
		add_prestige = -750

		remove_character_modifier = lotr_fleets_long_prepared_harwan_modifier

		title:k_umbar.holder = { #Trigger same event for Umbar
			trigger_event = harad.2003
		}
		title:k_mirlond.holder = { # Triger for Mirlond if kingdom
			trigger_event = harad.2003
		}
	}
	
	option = {  # Everyone who isn't Harwan
		name = harad.2003.b

		trigger = {
			NOT = {
				has_title = title:e_haradwaith
			}
		}

		remove_short_term_gold = 200 
		every_vassal = { # Corsair vassals get angry 
			limit = {
				faith = faith:faith_corsair
			}
			add_opinion = {
				modifier = didnt_raid_opinion
				target = root
			}
		}
		add_prestige = -750

		remove_character_modifier = lotr_fleets_long_prepared_umbar_modifier
	}
}

harad.2004 = { # Harrying of the Coasts - white peace
	content_source = realms_dlc
	type = character_event
	title = harad.2004.t
	desc = harad.2004.desc
	theme = war
	override_background = {
		reference = black_ship
	}
	left_portrait = {
		character = root
		animation = disbelief
	}
	
	option = { # Harwan
		name = harad.2004.a

		trigger = {
			has_title = title:e_haradwaith
		}

		add_prestige = 200
		add_pressed_claim = title:k_harondor

		remove_character_modifier = lotr_fleets_long_prepared_harwan_modifier

		title:k_umbar.holder = { #Trigger same event for Umbar
			trigger_event = harad.2004
		}
		title:k_mirlond.holder = { # Triger for Mirlond if kingdom
			trigger_event = harad.2004
		}
	}

	option = {  # Everyone who isn't Harwan
		name = harad.2004.b

		trigger = {
			NOT = {
				has_title = title:e_haradwaith
			}
		}

		add_gold = 200
		add_prestige = 100

		remove_character_modifier = lotr_fleets_long_prepared_umbar_modifier
	}
}

harad.2005 = { ## The Harrying of the Coast - Umbar joins
	content_source = realms_dlc
	type = character_event
	title = harad.2005.t
	desc = harad.2005.desc
	theme = war
	override_background = {
		reference = black_ship
	}
	left_portrait = {
		character = root
		animation = personality_bold
	}
	right_portrait = {
		character = title:k_umbar.holder
		animation = aggressive_sword
	}
	immediate = {
	}
	
	option = {
		name = harad.2005.a 
		add_prestige = 50
		spawn_army = {
			levies = 500
			men_at_arms = {
				type = corsair_warriors
				stacks = 3
			}
			location = capital_province
			inheritable = no
			uses_supply = no
			name = umbar_raiders		
		}
	}
}

harad.2006 = { ## The Harrying of the Coast - Harnendor joins
	content_source = realms_dlc
	type = character_event
	title = harad.2006.t
	desc = harad.2006.desc
	theme = war
	override_background = {
		reference = black_ship
	}
	left_portrait = {
		character = root
		animation = personality_bold
	}
	right_portrait = {
		character = title:k_mirlond.holder
		animation = aggressive_sword
	}
	immediate = {
	}
	
	option = {
		name = harad.2006.a 
		add_prestige = 50
		spawn_army = {
			levies = 500
			men_at_arms = {
				type = corsair_warriors
				stacks = 3
			}
			location = capital_province
			inheritable = no
			uses_supply = no
			name = mirlond_raiders		
		}
	}
}

harad.2007 = { ## The Harrying of the Coast - Umbar refuses
	content_source = realms_dlc
	type = character_event
	title = harad.2007.t
	desc = harad.2007.desc
	theme = war
	override_background = {
		reference = black_ship
	}
	left_portrait = {
		character = root
		animation = anger
	}
	right_portrait = {
		character = title:k_umbar.holder
		animation = fear
	}
	immediate = {
	}
	
	option = {
		name = harad.2007.a 
		add_prestige = -50
		# add title revocation reason
	}
}

harad.2008 = { ## The Harrying of the Coast - Harnendor refuses
	content_source = realms_dlc
	type = character_event
	title = harad.2008.t
	desc = harad.2008.desc
	theme = war
	override_background = {
		reference = black_ship
	}
	left_portrait = {
		character = root
		animation = anger
	}
	right_portrait = {
		character = title:k_mirlond.holder
		animation = fear
	}
	immediate = {
	}
	
	option = {
		name = harad.2008.a 
		add_prestige = -50
		# add title revocation reason

	}
}

harad.2500 = { # Lord of the Dunes decision event
	content_source = realms_dlc
	type = character_event
	title = harad.2500.t
	desc = harad.2500.desc
	theme = realm
	window = visit_settlement_window
	override_background = { reference = wilderness_desert }
	left_portrait = {
		character = root 
		animation = sword_coup_degrace
	}
	immediate = {
		show_as_tooltip = {
			dynasty = { add_dynasty_prestige = 1000 }
			add_prestige = massive_prestige_gain
			add_character_modifier = lord_of_the_dunes_modifier
			title:d_darsalan = {
				set_de_jure_liege_title = title:k_darsalan
			}
			title:d_tahbr_abrakhan = {
				set_de_jure_liege_title = title:k_darsalan
			}
			title:d_tarsesh_abrakhan = {
				set_de_jure_liege_title = title:k_darsalan
			}
			title:d_zhar_daniz = {
				set_de_jure_liege_title = title:k_darsalan
			}
			title:d_abrakhan = {
				set_de_jure_liege_title = title:k_darsalan
			}
			title:d_nafar_poan = {
				set_de_jure_liege_title = title:k_darsalan
			}
			title:d_sarysis = {
				set_de_jure_liege_title = title:k_darsalan
			}
			title:k_darsalan = {
				change_development_level = 5
			}
		}
	}
	option = {
		name = harad.2500.a 
	}
}

harad.2501 = { # Darsalan kingdom decision event
	content_source = realms_dlc
	type = character_event
	title = harad.2501.t
	desc = harad.2501.desc
	theme = realm
	override_background = { reference = wilderness_desert }
	left_portrait = {
		character = root 
		animation = personality_callous
	}
	immediate = {
		show_as_tooltip = {
			title:d_darsalan = {
				set_de_jure_liege_title = title:k_darsalan
				change_development_level = 5
			}
			title:d_abrakhan = {
				set_de_jure_liege_title = title:k_darsalan
				change_development_level = 5
			}
			get_title = title:k_darsalan
			dynasty = { add_dynasty_prestige = 200 }
			add_prestige = medium_prestige_gain
		}
	}
	option = {
		name = harad.2501.a 
	}
}

harad.2600 = {
	content_source = realms_dlc
	type = character_event
	title = harad.2600.t
	desc = harad.2600.desc

	theme = faith
	override_background = { reference = terrain }

	left_portrait = {
		character = root
		triggered_animation = {
			trigger = {
				martial >= 12
			}
			animation = inspect_weapon
		}
		triggered_animation = {
			trigger = {
				learning >= 12
			}
			animation = prayer
		}
		triggered_animation = {
			trigger = {
				always = yes
			}
			animation = personality_zealous
		}
	}
	
	immediate = {
		location = {
			save_scope_as = current_location
			if = {
				limit = { #Elves and Istari don't convert others to their own faith
					root = {
						faith_is_good = yes
						OR = {
							is_elf = yes
							is_istari = yes 
						}
					}
					faith_is_good = no
					culture = { is_orc_culture = no }
				}
				if = {
					limit = { scope:current_location.faith.religion = { is_in_family = rf_darkness } }
					if = {
						limit = {
							scope:current_location.faith.religion = {
								any_faith = {
									OR = { 
										has_doctrine = doctrine_echoes_of_the_ainur
										has_doctrine = special_doctrine_is_freepeople_faith
									}
								}
							}
						}
						scope:current_location.faith.religion = {
							random_faith = { #Find a good faith to convert to in the same religion
								limit = {
									OR = { 
										has_doctrine = doctrine_echoes_of_the_ainur
										has_doctrine = special_doctrine_is_freepeople_faith
									}
								}
								save_scope_as = new_faith
							}
						}
					}
					else = {
						faith:faith_edain = { save_scope_as = new_faith }
					}
				}
				else = { #If forces of evil, find an appropriate local faith
					if = {
						limit = { culture = { is_dwarf_culture = yes } }
						faith:faith_khazad = { save_scope_as = new_faith }
					}
					else_if = {
						limit = { culture = { is_hobbit_culture = yes } }
						faith:faith_hobbit = { save_scope_as = new_faith }
					}
					else_if = {
						limit = { culture = { is_druedain_culture = yes } }
						faith:faith_druedain = { save_scope_as = new_faith }
					}
					else_if = {
						limit = { geographical_region = middleearth_west_rohan }
						faith:faith_rohirric = { save_scope_as = new_faith }
					}
					else_if = {
						limit = { geographical_region = middleearth_west_enedhwaith }
						faith:faith_dunlending_turthalis = { save_scope_as = new_faith }
					}
					else_if = {
						limit = { geographical_region = middleearth_west_rhovanion }
						faith:faith_woodmen = { save_scope_as = new_faith }
					}
					else_if = {
						limit = { geographical_region = middleearth_west }
						faith:faith_edain = { save_scope_as = new_faith }
					}
					else_if = {
						limit = { geographical_region = middleearth_rhun_dorwinion }
						faith:faith_dorwinion = { save_scope_as = new_faith }
					}
					else_if = {
						limit = { geographical_region = middleearth_rhun }
						faith:faith_rhun_araw_triumvirate = { save_scope_as = new_faith }
					}
					else_if = {
						limit = { geographical_region = middleearth_mordor }
						faith:faith_rhun_araw_triumvirate = { save_scope_as = new_faith }
					}
					else_if = {
						limit = { geographical_region = middleearth_harad_near }
						faith:faith_chelkar = { save_scope_as = new_faith }
					}
					else_if = {
						limit = { geographical_region = middleearth_harad_far }
						faith:faith_conservative_eruism = { save_scope_as = new_faith }
					}
					else_if = {
						limit = { geographical_region = middleearth_uttersouth }
						faith:faith_gimileth = { save_scope_as = new_faith }
					}
					else = {
						faith:faith_edain = { save_scope_as = new_faith }
					}
				}
			}
			else = { root.faith = { save_scope_as = new_faith } }
		}
	}
	trigger = { #Double safeguard
		has_character_flag = zealous_missionary_timer
		government_has_flag = government_is_landless_adventurer
		location ?= {
			has_holding = yes
			culture = { is_elf_culture = no }
			OR = {
				AND = {
					root = {
						faith_is_good = yes
						OR = {
							is_elf = yes
							is_istari = yes 
						}
					}
					faith_is_good = no
					culture = { is_orc_culture = no }
				}
				culture = { same_race_culture =  { TARGET = root.culture } }
			}
		}
		NOT = {
			location.faith = root.faith
			is_ai = yes
			any_player = {
				OR = {
					this = location.county.holder
					this = location.county.holder.top_liege
				}
			}
		}
	}


	option = { # Convert!
		name = harad.2600.a
		duel = {
			skills = { diplomacy learning }
			value = very_high_skill_rating
			50 = {
				compare_modifier = {
					value = scope:duel_value
					multiplier = 3.5
					min = -49
				}
				modifier = {
					add = {
						subtract = location.county.county_opinion
					}
				}
				modifier = {
					factor = 0.75
					location.county.faith.religion = root.religion
				}
				modifier = {
					factor = 0.75
					knows_language_of_culture = location.county.culture
				}
				send_interface_toast = {
					type = event_toast_effect_good
					title = harad.2600.a.success
					left_icon = root
					right_icon = location.county
					location.county = {
						# set_county_faith = root.faith
						set_county_faith = scope:new_faith
					}
				}
			}
			50 = {
				compare_modifier = {
					value = scope:duel_value
					multiplier = -3.5
					min = -49
				}
				modifier = {
					add = location.county.development_level
				}
				send_interface_toast = {
					type = event_toast_effect_good
					title = harad.2600.a.failure
					left_icon = root
					right_icon = location.county
					add_stress = major_stress_gain
				}
			}
		}
		add_stress = miniscule_stress_gain
		add_piety = {
			value = 10
			multiply = location.county.development_level
			min = 20
		}

		reverse_add_opinion = {
			modifier = vengeful_opinion
			opinion = -75
			target = location.county.holder
		}

		ai_chance = {
			base = 25
			modifier = {
				add = root.learning
			}
		}
	}

	option = { # Embrace the peaceful ways of Iunast... BY FORCE!
		name = harad.2600.b
		duel = {
			skills = { martial intrigue }
			value = high_skill_rating
			50 = {
				compare_modifier = {
					value = scope:duel_value
					multiplier = 3.5
					min = -49
				}
				modifier = {
					add = {
						value = root.number_of_knights
						multiply = 10
					}
				}
				modifier = {
					add = root.current_military_strength
				}
				modifier = {
					factor = 1.2
					root.faith = {
						has_doctrine = tenet_armed_pilgrimages
					}
				}
				send_interface_toast = {
					type = event_toast_effect_good
					title = harad.2600.a.success
					left_icon = root
					right_icon = location.county
					location.county = {
						# set_county_faith = root.faith
						set_county_faith = scope:new_faith
					}
					ep3_hasan_advance_radicalism = yes
				}
			}
			50 = {
				compare_modifier = {
					value = scope:duel_value
					multiplier = -3.5
					min = -49
				}
				modifier = {
					add = location.county.development_level
				}
				modifier = {
					add = location.barony.building_max_garrison
				}
				send_interface_toast = {
					type = event_toast_effect_good
					title = harad.2600.a.failure
					left_icon = root
					right_icon = location.county
					increase_wounds_effect = { REASON = fight }
					random_courtier ?= {
						increase_wounds_effect = { REASON = fight }
					}
				}
			}
		}
		add_piety = 50
		reverse_add_opinion = {
			modifier = vengeful_opinion
			opinion = -75
			target = location.county.holder
		}

		ai_chance = {
			base = 50
			modifier = {
				add = {
					value = root.current_military_strength
					multiply = 0.1
				}
			}
			modifier = {
				add = {
					value = location.barony.building_max_garrison
					multiply = -0.1
				}
			}
			modifier = {
				add = root.martial
			}
		}
	}
	option = { #It's a lost cause
		name = harad.2600.c 
		add_stress = minor_stress_gain
		ai_chance = {
			base = 0
		}
	}
}
		
harad.2999 = {
	hidden = yes
	trigger = { is_ai = yes }
	immediate = { add_character_flag = bypass_normal_requirements }
}
