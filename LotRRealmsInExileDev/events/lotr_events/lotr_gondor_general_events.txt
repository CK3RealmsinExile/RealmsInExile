namespace = gondor

# General Events
#		gondor.3000 Pelargir / Umbar Trade Influx
#		gondor.3001 Pelargir / Umbar Trade Recession
#		gondor.4001 Recreate the Watch on Mordor
#		gondor.4002 Abandon the Watch on Mordor

#### General Gondor Events

gondor.3000 = { # Pelargir / Umbar Trade Influx
	content_source = realms_dlc
	type = character_event
	title = gondor.3000.t
	desc = gondor.3000.desc
	theme = stewardship
	left_portrait = {
		character = root
		animation = happiness
	}
	
	trigger = { 
		OR = { 
			has_title = title:c_pelargir
			has_title = title:c_umbar
		}
		NOR = {
			has_character_modifier = minor_trade_influx_modifier
			has_character_modifier = average_trade_influx_modifier
			has_character_modifier = large_trade_influx_modifier
			has_character_modifier = massive_trade_influx_modifier
			has_character_modifier = minor_trade_recession_modifier
			has_character_modifier = average_trade_recession_modifier
			has_character_modifier = large_trade_recession_modifier
			has_character_modifier = massive_trade_recession_modifier
		}
	}
	
	option = {
		name = gondor.3000.a
		random_list = {
			30 = {
				add_character_modifier = {
					modifier = minor_trade_influx_modifier
					years = 3
				}
				add_gold = 120
			}
			50 = {
				add_character_modifier = {
					modifier = average_trade_influx_modifier
					years = 3
				}
				add_gold = 250
			}
			15 = {
				add_character_modifier = {
					modifier = large_trade_influx_modifier
					years = 3
				}
				add_gold = 400
			}
			5 = {
				add_character_modifier = {
					modifier = massive_trade_influx_modifier
					years = 3
				}
				add_gold = 750
			}
		}
	}
}

gondor.3001 = { # Pelargir / Umbar Trade Shortage
	content_source = realms_dlc
	type = character_event
	title = gondor.3001.t
	desc = gondor.3001.desc
	theme = stewardship
	left_portrait = {
		character = root
		animation = disbelief
	}
	
	trigger = { 
		OR = { 
			has_title = title:c_pelargir
			has_title = title:c_umbar
		}
		NOR = {
			has_character_modifier = minor_trade_influx_modifier
			has_character_modifier = average_trade_influx_modifier
			has_character_modifier = large_trade_influx_modifier
			has_character_modifier = massive_trade_influx_modifier
			has_character_modifier = minor_trade_recession_modifier
			has_character_modifier = average_trade_recession_modifier
			has_character_modifier = large_trade_recession_modifier
			has_character_modifier = massive_trade_recession_modifier
		}
	}
	
	immediate = {
		cp:councillor_steward = {
			save_scope_as = steward
		}
	}
	
	option = {
		name = gondor.3001.a
		random_list = {
			30 = {
				add_character_modifier = {
					modifier = minor_trade_recession_modifier
					years = 3
				}
			}
			50 = {
				add_character_modifier = {
					modifier = average_trade_recession_modifier
					years = 3
				}
			}
			15 = {
				add_character_modifier = {
					modifier = large_trade_recession_modifier
					years = 3
				}
			}
			5 = {
				add_character_modifier = {
					modifier = massive_trade_recession_modifier
					years = 3
				}
			}
		}
	}
}

## Watch on Mordor events ##

gondor.4001 = { # Recreate the Watch on Mordor
	content_source = realms_dlc
	type = character_event
	title = gondor.4001.t
	theme = martial
	desc = {
		first_valid = {
			triggered_desc = {
				trigger = {
					root = { has_character_flag = wanted_new_watch_candidates }
				}
				desc = gondor.4001.desc.new
			}
			desc = gondor.4001.desc
		}
	}
	left_portrait = {
		character = root
		animation = marshal
	}
	lower_left_portrait = { character = scope:candidate1 }
	lower_center_portrait = { character = scope:candidate2 }
	lower_right_portrait = { character = scope:candidate3 }
	
	immediate = {
		random_knight = { save_scope_as = candidate1 }
		random_close_family_member = { save_scope_as = candidate2 }
		random_courtier_or_guest = { save_scope_as = candidate3 }
		if = {
			limit =  {
				exists = title:d_udun
			}
			destroy_title = title:d_udun
		}
		if = {
			limit =  {
				exists = title:d_ephel_duath
			}
			destroy_title = title:d_ephel_duath
		}
	}
	
	option = { # A knight
		name = gondor.4001.a
		custom_tooltip = event_gondor_4001_a
		
		hidden_effect = {
			title:c_morannon = {
				set_de_jure_liege_title = title:d_watch_on_mordor
			}
			title:c_cirith_ungol = {
				set_de_jure_liege_title = title:d_watch_on_mordor
			}
			title:c_durthang = {
				set_de_jure_liege_title = title:d_watch_on_mordor
			}
			
			create_title_and_vassal_change = {
				type = granted
				save_scope_as = morannon_change
				add_claim_on_loss = yes
			}
			title:c_morannon = {
				change_title_holder = {
					holder = scope:candidate1
					change = scope:morannon_change
					take_baronies = yes
				}	
			}
			resolve_title_and_vassal_change = scope:morannon_change
			
			create_title_and_vassal_change = {
				type = granted
				save_scope_as = durthang_change
				add_claim_on_loss = yes
			}
			title:c_durthang = {
				change_title_holder = {
					holder = scope:candidate1
					change = scope:durthang_change
					take_baronies = yes
				}	
			}
			resolve_title_and_vassal_change = scope:durthang_change
			
			create_title_and_vassal_change = {
				type = granted
				save_scope_as = cirith_ungol_change
				add_claim_on_loss = yes
			}
			title:c_cirith_ungol = {
				change_title_holder = {
					holder = scope:candidate1
					change = scope:cirith_ungol_change
					take_baronies = yes
				}	
			}
			resolve_title_and_vassal_change = scope:cirith_ungol_change
			
		}
		
		scope:candidate1 = {
			get_title = title:d_watch_on_mordor
			set_primary_title_to = title:d_watch_on_mordor
		}
	}
	
	option = { # A relative
		name = gondor.4001.b
		custom_tooltip = event_gondor_4001_a
		
		hidden_effect = {
			title:c_morannon = {
				set_de_jure_liege_title = title:d_watch_on_mordor
			}
			title:c_cirith_ungol = {
				set_de_jure_liege_title = title:d_watch_on_mordor
			}
			title:c_durthang = {
				set_de_jure_liege_title = title:d_watch_on_mordor
			}
			
			create_title_and_vassal_change = {
				type = granted
				save_scope_as = morannon_change
				add_claim_on_loss = yes
			}
			title:c_morannon = {
				change_title_holder = {
					holder = scope:candidate2
					change = scope:morannon_change
					take_baronies = yes
				}	
			}
			resolve_title_and_vassal_change = scope:morannon_change
			
			create_title_and_vassal_change = {
				type = granted
				save_scope_as = durthang_change
				add_claim_on_loss = yes
			}
			title:c_durthang = {
				change_title_holder = {
					holder = scope:candidate2
					change = scope:durthang_change
					take_baronies = yes
				}	
			}
			resolve_title_and_vassal_change = scope:durthang_change
			
			create_title_and_vassal_change = {
				type = granted
				save_scope_as = cirith_ungol_change
				add_claim_on_loss = yes
			}
			title:c_cirith_ungol = {
				change_title_holder = {
					holder = scope:candidate2
					change = scope:cirith_ungol_change
					take_baronies = yes
				}	
			}
			resolve_title_and_vassal_change = scope:cirith_ungol_change
			
		}
		
		scope:candidate2 = {
			get_title = title:d_watch_on_mordor
			set_primary_title_to = title:d_watch_on_mordor
		}
	}
	
	option = { # A courtier
		name = gondor.4001.c
		custom_tooltip = event_gondor_4001_a
		
		hidden_effect = {

			title:c_morannon = {
				set_de_jure_liege_title = title:d_watch_on_mordor
			}
			title:c_cirith_ungol = {
				set_de_jure_liege_title = title:d_watch_on_mordor
			}
			title:c_durthang = {
				set_de_jure_liege_title = title:d_watch_on_mordor
			}
			
			create_title_and_vassal_change = {
				type = granted
				save_scope_as = morannon_change
				add_claim_on_loss = yes
			}
			title:c_morannon = {
				change_title_holder = {
					holder = scope:candidate3
					change = scope:morannon_change
					take_baronies = yes
				}	
			}
			resolve_title_and_vassal_change = scope:morannon_change
			
			create_title_and_vassal_change = {
				type = granted
				save_scope_as = durthang_change
				add_claim_on_loss = yes
			}
			title:c_durthang = {
				change_title_holder = {
					holder = scope:candidate3
					change = scope:durthang_change
					take_baronies = yes
				}	
			}
			resolve_title_and_vassal_change = scope:durthang_change
			
			create_title_and_vassal_change = {
				type = granted
				save_scope_as = cirith_ungol_change
				add_claim_on_loss = yes
			}
			title:c_cirith_ungol = {
				change_title_holder = {
					holder = scope:candidate3
					change = scope:cirith_ungol_change
					take_baronies = yes
				}	
			}
			resolve_title_and_vassal_change = scope:cirith_ungol_change
			
		}
		
		scope:candidate3 = {
			get_title = title:d_watch_on_mordor
			set_primary_title_to = title:d_watch_on_mordor
		}
	}
	
	option = { # I don't like any of these candidates
		name = gondor.4001.d
		custom_tooltip = event_gondor_4001_d
		if = {
			limit = {
				NOT = {
					has_character_flag = wanted_new_watch_candidates
				}
			}
			add_character_flag = wanted_new_watch_candidates
		}
		trigger_event = {
			id = gondor.4001
			days = 1
		}
	}
	
	option = { # I myself will command the Watch
		name = gondor.4001.e
		custom_tooltip = event_gondor_4001_a
		
		hidden_effect = {
			title:c_morannon = {
				set_de_jure_liege_title = title:d_watch_on_mordor
			}
			title:c_cirith_ungol = {
				set_de_jure_liege_title = title:d_watch_on_mordor
			}
			title:c_durthang = {
				set_de_jure_liege_title = title:d_watch_on_mordor
			}
		}
		get_title = title:d_watch_on_mordor
	}
}


gondor.4002 = { # Abandon the Watch on Mordor 
	content_source = realms_dlc
	type = character_event
	title = gondor.4002.t
	desc = gondor.4002.desc
	theme = stewardship
	left_portrait = {
		character = root
		animation = steward
	}
	right_portrait = {
		character = scope:watch_commander
		animation = marshal
	}
	
	immediate = {
		title:d_watch_on_mordor.holder = { save_scope_as = watch_commander }
		destroy_title = title:d_watch_on_mordor
		
		hidden_effect = { # Turn the titles held by the watch into Wilderness
			scope:watch_commander = {
				every_held_county = {
					make_settlement_county_wilderness = { COUNTY = this }
				}
			}
				
		}
		
		spawn_army = { #Get the watchmen as special soldiers
			uses_supply = no
			inheritable = yes
			name = mordor_watchmen
			men_at_arms = {
				type = gondorian_footmen
				stacks = 6
			}
			men_at_arms = {
				type = gondorian_bowmen
				stacks = 3
			}
			location = root.location
		}
	}
	
	option = { # I have a place at my court for you
		name = gondor.4002.a
		add_prestige = 50
		add_courtier = scope:watch_commander
	}
	
	option = { # Your watch has ended. Go in peace.
		name = gondor.4002.b
		scope:watch_commander = {
			add_prestige = 100
			add_gold = 50
		}
	}
}

