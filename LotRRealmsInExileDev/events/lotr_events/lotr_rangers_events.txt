namespace = rangers

# Events about Aragorn
#		rangers.0101	Dunedain Encampments of Eriador
#       rangers.0200	Death of Gilraen
#		rangers.0300	Defence of the Shire
#		rangers.0305	Defence of Bree

# Long Winter Start Date Events
#		rangers.0300	Growing Orc Activity
#		rangers.0301	Visiting Elrond
#		rangers.0302	Elrond hears rumours of Orcs
#		rangers.0303	Elrond receives Arassuil
#		rangers.0304	Elrond gives his counsel
#		rangers.0305	Return to the Angle of Mitheithel

# Arassuil: Lay a Trap
#		rangers.0306	Setting the Ambush
#		rangers.0316	Springing the trap
#		rangers.0326	The Ambush succeeds
#		rangers.0336	The Ambush fails

# Arassuil: Fight a Duel
#		rangers.0307	Decide to fight
#		rangers.0317	Travelling to Moria
#		rangers.0327	The Challenge
#		rangers.0337	The Duel
#		rangers.0347	(Hidden) Re-enable the initial decision
#		rangers.0357	(Hidden) Process single combat result
#		rangers.0367	Win the Duel
#		rangers.0377 	Duel invalidated
#		rangers.0387	Lose the Duel

# Arassuil: Start a War
#		rangers.0308	To Plan a War
#		rangers.0318	Another Meeting with Elrond
#		rangers.0328	The Men of Bree
#		rangers.0338	Arriving in Mithlond
#		rangers.0348	The Mansions of Stone
#		rangers.0358	Awaiting an Opportune Moment
#		rangers.0368	Declade the War
#		rangers.0378	Lose the War
#		rangers.0388	Win the War

# Eradan, Warden of Sarn Ford ~ Story Events
#		rangers.0400	Sarn Ford: A Chieftain's Summon
#		rangers.0401	Bree: Rumours from Fornost
#		rangers.0402	Fornost: Arrival
#		rangers.0403	Fornost: Goblins!
#		rangers.0404	Fornost: The Sewers
#		rangers.0405	Fornost: The Eagle
#		rangers.0406	Fornost: The Troll
#		rangers.0407	Fornost: The Sons of Elrond
#		rangers.0408	Fornost: Leader of the Orcs
#		rangers.0409	Fornost: A Dark Figure
#		rangers.0410	Fornost: The Aftermath
#		rangers.0411 	Sarn Ford: The Return
#		rangers.0412	Barrow-downs: Unnatural Fog
#		rangers.0413	Barrow-downs: Wights!
#		rangers.0414	Barrow-downs: Discover Athelas
#		rangers.0415	Barrow-downs: Looking for Clues
#		rangers.0416	Barrow-downs: Find Luin
#		rangers.0417	Barrow-downs: More Wights!
#		rangers.0418	Barrow-downs: Find Kilaran
#		rangers.0419	Barrow-downs: A Mysterious Stranger
#		rangers.0420	Barrow-downs: Mission Complete
#		rangers.0421	Rivendell: Arrival
#		rangers.0432	Gundabad: Arrival
#		rangers.0433	Gundabad: Assaulting the gate
#		rangers.0434	Gundabad: Into the Dark
#		rangers.0435	Gundabad: The Vast Goblin Lair
#		rangers.0436	Gundabad: Meet Gundri and Nordri
#		rangers.0437	Gundabad: The Forges
#		rangers.0438	Gundabad: Escaping the tunnels
#		rangers.0439	Gundabad: The Light of Day
#		rangers.0440	Nordinbad: Arrival

# Eradan: Talk to Locals Events
#		rangers.0701	Sarn Ford: Main
#		rangers.0702	Sarn Ford: Halbarad
#		rangers.0703	Sarn Ford: Lorniel
#		rangers.0711	Bree: Main
#		rangers.0712	Bree: Aragorn
#		rangers.0713	Bree: Barliman
#		rangers.0714	Bree: Local Smith
#		rangers.0721	Imladris: Main
#		rangers.0722	Imladris: Elrond 
#		rangers.0723	Imladris: Sons of Elrond 
#		rangers.0724	Imladris: Gandalf
#		rangers.0725	Imladris: Aragorn & Arwen
#		rangers.0731	Nordinbad: Main
#		rangers.0732	Nordinbad: Gorin
#		rangers.0733	Nordinbad: Nordri 
#		rangers.0734	Nordinbad: Gundri

# Thorondor Warden of Rhudaur Events
#		rangers.1000	Arassuil's summons
#		rangers.1001	Arassuil's orders
#		rangers.1002	Arrival in Cameth Brin
#		rangers.1003	Cameth Brin: Goblins
#		rangers.1004	Cameth Brin: Storages

### Aragorn Events ###

rangers.0101 = { # Dunedain Encampments - chance to swear fealty
	content_source = realms_dlc
	type = character_event
	immediate = {
		title:d_northern_dunedain.holder = { save_scope_as = dunedain_chieftain }
	}
	title = rangers.0101.t
	desc = rangers.0101.desc
	theme = stewardship_duty_focus
	left_portrait = {
		character = root
		animation = idle
	}

	right_portrait = {
		character = scope:dunedain_chieftain
		animation = idle
	}

	option = { # Heed the call of the chieftain!
		name = rangers.0101.a
		create_title_and_vassal_change = {
			type = swear_fealty
			save_scope_as = change
		}
		root = {
			change_liege = {
				liege = scope:dunedain_chieftain
				change = scope:change
			}
			add_opinion = {
				modifier = became_vassal
				target = scope:dunedain_chieftain
				opinion = 10
			}
		}
		resolve_title_and_vassal_change = scope:change

		ai_chance = {
			base = 0 # LotR: This should be tied to WotR mode.

			modifier = { # Game Rule
				has_game_rule = default_ai_behavior
				add = 100
			}

			modifier = { # Game Rule
				has_game_rule = weighted_ai_behavior
				add = 70
			}

			modifier = { # Game Rule
				has_game_rule = random_ai_behavior
				add = 50
			}
		}
	}
	option = { # We need to act on our own for now.
		name = rangers.0101.b
		ai_chance = {
			base = 0 # LotR: This should be tied to WotR mode.

			modifier = { # Game Rule
				has_game_rule = default_ai_behavior
				add = 0
			}

			modifier = { # Game Rule
				has_game_rule = weighted_ai_behavior
				add = 30
			}

			modifier = { # Game Rule
				has_game_rule = random_ai_behavior
				add = 50
			}
		}
	}
}

rangers.0200 = { # Death of Gilraen
	content_source = realms_dlc
	type = character_event
	title = rangers.0200.t
	desc = rangers.0200.desc
	theme = stewardship_duty_focus
	left_portrait = {
		character = character:lineisildur42
		animation = worry
	}
	right_portrait = {
		character = character:linegilraen1
		animation = dead
	}
	
	option = { # Farewell, Mother
		name = rangers.0200.a
		character:linegilraen1 = {
			death = { death_reason = death_natural_causes }
		}
	}
}

### General Ranger events ###
rangers.0250 = { # Defence of the Shire
	content_source = realms_dlc
	type = character_event
	title = rangers.0250.t
	desc = rangers.0250.desc
	theme = war
	override_background = { reference = market_hobbit }
	immediate = {
		title:k_shire.holder = { save_scope_as = shireholder }
	}
	left_portrait = {
		character = root
		animation = worry
	}
	right_portrait = {
		character = scope:shireholder
		animation = shock
	}
	
	option = { # It is my duty to intervene
		name = rangers.0250.a
		scope:shireholder = {
			every_character_war = {
				limit = { primary_defender = scope:shireholder }
				add_defender = root 
			}
		}
	}
	
	option = { # You're on your own 
		name = rangers.0250.b 
		add_prestige = medium_prestige_loss 
	}
}	

rangers.0255 = { # Defence of Bree
	content_source = realms_dlc
	type = character_event
	title = rangers.0255.t
	desc = rangers.0255.desc
	theme = war
	override_background = { reference = city_north }
	immediate = {
		title:c_bree.holder = { save_scope_as = breeholder }
	}
	left_portrait = {
		character = root
		animation = worry
	}
	right_portrait = {
		character = scope:breeholder
		animation = shock
	}
	
	option = { # It is my duty to intervene
		name = rangers.0255.a
		scope:breeholder = {
			every_character_war = {
				limit = { primary_defender = scope:breeholder }
				add_defender = root 
			}
		}
	}
	
	option = { # You're on your own 
		name = rangers.0255.b 
		add_prestige = medium_prestige_loss 
	}
}

### Long Winter Start Date Events ###

rangers.0300 = { # Growing Orc Activity
	content_source = realms_dlc
	type = character_event
	title = rangers.0300.t
	desc = rangers.0300.desc
	theme = dread
	window = visit_settlement_window
	cooldown = { years = 150 }
	override_background = { reference = wilderness_forest }
	left_portrait = {
		character = root
		animation = worry
	}
	right_portrait = {
		character = scope:azog
		animation = aggressive_sword
	}
	immediate = {
		title:c_durins_hall.holder.top_liege = { save_scope_as = azog }
		title:c_imladris.holder.top_liege = { trigger_event = rangers.0302 }
	}
	option = { # I shall seek the counsel of Elrond of Rivendell
		name = rangers.0300.a
		custom_tooltip = rangers.0300.a.tt
		add_character_flag = arassuil_seek_elronds_counsel
	}
	option = { # AI only, bypass the decision and go to war directly
		name = rangers.0300.b
		trigger = { is_ai = yes }
		trigger_event = rangers.0318 
		ai_chance = { base = 100 }
	}
}

rangers.0301 = { # Visit Elrond
	content_source = realms_dlc
	type = character_event
	title = rangers.0301.t
	desc = rangers.0301.desc
	theme = elven
	window = visit_settlement_window
	override_background = { reference = throne_room_rivendell }
	left_portrait = {
		character = root
		animation = throne_room_conversation_1
	}
	right_portrait = {
		character = scope:elrond
		animation = personality_rational
	}
	immediate = {
		title:c_imladris.holder.top_liege = { save_scope_as = elrond }
	}
	option = { # 
		name = rangers.0301.a
		add_stress = -10
		title:c_imladris.holder.top_liege = { trigger_event = rangers.0303 }
	}
}

rangers.0302 = { # Elrond hears rumours of Orcs
	content_source = realms_dlc
	type = character_event
	title = rangers.0302.t
	desc = rangers.0302.desc
	theme = diplomacy_foreign_affairs_focus
	override_background = { reference = throne_room_rivendell }
	trigger = { is_elf = yes }
	left_portrait = {
		character = root
		animation = reading
	}
	right_portrait = {
		character = scope:son_of_elrond
		animation = marshal
	}
	immediate = {
		root.primary_heir = { save_scope_as = son_of_elrond }
	}
	option = { # I will reach out to the Dúnedain
		name = rangers.0302.a
		custom_tooltip = rangers.0302.a.tt
	}
}

rangers.0303 = { # Elrond gives his counsel 
	content_source = realms_dlc
	type = character_event
	title = rangers.0303.t
	desc = rangers.0303.desc
	theme = friend_relation
	override_background = { reference = throne_room_rivendell }
	left_portrait = {
		character = root
		animation = throne_room_conversation_2
	}
	right_portrait = {
		character = scope:dunedain_chieftain
		animation = throne_room_two_handed_passive_1
	}
	immediate = {
		title:d_northern_dunedain.holder = { save_scope_as = dunedain_chieftain }
	}
	option = { # Set a trap for the Orc's leader
		name = rangers.0303.a
	}
	option = { # Strike at the heart of our enemy
		name = rangers.0303.b
		add_character_flag = elrond_strike_moria
	}
	after = {
		scope:dunedain_chieftain = { trigger_Event = rangers.0304 }
	}
}

rangers.0304 = { # Receive Elrond's counsel 
	content_source = realms_dlc
	type = character_event
	title = rangers.0304.t
	desc = {
		first_valid = {
			triggered_desc = {
				trigger = {
					scope:elrond = { has_character_flag = elrond_strike_moria }
				}
				desc = rangers.0304.desc.a
			}
			desc = rangers.0304.desc
		}
	}
	theme = friend_relation
	override_background = { reference = throne_room_rivendell }
	window = visit_settlement_window
	left_portrait = {
		character = root
		animation = throne_room_two_handed_passive_1
	}
	right_portrait = {
		character = scope:elrond
		animation = throne_room_conversation_2
	}
	immediate = {
	}
	option = { # I will consider your wisdom
		name = rangers.0304.a
		custom_tooltip = rangers.0304.a.tt 
	}
	after = {
		start_travel_plan = { #Travel home
			destination = root.capital_county.title_province
			on_arrival_event = rangers.0305
			return_trip = no
			players_use_planner = no
			on_arrival_destinations = all
		}
	}
}

rangers.0305 = { # Returning to the Angle
	content_source = realms_dlc
	type = character_event
	title = rangers.0305.t
	desc = rangers.0305.desc
	theme = martial_chivalry_focus
	window = visit_settlement_window
	override_background = { reference = wilderness_forest_deep }
	left_portrait = {
		character = root
		animation = inspect_weapon
	}
	immediate = { title:c_durins_hall.holder.top_liege = { save_scope_as = azog } }
	option = { # I must end this threat to Eriador. It is my duty.
		name = rangers.0305.a
		custom_tooltip = rangers.0305.a.tt
		add_character_flag = arassuil_dealing_with_azog
	}
}

rangers.0306 = { # Lay a Trap
	content_source = realms_dlc
	type = character_event
	title = rangers.0306.t
	desc = rangers.0306.desc
	theme = intrigue
	window = visit_settlement_window
	override_background = { reference = wilderness_forest_deep }
	left_portrait = {
		character = root
		scripted_animation = bow_drawn
	}
	immediate = { 
		title:c_durins_hall.holder.top_liege = { save_scope_as = azog }
	}
	option = { # I will lay a trap for him
		name = rangers.0306.a
		custom_tooltip = rangers.0306.a.tt
		add_prestige = minor_prestige_gain
		start_travel_plan = { #Travel to the caravan
			destination = title:c_talath_formir.title_province
			on_arrival_event = rangers.0316
			#return_trip = no
			players_use_planner = no
			#on_arrival_destinations = all
		}
	}
}

rangers.0316 = { # The Ambush
	content_source = realms_dlc
	type = character_event
	title = rangers.0316.t
	desc = rangers.0316.desc
	theme = dread
	window = visit_settlement_window
	override_background = { reference = eregion_ruins }
	left_portrait = {
		character = root
		animation = sword_coup_degrace
	}
	right_portrait = {
		character = scope:azog
		animation = rage
	}
	option = { # I'll end this here and now
		name = rangers.0316.a
		duel = {
 			skill = intrigue
 			target = scope:azog
 			50 = {
				# You're successful
 				desc = rangers.0316.a.success
 				compare_modifier = {
 					value = scope:duel_value
 					multiplier = 3.5
 					min = -49
 				}
 				send_interface_toast = {
 					title = rangers.0316.a.success
 					left_icon = root
 					right_icon = scope:azog
					custom_tooltip = rangers.0316.a.success.tt
 				}
				add_intrigue_lifestyle_xp = medium_lifestyle_xp
				scope:azog = { death = { death_reason = death_assassination killer = root } }
				trigger_event = rangers.0326
 			}
 			50 = {
 				# You failed
 				desc = rangers.0316.a.failure
 				compare_modifier = {
 					value = scope:duel_value
 					multiplier = -3.5
 					min = -49
 				}
 				send_interface_toast = {
 					title = rangers.0316.a.failure
 					left_icon = root
 					right_icon = scope:azog
					custom_tooltip = rangers.0316.a.failure.tt
 				}
				increase_wounds_effect = { REASON = fight }
				trigger_event = rangers.0336
 			}
		}
	}
}

rangers.0326 = { # Success
	content_source = realms_dlc
	type = character_event
	title = rangers.0326.t
	desc = rangers.0326.desc
	theme = crown
	window = visit_settlement_window
	override_background = { reference = wilderness_forest_pine }
	left_portrait = {
		character = root
		animation = celebrate_spear
	}
	right_portrait = {
		character = scope:azog
		animation = dead
	}
	immediate = { # Azog's realm splinters
		if = {
			limit = {
				scope:azog = { is_alive = yes }
			}
			scope:azog = {
				death = {
					death_reason = death_assassination
					killer = root 
				}
			}
		}
		else = {
			show_as_tooltip = {
				scope:azog = {
					death = {
						death_reason = death_assassination
						killer = root 
					}
				}
			}
		}
		title:c_durins_hall.holder.top_liege = { save_scope_as = heir_of_azog }
		create_title_and_vassal_change = {
			type = conquest
			save_scope_as = change
			add_claim_on_loss = yes
		}
		scope:heir_of_azog = {
			every_held_title = {
				limit = { tier >= tier_kingdom }
				save_temporary_scope_as = azog_title
				scope:heir_of_azog = { destroy_title = scope:azog_title }
			}
			every_vassal_or_below = {
				limit = { highest_held_title_tier >= tier_county }
				becomes_independent = { change = scope:change }
				trigger_event = orcs.7204
			}
		}
		resolve_title_and_vassal_change = scope:change
	}
	option = { # Good riddance!
		name = rangers.0326.a 
		custom_tooltip = rangers.0326.a.tt 
		add_prestige = massive_prestige_gain
		give_nickname = nick_the_ambusher
		add_character_flag = had_nickname_event
	}
	option = { # Let's go home.
		name = rangers.0326.b 
		custom_tooltip = rangers.0326.b.tt 
		add_prestige = massive_prestige_gain
	}
}

rangers.0336 = { # Ambush fails
	content_source = realms_dlc
	type = character_event
	title = rangers.0336.t
	desc = rangers.0336.desc
	theme = dread
	window = visit_settlement_window
	override_background = { reference = eregion_ruins }
	left_portrait = {
		character = root
		animation = anger
	}
	right_portrait = {
		character = scope:azog
		animation = schadenfreude
	}
	option = { # We have to get out of here.
		name = rangers.0336.a 
		custom_tooltip = rangers.0336.a.tt 
		start_travel_plan = { #Travel home
			destination = root.capital_county.title_province
			#return_trip = no
			players_use_planner = no
			#on_arrival_destinations = all
			on_arrival_event = rangers.0347
		}
	}
}

rangers.0307 = { # Fight a duel
	content_source = realms_dlc
	type = character_event
	title = rangers.0307.t
	desc = rangers.0307.desc
	theme = dread
	window = visit_settlement_window
	override_background = { reference = wilderness_forest }
	left_portrait = {
		character = root
		animation = aggressive_sword
	}
	lower_right_portrait = { character = scope:knight1 }
	lower_center_portrait = { character = scope:knight2 }
	lower_left_portrait = { character = scope:knight3 }	
	immediate = { 
		title:c_durins_hall.holder.top_liege = { save_scope_as = azog }
		random_knight = { 
			limit = { is_ai = yes }
			save_scope_as = knight1 
		}
		random_knight = {
			limit = { 
				NOT = { this = scope:knight1 } 
				is_ai = yes
			}
			save_scope_as = knight2
		}
		random_knight = {
			limit = { 
				NOT = { this = scope:knight1 }
				NOT = { this = scope:knight2 }
				is_ai = yes
			}
			save_scope_as = knight3
		}
	}
	option = { # I will end this here and now
		name = rangers.0307.a
		custom_tooltip = rangers.0307.a.tt
		add_prestige = 50
		start_travel_plan = { #Travel to the west gate
			destination = title:c_west_hall.title_province
			on_arrival_event = rangers.0317
			# return_trip = no
			players_use_planner = no
			# on_arrival_destinations = all
		}
	}
	after = {
		current_travel_plan = { 
			add_companion = scope:knight1
			add_companion = scope:knight2
			add_companion = scope:knight3
		}
	}
}

rangers.0317 = { # Travelling to Moria
	content_source = realms_dlc
	type = character_event
	title = rangers.0317.t
	desc = rangers.0317.desc
	theme = dread
	window = visit_settlement_window
	override_background = { reference = durins_door }
	override_effect_2d = { reference = rain	}
	left_portrait = {
		character = root
		animation = personality_callous
	}
	right_portrait = {
		character = scope:caravan_master
		animation = worry
	}
	immediate = { 
		if = {
			limit = { employs_court_position = travel_leader_court_position }
			current_travel_plan.travel_leader = { save_scope_as = caravan_master }
		}
		else = {
			create_character = {
				template = foreign_architect_template
				employer = root
				save_scope_as = caravan_master
			}
			appoint_court_position = {
				recipient = scope:caravan_master
				court_position = travel_leader_court_position
			}
		}
	}
	option = { # Are you afraid of water now?
		name = rangers.0317.a
		custom_tooltip = rangers.0317.a.tt
		hidden_effect = {
			duel = {
				skill = prowess
				value = high_skill_rating
				60 = { # You beat back the Watcher
					compare_modifier = {
						value = scope:duel_value
						multiplier = 3.5
						min = -49
					}
					min = 10
					send_interface_toast = {
						title = rangers.0317.a.tt.success
						add_prestige = medium_prestige_value
					}
				}
				40 = {
					compare_modifier = {
						value = scope:duel_value
						multiplier = -3.5
						min = -49
					}
					min = 5
					random_list = {
						85 = {
							send_interface_toast = {
								title = rangers.0317.a.tt.failure
								add_stress = medium_stress_gain
								increase_wounds_effect = { REASON = maimed_by_wild_beast }
							}
						}
						15 = {
							send_interface_toast = {
								title = rangers.0317.a.tt.failure_critical
								death = { death_reason = death_drowned }
							}
						}
					}
				}
			}
		}
	}
	
	option = { # Do not stir up the water.
		name = rangers.0317.b 
		custom_tooltip = rangers.0317.b.tt 
		current_travel_plan = { 
			delay_travel_plan = {
				days = 25
			}
		}
	}
	
	after = {
		trigger_event = rangers.0327 # The Challenge
	}
}

rangers.0327 = { # The Challenge
	content_source = realms_dlc
	type = character_event
	title = rangers.0327.t
	desc = rangers.0327.desc
	theme = intrigue
	window = visit_settlement_window
	override_background = { reference = mining_activity }
	left_portrait = {
		character = root
		animation = celebrate_spear
	}
	lower_center_portrait = { character = scope:azog }
	option = { # Come forth, Azog! Come forth, and face me!
		name = rangers.0327.a
		custom_tooltip = rangers.0327.a.tt
		scope:azog = { trigger_event = orcs.7202 } #Azog reacts 
	}
}

rangers.0337 = { # The Duel
	content_source = realms_dlc
	type = character_event
	title = rangers.0337.t
	desc = rangers.0337.desc
	theme = battle
	window = visit_settlement_window
	override_background = { reference = throne_room_dwarf }
	left_portrait = {
		character = root
		animation = aggressive_spear
	}
	right_portrait = {
		character = scope:azog
		animation = menacing
	}
	immediate = { 
		title:c_durins_hall.holder.top_liege = { save_scope_as = azog } 
		random_knight = {
			limit = { is_travel_entourage_character = yes }
			save_scope_as = chosen_knight1
		}
		random_knight = {
			limit = { 
				is_travel_entourage_character = yes 
				NOT = { this = scope:chosen_knight1 }
			}
			save_scope_as = chosen_knight2
		}
	}
	option = { # Fight the duel yourself 
		name = rangers.0337.a
		custom_tooltip = rangers.0337.a.tt
		# trigger = {
			# can_start_single_combat_trigger = yes
		# }
		configure_start_single_combat_effect = {
			SC_INITIATOR = root
			SC_ATTACKER = root
			SC_DEFENDER = scope:azog
			FATALITY = always
			FIXED = no
			LOCALE = wilderness_scope
			OUTPUT_EVENT = rangers.0357
			INVALIDATION_EVENT = rangers.0377
		}
	}
	
	# option = { # Send a knight to fight (1)
		# name = rangers.0337.b
		# trigger = {
			# exists = scope:chosen_knight1
			# #scope:knight1 = { can_start_single_combat_trigger = yes }
		# }
		# custom_tooltip = rangers.0337.b.tt
		# configure_start_single_combat_effect = {
			# SC_INITIATOR = root
			# SC_ATTACKER = scope:chosen_knight1
			# SC_DEFENDER = scope:azog
			# FATALITY = always
			# FIXED = no
			# LOCALE = wilderness_scope
			# OUTPUT_EVENT = rangers.0357
			# INVALIDATION_EVENT = rangers.0377
		# }
	# }
	
	# option = { # Send a knight to fight (2)
		# name = rangers.0337.c
		# trigger = {
			# exists = scope:chosen_knight2
			# #scope:knight2 = { can_start_single_combat_trigger = yes }
		# }
		# custom_tooltip = rangers.0337.c.tt
		# configure_start_single_combat_effect = {
			# SC_INITIATOR = root
			# SC_ATTACKER = scope:chosen_knight1
			# SC_DEFENDER = scope:azog
			# FATALITY = always
			# FIXED = no
			# LOCALE = wilderness_scope
			# OUTPUT_EVENT = rangers.0357
			# INVALIDATION_EVENT = rangers.0377
		# }
	# }
}

rangers.0357 = { # Single combat result
	hidden = yes
	immediate = {
		if = {
			limit = { scope:sc_victor = scope:azog }
			scope:azog = { 
				trigger_event = {
					id = orcs.7203
					days = 1
				}
			}
		}
		else_if = {
			limit = { 
				OR = {
					scope:sc_victor = root
					scope:sc_victor = scope:chosen_knight1
					scope:sc_victor = scope:chosen_knight2
				}
			}
			trigger_event = {
				id = rangers.0367
				days = 1 
			}
		}
	}
}

rangers.0367 = { # Win the duel
	content_source = realms_dlc
	type = character_event
	title = rangers.0367.t
	desc = rangers.0367.desc
	theme = crown
	window = visit_settlement_window
	override_background = { reference = wilderness_underground }
	left_portrait = {
		character = scope:sc_victor
		animation = celebrate_sword
	}
	right_portrait = {
		character = scope:azog
		animation = shock
	}
	immediate = {
		if = {
			limit = {
				scope:azog = { is_alive = yes }
			}
			scope:azog = {
				death = {
					death_reason = death_duel
					killer = root 
				}
			}
		}
		else = {
			show_as_tooltip = {
				scope:azog = {
					death = {
						death_reason = death_duel
						killer = root 
					}
				}
			}
		}
		title:c_durins_hall.holder.top_liege = { save_scope_as = heir_of_azog }
		create_title_and_vassal_change = {
			type = conquest
			save_scope_as = change
			add_claim_on_loss = yes
		}
		scope:heir_of_azog = {
			every_held_title = {
				limit = { tier >= tier_kingdom }
				save_temporary_scope_as = azog_title
				scope:heir_of_azog = { destroy_title = scope:azog_title }
			}
			every_vassal_or_below = {
				limit = { highest_held_title_tier >= tier_county }
				becomes_independent = { change = scope:change }
				trigger_event = orcs.7204
			}
		}
		resolve_title_and_vassal_change = scope:change
	}
	option = { # Good riddance!
		name = rangers.0367.a 
		custom_tooltip = rangers.0367.a.tt 
		add_prestige = massive_prestige_gain
		give_nickname = nick_orcslayer
		add_character_flag = had_nickname_event
	}
	option = { # Let's go home.
		name = rangers.0367.b 
		custom_tooltip = rangers.0367.b.tt 
		add_prestige = massive_prestige_gain
	}
	after = {
		start_travel_plan = { #Travel home
			destination = root.capital_county.title_province
			return_trip = no
			players_use_planner = no
			on_arrival_destinations = all
		}
	}
}

rangers.0377 = { # Duel invalidated (Azog flees)
	content_source = realms_dlc
	type = character_event
	title = rangers.0377.t
	desc = rangers.0377.desc
	theme = dread
	window = visit_settlement_window
	override_background = { reference = wilderness_underground }
	left_portrait = {
		character = scope:sc_victor
		animation = anger
	}
	right_portrait = {
		character = scope:azog
		animation = schadenfreude
	}
	option = { # We have to get out of here.
		name = rangers.0377.a 
		custom_tooltip = rangers.0377.a.tt 
		start_travel_plan = { #Travel home
			destination = root.capital_county.title_province
			#return_trip = no
			players_use_planner = no
			#on_arrival_destinations = all
			on_arrival_event = rangers.0347
		}
	}
}

rangers.0387 = { # Lose the Duel
	content_source = realms_dlc
	type = character_event
	title = rangers.0387.t
	desc = rangers.0387.desc
	theme = dread
	window = visit_settlement_window
	override_background = { reference = throne_room_dwarf }
	left_portrait = {
		character = root
		animation = rage
	}
	right_portrait = {
		character = scope:azog
		animation = schadenfreude
	}
	immediate = { title:c_durins_hall.holder.top_liege = { save_scope_as = azog } }
	option = { # I will avenge my father
		name = rangers.0387.a 
		custom_tooltip = rangers.0387.a.tt 
		set_relation_rival = { target = scope:azog }
		trigger_event = rangers.0347
	}
}

rangers.0347 = { # Re-enable Orc decision
	hidden = yes
	immediate = {
		remove_list_global_variable = {
			name = unavailable_unique_decisions
   			target = flag:arassuil_dealing_with_azog
		}
		add_character_flag = arassuil_dealing_with_azog
		current_travel_plan ?= { abort_travel_plan = yes }
	}
}

rangers.0308 = { # To Plan a War
	content_source = realms_dlc
	type = character_event
	title = rangers.0308.t
	desc = rangers.0308.desc
	theme = war
	window = visit_settlement_window
	override_background = { reference = wilderness_forest_pine }
	left_portrait = {
		character = root
		animation = celebrate_sword
	}
	immediate = { title:c_durins_hall.holder.top_liege = { save_scope_as = azog } }
	option = { # I will end this here and now
		name = rangers.0308.a
		custom_tooltip = rangers.0308.a.tt
		add_prestige = 50
		start_travel_plan = { #Travel to Rivendell
			destination = title:c_imladris.title_province
			#return_trip = no
			players_use_planner = no
			#on_arrival_destinations = all
			on_arrival_event = rangers.0318
		}
	}
}

rangers.0318 = { # Meet Elrond again, get dwarven allies
	content_source = realms_dlc
	type = character_event
	title = rangers.0318.t
	desc = rangers.0318.desc
	theme = alliance
	window = visit_settlement_window
	override_background = { reference = throne_room_rivendell }
	left_portrait = {
		character = root
		animation = personality_rational
	}
	center_portrait = {
		character = scope:elrond
		animation = personality_greedy
	}
	right_portrait = {
		character = scope:brogur
		animation = interested
	}
	immediate = { 
		title:c_imladris.holder.top_liege = { save_scope_as = elrond }
		create_character = {
			template = random_dwarf_template
			employer = scope:elrond
			dynasty = generate
			culture = culture:iron_hills
			faith = faith:faith_khazad
			name = Brogur
			age = 100
			save_scope_as = brogur
		}
	}
	option = { # That's wonderful news!
		name = rangers.0318.a 
		custom_tooltip = rangers.0318.a.tt 
		if = {
			limit = {
				scope:elrond = { NOT = { is_allied_to = root } }
			}
			create_alliance = {
				target = scope:elrond
				allied_through_owner = root
				allied_through_target = scope:elrond
			}
			scope:elrond = {
				add_opinion = {
					modifier = perk_negotiated_alliance_opinion
					target = root
				}
			}
		}
		add_courtier = scope:brogur
	}
	after = {
		start_travel_plan = { #Travel to Bree
			destination = title:c_bree.title_province
			#return_trip = no
			players_use_planner = no
			#on_arrival_destinations = all
			on_arrival_event = rangers.0328
		}
	}
}

rangers.0328 = { # Go to Bree
	content_source = realms_dlc
	type = character_event
	title = rangers.0328.t
	desc = rangers.0328.desc
	theme = diplomacy_foreign_affairs_focus
	window = visit_settlement_window
	override_background = { reference = market_west }
	left_portrait = {
		character = root
		animation = throne_room_conversation_1
	}
	right_portrait = {
		character = scope:breemayor
		animation = personality_rational
	}
	immediate = { title:c_bree.holder = { save_scope_as = breemayor } }
	option = { # Join me for your own safety!
		name = rangers.0328.a
		duel = {
 			skill = diplomacy
 			target = scope:breemayor
 			50 = {
				# You're successful
 				desc = rangers.0328.a.success
 				compare_modifier = {
 					value = scope:duel_value
 					multiplier = 3.5
 					min = -49
 				}
 				send_interface_toast = {
 					title = rangers.0328.a.success
 					left_icon = root
 					right_icon = scope:breemayor
					custom_tooltip = rangers.0328.a.success.tt
 				}
				add_diplomacy_lifestyle_xp = medium_lifestyle_xp
				add_gold = 250
 			}
 			50 = {
 				# You failed
 				desc = rangers.0328.a.failure
 				compare_modifier = {
 					value = scope:duel_value
 					multiplier = -3.5
 					min = -49
 				}
 				send_interface_toast = {
 					title = rangers.0328.a.failure
 					left_icon = root
 					right_icon = scope:breemayor
					custom_tooltip = rangers.0328.a.failure.tt
 				}
				scope:breemayor = {
					add_opinion = {
						modifier = insulted_opinion
						opinion = -30
						target = root
					}
				}
 			}
		}
	}
	after = {
		start_travel_plan = { #Travel to Mithlond
			destination = title:c_mithrhulond.title_province
			#return_trip = no
			players_use_planner = no
			#on_arrival_destinations = all
			on_arrival_event = rangers.0338
		}
	}
}

rangers.0338 = { # Go to Mithlond
	content_source = realms_dlc
	type = character_event
	title = rangers.0338.t
	desc = rangers.0338.desc
	theme = elven
	window = visit_settlement_window
	override_background = { reference = throne_room_noldor }
	left_portrait = {
		character = root
		animation = throne_room_conversation_1
	}
	right_portrait = {
		character = scope:cirdan
		animation = throne_room_conversation_2
	}
	immediate = { title:c_mithrhulond.holder.top_liege = { save_scope_as = cirdan } } 
	option = { # Return home
		name = rangers.0338.a 
		custom_tooltip = rangers.0338.a.tt 
		ai_chance = { base = 100 } # AI doesn't make the detour
		start_travel_plan = { #Travel home
			destination = root.capital_county.title_province
			#return_trip = no
			players_use_planner = no
			#on_arrival_destinations = all
			on_arrival_event = rangers.0358
		}
	}
	option = { # Go to Thorin's Halls
		name = rangers.0338.b 
		custom_tooltip = rangers.0338.b.tt
		start_travel_plan = { #Travel to the Dwarves
			destination = title:c_ursel_zabad.title_province
			#return_trip = no
			players_use_planner = no
			#on_arrival_destinations = all
			on_arrival_event = rangers.0348
		}
	}
}

rangers.0348 = { # Go to Thorin's Hall
	content_source = realms_dlc
	type = character_event
	title = rangers.0348.t
	desc = rangers.0348.desc
	theme = realm
	window = visit_settlement_window
	override_background = { reference = throne_room_dwarf }
	left_portrait = {
		character = root
		animation = throne_room_conversation_1
	}
	right_portrait = {
		character = scope:thorinshalldwarf
		animation = personality_greedy
	}
	immediate = { title:c_ursel_zabad.holder.top_liege = { save_scope_as = thorinshalldwarf } } 
	option = { # Secure alliance
		name = rangers.0348.a 
		custom_tooltip = rangers.0348.a.tt 
		create_alliance = {
			target = scope:thorinshalldwarf
			allied_through_owner = root
			allied_through_target = scope:thorinshalldwarf
		}
		scope:thorinshalldwarf = {
			add_opinion = {
				modifier = perk_negotiated_alliance_opinion
				target = root
			}
		}
		start_travel_plan = { #Travel home
			destination = root.capital_county.title_province
			#return_trip = no
			players_use_planner = no
			#on_arrival_destinations = all
			on_arrival_event = rangers.0358
		}
	}
}

rangers.0358 = { # Arrive back home
	content_source = realms_dlc
	type = character_event
	title = rangers.0358.t
	desc = rangers.0358.desc
	theme = war
	window = visit_settlement_window
	override_background = { reference = wilderness_forest_deep }
	left_portrait = {
		character = root
		animation = personality_bold
	}
	right_portrait = {
		character = scope:brogur
		animation = marshal_shield
	}
	immediate = {
		hidden_effect = {
			current_travel_plan ?= { abort_travel_plan = yes }
			if = {
				limit = {
					NOT = { exists = title:k_khazad_dum.holder }
					title:c_durins_hall.holder.top_liege = {
						is_ai = yes 
						NOT = { has_title = title:k_wastelands }
					}
				}
				title:c_durins_hall.holder.top_liege = {
					get_title = title:k_khazad_dum 
				}
			}
		}
	}
	option = { # We will march to war as soon as all is ready
		name = rangers.0358.a 
		custom_tooltip = rangers.0358.a.tt 
		spawn_army = {
			uses_supply = no
			inheritable = yes
			name = elven_volunteers
			men_at_arms = {
				type = high_elven_pikemen
				stacks = 3
			}
			men_at_arms = {
				type = high_elven_archers
				stacks = 3
			}
			men_at_arms = {
				type = high_elven_heavy_cavalry
				stacks = 1
			}
			location = root.location
		}
		spawn_army = {
			uses_supply = no
			inheritable = yes
			name = dwarven_volunteers
			men_at_arms = {
				type = longbeard_heavy_infantry
				stacks = 3
			}
			men_at_arms = {
				type = longbeard_skirmishers
				stacks = 3
			}
			men_at_arms = {
				type = longbeard_pikemen
				stacks = 3
			}
			location = root.location
		}
		add_character_flag = arassuil_purge_moria
	}	
}

rangers.0368 = { # Declare the War
	content_source = realms_dlc
	type = character_event
	title = rangers.0368.t
	desc = rangers.0368.desc
	theme = war
	window = visit_settlement_window
	trigger = { 
		OR = {
			title:c_durins_hall.holder.top_liege = { is_ai = no }
			root = { is_ai = no }
		}
	}
	override_background = { reference = eregion }
	left_portrait = {
		character = root
		animation = throne_room_two_handed_passive_1
	}
	immediate = { title:c_durins_hall.holder.top_liege = { save_scope_as = azog } }
	option = { # The time has come 
		name = rangers.0368.a
		start_war = {
			casus_belli = purge_moria_arassuil_cb
			target = scope:azog
		}
	}
}

rangers.0388 = { # Win the war
	content_source = realms_dlc
	type = character_event
	title = rangers.0388.t
	desc = rangers.0388.desc
	theme = crown
	window = visit_settlement_window
	override_background = { reference = throne_room_dwarf }
	left_portrait = {
		character = root
		animation = celebrate_spear
	}
	right_portrait = {
		character = scope:azog
		animation = shock
	}
	immediate = {
		title:c_durins_hall.holder.top_liege = { save_scope_as = azog }
		hidden_effect = {
			title:d_zirakzigil = { 
				every_in_de_jure_hierarchy = {
					limit = { 
						#this.title_province = { has_holding_type = dwarven_holding } 
						tier = tier_county
						holder = { faith_is_evil = yes } # don't kick out any dwarves
					}
					make_settlement_county_wilderness = { COUNTY = this }
				}
			}
			title:d_barazinbar = { 
				every_in_de_jure_hierarchy = {
					limit = { 
						#this.title_province = { has_holding_type = dwarven_holding } 
						tier = tier_county
						holder = { faith_is_evil = yes } # don't kick out any dwarves
					}
					make_settlement_county_wilderness = { COUNTY = this }
				}
			}
			title:d_bundushathur = { 
				every_in_de_jure_hierarchy = {
					limit = { 
						#this.title_province = { has_holding_type = dwarven_holding } 
						tier = tier_county
						holder = { faith_is_evil = yes } # don't kick out any dwarves
					}
					make_settlement_county_wilderness = { COUNTY = this }
				}
			}
		}
		remove_character_flag = arassuil_purge_moria 
		scope:azog = { death = { death_reason = death_execution killer = root } }
	}
	option = { # We did it!
		name = rangers.0388.a 
		give_nickname = nick_moria_purger
		add_prestige = massive_prestige_gain
		add_character_flag = had_nickname_event
	}
	option = { # We did it!
		name = rangers.0388.b 
		add_prestige = massive_prestige_gain
		add_legitimacy = medium_legitimacy_gain
	}
}

rangers.0378 = { # Lose the war
	content_source = realms_dlc
	type = character_event
	title = rangers.0378.t
	desc = rangers.0378.desc
	theme = mental_break
	window = visit_settlement_window
	override_background = { reference = throne_room_dwarf }
	left_portrait = {
		character = root
		animation = shock
	}
	right_portrait = {
		character = scope:azog
		animation = celebrate_sword
	}
	immediate = {
		remove_list_global_variable = {
			name = unavailable_unique_decisions
   			target = flag:arassuil_dealing_with_azog
		}
		remove_character_flag = arassuil_purge_moria
	}
	option = { # How could this happen?
		name = rangers.0378.a 
		custom_tooltip = rangers.0378.a.tt
		add_prestige = massive_prestige_loss
	}
}

### Eradan, Andriel, and Farin events ###

rangers.0400 = { # Sarn Ford: A Chieftain's Summon
	content_source = realms_dlc
	type = character_event
	title = rangers.0400.t
	desc = rangers.0400.desc
	theme = diplomacy_foreign_affairs_focus
	#window = visit_settlement_window
	override_background = { reference = wilderness_forest }
	left_portrait = {
		character = root
		animation = throne_room_conversation_1
	}
	right_portrait = {
		character = scope:halbarad
		animation = throne_room_one_handed_passive_1
	}
	lower_left_portrait = { character = scope:farin }
	lower_right_portrait = { character = scope:andriel }
	immediate = { 
		character:linehalbarad9 = { save_scope_as = halbarad } 
		character:lineofandriel = { save_scope_as = andriel } 
		character:lineofnorin2 = { save_scope_as = farin }
		add_character_flag = is_eradan_wotn
		add_character_modifier = eradan_experienced_traveler
	}
	option = { # We leave at once.
		name = rangers.0400.a
		custom_tooltip = rangers.0400.a.tt
		scope:andriel = { add_character_flag = is_eradan_companion }
		scope:farin = { add_character_flag = is_eradan_companion }
		start_travel_plan = { #Travel to Bree
			destination = title:c_bree.title_province
			players_use_planner = no
			on_arrival_event = rangers.0401
		}
	}
	option = { # I still need time to prepare.
		name = rangers.0400.b
		custom_tooltip = rangers.0400.b.tt
		add_character_flag = eradan_delay_bree
		scope:andriel = { add_character_flag = is_eradan_companion }
		scope:farin = { add_character_flag = is_eradan_companion }
	}
	option = { # AI doesn't do the event chain
		name = rangers.0400.c
		trigger = { is_ai = yes }
		add_prestige = miniscule_prestige_gain
		ai_chance = {
			base = 100 
		}
	}
}

rangers.0401 = { # Bree: Rumours from Fornost
	content_source = realms_dlc
	type = character_event
	title = rangers.0401.t
	desc = rangers.0401.desc
	theme = laamp
	window = visit_settlement_window
	override_background = { reference = daen_tavern }
	center_portrait = {
		character = root
		animation = marshal
	}
	left_portrait = {
		character = scope:andriel
		animation = writing
	}
	right_portrait = {
		character = scope:aragorn
		animation = debating
	}
	lower_left_portrait = {
		character = scope:farin
	}
	immediate = { 
		character:lineisildur42 = { save_scope_as = aragorn } 
		character:lineofandriel = { save_scope_as = andriel } 
		character:lineofnorin2 = { save_scope_as = farin }
		remove_character_flag = eradan_locals_sarnford
		hidden_effect = { add_contact = scope:aragorn }
		domicile ?= { 
			change_provisions = miniscule_provisions_gain 
			move_domicile = title:c_bree.title_province
		}
		hidden_effect = {
			current_travel_plan ?= { abort_travel_plan = yes }
		}
	}
	option = { # Acknowledge & create the custom contract
		name = rangers.0401.a
		custom_tooltip = rangers.0401.a.tt
		hidden_effect = {
			root = {
				create_task_contract = {
					task_contract_type = lotr_eradan_contract_fornost
					task_contract_employer = scope:aragorn
					location = title:c_rhunlest.title_province
					task_contract_tier = 4
					save_scope_as = created_contract
				}
			}
		}
		add_character_flag = eradan_locals_bree
		add_character_flag = eradan_ready_for_rhunlest
		custom_tooltip = eradan_safe_locations_tt
	}
}

rangers.0402 = { # Fornost: Arrival
	content_source = realms_dlc
	type = character_event
	title = rangers.0402.t
	desc = rangers.0402.desc
	theme = hunt_activity
	window = visit_settlement_window
	override_background = { reference = fornost }
	left_portrait = {
		character = scope:andriel
		animation = survey_staff
	}
	center_portrait = {
		character = root
		animation = marshal
	}
	right_portrait = {
		character = scope:farin
		animation = aggressive_longaxe
		camera = camera_event_left
		triggered_outfit = {
			outfit_tags = { dwarf_war_steel_outfit }
		}
	}
	immediate = { 
		character:lineofandriel = { save_scope_as = andriel } 
		character:lineofnorin2 = { save_scope_as = farin }
		remove_character_flag = eradan_locals_bree
		remove_character_flag = eradan_ready_for_rhunlest
		domicile ?= { 
			change_provisions = miniscule_provisions_gain 
			move_domicile = title:c_rhunlest.title_province
		}
		hidden_effect = {
			current_travel_plan ?= { abort_travel_plan = yes }
		}
		if = { 
			limit = { has_character_flag = spoken_with_aragorn }
			remove_character_flag = spoken_with_aragorn
		}
		if = { 
			limit = { has_character_flag = spoken_with_barliman }
			remove_character_flag = spoken_with_barliman
		}
		if = { 
			limit = { has_character_flag = spoken_with_smith}
			remove_character_flag = spoken_with_smith
		}
	}
	option = { # We're here, let's explore ...
		name = rangers.0402.a 
		add_prestige = miniscule_prestige_gain
		trigger_event = rangers.0403
	}
}

rangers.0403 = { # Fornost: Goblins!
	content_source = realms_dlc
	type = character_event
	title = rangers.0403.t
	desc = rangers.0403.desc
	theme = hunt_activity
	#window = visit_settlement_window
	override_background = { reference = fornost }
	left_portrait = {
		character = root
		scripted_animation = bow_drawn
	}
	right_portrait = {
		character = scope:fornost_goblin
		animation = aggressive_mace
	}
	lower_left_portrait = {
		character = scope:andriel
	}
	lower_right_portrait = {
		character = scope:farin
	}
	immediate = { 
		character:lineofandriel = { save_scope_as = andriel } 
		character:lineofnorin2 = { save_scope_as = farin }
		create_character = {
			template = new_warrior_character
			dynasty = generate
			location = root.location
			gender_female_chance = 0
			save_scope_as = fornost_goblin
			prowess = 14
			culture = culture:generic_goblin
			faith = faith:way_of_strength
			after_creation = {
				scope:fornost_goblin = {
					random_list = {
						1 = { give_nickname = nick_the_dreamer }
						1 = { give_nickname = nick_the_literate_one }
						1 = { give_nickname = nick_the_flogger }
						1 = { give_nickname = nick_the_disgusting }
						1 = { give_nickname = nick_the_angry }
						1 = { give_nickname = nick_the_stalker }
						1 = { give_nickname = nick_the_crafty }
						1 = { give_nickname = nick_the_funny_one }
						1 = { give_nickname = nick_the_filthy }
						1 = { give_nickname = nick_the_screamer }
						1 = { give_nickname = nick_the_bloated }
						1 = { give_nickname = nick_the_whiner }
					}
				}
			}
		}
	}
	option = { # Charge!
		name = rangers.0403.a 
		duel = {
 			skill = prowess
			value = high_skill_rating 
 			50 = {
				# You're successful
 				desc = rangers.0403.a.success
 				compare_modifier = {
 					value = scope:duel_value
 					multiplier = 3.5
 					min = -49
 				}
 				hidden_effect = { 
					send_interface_toast = {
						title = rangers.0403.a.success
						left_icon = root
						right_icon = scope:fornost_goblin
						custom_tooltip = rangers.0403.a.success
					}
				}
				add_prestige = minor_prestige_gain
				scope:fornost_goblin = { death = { death_reason = death_fight killer = root } }
 			}
 			50 = {
 				# You failed
 				desc = rangers.0403.a.failure
 				compare_modifier = {
 					value = scope:duel_value
 					multiplier = -3.5
 					min = -49
 				}
				hidden_effect = {
					send_interface_toast = {
						title = rangers.0403.a.failure
						left_icon = root
						right_icon = scope:fornost_goblin
						custom_tooltip = rangers.0403.a.failure
					}
				}
				increase_wounds_effect = { REASON = fight }
				hidden_effect = { scope:fornost_goblin = { silent_disappearance_effect = yes } }
 			}
		}
	}
	option = { # Shoot them!
		name = rangers.0403.b 
		custom_tooltip = rangers.0403.b.tt
		domicile = {
			change_provisions = minor_provisions_loss
		}
	}
	after = {
		trigger_event = rangers.0404 
	}
}

rangers.0404 = { # Fornost: The Sewers
	content_source = realms_dlc
	type = character_event
	title = rangers.0404.t
	desc = rangers.0404.desc
	theme = dread
	#window = visit_settlement_window
	override_background = { reference = ce1_catacombs }
	left_portrait = {
		character = root
		animation = survey
	}
	right_portrait = {
		character = scope:andriel
		animation = throne_room_one_handed_passive_1
		camera = camera_event_left
	}
	lower_center_portrait = {
		character = scope:farin
	}
	immediate = { 
		character:lineofandriel = { save_scope_as = andriel } 
		character:lineofnorin2 = { save_scope_as = farin }
	}
	option = { # Let Andriel find a way out
		name = rangers.0404.a
		scope:andriel = {
			duel = {
				skill = learning
				value = high_skill_rating 
				50 = {
					# You're successful
					desc = rangers.0404.a.success
					compare_modifier = {
						value = scope:duel_value
						multiplier = 3.5
						min = -49
					}
					hidden_effect = { 
						root = {
							send_interface_toast = {
								title = rangers.0404.a.success
								left_icon = root
								right_icon = scope:andriel
								custom_tooltip = rangers.0404.a.success
							}
						}
					}
					add_prestige = minor_prestige_gain
					root = { trigger_event = rangers.0405 }
				}
				50 = {
					# You failed
					desc = rangers.0404.a.failure
					compare_modifier = {
						value = scope:duel_value
						multiplier = -3.5
						min = -49
					}
					hidden_effect = {
						root = {
							send_interface_toast = {
								title = rangers.0404.a.failure
								left_icon = root
								right_icon = scope:andriel
								custom_tooltip = rangers.0404.a.failure
							}
						}
					}
					add_prestige = minor_prestige_loss
					root = { trigger_event = { id = rangers.0405 days = 10 } }
				}
			}
		}
	}
	option = { # Let Farin find a way out
		name = rangers.0404.b
		scope:farin = {
			duel = {
				skill = martial
				value = high_skill_rating 
				50 = {
					# You're successful
					desc = rangers.0404.b.success
					compare_modifier = {
						value = scope:duel_value
						multiplier = 3.5
						min = -49
					}
					hidden_effect = { 
						root = {
							send_interface_toast = {
								title = rangers.0404.b.success
								left_icon = root
								right_icon = scope:farin
								custom_tooltip = rangers.0404.b.success
							}
						}
					}
					add_prestige = minor_prestige_gain
					root = { trigger_event = rangers.0405 }
				}
				50 = {
					# You failed
					desc = rangers.0404.b.failure
					compare_modifier = {
						value = scope:duel_value
						multiplier = -3.5
						min = -49
					}
					hidden_effect = {
						root = {
							send_interface_toast = {
								title = rangers.0404.b.failure
								left_icon = root
								right_icon = scope:farin
								custom_tooltip = rangers.0404.b.failure
							}
						}
					}
					add_prestige = minor_prestige_loss
					root = { trigger_event = { id = rangers.0405 days = 10 } }
				}
			}
		}
	}
}

rangers.0405 = { # Fornost: The Eagle
	content_source = realms_dlc
	type = character_event
	title = rangers.0405.t
	desc = rangers.0405.desc
	theme = hunt_activity
	#window = visit_settlement_window
	override_background = { reference = market_dunedain }
	left_portrait = {
		character = root
		animation = interested
	}
	right_portrait = {
		character = scope:farin
		animation = personality_rational
		camera = camera_event_left
		triggered_outfit = {
			outfit_tags = { dwarf_war_steel_outfit }
		}
	}
	lower_center_portrait = {
		character = scope:andriel
	}
	immediate = { 
		character:lineofandriel = { save_scope_as = andriel } 
		character:lineofnorin2 = { save_scope_as = farin }
	}
	option = { # Well met, Belaram.
		name = rangers.0405.a
		add_stress = -10
	}
	after = {
		trigger_event = rangers.0406
	}
}

rangers.0406 = { # Fornost: The Troll
	content_source = realms_dlc
	type = character_event
	title = rangers.0406.t
	desc = rangers.0406.desc
	theme = martial
	#window = visit_settlement_window
	override_background = { reference = eagles }
	left_portrait = {
		character = root
		animation = aggressive_sword
	}
	right_portrait = {
		character = scope:fornost_troll
		animation = menacing
		camera = camera_body_left
	}
	lower_left_portrait = {
		character = scope:andriel
	}
	lower_right_portrait = {
		character = scope:farin
	}
	immediate = { 
		character:lineofandriel = { save_scope_as = andriel } 
		character:lineofnorin2 = { save_scope_as = farin }
		create_character = { # Create a new troll
			culture = culture:hill_troll
			faith = faith:way_of_strength
			prowess = 25
			gender_female_chance = 0
			location = root.location
			save_scope_as = fornost_troll
		}
	}
	option = { # We fight the troll!
		name = rangers.0406.a
		add_stress = 10
		duel = {
 			skill = prowess
			target = scope:fornost_troll
 			50 = {
				# You're successful
 				desc = rangers.0406.a.success
 				compare_modifier = {
 					value = scope:duel_value
 					multiplier = 3.5
 					min = -49
 				}
 				hidden_effect = { 
					send_interface_toast = {
						title = rangers.0406.a.success
						left_icon = root
						right_icon = scope:fornost_troll
						custom_tooltip = rangers.0406.a.success
					}
				}
				add_prestige = medium_prestige_gain
				scope:fornost_troll = { death = { death_reason = death_fight killer = root } }
 			}
 			50 = {
 				# You failed
 				desc = rangers.0406.a.failure
 				compare_modifier = {
 					value = scope:duel_value
 					multiplier = -3.5
 					min = -49
 				}
				hidden_effect = {
					send_interface_toast = {
						title = rangers.0406.a.failure
						left_icon = root
						right_icon = scope:fornost_troll
						custom_tooltip = rangers.0406.a.failure
					}
				}
				increase_wounds_effect = { REASON = fight }
				hidden_effect = { scope:fornost_troll = { silent_disappearance_effect = yes } }
 			}
		}
	}
	option = { # Distract it so Belaram can kill it
		name = rangers.0406.b
		duel = {
 			skill = intrigue
			target = scope:fornost_troll
 			50 = {
				# You're successful
 				desc = rangers.0406.a.success
 				compare_modifier = {
 					value = scope:duel_value
 					multiplier = 3.5
 					min = -49
 				}
 				hidden_effect = { 
					send_interface_toast = {
						title = rangers.0406.a.success
						left_icon = root
						right_icon = scope:fornost_troll
						custom_tooltip = rangers.0406.a.success
					}
				}
				add_intrigue_lifestyle_xp = 100
				scope:fornost_troll = { death = { death_reason = death_fight } }
 			}
 			50 = {
 				# You failed
 				desc = rangers.0406.a.failure
 				compare_modifier = {
 					value = scope:duel_value
 					multiplier = -3.5
 					min = -49
 				}
				hidden_effect = {
					send_interface_toast = {
						title = rangers.0406.a.failure
						left_icon = root
						right_icon = scope:fornost_troll
						custom_tooltip = rangers.0406.a.failure
					}
				}
				increase_wounds_effect = { REASON = fight }
				hidden_effect = { scope:fornost_troll = { silent_disappearance_effect = yes } }
 			}
		}
	}
	after = {
		trigger_event = rangers.0407
	}
}

rangers.0407 = { # Fornost: The Sons of Elrond
	content_source = realms_dlc
	type = character_event
	title = rangers.0407.t
	desc = rangers.0407.desc
	theme = elven
	window = visit_settlement_window
	override_background = { reference = fornost }
	left_portrait = {
		character = root
		animation = happiness
		camera = camera_event_left
	}
	center_portrait = {
		character = scope:elladan
		animation = marshal
		camera = camera_event_right
		triggered_outfit = {
			outfit_tags = { elven_war_noldor no_headgear }
		}
	}
	right_portrait = {
		character = scope:elrohir
		animation = bow_idle
		camera = camera_event_right
		triggered_outfit = {
			outfit_tags = { elven_war_noldor no_headgear }
		}
	}
	lower_left_portrait = {
		character = scope:andriel
	}
	lower_center_portrait = {
		character = scope:farin
	}
	immediate = { 
		character:lineofandriel = { save_scope_as = andriel } 
		character:lineofnorin2 = { save_scope_as = farin }
		character:lineofelrond2 = { save_scope_as = elladan }
		character:lineofelrond3 = { save_scope_as = elrohir }
	}
	option = { # It is good to see you, friends.
		name = rangers.0407.a
		add_stress = -20
	}
	option = { # Let us bandage your wounds
		name = rangers.0407.b
		trigger = {
			OR = {
				has_trait = wounded_1
				has_trait = wounded_2
				has_trait = wounded_3
			}
		}
		if = {
			limit = { has_trait = wounded_1 }
			remove_trait = wounded_1
		}
		else_if = {
			limit = { has_trait = wounded_2 }
			remove_trait = wounded_2 
			add_trait = wounded_1
		}
		else_if = {
			limit = { has_trait = wounded_3 }
			remove_trait = wounded_3
			add_trait = wounded_2
		}	
	}
	after = {
		trigger_event = rangers.0408
	}
}

rangers.0408 = { # Fornost: Leader of the Orcs
	content_source = realms_dlc
	type = character_event
	title = rangers.0408.t
	desc = rangers.0408.desc
	theme = war
	#window = visit_settlement_window
	override_background = { reference = fornost }
	left_portrait = {
		character = root
		scripted_animation = bow_drawn
	}
	right_portrait = {
		character = scope:tharzog
		animation = random_weapon_coup_degrace
	}
	lower_left_portrait = {
		character = scope:andriel
	}
	lower_right_portrait = {
		character = scope:farin
	}
	immediate = { 
		character:lineofandriel = { save_scope_as = andriel } 
		character:lineofnorin2 = { save_scope_as = farin }
		character:lineofelrond2 = { save_scope_as = elladan }
		character:lineofelrond3 = { save_scope_as = elrohir }
		character:lineoftharzog1 = { save_scope_as = tharzog }
	}
	option = { # We must strike down this foe
		name = rangers.0408.a
		duel = {
 			skill = martial
			target = scope:tharzog
 			50 = {
				# You're successful
 				desc = rangers.0408.a.success
 				compare_modifier = {
 					value = scope:duel_value
 					multiplier = 3.5
 					min = -49
 				}
 				hidden_effect = { 
					send_interface_toast = {
						title = rangers.0408.a.success
						left_icon = root
						right_icon = scope:tharzog
						custom_tooltip = rangers.0408.a.success
					}
				}
				add_prestige = major_prestige_gain
				scope:tharzog = { death = { death_reason = death_fight killer = root } }
 			}
 			50 = {
 				# You failed
 				desc = rangers.0408.a.failure
 				compare_modifier = {
 					value = scope:duel_value
 					multiplier = -3.5
 					min = -49
 				}
				hidden_effect = {
					send_interface_toast = {
						title = rangers.0408.a.failure
						left_icon = root
						right_icon = scope:tharzog
						custom_tooltip = rangers.0408.a.failure
					}
				}
				increase_wounds_effect = { REASON = fight }
 			}
		}	
	}
	after = {
		trigger_event = rangers.0409
	}
}

rangers.0409 = { # Fornost: The Dark Figure
	content_source = realms_dlc
	type = character_event
	title = rangers.0409.t
	desc = rangers.0409.desc
	theme = skull
	window = visit_settlement_window
	override_background = { reference = fornost }
	override_effect_2d = {
		reference = rain
	}
	widgets = {
		widget = {
			gui = "event_window_widget_vfx_lightning_storm"
			container = "foreground_shader_vfx_container"
		}
	}
	left_portrait = {
		character = scope:elladan
		scripted_animation = bow_drawn
		triggered_outfit = {
			outfit_tags = { elven_war_noldor no_headgear }
		}
	}
	center_portrait = {
		character = scope:elrohir
		animation = aggressive_sword
		triggered_outfit = {
			outfit_tags = { elven_war_noldor no_headgear }
		}
	}
	right_portrait = {
		character = scope:agandaur
		animation = throne_room_two_handed_passive_1
		triggered_outfit = {
			outfit_tags = { western_stealth_hood }
			#outfit_tags = { military_outfit }
		}
	}
	lower_left_portrait = {
		character = scope:andriel
	}
	lower_right_portrait = {
		character = root
	}
	lower_center_portrait = {
		character = scope:farin
	}
	immediate = { 
		character:lineofandriel = { save_scope_as = andriel } 
		character:lineofnorin2 = { save_scope_as = farin }
		character:lineofelrond2 = { save_scope_as = elladan }
		character:lineofelrond3 = { save_scope_as = elrohir }
		create_character = {
			#template = new_warrior_character
			dynasty = generate
			name = Agburanar
			age = 77
			prowess = 17
			martial = 11
			diplomacy = 8 
			intrigue = 12 
			learning = 7
			trait = arrogant
			trait = patient
			trait = deceitful
			trait = shrewd
			random_traits = no
			location = root.location
			gender_female_chance = 0
			trait = sorcerer_1
			save_scope_as = agandaur
			culture = culture:kazgumhoth
			faith = faith:lidless_eye
		}
	}
	option = { # A dark power is rising
		name = rangers.0409.a
		add_stress = 30
		hidden_effect = {
			scope:agandaur = {
				create_landless_adventurer_title_effect = {
					REASON = flag:voluntary
					FLAVOR_CHAR = root
				}
				trigger_event = { id = ep3_laamps.0030 days = 1 }
				start_travel_plan = {
					destination = title:c_carn_dum.title_province
					travel_with_domicile = yes
					return_trip = no
					players_use_planner = no
					on_arrival_destinations = all
				}
				add_gold = 1000
				add_character_flag = is_agandaur
				scope:agandaur.primary_title = {
					set_coa = d_enroaching_shadows
					set_title_name = encroaching_shadows_name
				}
				create_character = {
					template = orc_champion_character
					dynasty = none
					employer = scope:agandaur
					culture = culture:kazgumhoth
					faith = faith:lidless_eye
					gender_female_chance = 0
					random_traits = yes
					age = 30
				}
				create_character = {
					template = orc_champion_character
					dynasty = none
					employer = scope:agandaur
					culture = culture:kazgumhoth
					faith = faith:lidless_eye
					gender_female_chance = 0
					random_traits = yes
					age = 30
				}
				spawn_army = {
					uses_supply = no
					inheritable = yes
					name = servants_of_shadows
					levies = 500
					men_at_arms = {
						type = hunter_orcs_on_fell_wargs
						stacks = 2
					}
					men_at_arms = {
						type = mountain_troll
						stacks = 1
					}
					men_at_arms = {
						type = orc_warriors
						stacks = 2
					}
					men_at_arms = {
						type = orc_pikemen
						stacks = 2
					}
					men_at_arms = {
						type = orc_archers
						stacks = 2
					}
					location = scope:agandaur.location
				}
			}
		}
	}

	after = {
		trigger_event = rangers.0410
	}
}

rangers.0410 = { # Fornost: The Aftermath
	content_source = realms_dlc
	type = character_event
	title = rangers.0410.t
	desc = rangers.0410.desc
	theme = hunt_activity
	#window = visit_settlement_window
	override_background = { reference = fornost }
	left_portrait = {
		character = scope:elladan
		animation = worry
		triggered_outfit = {
			outfit_tags = { elven_war_noldor no_headgear }
		}
	}
	right_portrait = {
		character = root
		animation = personality_rational
	}
	lower_left_portrait = {
		character = scope:andriel
	}
	lower_center_portrait = {
		character = scope:farin
	}
	lower_right_portrait = {
		character = scope:elrohir 
		triggered_outfit = {
			outfit_tags = { elven_war_noldor no_headgear }
		}
	}
	option = { # We must return to Sarn Ford 
		name = rangers.0410.a
		set_relation_friend = {
			reason = friend_upgrade_generic
			target = scope:elladan
		}
		set_relation_friend = {
			reason = friend_upgrade_generic
			target = scope:elrohir
		}
		start_travel_plan = { #Travel to Sarn Ford
			destination = title:c_iach_sarn.title_province
			on_arrival_event = rangers.0411
			#return_trip = no
			players_use_planner = no
			#on_arrival_destinations = all
		}
	}
}

rangers.0411 = { # Sarn Ford: The Return
	content_source = realms_dlc
	type = character_event
	title = rangers.0411.t
	desc = rangers.0411.desc
	theme = diplomacy
	#window = visit_settlement_window
	override_background = { reference = carrock }
	left_portrait = {
		character = root
		animation = worry
	}
	right_portrait = {
		character = scope:halbarad
		animation = personality_rational
	}
	lower_left_portrait = {
		character = scope:andriel
	}
	lower_center_portrait = {
		character = scope:farin
	}
	immediate = {
		character:lineofandriel = { save_scope_as = andriel } 
		character:lineofnorin2 = { save_scope_as = farin }
		character:linehalbarad9 = { save_scope_as = halbarad }
		hidden_effect = { add_contact = scope:halbarad }		
		domicile ?= { 
			change_provisions = minor_provisions_gain 
			move_domicile = title:c_iach_sarn.title_province
		}
		hidden_effect = {
			current_travel_plan ?= { abort_travel_plan = yes }
		}
		if = {
			limit = { has_character_flag = spoken_with_halbarad }
			remove_character_flag = spoken_with_halbarad
		}
		if = {
			limit = { has_character_flag = spoken_with_lorniel }
			remove_character_flag = spoken_with_lorniel
		}
	}
	option = { # We're back
		name = rangers.0411.a
		custom_tooltip = rangers.0411.a.tt # You complete your contract
		add_prestige = minor_prestige_gain
		add_character_flag = eradan_locals_sarnford
		random_character_active_contract = {
			limit = { has_task_contract_type = lotr_eradan_contract_fornost }
			complete_task_contract = success_standard
		}
		hidden_effect = { # Create the Barrow-downs contract
			root = {
				create_task_contract = {
					task_contract_type = lotr_eradan_contract_barrowdowns
					task_contract_employer = scope:halbarad
					location = title:c_dol_daergorthad.title_province
					task_contract_tier = 4
					save_scope_as = created_contract
				}
			}
		}
		custom_tooltip = eradan_safe_locations_tt
		add_character_flag = eradan_ready_for_barrows
	}
}	

rangers.0412 = { # Barrow-downs: Unnatural Fog
	content_source = realms_dlc
	type = character_event
	title = rangers.0412.t
	desc = rangers.0412.desc
	theme = mental_health
	window = visit_settlement_window
	override_background = { reference = wilderness }
	override_effect_2d = { reference = fog }
	left_portrait = {
		character = root
		animation = survey 
	}
	center_portrait = {
		character = scope:andriel 
		animation = throne_room_one_handed_passive_1
	}
	right_portrait = {
		character = scope:farin
		animation = marshal_longaxe
		camera = camera_event_scheme_vs_right_look_right
		triggered_outfit = {
			outfit_tags = { dwarf_war_steel_outfit }
		}
	}
	lower_right_portrait = {
		character = scope:luin
	}
	lower_center_portrait = {
		character = scope:kilaran
	}
	immediate = {
		character:lineofandriel = { save_scope_as = andriel } 
		character:lineofnorin2 = { save_scope_as = farin }
		remove_character_flag = eradan_locals_sarnford
		remove_character_flag = eradan_ready_for_barrows
		create_character = {
			dynasty = none
			location = root.location
			name = "Kilaran"
			age = 31
			gender_female_chance = 0
			trait = brave
			trait = impatient
			trait = honest
			trait = blood_of_numenor_4
			#disallow_random_traits = yes
			culture = culture:dunedain_ranger
			faith = faith:faith_edain
			save_scope_as = kilaran
			after_creation = {
				add_trait = possessed_1
			}
		}
		create_character = {
			dynasty = none
			location = root.location
			name = "Luin"
			age = 34
			gender_female_chance = 0
			trait = brave
			trait = calm
			trait = humble
			trait = blood_of_numenor_4
			#disallow_random_traits = yes
			culture = culture:dunedain_ranger
			faith = faith:faith_edain
			save_scope_as = luin
		}
		domicile ?= { 
			change_provisions = miniscule_provisions_gain 
			move_domicile = title:c_dol_daergorthad.title_province
		}
		hidden_effect = {
			current_travel_plan ?= { abort_travel_plan = yes }
		}
	}
	option = { # Let's keep our eyes open for the missing rangers
		name = rangers.0412.a
		trigger_event = {
			id = rangers.0413
			days = 5 
		}
	}
}

rangers.0413 = { # Barrow-downs: Wights!
	content_source = realms_dlc
	type = character_event
	title = rangers.0413.t
	desc = rangers.0413.desc
	theme = skull
	#window = visit_settlement_window
	override_background = { reference = barrow }
	override_effect_2d = { reference = fog }
	left_portrait = {
		character = root
		animation = aggressive_sword 
	}
	right_portrait = {
		character = scope:farin
		animation = crossbow
		camera = camera_event_left
		triggered_outfit = {
			outfit_tags = { dwarf_war_steel_outfit }
		}
	}
	lower_center_portrait = {
		character = scope:andriel
	}
	immediate = {
		character:lineofandriel = { save_scope_as = andriel } 
		character:lineofnorin2 = { save_scope_as = farin }
	}
	option = { # Fight them
		name = rangers.0413.a
		duel = {
 			skill = prowess
			value = high_skill_rating 
 			50 = {
				# You're successful
 				desc = rangers.0413.a.success
 				compare_modifier = {
 					value = scope:duel_value
 					multiplier = 3.5
 					min = -49
 				}
 				hidden_effect = { 
					send_interface_toast = {
						title = rangers.0413.a.success
						left_icon = root
						custom_tooltip = rangers.0413.a.success
					}
				}
				add_prestige = minor_prestige_gain
 			}
 			50 = {
 				# You failed
 				desc = rangers.0413.a.failure
 				compare_modifier = {
 					value = scope:duel_value
 					multiplier = -3.5
 					min = -49
 				}
				hidden_effect = {
					send_interface_toast = {
						title = rangers.0413.a.failure
						left_icon = root
						custom_tooltip = rangers.0413.a.failure
					}
				}
				increase_wounds_effect = { REASON = fight }
 			}
		}
		trigger_event = {
			id = rangers.0414
			days = 1 
		}
	}
	
	option = { # Sneak around them
		name = rangers.0413.b 
		custom_tooltip = rangers.0413.b.tt 
		trigger_event = {
			id = rangers.0414
			days = 15 
		}
	}
}

rangers.0414 = { # Barrow-downs: Find some Athelas
	content_source = realms_dlc
	type = character_event
	title = rangers.0414.t
	desc = rangers.0414.desc
	theme = healthcare
	#window = visit_settlement_window
	override_background = { reference = wilderness_forest }
	override_effect_2d = { reference = fog }
	left_portrait = {
		character = root
		animation = happiness 
	}
	right_portrait = {
		character = scope:andriel
		animation = happy_teacher
	}
	lower_center_portrait = {
		character = scope:farin
	}
	immediate = {
		character:lineofandriel = { save_scope_as = andriel } 
		character:lineofnorin2 = { save_scope_as = farin }
	}
	option = { # Bag it for later
		name = rangers.0414.a
		add_learning_lifestyle_xp = 500
	}
	option = { # Treat our wounds
		name = rangers.0414.b 
		trigger = {
			OR = {
				has_trait = wounded_1
				has_trait = wounded_2
				has_trait = wounded_3
			}
		}
		if = {
			limit = { has_trait = wounded_1 }
			remove_trait = wounded_1
		}
		else_if = {
			limit = { has_trait = wounded_2 }
			remove_trait = wounded_2 
			add_trait = wounded_1
		}
		else_if = {
			limit = { has_trait = wounded_3 }
			remove_trait = wounded_3
			add_trait = wounded_2
		}	
	}
	after = {
		trigger_event = {
			id = rangers.0415
			days = 2 
		}
	}
}

rangers.0415 = { # Barrow-downs: Looking for Clues
	content_source = realms_dlc
	type = character_event
	title = rangers.0415.t
	desc = rangers.0415.desc
	theme = intrigue
	#window = visit_settlement_window
	override_background = { reference = barrow }
	override_effect_2d = { reference = fog }
	left_portrait = {
		character = root
		animation = thinking 
	}
	right_portrait = {
		character = scope:andriel
		animation = survey_staff
		camera = camera_event_left
	}
	lower_center_portrait = {
		character = scope:farin
	}
	immediate = {
		character:lineofandriel = { save_scope_as = andriel } 
		character:lineofnorin2 = { save_scope_as = farin }
	}
	option = { # Trust Andriel's instincts
		name = rangers.0415.a
		scope:andriel = {
			duel = {
				skill = learning
				value = high_skill_rating 
				50 = {
					# You're successful
					desc = rangers.0415.a.success
					compare_modifier = {
						value = scope:duel_value
						multiplier = 3.5
						min = -49
					}
					hidden_effect = { 
						root = {
							send_interface_toast = {
								title = rangers.0415.a.success
								left_icon = root
								right_icon = scope:andriel
								custom_tooltip = rangers.0415.a.success
							}
						}
					}
					add_prestige = minor_prestige_gain
					root = { trigger_event = rangers.0416 }
				}
				50 = {
					# You failed
					desc = rangers.0415.a.failure
					compare_modifier = {
						value = scope:duel_value
						multiplier = -3.5
						min = -49
					}
					hidden_effect = {
						root = {
							send_interface_toast = {
								title = rangers.0415.a.failure
								left_icon = root
								right_icon = scope:andriel
								custom_tooltip = rangers.0415.a.failure
							}
						}
					}
					add_prestige = minor_prestige_loss
					root = { trigger_event = { id = rangers.0416 days = 20 } }
				}
			}
		}
	}
	
	option = { # Trust Farin's nose
		name = rangers.0415.b 
		scope:farin = {
			duel = {
				skill = intrigue
				value = decent_skill_rating 
				50 = {
					# You're successful
					desc = rangers.0415.b.success
					compare_modifier = {
						value = scope:duel_value
						multiplier = 3.5
						min = -49
					}
					hidden_effect = { 
						root = {
							send_interface_toast = {
								title = rangers.0415.b.success
								left_icon = root
								right_icon = scope:farin
								custom_tooltip = rangers.0415.b.success
							}
						}
					}
					add_prestige = minor_prestige_gain
					root = { trigger_event = rangers.0416 }
				}
				50 = {
					# You failed
					desc = rangers.0415.b.failure
					compare_modifier = {
						value = scope:duel_value
						multiplier = -3.5
						min = -49
					}
					hidden_effect = {
						root = {
							send_interface_toast = {
								title = rangers.0415.b.failure
								left_icon = root
								right_icon = scope:farin
								custom_tooltip = rangers.0415.b.failure
							}
						}
					}
					add_prestige = minor_prestige_loss
					root = { trigger_event = { id = rangers.0416 days = 20 } }
				}
			}
		}
	}
}

rangers.0416 = { # Barrow-downs: Find Luin
	content_source = realms_dlc
	type = character_event
	title = rangers.0416.t
	desc = rangers.0416.desc
	theme = mental_break
	window = visit_settlement_window
	override_background = { reference = barrow }
	override_effect_2d = { reference = fog }
	left_portrait = {
		character = root
		animation = marshal 
	}
	center_portrait = {
		character = scope:farin
		animation = personality_compassionate
		triggered_outfit = {
			outfit_tags = { dwarf_war_steel_outfit }
		}
	}
	right_portrait = {
		character = scope:luin
		animation = stayback
	}
	lower_center_portrait = {
		character = scope:andriel
	}
	immediate = {
		scope:luin = { increase_wounds_effect = { REASON = fight } }
	}
	option = {
		name = rangers.0416.a 
		add_courtier = scope:luin 
		trigger_event = rangers.0417
	}
}

rangers.0417 = { # Barrow-downs: More Wights!
	content_source = realms_dlc
	type = character_event
	title = rangers.0417.t
	desc = rangers.0417.desc
	theme = hunt_activity
	#window = visit_settlement_window
	override_background = { reference = wilderness_mountains }
	override_effect_2d = { reference = fog }
	left_portrait = {
		character = root
		scripted_animation = bow_drawn 
	}
	right_portrait = {
		character = scope:farin
		animation = aggressive_longaxe
		camera = camera_event_left
		triggered_outfit = {
			outfit_tags = { dwarf_war_steel_outfit }
		}
	}
	lower_center_portrait = {
		character = scope:andriel
	}
	lower_right_portrait = {
		character = scope:luin
	}
	option = { # Fight them with bow and blade
		name = rangers.0417.a 
		add_martial_lifestyle_xp = 200 
		random = {
			chance = 20 
			add_trait = aggressive_attacker 
		}
	}
	
	option = { # Banish them 
		name = rangers.0417.b 
		add_learning_lifestyle_xp = 200 
		random = {
			chance = 25 
			add_learning_skill = 1
		}
	}
	
	option = { # Ambush them 
		name = rangers.0417.c 
		add_intrigue_lifestyle_xp = 200 
		random = {
			chance = 25 
			add_intrigue_skill = 1
		}
	}
	after = {
		trigger_event = {	
			id = rangers.0418 
			days = 2 
		}
	}
}

rangers.0418 = { # Barrow-downs: Find Kilaran
	content_source = realms_dlc
	type = character_event
	title = rangers.0418.t
	desc = rangers.0418.desc
	theme = skull
	window = visit_settlement_window
	override_background = { reference = barrow }
	override_effect_2d = { reference = fog }
	widgets = {
		widget = {
			gui = "lotr_shader_event_sparks"
			container = "lotr_shader_event_foreground"
		}
	}
	left_portrait = {
		character = root
		animation = marshal 
	}
	center_portrait = {
		character = scope:luin
		animation = fear
	}
	right_portrait = {
		character = scope:kilaran
		animation = random_weapon_coup_degrace
	}
	option = { # We must fight him
		name = rangers.0418.a 
		duel = {
 			skill = prowess
			value = very_high_skill_rating 
 			30 = {
				# You're successful
 				desc = rangers.0418.a.success
 				compare_modifier = {
 					value = scope:duel_value
 					multiplier = 3.5
 					min = -49
 				}
 				hidden_effect = { 
					send_interface_toast = {
						title = rangers.0418.a.success
						left_icon = root
						right_icon = scope:kilaran
						custom_tooltip = rangers.0418.a.success
					}
				}
				add_prowess_skill = 1
				add_courtier = scope:kilaran
				scope:kilaran = {
					remove_trait = possessed_1
					increase_wounds_effect = { REASON = fight }
				}
				
 			}
 			70 = {
 				# You failed
 				desc = rangers.0418.a.failure
 				compare_modifier = {
 					value = scope:duel_value
 					multiplier = -3.5
 					min = -49
 				}
				hidden_effect = {
					send_interface_toast = {
						title = rangers.0418.a.failure
						left_icon = root
						custom_tooltip = rangers.0418.a.failure
					}
				}
				scope:kilaran = { death = { death_reason = death_duel killer = root } }
 			}
		}
		trigger_event = {
			id = rangers.0419
			days = 1 
		}
	}
}

rangers.0419 = { # Barrow-downs: A Mysterious Stranger
	content_source = realms_dlc
	type = character_event
	title = rangers.0419.t
	desc = rangers.0419.desc
	theme = legend
	#window = visit_settlement_window
	override_background = { reference = wilderness }
	override_effect_2d = { reference = legend_glow }
	left_portrait = {
		character = root
		animation = interested
	}
	right_portrait = {
		character = scope:tom_bombadil
		animation = dancing
	}
	lower_center_portrait = {
		character = scope:andriel
	}
	lower_right_portrait = {
		character = scope:luin
	}
	lower_left_portrait = {
		character = scope:farin 
	}
	immediate = { title:k_wastelands.holder = { save_scope_as = tom_bombadil } }
	option = { # Take a rest at Tom's house 
		name = rangers.0419.a 
		custom_tooltip = rangers.0419.a.tt
		add_stress = -50 
		trigger_event = {
			id = rangers.0420 
			days = 20 
		}
	}
	option = { # Thank him and leave 
		name = rangers.0419.b 
		add_stress = -10 
		trigger_event = {
			id = rangers.0420 
			days = 1 
		}
	}
}

rangers.0420 = { # Barrow-downs: Mission Complete
	content_source = realms_dlc
	type = character_event
	title = rangers.0420.t
	desc = rangers.0420.desc
	theme = laamp
	override_background = { reference = wilderness_forest }
	#window = visit_settlement_window
	left_portrait = {
		character = root
		animation = happiness
	}
	right_portrait = {
		character = scope:halbarad
		animation = personality_forgiving
	}
	lower_left_portrait = {
		character = scope:kilaran 
	}
	lower_center_portrait = {
		character = scope:andriel
	}
	lower_right_portrait = {
		character = scope:luin
	}
	immediate = { 
		character:linehalbarad9 = { save_scope_as = halbarad } 
		custom_tooltip = rangers.0420.tt # You completed your contract
		random_character_active_contract = {
			limit = { has_task_contract_type = lotr_eradan_contract_barrowdowns }
			complete_task_contract = success_standard
		}
		domicile ?= { 
			change_provisions = minor_provisions_gain 
		}
	}
	option = { # Time to travel to Rivendell 
		name = rangers.0420.a 
		custom_tooltip = rangers.0420.a.tt
		hidden_effect = { # Create the Rivendell contract
			root = {
				create_task_contract = {
					task_contract_type = lotr_eradan_contract_rivendell
					task_contract_employer = title:c_imladris.holder
					location = title:c_imladris.title_province
					task_contract_tier = 4
					save_scope_as = created_contract
				}
				add_contact = title:c_imladris.holder
			}
		}
		add_character_flag = eradan_ready_for_imladris
	}
}

rangers.0421 = { # Rivendell: Arrival
	content_source = realms_dlc
	type = character_event
	title = rangers.0421.t
	desc = rangers.0421.desc
	theme = elven
	window = visit_settlement_window
	override_background = { reference = throne_room_rivendell }
	left_portrait = {
		character = scope:andriel
		animation = reading 
	}
	center_portrait = {
		character = root
		animation = throne_room_conversation_1
	}
	right_portrait = {
		character = scope:elrond
		animation = personality_rational
	}
	lower_center_portrait = { 
		character = scope:farin 
	}
	immediate = {
		title:c_imladris.holder.top_liege = { save_scope_as = elrond }
		character:lineofandriel = { save_scope_as = andriel }
		character:lineofnorin2 = { save_scope_as = farin }
		hidden_effect = {
			current_travel_plan ?= { abort_travel_plan = yes }
		}
		remove_character_flag = eradan_ready_for_imladris
	}
	option = { # Find Elrond in his library
		name = rangers.0421.a
		custom_tooltip = rangers.0421.a.tt
		random_character_active_contract = {
			limit = { has_task_contract_type = lotr_eradan_contract_rivendell }
			complete_task_contract = success_standard
		}
		domicile ?= { 
			change_provisions = miniscule_provisions_gain 
			move_domicile = title:c_imladris.title_province
		}
		add_character_flag = eradan_locals_imladris
		add_character_flag = eradan_ready_for_ettenmoors
		custom_tooltip = eradan_safe_locations_tt
		hidden_effect = { # Create the Ettenmoors contract
			root = {
				create_task_contract = {
					task_contract_type = lotr_eradan_contract_ettenmoors
					task_contract_employer = scope:elrond
					location = title:c_ettenmoors.title_province
					task_contract_tier = 4
					save_scope_as = created_contract
				}
			}
		}
	}
}

rangers.0422 = { # Ettenmoors: Arrival
	content_source = realms_dlc
	type = character_event
	title = rangers.0422.t
	desc = rangers.0422.desc
	theme = hunt_activity
	window = visit_settlement_window
	override_background = { reference = ettenmoors }
	left_portrait = {
		character = root 
		animation = personality_callous
	}
	center_portrait = {
		character = scope:andriel 
		animation = throne_room_one_handed_passive_1
	}
	right_portrait = {
		character = scope:farin 
		animation = marshal_longaxe
		camera = camera_event_scheme_vs_right_look_right
		triggered_outfit = {
			outfit_tags = { dwarf_war_steel_outfit }
		}
	}
	immediate = {
		character:lineofandriel = { save_scope_as = andriel }
		character:lineofnorin2 = { save_scope_as = farin }
		remove_character_flag = eradan_locals_imladris
		remove_character_flag = eradan_ready_for_ettenmoors
		domicile ?= { 
			change_provisions = miniscule_provisions_gain 
			move_domicile = title:c_ettenmoors.title_province
		}
		hidden_effect = {
			current_travel_plan ?= { abort_travel_plan = yes }
		}
		if = {
			limit = { has_character_flag = spoken_with_elrond }
			remove_character_flag = spoken_with_elrond
		}
		if = {
			limit = { has_character_flag = spoken_with_elrondsons }
			remove_character_flag = spoken_with_elrondsons
		}
		if = {
			limit = { has_character_flag = spoken_with_gandalf }
			remove_character_flag = spoken_with_gandalf
		}
		if = {
			limit = { has_character_flag = spoken_with_arwen }
			remove_character_flag = spoken_with_arwen
		}
	}
	option = { # We look for tracks immediately
		name = rangers.0422.a
		add_prestige = minor_prestige_gain
		trigger_event = rangers.0423 
	}
	option = { # We set up camp and rest 
		name = rangers.0422.b 
		add_stress = -25
		domicile ?= { change_provisions = miniscule_provisions_gain }
		trigger_event = {
			id = rangers.0423 
			days = 10 
		}
	}
}

rangers.0423 = { # Ettenmoors: A Trackless Wilderness
	content_source = realms_dlc
	type = character_event
	title = rangers.0423.t
	desc = rangers.0423.desc
	theme = dread
	#window = visit_settlement_window
	override_background = { reference = wilderness_mountains }
	left_portrait = {
		character = root 
		animation = worry
	}
	right_portrait = {
		character = scope:farin 
		animation = crossbow
		camera = camera_event_left
		triggered_outfit = {
			outfit_tags = { dwarf_war_steel_outfit }
		}
	}
	lower_center_portrait = {
		character = scope:andriel 
	}
	immediate = {
		character:lineofandriel = { save_scope_as = andriel }
		character:lineofnorin2 = { save_scope_as = farin }
	}
	option = { # Follow Farin's advice
		name = rangers.0423.a 
		scope:farin = {
			add_opinion = {
				target = root
				modifier = pleased_opinion
				opinion = 30
			}
		}
	}
	option = { # Follow Andriel's advice
		name = rangers.0423.b
		scope:andriel = {
			add_opinion = {
				target = root
				modifier = pleased_opinion
				opinion = 30
			}
		}
	}
	after = {
		trigger_event = rangers.0424
	}
}

rangers.0424 = { # Ettenmoors: Orc Ambush
	content_source = realms_dlc
	type = character_event
	title = rangers.0424.t
	desc = rangers.0424.desc
	theme = war
	#window = visit_settlement_window
	override_background = { reference = ettenmoors }
	left_portrait = {
		character = root
		scripted_animation = bow_drawn
	}
	right_portrait = {
		character = scope:ettenmoors_orc
		animation = aggressive_mace
	}
	lower_left_portrait = {
		character = scope:andriel
	}
	lower_right_portrait = {
		character = scope:farin
	}
	immediate = { 
		character:lineofandriel = { save_scope_as = andriel } 
		character:lineofnorin2 = { save_scope_as = farin }
		create_character = {
			template = new_warrior_character
			dynasty = generate
			location = root.location
			gender_female_chance = 0
			save_scope_as = ettenmoors_orc
			prowess = 24
			culture = culture:worauthai_madur
			faith = faith:way_of_strength
			after_creation = {
				scope:ettenmoors_orc = {
					random_list = {
						1 = { give_nickname = nick_the_dreamer }
						1 = { give_nickname = nick_the_literate_one }
						1 = { give_nickname = nick_the_flogger }
						1 = { give_nickname = nick_the_disgusting }
						1 = { give_nickname = nick_the_angry }
						1 = { give_nickname = nick_the_stalker }
						1 = { give_nickname = nick_the_crafty }
						1 = { give_nickname = nick_the_funny_one }
						1 = { give_nickname = nick_the_filthy }
						1 = { give_nickname = nick_the_screamer }
						1 = { give_nickname = nick_the_bloated }
						1 = { give_nickname = nick_the_whiner }
					}
				}
			}
		}
	}
	option = { # Charge!
		name = rangers.0424.a 
		duel = {
 			skill = prowess
			value = very_high_skill_rating 
 			50 = {
				# You're successful
 				desc = rangers.0424.a.success
 				compare_modifier = {
 					value = scope:duel_value
 					multiplier = 3.5
 					min = -49
 				}
 				hidden_effect = { 
					send_interface_toast = {
						title = rangers.0424.a.success
						left_icon = root
						right_icon = scope:ettenmoors_orc
						custom_tooltip = rangers.0424.a.success
					}
				}
				add_prestige = minor_prestige_gain
				scope:ettenmoors_orc = { death = { death_reason = death_fight killer = root } }
 			}
 			50 = {
 				# You failed
 				desc = rangers.0424.a.failure
 				compare_modifier = {
 					value = scope:duel_value
 					multiplier = -3.5
 					min = -49
 				}
				hidden_effect = {
					send_interface_toast = {
						title = rangers.0424.a.failure
						left_icon = root
						right_icon = scope:ettenmoors_orc
						custom_tooltip = rangers.0424.a.failure
					}
				}
				increase_wounds_effect = { REASON = fight }
				hidden_effect = { scope:ettenmoors_orc = { silent_disappearance_effect = yes } }
 			}
		}
	}
	option = { # Shoot them!
		name = rangers.0424.b 
		custom_tooltip = rangers.0424.b.tt
		domicile = {
			change_provisions = minor_provisions_loss
		}
	}
	after = {
		trigger_event = rangers.0425 
	}
}

rangers.0425 = { # Ettenmoors: Belaram's Return
	content_source = realms_dlc
	type = character_event
	title = rangers.0425.t
	desc = rangers.0425.desc
	theme = friend_relation
	#window = visit_settlement_window
	override_background = { reference = eagles }
	left_portrait = {
		character = root
		animation = happiness
	}
	right_portrait = {
		character = scope:andriel
		animation = holding_staff
	}
	lower_right_portrait = {
		character = scope:farin
	}
	immediate = { 
		character:lineofandriel = { save_scope_as = andriel } 
		character:lineofnorin2 = { save_scope_as = farin }
	}
	option = { # It is good to see you, friend!
		name = rangers.0425.a 
		add_stress = -20 
		trigger_event = rangers.0426 
	}
}

rangers.0426 = { # Ettenmoors: More Orcs Attack
	content_source = realms_dlc
	type = character_event
	title = rangers.0426.t
	desc = rangers.0426.desc
	theme = martial
	#window = visit_settlement_window
	override_background = { reference = ettenmoors }
	left_portrait = {
		character = root
		animation = aggressive_sword
	}
	right_portrait = {
		character = scope:andriel
		animation = throne_room_one_handed_passive_1
		camera = camera_event_left
	}
	lower_right_portrait = {
		character = scope:farin
	}
	immediate = { 
		character:lineofandriel = { save_scope_as = andriel } 
		character:lineofnorin2 = { save_scope_as = farin }
	}
	option = { # We charge them head-on
		name = rangers.0426.a
		add_prestige = medium_prestige_gain
		add_martial_lifestyle_xp = 500
		random = {
			chance = 27
			increase_wounds_effect = { REASON = fight }
		}
		random = {
			chance = 14 
			add_trait = lifestyle_blademaster
		}
	}
	option = { # We keep them at a distance 
		name = rangers.0426.b 
		add_trait = lifestyle_hunter
	}
	after = {
		trigger_event = {
			id = rangers.0427
			days = 2 
		}
	}
}

rangers.0427 = { # Ettenmoors: Troll Assault
	content_source = realms_dlc
	type = character_event
	title = rangers.0427.t
	desc = rangers.0427.desc
	theme = dread
	window = visit_settlement_window
	override_background = { reference = ettenmoors }
	left_portrait = {
		character = root
		animation = shock
	}
	center_portrait = {
		character = scope:ettenmoors_troll_2
		animation = war_defender 
		camera = camera_event_scheme_vs_center_look_left
	}
	right_portrait = {
		character = scope:ettenmoors_troll_1
		animation = menacing
	}
	lower_right_portrait = {
		character = scope:farin
	}
	lower_center_portrait = {
		character = scope:andriel 
	}
	immediate = { 
		character:lineofandriel = { save_scope_as = andriel } 
		character:lineofnorin2 = { save_scope_as = farin }
		create_character = { # Create a new troll
			culture = culture:hill_troll
			faith = faith:way_of_strength
			prowess = 30
			gender_female_chance = 0
			location = root.location
			save_scope_as = ettenmoors_troll_1
		}
		create_character = { # Create a new troll
			culture = culture:hill_troll
			faith = faith:way_of_strength
			prowess = 30
			gender_female_chance = 0
			location = root.location
			save_scope_as = ettenmoors_troll_2
		}
	}
	option = { # Stand and fight
		name = rangers.0427.a 
		duel = {
 			skill = prowess
			target = scope:ettenmoors_troll_1 
 			50 = {
				# You're successful
 				desc = rangers.0427.a.success
 				compare_modifier = {
 					value = scope:duel_value
 					multiplier = 3.5
 					min = -49
 				}
 				hidden_effect = { 
					send_interface_toast = {
						title = rangers.0427.a.success
						left_icon = root
						right_icon = scope:ettenmoors_troll_1
						custom_tooltip = rangers.0427.a.success
					}
				}
				add_prestige = medium_prestige_gain
				scope:ettenmoors_troll_1 = { death = { death_reason = death_fight killer = scope:andriel } }
				scope:ettenmoors_troll_2 = { death = { death_reason = death_fight killer = scope:farin } }
 			}
 			50 = {
 				# You failed
 				desc = rangers.0427.a.failure
 				compare_modifier = {
 					value = scope:duel_value
 					multiplier = -3.5
 					min = -49
 				}
				hidden_effect = {
					send_interface_toast = {
						title = rangers.0427.a.failure
						left_icon = root
						right_icon = scope:ettenmoors_troll_1
						custom_tooltip = rangers.0427.a.failure
					}
				}
				hidden_effect = { increase_wounds_effect = { REASON = fight } }
				increase_wounds_effect = { REASON = fight }
				hidden_effect = { scope:ettenmoors_troll_1 = { silent_disappearance_effect = yes } }
				hidden_effect = { scope:ettenmoors_troll_2 = { silent_disappearance_effect = yes } }
 			}
		}
	}
	option = { # Run Away
		name = rangers.0427.b 
		duel = {
 			skill = intrigue
			target = scope:ettenmoors_troll_2
 			50 = {
				# You're successful
 				desc = rangers.0427.b.success
 				compare_modifier = {
 					value = scope:duel_value
 					multiplier = 3.5
 					min = -49
 				}
 				hidden_effect = { 
					send_interface_toast = {
						title = rangers.0427.b.success
						left_icon = root
						right_icon = scope:ettenmoors_troll_2
						custom_tooltip = rangers.0427.b.success
					}
				}
				add_prestige = medium_prestige_loss
				hidden_effect = { scope:ettenmoors_troll_1 = { silent_disappearance_effect = yes } }
				hidden_effect = { scope:ettenmoors_troll_2 = { silent_disappearance_effect = yes } }
 			}
 			50 = {
 				# You failed
 				desc = rangers.0427.b.failure
 				compare_modifier = {
 					value = scope:duel_value
 					multiplier = -3.5
 					min = -49
 				}
				hidden_effect = {
					send_interface_toast = {
						title = rangers.0427.b.failure
						left_icon = root
						right_icon = scope:ettenmoors_troll_2
						custom_tooltip = rangers.0427.b.failure
					}
				}
				increase_wounds_effect = { REASON = fight }
				hidden_effect = { scope:ettenmoors_troll_1 = { silent_disappearance_effect = yes } }
				hidden_effect = { scope:ettenmoors_troll_2 = { silent_disappearance_effect = yes } }
 			}
		}
	}
	after = {
		trigger_event = rangers.0428
	}
}

rangers.0428 = { # Ettenmoors: A Moment To Rest
	content_source = realms_dlc
	type = character_event
	title = rangers.0428.t
	desc = rangers.0428.desc
	theme = laamp
	left_portrait = {
		character = root
		animation = throne_room_conversation_1
	}
	right_portrait = {
		character = scope:farin
		animation = interested
		triggered_outfit = {
			outfit_tags = { dwarf_war_steel_outfit }
		}
	}
	lower_right_portrait = {
		character = scope:andriel
	}
	immediate = { 
		character:lineofandriel = { save_scope_as = andriel } 
		character:lineofnorin2 = { save_scope_as = farin }
	}
	option = { # We cannot tarry long
		name = rangers.0428.a 
		add_stress = -10
		trigger_event = {
			id = rangers.0429 
			days = 3 
		}
	}
	option = { # Let us rest fully and heal 
		name = rangers.0428.b 
		add_stress = -30 
		if = {
			limit = { has_trait = wounded_1 }
			remove_trait = wounded_1
		}
		else_if = {
			limit = { has_trait = wounded_2 }
			remove_trait = wounded_2 
			add_trait = wounded_1
		}
		else_if = {
			limit = { has_trait = wounded_3 }
			remove_trait = wounded_3
			add_trait = wounded_2
		}	
		trigger_event = {
			id = rangers.0429 
			days = 25
		}
	}
}

rangers.0429 = { # Ettenmoors: The Stone-giant
	content_source = realms_dlc
	type = character_event
	title = rangers.0429.t
	desc = rangers.0429.desc
	theme = dread
	window = visit_settlement_window
	override_background = { reference = ettenmoors }
	left_portrait = {
		character = scope:andriel
		animation = worry
	}
	center_portrait = {
		character = root
		scripted_animation = bow_drawn
		camera = camera_event_scheme_vs_right_look_right		
	}
	lower_right_portrait = {
		character = scope:farin
	}
	option = { # We have to distract it long enough for the eagles to bring it down
		name = rangers.0429.a 
		random_list = {
			42 = {
				custom_tooltip = rangers.0429.a.success 
				add_prestige = major_prestige_gain
 				hidden_effect = { 
					send_interface_toast = {
						title = rangers.0429.a.success
						left_icon = root
						custom_tooltip = rangers.0429.a.success
					}
				}
			}
			28 = {
				custom_tooltip = rangers.0429.a.wounded 
				add_prestige = medium_prestige_gain
 				hidden_effect = { 
					send_interface_toast = {
						title = rangers.0429.a.wounded
						left_icon = root
						custom_tooltip = rangers.0429.a.wounded
					}
				}
				hidden_effect = { increase_wounds_effect = { REASON = fight } }
				increase_wounds_effect = { REASON = fight }
			}
			21 = {
				custom_tooltip = rangers.0429.a.companion 
 				hidden_effect = { 
					send_interface_toast = {
						title = rangers.0429.a.companion
						left_icon = root
						custom_tooltip = rangers.0429.a.companion
					}
				}
				scope:andriel = { increase_wounds_effect = { REASON = fight } }
				scope:farin = { increase_wounds_effect = { REASON = fight } }
			}
			9 = {
				custom_tooltip = rangers.0429.a.failure 
 				hidden_effect = { 
					send_interface_toast = {
						title = rangers.0429.a.failure
						left_icon = root
						custom_tooltip = rangers.0429.a.failure
					}
				}
				death = { death_reason = death_crushed }
			}
		}
	}
	after = {
		trigger_event = rangers.0430 
	}
}

rangers.0430 = { # Ettenmoors: Aftermath
	content_source = realms_dlc
	type = character_event
	title = rangers.0430.t
	desc = rangers.0430.desc
	theme = intrigue
	#window = visit_settlement_window
	override_background = { reference = wilderness_forest }
	left_portrait = {
		character = root
		animation = thinking
	}
	right_portrait = {
		character = scope:farin
		animation = personality_callous
		triggered_outfit = {
			outfit_tags = { dwarf_war_steel_outfit }
		}
	}
	lower_right_portrait = {
		character = scope:andriel
	}
	immediate = { 
		character:lineofandriel = { save_scope_as = andriel } 
		character:lineofnorin2 = { save_scope_as = farin }
	}
	option = { # That news is worrying. Elrond must hear of it
		name = rangers.0430.a 
		custom_tooltip = rangers.0430.a.tt 
		start_travel_plan = { #Travel to Rivendell
			destination = title:c_imladris.title_province
			players_use_planner = no
			on_arrival_event = rangers.0431
		}
	}
}

rangers.0431 = { # Rivendell: Arrival (again)
	content_source = realms_dlc
	type = character_event
	title = rangers.0431.t
	desc = rangers.0431.desc
	theme = elven
	#window = visit_settlement_window
	override_background = { reference = throne_room_rivendell }
	left_portrait = {
		character = root
		animation = worry 
	}
	right_portrait = {
		character = scope:elrond
		animation = throne_room_conversation_2
	}
	lower_left_portrait = {
		character = scope:gandalf 
	}
	lower_center_portrait = { 
		character = scope:farin 
	}
	lower_right_portrait = {
		character = scope:andriel 
	}
	immediate = {
		title:c_imladris.holder.top_liege = { save_scope_as = elrond }
		character:lineofandriel = { save_scope_as = andriel }
		character:lineofnorin2 = { save_scope_as = farin }
		character:lineofgandalf = { save_scope_as = gandalf }
		hidden_effect = {
			current_travel_plan ?= { abort_travel_plan = yes }
		}
		#custom_tooltip = eradan_end_of_content
	}
	option = { # Find Elrond in his library
		name = rangers.0431.a
		custom_tooltip = rangers.0431.a.tt
		random_character_active_contract = {
			limit = { has_task_contract_type = lotr_eradan_contract_ettenmoors }
			complete_task_contract = success_standard
		}
		domicile ?= { 
			change_provisions = miniscule_provisions_gain 
			move_domicile = title:c_imladris.title_province
		}
		add_character_flag = eradan_locals_imladris
		add_character_flag = eradan_ready_for_gundabad
		custom_tooltip = eradan_safe_locations_tt
		hidden_effect = { # Create the Gundabad Contract
			root = {
				create_task_contract = {
					task_contract_type = lotr_eradan_contract_gundabad
					task_contract_employer = title:c_imladris.holder
					location = title:c_gundabad.title_province
					task_contract_tier = 4
					save_scope_as = created_contract
				}
			}
		}
	}
}

rangers.0432 = { # Gundabad: Arrival
	content_source = realms_dlc
	type = character_event
	title = rangers.0432.t
	desc = rangers.0432.desc
	theme = intrigue
	window = visit_settlement_window
	override_background = { reference = wilderness_mountains }
	left_portrait = {
		character = root 
		animation = thinking
	}
	center_portrait = {
		character = scope:farin 
		animation = marshal_longaxe
		triggered_outfit = {
			outfit_tags = { dwarf_war_steel_outfit }
		}
	}
	right_portrait = {
		character = scope:andriel 
		animation = holding_staff
		camera = camera_event_scheme_vs_center_look_left
	}
	immediate = {
		character:lineofandriel = { save_scope_as = andriel }
		character:lineofnorin2 = { save_scope_as = farin }
		remove_character_flag = eradan_locals_imladris
		remove_character_flag = eradan_ready_for_gundabad
		domicile ?= { 
			change_provisions = miniscule_provisions_gain 
			move_domicile = title:c_gundabad.title_province
		}
		hidden_effect = {
			current_travel_plan ?= { abort_travel_plan = yes }
		}
		if = {
			limit = { has_character_flag = spoken_with_elrond }
			remove_character_flag = spoken_with_elrond
		}
		if = {
			limit = { has_character_flag = spoken_with_elrondsons }
			remove_character_flag = spoken_with_elrondsons
		}
		if = {
			limit = { has_character_flag = spoken_with_gandalf }
			remove_character_flag = spoken_with_gandalf
		}
		if = {
			limit = { has_character_flag = spoken_with_arwen }
			remove_character_flag = spoken_with_arwen
		}
	}
	option = { # It seems this entrance is lightly guarded...
		name = rangers.0432.a
		add_prestige = minor_prestige_gain
		trigger_event = rangers.0433
	}
}

rangers.0433 = { # Gundabad: Assaulting the gate
	content_source = realms_dlc
	type = character_event
	title = rangers.0433.t
	desc = rangers.0433.desc
	theme = martial
	#window = visit_settlement_window
	override_background = { reference = dwarven_gate }
	left_portrait = {
		character = root
		animation = throne_room_two_handed_passive_1
		camera = camera_event_very_left
	}
	right_portrait = {
		character = scope:gundabad_orc
		animation = aggressive_mace
	}
	lower_left_portrait = {
		character = scope:andriel
	}
	lower_right_portrait = {
		character = scope:farin
	}
	immediate = { 
		character:lineofandriel = { save_scope_as = andriel } 
		character:lineofnorin2 = { save_scope_as = farin }
		create_character = {
			template = new_warrior_character
			dynasty = generate
			location = root.location
			gender_female_chance = 0
			save_scope_as = gundabad_orc
			prowess = 24
			culture = culture:ghrazim
			faith = faith:cult_of_the_ulukai
			after_creation = {
				scope:gundabad_orc = {
					random_list = {
						1 = { give_nickname = nick_the_dreamer }
						1 = { give_nickname = nick_the_literate_one }
						1 = { give_nickname = nick_the_flogger }
						1 = { give_nickname = nick_the_disgusting }
						1 = { give_nickname = nick_the_angry }
						1 = { give_nickname = nick_the_stalker }
						1 = { give_nickname = nick_the_crafty }
						1 = { give_nickname = nick_the_funny_one }
						1 = { give_nickname = nick_the_filthy }
						1 = { give_nickname = nick_the_screamer }
						1 = { give_nickname = nick_the_bloated }
						1 = { give_nickname = nick_the_whiner }
					}
				}
			}
		}
	}
	option = { # Charge!
		name = rangers.0433.a 
		duel = {
 			skill = prowess
			value = very_high_skill_rating 
 			50 = {
				# You're successful
 				desc = rangers.0433.a.success
 				compare_modifier = {
 					value = scope:duel_value
 					multiplier = 3.5
 					min = -49
 				}
 				hidden_effect = { 
					send_interface_toast = {
						title = rangers.0433.a.success
						left_icon = root
						right_icon = scope:gundabad_orc
						custom_tooltip = rangers.0433.a.success
					}
				}
				add_prestige = minor_prestige_gain
				scope:gundabad_orc = { death = { death_reason = death_fight killer = root } }
 			}
 			50 = {
 				# You are driven off
 				desc = rangers.0433.a.failure
 				compare_modifier = {
 					value = scope:duel_value
 					multiplier = -3.5
 					min = -49
 				}
				hidden_effect = {
					send_interface_toast = {
						title = rangers.0433.a.failure
						left_icon = root
						right_icon = scope:gundabad_orc
						custom_tooltip = rangers.0433.a.failure
					}
				}
				increase_wounds_effect = { REASON = fight }
				hidden_effect = { scope:gundabad_orc = { silent_disappearance_effect = yes } }
 			}
		}
	}
	option = { # Shoot them!
		name = rangers.0433.b 
		custom_tooltip = rangers.0433.b.tt
		domicile = {
			change_provisions = medium_provisions_loss
		}
	}
	after = {
		trigger_event = rangers.0434 
	}
}

rangers.0434 = { # Gundabad: Into the Dark
	content_source = realms_dlc
	type = character_event
	title = rangers.0434.t
	desc = rangers.0434.desc
	theme = dread
	#window = visit_settlement_window
	override_background = { reference = ce1_catacombs }
	left_portrait = {
		character = root
		animation = lantern
	}
	right_portrait = {
		character = scope:farin
		animation = marshal_longaxe
		camera = camera_event_left
		triggered_outfit = {
			outfit_tags = { dwarf_war_steel_outfit }
		}
	}
	lower_left_portrait = {
		character = scope:andriel
	}
	immediate = { 
		character:lineofandriel = { save_scope_as = andriel } 
		character:lineofnorin2 = { save_scope_as = farin }
	}
	option = { # I'm glad you're on my side, Farin
		name = rangers.0434.a
		add_stress = -20 
		trigger_event = {
			id = rangers.0435 
			days = 7 
		}
	}
}

rangers.0435 = { # Gundabad: The Vast Goblin Lair
	content_source = realms_dlc
	type = character_event
	title = rangers.0435.t
	desc = rangers.0435.desc
	theme = laamp
	#window = visit_settlement_window
	override_background = { reference = market_goblin }
	left_portrait = {
		character = root
		animation = shock
	}
	right_portrait = {
		character = scope:andriel
		animation = throne_room_one_handed_passive_1
		camera = camera_event_left
	}
	lower_left_portrait = {
		character = scope:farin
	}
	immediate = { 
		character:lineofandriel = { save_scope_as = andriel } 
		character:lineofnorin2 = { save_scope_as = farin }
	}
	option = { # I'm glad you're on my side, Andriel
		name = rangers.0435.a
		add_learning_lifestyle_xp = 400
		trigger_event = {
			id = rangers.0436
			days = 7 
		}
	}
}

rangers.0436 = { # Gundabad: Meet Gundri and Nordri
	content_source = realms_dlc
	type = character_event
	title = rangers.0436.t
	desc = rangers.0436.desc
	theme = alliance
	window = visit_settlement_window
	override_background = { reference = market_goblin }
	left_portrait = {
		character = root
		animation = interested
	}
	center_portrait = {
		character = scope:nordri
		animation = throne_room_one_handed_passive_1
		camera = camera_event_scheme_vs_center_look_left
	}
	right_portrait = {
		character = scope:gundri
		animation = marshal
	}
	lower_left_portrait = {
		character = scope:farin
	}
	lower_right_portrait = {
		character = scope:andriel 
	}
	immediate = { 
		character:lineofandriel = { save_scope_as = andriel } 
		character:lineofnorin2 = { save_scope_as = farin }
		character:lineofgundri1 = { save_scope_as = gundri }
		character:linegorin9 = { save_scope_as = nordri }
	}
	option = { # We'll fight the orcs until they flee 
		name = rangers.0436.a
		add_martial_lifestyle_xp = 400
	}
	option = { # We'll collapse the passages behind us 
		name = rangers.0436.b
		add_intrigue_lifestyle_xp = 400 
	}
	after = {
		trigger_event = rangers.0437
	}
}

rangers.0437 = { # Gundabad: The Forges
	content_source = realms_dlc
	type = character_event
	title = rangers.0437.t
	desc = rangers.0437.desc
	theme = battle
	#window = visit_settlement_window
	override_background = { reference = throne_room_dwarf }
	left_portrait = {
		character = root
		scripted_animation = bow_drawn
	}
	right_portrait = {
		character = scope:gundri
		animation = aggressive_axe
		camera = camera_event_left
	}
	lower_left_portrait = {
		character = scope:farin 
	}
	lower_center_portrait = {
		character = scope:andriel 
	}
	lower_right_portrait = {
		character = scope:nordri 
	}
	immediate = { 
		character:lineofandriel = { save_scope_as = andriel } 
		character:lineofnorin2 = { save_scope_as = farin }
		character:lineofgundri1 = { save_scope_as = gundri }
		character:linegorin9 = { save_scope_as = nordri }
	}
	option = { # We will hold them off!
		name = rangers.0437.a
		duel = {
 			skill = prowess
 			value = extremely_high_skill_rating
 			55 = {
				# You're successful
 				desc = rangers.0437.a.success
 				compare_modifier = {
 					value = scope:duel_value
 					multiplier = 3.5
 					min = -49
 				}
 				send_interface_toast = {
 					title = rangers.0437.a.success
 					left_icon = root
 					right_icon = scope:nordri
					custom_tooltip = rangers.0437.a.success
 				}
				title:c_gundabad = { 
					title_province = {
						remove_building = slave_mines_02
					}
				}
 			}
 			45 = {
 				# You failed
 				desc = rangers.0437.a.failure
 				compare_modifier = {
 					value = scope:duel_value
 					multiplier = -3.5
 					min = -49
 				}
 				send_interface_toast = {
 					title = rangers.0437.a.failure
 					left_icon = root
 					right_icon = scope:nordri
					custom_tooltip = rangers.0437.a.failure
 				}
				hidden_effect = { increase_wounds_effect = { REASON = fight } }
				increase_wounds_effect = { REASON = fight }
 			}
		}
	}
	after = {
		trigger_event = rangers.0438
	}
}

rangers.0438 = { # Gundabad: Escaping the tunnels
	content_source = realms_dlc
	type = character_event
	title = rangers.0438.t
	desc = rangers.0438.desc
	theme = dread
	#window = visit_settlement_window
	override_background = { reference = wilderness_underground }
	left_portrait = {
		character = root
		animation = worry
	}
	right_portrait = {
		character = scope:nordri
		animation = crossbow
		camera = camera_event_left
	}
	lower_left_portrait = {
		character = scope:farin 
	}
	lower_center_portrait = {
		character = scope:andriel 
	}
	lower_right_portrait = {
		character = scope:gundri 
	}	
	immediate = { 
		character:lineofandriel = { save_scope_as = andriel } 
		character:lineofnorin2 = { save_scope_as = farin }
		character:lineofgundri1 = { save_scope_as = gundri }
		character:linegorin9 = { save_scope_as = nordri }
	}
	option = { # Take the path suggested by Nordri 
		name = rangers.0438.a
		set_relation_friend = { reason = friend_deep_understanding target = scope:nordri }
		trigger_event = { id = rangers.0439 days = 20 }
	}
	option = { # Take the fastest way out 
		name = rangers.0438.b 
		scope:nordri = {
			add_opinion = {
				target = root
				modifier = disappointed_opinion
				opinion = -20
			}
		}
		trigger_event = rangers.0439
	}
}

rangers.0439 = { # Gundabad: The Light of Day
	content_source = realms_dlc
	type = character_event
	title = rangers.0439.t
	desc = rangers.0439.desc
	theme = friendly
	#window = visit_settlement_window
	override_background = { reference = wilderness_mountains }
	left_portrait = {
		character = root
		animation = happiness
	}
	right_portrait = {
		character = scope:andriel
		animation = survey_staff
		camera = camera_event_left
	}
	lower_left_portrait = {
		character = scope:farin 
	}
	lower_center_portrait = {
		character = scope:nordri 
	}
	lower_right_portrait = {
		character = scope:gundri 
	}	
	immediate = { 
		character:lineofandriel = { save_scope_as = andriel } 
		character:lineofnorin2 = { save_scope_as = farin }
		character:lineofgundri1 = { save_scope_as = gundri }
		character:linegorin9 = { save_scope_as = nordri }
	}
	option = { # We must go to Nordinbad to warn them of the army
		name = rangers.0439.a
		custom_tooltip = rangers.0439.a.tt 
		start_travel_plan = { #Travel to Nordinbad
			destination = title:c_nordinbad.title_province
			players_use_planner = no
			on_arrival_event = rangers.0440
		}
	}
}

rangers.0440 = { # Nordinbad: Arrival
	content_source = realms_dlc
	type = character_event
	title = rangers.0440.t
	desc = rangers.0440.desc
	theme = stewardship_wealth_focus
	window = visit_settlement_window
	override_background = { reference = corridor_dwarven }
	left_portrait = {
		character = root
		animation = personality_forgiving
	}
	center_portrait = {
		character = scope:nordri 
		animation = storyteller
	}
	right_portrait = {
		character = scope:gorin
		animation = personality_rational
	}
	lower_left_portrait = {
		character = scope:farin 
	}
	lower_center_portrait = {
		character = scope:andriel 
	}
	lower_right_portrait = {
		character = scope:gundri 
	}	
	immediate = { 
		character:lineofandriel = { save_scope_as = andriel } 
		character:lineofnorin2 = { save_scope_as = farin }
		character:lineofgundri1 = { save_scope_as = gundri }
		character:linegorin9 = { save_scope_as = nordri }
		character:linegorin7 = { save_scope_as = gorin }
		hidden_effect = {
			current_travel_plan ?= { abort_travel_plan = yes }
		}
		#custom_tooltip = eradan_end_of_content
	}	
	option = { # We bring news from Gundabad
		name = rangers.0440.a
		custom_tooltip = rangers.0440.a.tt
		random_character_active_contract = {
			limit = { has_task_contract_type = lotr_eradan_contract_gundabad }
			complete_task_contract = success_standard
		}
		domicile ?= { 
			change_provisions = miniscule_provisions_gain 
			move_domicile = title:c_nordinbad.title_province
		}
		add_character_flag = eradan_locals_nordinbad
		custom_tooltip = eradan_safe_locations_tt
		hidden_effect = {
			contract_passive_spawn_effect = {
				SPAWN_CONTRACTS = 5
			}
		}
		trigger_event = {
			id = rangers.0441 
			days = 15
		}
	}
}	

rangers.0441 = { # Nordinbad: A New Mission
	content_source = realms_dlc
	type = character_event
	title = rangers.0441.t
	desc = rangers.0441.desc
	theme = martial_authority_focus
	window = visit_settlement_window
	override_background = { reference = throne_room_dwarf }
	left_portrait = {
		character = root
		animation = thinking
	}
	center_portrait = {
		character = scope:farin 
		animation = marshal_longaxe
		triggered_outfit = {
			outfit_tags = { dwarf_war_steel_outfit }
		}
	}
	right_portrait = {
		character = scope:gorin
		animation = throne_room_conversation_1
	}
	lower_left_portrait = {
		character = scope:nordri 
	}
	lower_center_portrait = {
		character = scope:andriel 
	}
	lower_right_portrait = {
		character = scope:gundri 
	}	
	immediate = { 
		character:lineofandriel = { save_scope_as = andriel } 
		character:lineofnorin2 = { save_scope_as = farin }
		character:lineofgundri1 = { save_scope_as = gundri }
		character:linegorin9 = { save_scope_as = nordri }
		character:linegorin7 = { save_scope_as = gorin }
		hidden_effect = { add_contact = scope:gorin }
	}	
	option = { # A new mission for us
		name = rangers.0441.a
		custom_tooltip = rangers.0441.a.tt
		add_character_flag = eradan_ready_for_mirkwood
		hidden_effect = { # Create the Mirkwood Contract
			root = {
				create_task_contract = {
					task_contract_type = lotr_eradan_contract_mirkwood
					task_contract_employer = title:c_nordinbad.holder
					location = province:3286
					task_contract_tier = 4
					save_scope_as = created_contract
				}
			}
		}
	}
}

rangers.0442 = { # Mirkwood: The Forest Gate
	content_source = realms_dlc
	type = character_event
	title = rangers.0442.t
	desc = rangers.0442.desc
	theme = elven
	window = visit_settlement_window
	override_background = { reference = eaves_of_lorien }
	left_portrait = {
		character = root
		animation = survey
	}
	center_portrait = {
		character = scope:farin
		animation = marshal_longaxe
		triggered_outfit = {
			outfit_tags = { dwarf_war_steel_outfit }
		}
	}
	right_portrait = {
		character = scope:andriel
		animation = throne_room_conversation_3
	}
	immediate = { 
		character:lineofandriel = { save_scope_as = andriel } 
		character:lineofnorin2 = { save_scope_as = farin }
		hidden_effect = { current_travel_plan ?= { abort_travel_plan = yes } }
		remove_character_flag = eradan_ready_for_mirkwood 
		remove_character_flag = eradan_locals_nordinbad
		if = {
			limit = { has_character_flag = spoken_with_gorin }
			remove_character_flag = spoken_with_gorin
		}
		if = {
			limit = { has_character_flag = spoken_with_nordri }
			remove_character_flag = spoken_with_nordri
		}
		if = {
			limit = { has_character_flag = spoken_with_gundri }
			remove_character_flag = spoken_with_gundri 
		}
	}
	option = { # We must stay on the path 
		name = rangers.0442.a 
		custom_tooltip = rangers.0442.a.tt
		add_stress = 10 
		start_travel_plan = { #Travel further along the elven path
			destination = province:3184 # Iaurmen
			players_use_planner = no
			on_arrival_event = rangers.0443
		}
	}
}

rangers.0443 = { # Mirkwood: Darkness Beneath the Boughs
	content_source = realms_dlc
	type = character_event
	title = rangers.0443.t
	desc = rangers.0443.desc
	theme = dread
	override_background = { reference = wilderness_forest }
	left_portrait = {
		character = root
		animation = worry
	}
	right_portrait = {
		character = scope:wounded_traveler
		animation = severelywounded
	}
	lower_right_portrait = {
		character = scope:andriel
	}
	lower_center_portrait = {
		character = scope:farin 
	}
	immediate = { 
		character:lineofandriel = { save_scope_as = andriel } 
		character:lineofnorin2 = { save_scope_as = farin }
		hidden_effect = { current_travel_plan ?= { abort_travel_plan = yes } }
		create_character = {
			dynasty = none
			location = root.location
			age = 29
			gender_female_chance = 0
			culture = culture:woodmen
			faith = faith:faith_woodmen
			trait = lifestyle_traveler
			trait = wounded_2
			save_scope_as = wounded_traveler
		}
	}
	option = { # We will save your friends
		name = rangers.0443.a 
		custom_tooltip = rangers.0443.a.tt 
		add_prestige = miniscule_prestige_gain
		add_courtier = scope:wounded_traveler
		start_travel_plan = { #Travel south, leaving the elvenpath
			destination = province:3285 # Mornrad
			players_use_planner = no
			on_arrival_event = rangers.0444
		}
	}
}

rangers.0444 = { # Mirkwood: Eight-legged Foes
	content_source = realms_dlc
	type = character_event
	title = rangers.0444.t
	desc = rangers.0444.desc
	theme = battle
	override_background = { reference = wilderness_forest_deep }
	left_portrait = {
		character = root
		animation = bow_idle
	}
	right_portrait = {
		character = scope:farin
		animation = aggressive_longaxe
		camera = camera_event_left
		triggered_outfit = {
			outfit_tags = { dwarf_war_steel_outfit }
		}
	}
	lower_right_portrait = {
		character = scope:andriel
	}
	immediate = { 
		character:lineofandriel = { save_scope_as = andriel } 
		character:lineofnorin2 = { save_scope_as = farin }
		hidden_effect = { current_travel_plan ?= { abort_travel_plan = yes } }
	}
	option = { # We're under attack!
		name = rangers.0444.a 
		duel = {
 			skill = prowess
			value = very_high_skill_rating
 			50 = {
				# You're successful
 				desc = rangers.0444.a.success
 				compare_modifier = {
 					value = scope:duel_value
 					multiplier = 3.5
 					min = -49
 				}
 				hidden_effect = { 
					send_interface_toast = {
						title = rangers.0444.a.success
						left_icon = root
						custom_tooltip = rangers.0444.a.success
					}
				}
				add_martial_lifestyle_xp = 200
 			}
 			50 = {
 				# You failed
 				desc = rangers.0444.a.failure
 				compare_modifier = {
 					value = scope:duel_value
 					multiplier = -3.5
 					min = -49
 				}
				hidden_effect = {
					send_interface_toast = {
						title = rangers.0444.a.failure
						left_icon = root
						custom_tooltip = rangers.0444.a.failure
					}
				}
				increase_wounds_effect = { REASON = fight }
 			}
		}
	}
	after = {
		start_travel_plan = { #Travel further south into central Mirkwood
			destination = province:3299 # Radlaeth
			players_use_planner = no
			on_arrival_event = rangers.0445
		}
	}
}

rangers.0445 = { # Mirkwood: A Tangled Trail
	content_source = realms_dlc
	type = character_event
	title = rangers.0445.t
	desc = rangers.0445.desc
	theme = mental_break
	override_background = { reference = wilderness_forest_pine }
	left_portrait = {
		character = root
		animation = stress
	}
	right_portrait = {
		character = scope:andriel
		animation = pain
	}
	lower_center_portrait = {
		character = scope:farin 
	}
	immediate = { 
		character:lineofandriel = { save_scope_as = andriel } 
		character:lineofnorin2 = { save_scope_as = farin }
		hidden_effect = { current_travel_plan ?= { abort_travel_plan = yes } }
	}
	option = { # We must keep going!
		name = rangers.0445.a 
		add_stress = 35
		start_travel_plan = { #Travel to the spiders' lair
			destination = province:3316 # Dunrad Angaladh
			players_use_planner = no
			on_arrival_event = rangers.0446
		}
	}
	option = { # Perhaps just a short rest...
		name = rangers.0445.b 
		add_stress = -50 
		add_character_flag = eradan_mirkwood_rest
		start_travel_plan = { #Travel to the spiders' lair
			destination = province:3316 # Dunrad Angaladh
			players_use_planner = no
			on_arrival_event = rangers.0446
		}
	}
	after = {
		if = {
			limit = { has_character_flag = eradan_mirkwood_rest }
			current_travel_plan ?= {
				delay_travel_plan = {
					days = 25
				}	
			}
		}
	}
}

rangers.0446 = { # Mirkwood: The Spiders' Lair
	content_source = realms_dlc
	type = character_event
	title = rangers.0446.t
	desc = rangers.0446.desc
	theme = skull
	override_background = { reference = wilderness_forest_deep }
	left_portrait = {
		character = scope:farin
		animation = survey
		triggered_outfit = {
			outfit_tags = { dwarf_war_steel_outfit }
		}
	}
	right_portrait = {
		character = root
		animation = throne_room_one_handed_passive_1
		camera = camera_event_left
	}
	lower_center_portrait = {
		character = scope:andriel
	}
	immediate = { 
		character:lineofandriel = { save_scope_as = andriel } 
		character:lineofnorin2 = { save_scope_as = farin }
		hidden_effect = { current_travel_plan ?= { abort_travel_plan = yes } }
	}
	option = { # We must rescue them
		name = rangers.0446.a
		trigger = { NOT = { has_character_flag = eradan_mirkwood_rest } }
		random_list = {
			54 = {
				custom_tooltip = rangers.0446.a.success 
				add_prestige = medium_prestige_gain
				add_diplomacy_lifestyle_xp = 200 
 				hidden_effect = { 
					send_interface_toast = {
						title = rangers.0446.a.success
						left_icon = root
						custom_tooltip = rangers.0446.a.success
					}
				}
			}
			46 = {
				custom_tooltip = rangers.0446.a.failure 
				add_stress = 40 
 				hidden_effect = { 
					send_interface_toast = {
						title = rangers.0446.a.failure
						left_icon = root
						custom_tooltip = rangers.0446.a.failure
					}
				}
			}
		}
	}
	option = { # We must rescue them (took a rest before)
		name = rangers.0446.b 
		trigger = { has_character_flag = eradan_mirkwood_rest }
		random_list = {
			21 = {
				custom_tooltip = rangers.0446.b.success 
				add_prestige = medium_prestige_gain
				add_diplomacy_lifestyle_xp = 200 
			}
			79 = {
				custom_tooltip = rangers.0446.b.failure 
				add_stress = 40 
			}
		}
	}
	after = {
		trigger_event = rangers.0447
	}
}

rangers.0447 = { # Mirkwood: A Fresh Captive
	content_source = realms_dlc
	type = character_event
	title = rangers.0447.t
	desc = rangers.0447.desc
	theme = prison
	override_background = { reference = wilderness_forest }
	left_portrait = {
		character = root
		animation = marshal
	}
	right_portrait = {
		character = scope:glorhirin
		animation = pain
	}
	lower_center_portrait = {
		character = scope:andriel
	}
	lower_right_portrait = {
		character = scope:farin 
	}
	immediate = { 
		character:lineofandriel = { save_scope_as = andriel } 
		character:lineofnorin2 = { save_scope_as = farin }
		create_character = {
			dynasty = none
			location = root.location
			name = "Glorhirin"
			age = 975
			gender_female_chance = 0
			trait = brave
			trait = diligent
			trait = compassionate
			trait = loyal
			trait = forest_fighter
			#disallow_random_traits = yes
			culture = culture:lasgalendrim
			faith = faith:faith_eldar
			save_scope_as = glorhirin
		}
	}
	option = { # We shall aid you
		name = rangers.0447.a
		scope:glorhirin = {
			add_opinion = {
				target = root
				modifier = pleased_opinion
				opinion = 30
			}
		}
		add_courtier = scope:glorhirin
		scope:glorhirin = { add_character_flag = is_glorhirin }
		start_travel_plan = { #Travel to the boss fight location
			destination = province:3365 # Dulindor
			players_use_planner = no
			on_arrival_event = rangers.0448
		}
	}
}

rangers.0448 = { # Mirkwood: Union of Evil
	content_source = realms_dlc
	type = character_event
	title = rangers.0448.t
	desc = rangers.0448.desc
	theme = martial
	window = visit_settlement_window
	override_background = { reference = wilderness_forest_pine }
	left_portrait = {
		character = root
		scripted_animation = bow_drawn
	}
	center_portrait = {
		character = scope:andriel
		animation = throne_room_two_handed_passive_1
		camera = camera_event_scheme_vs_right_look_right
	}
	right_portrait = {
		character = scope:mirkwood_orc
		animation = aggressive_spear
	}
	lower_right_portrait = {
		character = scope:farin 
	}
	lower_center_portrait = {
		character = scope:glorhirin 
	}
	lower_left_portrait = {
		character = scope:radagast
	}
	immediate = { 
		character:lineofandriel = { save_scope_as = andriel } 
		character:lineofnorin2 = { save_scope_as = farin }
		character:lineofradagast = { save_scope_as = radagast }
		random_courtier = {
			limit = { has_character_flag = is_glorhirin }
			save_scope_as = glorhirin 
		}
		hidden_effect = { current_travel_plan ?= { abort_travel_plan = yes } }
		create_character = {
			template = new_warrior_character
			dynasty = generate
			location = root.location
			gender_female_chance = 0
			save_scope_as = mirkwood_orc
			prowess = 29
			culture = culture:kazgumhoth
			faith = faith:lidless_eye
			after_creation = {
				scope:mirkwood_orc = {
					random_list = {
						1 = { give_nickname = nick_the_dreamer }
						1 = { give_nickname = nick_the_literate_one }
						1 = { give_nickname = nick_the_flogger }
						1 = { give_nickname = nick_the_disgusting }
						1 = { give_nickname = nick_the_angry }
						1 = { give_nickname = nick_the_stalker }
						1 = { give_nickname = nick_the_crafty }
						1 = { give_nickname = nick_the_funny_one }
						1 = { give_nickname = nick_the_filthy }
						1 = { give_nickname = nick_the_screamer }
						1 = { give_nickname = nick_the_bloated }
						1 = { give_nickname = nick_the_whiner }
					}
				}
			}
		}
	}
	option = { # We must free Radagast!
		name = rangers.0448.a 
		random_list = {
			32 = {
				custom_tooltip = rangers.0448.a.success 
				add_prestige = medium_prestige_gain
 				hidden_effect = { 
					send_interface_toast = {
						title = rangers.0448.a.success
						left_icon = root
						right_icon = scope:mirkwood_orc
						custom_tooltip = rangers.0448.a.success
					}
				}
				scope:mirkwood_orc = { death = { death_reason = death_duel killer = scope:andriel } }
			}
			27 = {
				custom_tooltip = rangers.0448.a.wounded 
				add_prestige = medium_prestige_gain
 				hidden_effect = { 
					send_interface_toast = {
						title = rangers.0448.a.wounded
						left_icon = root
						right_icon = scope:mirkwood_orc
						custom_tooltip = rangers.0448.a.wounded
					}
				}
				hidden_effect = { increase_wounds_effect = { REASON = fight } }
				increase_wounds_effect = { REASON = fight }
				scope:mirkwood_orc = { death = { death_reason = death_duel killer = scope:farin } }
			}
			18 = {
				custom_tooltip = rangers.0448.a.companion 
 				hidden_effect = { 
					send_interface_toast = {
						title = rangers.0448.a.companion
						left_icon = root
						right_icon = scope:mirkwood_orc
						custom_tooltip = rangers.0448.a.companion
					}
				}
				scope:andriel = { increase_wounds_effect = { REASON = fight } }
				scope:farin = { increase_wounds_effect = { REASON = fight } }
				scope:mirkwood_orc = { death = { death_reason = death_duel killer = root } }
			}
			11 = {
				custom_tooltip = rangers.0448.a.glorhirin 
 				hidden_effect = { 
					send_interface_toast = {
						title = rangers.0448.a.glorhirin
						left_icon = root
						right_icon = scope:mirkwood_orc
						custom_tooltip = rangers.0448.a.glorhirin
					}
				}
				scope:glorhirin = { death = { death_reason = death_duel killer = scope:mirkwood_orc } }
				scope:mirkwood_orc = { death = { death_reason = death_duel killer = root } }
			}
			7 = {
				custom_tooltip = rangers.0448.a.failure 
 				hidden_effect = { 
					send_interface_toast = {
						title = rangers.0448.a.failure
						left_icon = root
						right_icon = scope:mirkwood_orc
						custom_tooltip = rangers.0448.a.failure
					}
				}
				death = { death_reason = death_fight killer = scope:mirkwood_orc }
			}
		}
	}
	after = {
		trigger_event = rangers.0449 
	}
}

rangers.0449 = { # Mirkwood: On Hidden Paths
	content_source = realms_dlc
	type = character_event
	title = rangers.0449.t
	desc = rangers.0449.desc
	theme = travel
	override_background = { reference = wilderness_forest_pine }
	left_portrait = {
		character = root
		animation = interested
	}
	right_portrait = {
		character = scope:radagast
		animation = pain
	}
	lower_center_portrait = {
		character = scope:andriel
	}
	lower_right_portrait = {
		character = scope:farin 
	}
	immediate = { 
		character:lineofandriel = { save_scope_as = andriel } 
		character:lineofnorin2 = { save_scope_as = farin }
		character:lineofradagast = { save_scope_as = radagast }
		random_courtier = {
			limit = { has_character_flag = is_glorhirin }
			save_scope_as = glorhirin 
		}
	}
	option = { # Yeah let's get out of here
		name = rangers.0449.a
		custom_tooltip = rangers.0449.a.tt 
		start_travel_plan = { #Travel to Rhosgobel
			destination = title:c_rhosghobel.title_province
			players_use_planner = no
			on_arrival_event = rangers.0450
		}
	}
}

rangers.0450 = { # Rhosgobel: Arrival
	content_source = realms_dlc
	type = character_event
	title = rangers.0450.t
	desc = rangers.0450.desc
	theme = learning
	window = visit_settlement_window
	override_background = { reference = eaves_of_lorien }
	left_portrait = {
		character = root
		animation = interested
	}
	center_portrait = {
		character = scope:farin
		animation = personality_compassionate
		camera = camera_event_scheme_vs_right_look_right
		triggered_outfit = {
			outfit_tags = { dwarf_war_steel_outfit }
		}
	}
	right_portrait = {
		character = scope:radagast
		animation = holding_staff
	}
	lower_right_portrait = {
		character = scope:andriel 
	}
	lower_center_portrait = {
		trigger = { exists = scope:glorhirin }
		character = scope:glorhirin
	}
	immediate = { 
		character:lineofandriel = { save_scope_as = andriel } 
		character:lineofnorin2 = { save_scope_as = farin }
		character:lineofradagast = { save_scope_as = radagast }
		random_courtier = {
			limit = { has_character_flag = is_glorhirin }
			save_scope_as = glorhirin 
		}
		hidden_effect = { current_travel_plan ?= { abort_travel_plan = yes } }
	}	
	option = { # Time to rest for a day
		name = rangers.0450.a
		custom_tooltip = rangers.0450.a.tt
		add_character_flag = eradan_locals_rhosgobel
		random_character_active_contract = {
			limit = { has_task_contract_type = lotr_eradan_contract_mirkwood }
			complete_task_contract = success_standard
		}
		domicile ?= { 
			change_provisions = miniscule_provisions_gain 
			move_domicile = title:c_rhosghobel.title_province
		}
		custom_tooltip = eradan_safe_locations_tt
		hidden_effect = {
			contract_passive_spawn_effect = {
				SPAWN_CONTRACTS = 5
			}
		}
		hidden_effect = { # Create the Erebor contract
			root = {
				create_task_contract = {
					task_contract_type = lotr_eradan_contract_erebor
					task_contract_employer = title:c_rhosghobel.holder
					location = title:c_aradhrynd.title_province
					task_contract_tier = 4
					save_scope_as = created_contract
				}
				add_contact = title:c_rhosghobel.holder
			}
		}
		add_character_flag = eradan_ready_for_erebor
	}
}	

rangers.0451 = { # Thranduil's Halls: Check if Elfboy is alive
	hidden = yes 
	immediate = { 
		character:lineofandriel = { save_scope_as = andriel } 
		character:lineofnorin2 = { save_scope_as = farin }
		hidden_effect = { current_travel_plan ?= { abort_travel_plan = yes } }
		random_courtier = {
			limit = { has_character_flag = is_glorhirin }
			save_scope_as = glorhirin 
		}
		remove_character_flag = eradan_ready_for_erebor
		remove_character_flag = eradan_locals_rhosgobel
		if = {
			limit = { has_character_flag = spoken_with_radagast }
			remove_character_flag = spoken_with_radagast
		}
		if = {
			limit = { has_character_flag = spoken_with_glorhirin }
			remove_character_flag = spoken_with_glorhirin
		}
		if = {
			limit = { exists = scope:glorhirin }
			trigger_event = rangers.0452
		}
		else = { 
			trigger_event = rangers.0454 
		}
	}
}

rangers.0452 = { # Thranduil's Halls: Arrival
	content_source = realms_dlc
	type = character_event
	title = rangers.0452.t
	desc = rangers.0452.desc
	theme = elven
	override_background = { reference = throne_room_woodland }
	left_portrait = {
		character = root
		animation = personality_forgiving
	}
	right_portrait = {
		character = scope:glorhirin
		animation = throne_room_conversation_2
	}
	lower_right_portrait = { character = scope:farin }
	lower_center_portrait = { character = scope:thranduil }
	lower_left_portrait = { character = scope:andriel }
	immediate = { 
		character:lineofandriel = { save_scope_as = andriel } 
		character:lineofnorin2 = { save_scope_as = farin }
		title:c_aradhrynd.holder.top_liege = { save_scope_as = thranduil }
		random_courtier = {
			limit = { has_character_flag = is_glorhirin }
			save_scope_as = glorhirin 
		}
	}
	option = { # We should ask the elvenking if he allows Glorhirin to come with us
		name = rangers.0452.a 
		custom_tooltip = rangers.0452.a.tt
		trigger_event = rangers.0453
	}
	option = { # See ya Elfboy and thanks for your help
		name = rangers.0452.b 
		custom_tooltip = rangers.0452.b.tt 
		trigger_event = rangers.0454 
	}
}

rangers.0453 = { # Thranduil's Halls: Audience with the King
	content_source = realms_dlc
	type = character_event
	title = rangers.0453.t
	desc = rangers.0453.desc
	theme = crown
	window = visit_settlement_window
	override_background = { reference = throne_room_woodland }
	left_portrait = {
		character = root
		animation = throne_room_conversation_1
	}
	center_portrait = { 
		character = scope:glorhirin
		animation = personality_content
		camera = camera_event_scheme_vs_right_look_right
	}	
	right_portrait = {
		character = scope:thranduil
		animation = personality_callous
	}
	lower_right_portrait = { character = scope:farin }
	lower_left_portrait = { character = scope:andriel }
	immediate = { 
		character:lineofandriel = { save_scope_as = andriel } 
		character:lineofnorin2 = { save_scope_as = farin }
		title:c_aradhrynd.holder.top_liege = { save_scope_as = thranduil }
		random_courtier = {
			limit = { has_character_flag = is_glorhirin }
			save_scope_as = glorhirin 
		}
	}
	option = { # Can Glorhirin come out to play please?
		name = rangers.0453.a 
		duel = {
 			skill = diplomacy
 			target = scope:thranduil
 			90 = {
				# You're successful
 				desc = rangers.0453.a.success
 				compare_modifier = {
 					value = scope:duel_value
 					multiplier = 3.5
 					min = -49
 				}
 				send_interface_toast = {
 					title = rangers.0453.a.success
 					left_icon = root
 					right_icon = scope:thranduil
					custom_tooltip = rangers.0453.a.success.tt
 				}
				add_diplomacy_lifestyle_xp = medium_lifestyle_xp
 			}
 			10 = {
 				# You failed
 				desc = rangers.0453.a.failure
 				compare_modifier = {
 					value = scope:duel_value
 					multiplier = -3.5
 					min = -49
 				}
 				send_interface_toast = {
 					title = rangers.0453.a.failure
 					left_icon = root
 					right_icon = scope:thranduil
					custom_tooltip = rangers.0453.a.failure.tt
 				}
				scope:thranduil = { add_courtier = scope:glorhirin }
 			}
		}
	}
	after = {
		trigger_event = rangers.0454 
	}
}

rangers.0454 = { # Thranduil's Halls: Onwards to Erebor
	content_source = realms_dlc
	type = character_event
	title = rangers.0454.t
	desc = rangers.0454.desc
	theme = laamp
	override_background = { reference = wilderness_forest_deep }
	left_portrait = {
		character = root
		animation = marshal
	}
	right_portrait = {
		character = scope:andriel
		animation = holding_staff
	}
	lower_right_portrait = { character = scope:farin }
	immediate = { 
		character:lineofandriel = { save_scope_as = andriel } 
		character:lineofnorin2 = { save_scope_as = farin }
	}
	option = { # Let's finally go to Erebor 
		name = rangers.0454.a 
		custom_tooltip = rangers.0454.a.tt 
		start_travel_plan = { #Travel to Erebor
			destination = title:c_throne_of_erebor.title_province
			players_use_planner = no
			on_arrival_event = rangers.0455
		}
	}
}

rangers.0455 = { # Erebor: Arrival
	content_source = realms_dlc
	type = character_event
	title = rangers.0455.t
	desc = rangers.0455.desc
	theme = realm
	window = visit_settlement_window
	override_background = { reference = market_dwarven }
	left_portrait = {
		character = root
		animation = personality_compassionate
	}
	center_portrait = {
		character = scope:farin
		animation = marshal_longaxe
		camera = camera_event_scheme_vs_right_look_right
		triggered_outfit = {
			outfit_tags = { dwarf_war_steel_outfit }
		}
	}
	right_portrait = {
		character = scope:ereborking
		animation = personality_rational
	}
	lower_right_portrait = {
		character = scope:andriel 
	}
	lower_center_portrait = {
		character = scope:ereborprince
	}
	immediate = { 
		character:lineofandriel = { save_scope_as = andriel } 
		character:lineofnorin2 = { save_scope_as = farin }
		title:c_throne_of_erebor.holder = { save_scope_as = ereborking }
		title:c_throne_of_erebor.holder.player_heir = { save_scope_as = ereborprince }
		hidden_effect = { current_travel_plan ?= { abort_travel_plan = yes } }
		#custom_tooltip = eradan_end_of_content
	}	
	option = { # We will save Nordinbad!
		name = rangers.0455.a
		custom_tooltip = rangers.0455.a.tt
		add_character_flag = eradan_locals_erebor
		random_character_active_contract = {
			limit = { has_task_contract_type = lotr_eradan_contract_erebor }
			complete_task_contract = success_standard
		}
		domicile ?= { 
			change_provisions = miniscule_provisions_gain 
			move_domicile = title:c_throne_of_erebor.title_province
		}
		custom_tooltip = eradan_safe_locations_tt
		hidden_effect = {
			contract_passive_spawn_effect = {
				SPAWN_CONTRACTS = 5
			}
		}
		trigger_event = {
			id = rangers.0456 
			days = 10 
		}
	}
}

rangers.0456 = { # Erebor: A New Mission
	content_source = realms_dlc
	type = character_event
	title = rangers.0456.t
	desc = rangers.0456.desc
	theme = realm
	window = visit_settlement_window
	override_background = { reference = throne_room_dwarf }
	left_portrait = {
		character = root
		animation = thinking
	}
	center_portrait = {
		character = scope:farin
		animation = marshal_longaxe
		camera = camera_event_scheme_vs_right_look_right
		triggered_outfit = {
			outfit_tags = { dwarf_war_steel_outfit }
		}
	}
	right_portrait = {
		character = scope:ereborking
		animation = throne_room_conversation_1
	}
	lower_right_portrait = {
		character = scope:andriel 
	}
	lower_center_portrait = {
		character = scope:ereborprince
	}
	immediate = { 
		character:lineofandriel = { save_scope_as = andriel } 
		character:lineofnorin2 = { save_scope_as = farin }
		title:c_throne_of_erebor.holder = { save_scope_as = ereborking }
		title:c_throne_of_erebor.holder.player_heir = { save_scope_as = ereborprince }
	}	
	option = { # Let us travel north
		name = rangers.0456.a
		custom_tooltip = rangers.0456.a.tt
		hidden_effect = { # Create the Grey Mountains contract
			root = {
				create_task_contract = {
					task_contract_type = lotr_eradan_contract_mountains
					task_contract_employer = title:c_throne_of_erebor.holder
					location = province:5019
					task_contract_tier = 4
					save_scope_as = created_contract
				}
				add_contact = title:c_throne_of_erebor.holder
			}
		}
		add_character_flag = eradan_ready_for_mountains
	}
}	

rangers.0457 = { # Grey Mountains: Arrival
	content_source = realms_dlc
	type = character_event
	title = rangers.0457.t
	desc = rangers.0457.desc
	theme = travel_danger
	window = visit_settlement_window
	override_background = { reference = wilderness_mountains }
	left_portrait = {
		character = root
		animation = bow_idle
	}
	right_portrait = {
		character = scope:andriel
		animation = survey_staff
	}
	center_portrait = {
		character = scope:farin
		animation = personality_callous
		triggered_outfit = {
			outfit_tags = { dwarf_war_steel_outfit }
		}
		#camera = camera_event_scheme_vs_right_look_right
	}
	immediate = { 
		character:lineofandriel = { save_scope_as = andriel } 
		character:lineofnorin2 = { save_scope_as = farin }
		hidden_effect = { current_travel_plan ?= { abort_travel_plan = yes } }
		remove_character_flag = eradan_ready_for_mountains 
		remove_character_flag = eradan_locals_erebor
		if = {
			limit = { has_character_flag = spoken_with_dain }
			remove_character_flag = spoken_with_dain
		}
		if = {
			limit = { has_character_flag = spoken_with_thorin }
			remove_character_flag = spoken_with_thorin
		}
	}
	option = { # Time to look for the enemy army
		name = rangers.0457.a 
		#custom_tooltip = rangers.0457.a.tt
		domicile ?= { 
			change_provisions = minor_provisions_gain 
		}
		trigger_event = rangers.0458
	}
}

rangers.0458 = { # Grey Mountains: Spotted by Orcs
	content_source = realms_dlc
	type = character_event
	title = rangers.0458.t
	desc = rangers.0458.desc
	theme = battle
	#window = visit_settlement_window
	override_background = { reference = wilderness_mountains }
	left_portrait = {
		character = root
		animation = throne_room_two_handed_passive_1
		camera = camera_event_very_left
	}
	right_portrait = {
		character = scope:greymountains_orc
		animation = aggressive_axe
	}
	lower_left_portrait = {
		character = scope:andriel
	}
	lower_right_portrait = {
		character = scope:farin
	}
	immediate = { 
		character:lineofandriel = { save_scope_as = andriel } 
		character:lineofnorin2 = { save_scope_as = farin }
		hidden_effect = { current_travel_plan ?= { abort_travel_plan = yes } }
		create_character = {
			template = new_warrior_character
			dynasty = generate
			location = root.location
			gender_female_chance = 0
			save_scope_as = greymountains_orc
			prowess = 29
			culture = culture:worauthai_madur
			faith = faith:dragon_cult
			after_creation = {
				scope:greymountains_orc = {
					random_list = {
						1 = { give_nickname = nick_the_dreamer }
						1 = { give_nickname = nick_the_literate_one }
						1 = { give_nickname = nick_the_flogger }
						1 = { give_nickname = nick_the_disgusting }
						1 = { give_nickname = nick_the_angry }
						1 = { give_nickname = nick_the_stalker }
						1 = { give_nickname = nick_the_crafty }
						1 = { give_nickname = nick_the_funny_one }
						1 = { give_nickname = nick_the_filthy }
						1 = { give_nickname = nick_the_screamer }
						1 = { give_nickname = nick_the_bloated }
						1 = { give_nickname = nick_the_whiner }
					}
				}
			}
		}
	}
	option = { # Charge!
		name = rangers.0458.a 
		duel = {
 			skill = prowess
			target = scope:greymountains_orc 
 			50 = {
				# You're successful
 				desc = rangers.0458.a.success
 				compare_modifier = {
 					value = scope:duel_value
 					multiplier = 3.5
 					min = -49
 				}
 				hidden_effect = { 
					send_interface_toast = {
						title = rangers.0458.a.success
						left_icon = root
						right_icon = scope:greymountains_orc
						custom_tooltip = rangers.0458.a.success
					}
				}
				add_prestige = minor_prestige_gain
				scope:greymountains_orc = { death = { death_reason = death_fight killer = root } }
 			}
 			50 = {
 				# You are wounded
 				desc = rangers.0458.a.failure
 				compare_modifier = {
 					value = scope:duel_value
 					multiplier = -3.5
 					min = -49
 				}
				hidden_effect = {
					send_interface_toast = {
						title = rangers.0458.a.failure
						left_icon = root
						right_icon = scope:greymountains_orc
						custom_tooltip = rangers.0458.a.failure
					}
				}
				increase_wounds_effect = { REASON = fight }
				hidden_effect = { scope:greymountains_orc = { silent_disappearance_effect = yes } }
 			}
		}
	}
	option = { # Shoot them!
		name = rangers.0458.b 
		custom_tooltip = rangers.0458.b.tt
		domicile = {
			change_provisions = major_provisions_loss
		}
		scope:greymountains_orc = { death = { death_reason = death_fight killer = root } }
	}
	after = {
		trigger_event = rangers.0459 
	}
}

rangers.0459 = { # Grey Mountains: Belaram is back
	content_source = realms_dlc
	type = character_event
	title = rangers.0459.t
	desc = rangers.0459.desc
	theme = friend_relation
	#window = visit_settlement_window
	override_background = { reference = eagles }
	left_portrait = {
		character = root
		animation = happiness
	}
	right_portrait = {
		character = scope:andriel
		animation = holding_staff 
		camera = camera_event_left
	}
	lower_left_portrait = {
		character = scope:farin
	}
	immediate = { 
		character:lineofandriel = { save_scope_as = andriel } 
		character:lineofnorin2 = { save_scope_as = farin }
	}
	option = { # It's good to see you buddy but you bear grave news 
		name = rangers.0459.a 
		custom_tooltip = rangers.0459.a.tt
		add_stress = 20
		start_travel_plan = { #Travel towards Nordinbad
			destination = title:c_makalkukhizdin.title_province
			players_use_planner = no
			on_arrival_event = rangers.0460
		}
	}
}

rangers.0460 = { # Grey Mountains: Mourning the lost dwarven holds 
	content_source = realms_dlc
	type = character_event
	title = rangers.0460.t
	desc = rangers.0460.desc
	theme = balrog
	#window = visit_settlement_window
	override_background = { reference = wilderness_mountains }
	left_portrait = {
		character = root
		animation = worry
	}
	right_portrait = {
		character = scope:farin
		animation = sorrow 
		triggered_outfit = {
			outfit_tags = { dwarf_war_steel_outfit }
		}
	}
	lower_left_portrait = {
		character = scope:andriel
	}
	immediate = { 
		character:lineofandriel = { save_scope_as = andriel } 
		character:lineofnorin2 = { save_scope_as = farin }
		hidden_effect = { current_travel_plan ?= { abort_travel_plan = yes } }
	}
	option = { # I'm sorry to hear that, Farin
		name = rangers.0460.a 
		custom_tooltip = rangers.0460.a.tt
		scope:farin = {
			add_opinion = {
				target = root 
				modifier = comforted_opinion
			}
		}
		start_travel_plan = { #Travel on towards Nordinbad
			destination = title:c_fireheart_mine.title_province
			players_use_planner = no
			on_arrival_event = rangers.0461
		}
	}
}

rangers.0461 = { # Grey Mountains: Nordinbad is already under siege!
	content_source = realms_dlc
	type = character_event
	title = rangers.0461.t
	desc = rangers.0461.desc
	theme = war
	#window = visit_settlement_window
	override_background = { reference = ettenmoors }
	left_portrait = {
		character = root
		animation = shock
	}
	right_portrait = {
		character = scope:farin
		animation = anger 
		triggered_outfit = {
			outfit_tags = { dwarf_war_steel_outfit }
		}
		camera = camera_event_left
	}
	lower_left_portrait = {
		character = scope:andriel
	}
	immediate = { 
		character:lineofandriel = { save_scope_as = andriel } 
		character:lineofnorin2 = { save_scope_as = farin }
		title:c_mattugard.holder.top_liege = { save_scope_as = gundabadholder }
		title:c_nordinbad.holder = { save_scope_as = nordinbadholder }
		hidden_effect = { current_travel_plan ?= { abort_travel_plan = yes } }
	}
	option = { # We have to hurry towards them!
		name = rangers.0461.a 
		custom_tooltip = rangers.0461.a.tt
		scope:gundabadholder = {
			start_war = {
				casus_belli = invasion_war
				target = scope:nordinbadholder
				target_title = title:c_nordinbad
			}
		}
		scope:nordinbadholder = {
			every_character_war = {
				limit = {
					is_attacker = scope:gundabadholder
				}
				add_defender = root
			}
		}
		start_travel_plan = { #Travel on towards Nordinbad
			destination = title:c_nordinbad.title_province
			players_use_planner = no
			on_arrival_event = rangers.0462
		}
		create_alliance = {
			target = scope:nordinbadholder
			allied_through_owner = root
			allied_through_target = scope:nordinbadholder
		}
		scope:nordinbadholder = {
			add_opinion = {
				modifier = perk_negotiated_alliance_opinion
				target = root
			}
		}
	}
}

rangers.0462 = { # Nordinbad: The Siege
	content_source = realms_dlc
	type = character_event
	title = rangers.0462.t
	desc = rangers.0462.desc
	theme = war
	window = visit_settlement_window
	override_background = { reference = dwarven_gate }
	left_portrait = {
		character = root
		scripted_animation = bow_drawn
	}
	center_portrait = {
		character = scope:gundabadholder
		animation = random_weapon_coup_degrace
		camera = camera_event_scheme_vs_center_look_left
	}
	right_portrait = {
		character = scope:gundabad_troll
		animation = menacing 
		camera = camera_event_scheme_vs_center_look_left
	}
	lower_left_portrait = {
		character = scope:andriel
	}
	lower_center_portrait = {
		character = scope:farin 
	}
	lower_right_portrait = {
		character = scope:nordinbadholder
	}
	immediate = { 
		character:lineofandriel = { save_scope_as = andriel } 
		character:lineofnorin2 = { save_scope_as = farin }
		title:c_mattugard.holder.top_liege = { save_scope_as = gundabadholder }
		title:c_nordinbad.holder = { save_scope_as = nordinbadholder }
		title:c_nordinbad = { save_scope_as = targeted_county }
		hidden_effect = { current_travel_plan ?= { abort_travel_plan = yes } }
		create_character = { # Create a new troll
			culture = culture:cave_troll
			faith = faith:way_of_strength
			prowess = 35
			gender_female_chance = 0
			location = root.location
			save_scope_as = gundabad_troll
		}
	}
	option = { # Nordinbad must not fall!
		name = rangers.0462.a 
		#custom_tooltip = rangers.0462.a.tt
		random_list = {
			28 = {
				custom_tooltip = rangers.0462.a.success 
				add_prestige = major_prestige_gain
 				hidden_effect = { 
					send_interface_toast = {
						title = rangers.0462.a.success
						left_icon = root
						custom_tooltip = rangers.0462.a.success
					}
				}
				scope:gundabadholder = { death = { death_reason = death_duel killer = root } }
				scope:gundabad_troll = { death = { death_reason = death_fight killer = scope:farin } }
			}
			16 = {
				custom_tooltip = rangers.0462.a.scareoff 
				add_prestige = medium_prestige_gain
 				hidden_effect = { 
					send_interface_toast = {
						title = rangers.0462.a.scareoff
						left_icon = root
						custom_tooltip = rangers.0462.a.scareoff
					}
				}
				scope:gundabad_troll = { death = { death_reason = death_fight killer = scope:andriel } }
			}
			19 = {
				custom_tooltip = rangers.0462.a.wounded 
				add_prestige = medium_prestige_gain
 				hidden_effect = { 
					send_interface_toast = {
						title = rangers.0462.a.wounded
						left_icon = root
						custom_tooltip = rangers.0462.a.wounded
					}
				}
				hidden_effect = { increase_wounds_effect = { REASON = fight } }
				increase_wounds_effect = { REASON = fight }
			}
			22 = {
				custom_tooltip = rangers.0462.a.companion 
 				hidden_effect = { 
					send_interface_toast = {
						title = rangers.0462.a.companion
						left_icon = root
						custom_tooltip = rangers.0462.a.companion
					}
				}
				scope:andriel = { increase_wounds_effect = { REASON = fight } }
				scope:farin = { increase_wounds_effect = { REASON = fight } }
			}
			7 = {
				custom_tooltip = rangers.0462.a.defeat
 				hidden_effect = { 
					send_interface_toast = {
						title = rangers.0462.a.defeat
						left_icon = root
						custom_tooltip = rangers.0462.a.defeat
					}
				}
				add_courtier = scope:nordinbadholder.player_heir
				scope:nordinbadholder = { death = { death_reason = death_battle killer = scope:gundabadholder } }
				make_settlement_county_wilderness = { COUNTY = scope:targeted_county } 
			}
			8 = {
				custom_tooltip = rangers.0462.a.failure 
 				hidden_effect = { 
					send_interface_toast = {
						title = rangers.0462.a.failure
						left_icon = root
						custom_tooltip = rangers.0462.a.failure
					}
				}
				death = { death_reason = death_battle killer = scope:gundabadholder } 
				scope:nordinbadholder = { death = { death_reason = death_battle killer = scope:gundabadholder } }
				make_settlement_county_wilderness = { COUNTY = scope:targeted_county }
			}
		}
	}
	after = {
		if = {
			limit = { title:c_nordinbad.title_province = { has_holding_type = dwarven_holding } } 
			trigger_event = rangers.0463
		}
		else = { trigger_event = rangers.0464 }
	}
}

rangers.0463 = { # Nordinbad: Victory!
	content_source = realms_dlc
	type = character_event
	title = rangers.0463.t
	desc = rangers.0463.desc
	theme = crown
	window = visit_settlement_window
	override_background = { reference = wilderness_mountains }
	left_portrait = {
		character = root
		animation = happiness
	}
	right_portrait = {
		character = scope:thorin
		animation = marshal_shield 
		triggered_outfit = {
			outfit_tags = { dwarf_war_steel_outfit }
		}
	}
	lower_left_portrait = {
		character = scope:andriel
	}
	lower_center_portrait = {
		character = scope:nordinbadholder
	}
	lower_right_portrait = {
		character = scope:farin 
	}
	immediate = { 
		character:lineofandriel = { save_scope_as = andriel } 
		character:lineofnorin2 = { save_scope_as = farin }
		title:c_mattugard.holder.top_liege = { save_scope_as = gundabadholder }
		title:c_nordinbad.holder = { save_scope_as = nordinbadholder }
		title:c_throne_of_erebor.holder = { save_scope_as = ereborholder }
		title:c_throne_of_erebor.holder.top_liege.player_heir = { save_scope_as = thorin }
		scope:nordinbadholder = {
			every_character_war = { 
				limit = {
					is_attacker = scope:gundabadholder
				}
				save_scope_as = war_for_nordinbad
			}
		}
		hidden_effect = { current_travel_plan ?= { abort_travel_plan = yes } }
	}
	option = { # Reinforcements are here!
		name = rangers.0463.a 
		scope:war_for_nordinbad = {
			add_defender = scope:ereborholder
		}
		spawn_army = {
			men_at_arms = {			
				type = longbeard_heavy_infantry
				stacks = 5
			}
			men_at_arms = {
				type = longbeard_pikemen
				stacks = 5
			}
			men_at_arms = {
				type = longbeard_skirmishers
				stacks = 5 
			}
			men_at_arms = {	
				type = trebuchet 
				stacks = 3 
			}
			inheritable = no
			location = root.location
			war = scope:war_for_nordinbad
			war_keep_on_attacker_victory = no
			name = host_of_erebor
		}
		add_character_flag = eradan_locals_nordinbad
		custom_tooltip = rangers.0463.a.tt
		random_character_active_contract = {
			limit = { has_task_contract_type = lotr_eradan_contract_mountains }
			complete_task_contract = success_standard
		}
		domicile ?= { 
			change_provisions = miniscule_provisions_gain 
			move_domicile = title:c_nordinbad.title_province
		}
		custom_tooltip = eradan_safe_locations_tt
		hidden_effect = {
			contract_passive_spawn_effect = {
				SPAWN_CONTRACTS = 5
			}
		}
	}
	after = { # We must end the threat of Gundabad
		hidden_effect = { # Create the final contract
			root = {
				create_task_contract = {
					task_contract_type = lotr_eradan_contract_final
					task_contract_employer = title:c_nordinbad.holder
					location = title:c_gundabad.title_province
					task_contract_tier = 4
					save_scope_as = created_contract
				}
			}
		}
		add_character_flag = eradan_ready_for_final
	}
}

rangers.0464 = { # Nordinbad: Defeat!
	content_source = realms_dlc
	type = character_event
	title = rangers.0464.t
	desc = rangers.0464.desc
	theme = war
	override_background = { reference = wilderness_mountains }
	left_portrait = {
		character = root
		animation = sorrow
	}
	right_portrait = {
		character = scope:thorin
		animation = marshal_shield 
		triggered_outfit = {
			outfit_tags = { dwarf_war_steel_outfit }
		}
	}
	lower_left_portrait = {
		character = scope:andriel
	}
	lower_right_portrait = {
		character = scope:farin 
	}
	immediate = { 
		character:lineofandriel = { save_scope_as = andriel } 
		character:lineofnorin2 = { save_scope_as = farin }
		title:c_mattugard.holder.top_liege = { save_scope_as = gundabadholder }
		title:c_throne_of_erebor.holder = { save_scope_as = ereborholder }
		title:c_throne_of_erebor.holder.top_liege.player_heir = { save_scope_as = thorin }
		scope:gundabadholder = {
			every_character_war = { 
				limit = {
					is_attacker = scope:gundabadholder
					casus_belli = {
						any_target_title = {
							this = title:c_nordinbad
						}
					}
				}
				save_scope_as = war_for_nordinbad
			}
		}
		custom_tooltip = eradan_end_of_content
	}
	option = { # We can only retreat to Erebor for now...
		name = rangers.0464.a 
		scope:war_for_nordinbad = {
			end_war = attacker
		}
		random_character_active_contract = {
			limit = { has_task_contract_type = lotr_eradan_contract_mountains }
			complete_task_contract = failure_standard
		}
		custom_tooltip = rangers.0464.a.tt
		start_travel_plan = { #Flee to Erebor
			destination = title:c_throne_of_erebor.title_province
			players_use_planner = no
			on_arrival_event = rangers.0465
		}
	}
}

rangers.0465 = { # Nordinbad: Avenging Nordinbad
	content_source = realms_dlc
	type = character_event
	title = rangers.0465.t
	desc = rangers.0465.desc
	theme = war
	override_background = { reference = throne_room_dwarf }
	left_portrait = {
		character = root
		animation = anger
	}
	right_portrait = {
		character = scope:farin
		animation = marshal_longaxe 
		triggered_outfit = {
			outfit_tags = { dwarf_war_steel_outfit }
		}
		camera = camera_event_left
	}
	lower_left_portrait = {
		character = scope:andriel
	}
	lower_right_portrait = {
		character = scope:thorin 
	}
	immediate = { 
		character:lineofandriel = { save_scope_as = andriel } 
		character:lineofnorin2 = { save_scope_as = farin }
		character:linegorin9 = { save_scope_as = nordri }
		title:c_mattugard.holder.top_liege = { save_scope_as = gundabadholder }
		title:c_throne_of_erebor.holder = { save_scope_as = ereborholder }
		title:c_throne_of_erebor.holder.top_liege.player_heir = { save_scope_as = thorin }
		hidden_effect = { current_travel_plan ?= { abort_travel_plan = yes } }
	}
	option = { # We will gather our strength and strike when the time is right
		name = rangers.0465.a 
		custom_tooltip = rangers.0465.a.tt
		add_character_flag = eradan_avenge_nordinbad
		add_character_flag = eradan_locals_erebor
		custom_tooltip = eradan_safe_locations_tt
		hidden_effect = {
			contract_passive_spawn_effect = {
				SPAWN_CONTRACTS = 5
			}
		}
	}
}

rangers.0466 = { # Nordinbad: Vengeance
	content_source = realms_dlc
	type = character_event
	title = rangers.0466.t
	desc = rangers.0466.desc
	theme = martial_authority_focus
	window = visit_settlement_window
	override_background = { reference = throne_room_dwarf }
	left_portrait = {
		character = root
		animation = celebrate_spear
	}
	center_portrait = {
		character = scope:farin 
		animation = celebrate_longaxe
		triggered_outfit = {
			outfit_tags = { dwarf_war_steel_outfit }
		}
	}
	right_portrait = {
		character = scope:gundabadholder
		animation = shock
	}
	immediate = {
		title:c_mattugard.holder.top_liege = { save_scope_as = gundabadholder }
		character:lineofandriel = { save_scope_as = andriel } 
		character:lineofnorin2 = { save_scope_as = farin }
		title:c_throne_of_erebor.holder.top_liege.player_heir = { save_scope_as = thorin }
		remove_character_flag = eradan_avenge_nordinbad 
		scope:gundabadholder = { death = { death_reason = death_execution killer = scope:farin } }
		add_prestige = massive_prestige_gain
		title:c_mattugard = { add_to_list = avenged_titles_taken }
		title:c_gundabad = { add_to_list = avenged_titles_taken }
		if = {
			limit = { character:linegorin9 = { is_alive = yes } }
			character:linegorin9 = { save_scope_as = nordinbadrestorer }
		}
		else = {
			scope:thorin = { save_scope_as = nordinbadrestorer }
		}
	}
	option = { # We shall restore Nordinbad
		name = rangers.0466.a 
		
		title:d_gundabad = { 
			every_in_de_jure_hierarchy = {
				limit = { 
					#this.title_province = { has_holding_type = dwarven_holding } 
					tier = tier_county
					holder = { faith_is_evil = yes } # don't kick out any dwarves
				}
				make_settlement_county_wilderness = { COUNTY = this }
			}
		}

		create_title_and_vassal_change = {
			type = returned
			save_scope_as = change
			add_claim_on_loss = no
		}

		title:c_nordinbad = {
			set_county_culture = root.culture
			set_county_faith = root.faith
			generate_coa = yes
			change_development_level = 4
		}
		title:c_nordinbad = {
			change_title_holder = {
				holder = scope:nordinbadrestorer
				change = scope:change
			}			
		}
		resolve_title_and_vassal_change = scope:change
		
		title:c_nordinbad.title_province = {
			set_holding_type = dwarven_holding	
			add_building = dwarven_depths_02
		}
	}
			
	option = { # Gundabad will be taken
		name = rangers.0466.b 
		
		create_title_and_vassal_change = {
			type = returned
			save_scope_as = change
			add_claim_on_loss = no
		}
		every_in_list = {
			list = avenged_titles_taken
			set_county_culture = scope:thorin.culture
			set_county_faith = scope:thorin.faith
			change_title_holder = {
				holder = scope:thorin
				change = scope:change
				take_baronies = yes
			}
		}
		resolve_title_and_vassal_change = scope:change
	}
	after = {
		trigger_event = rangers.0472
	}
}

rangers.0467 = { # Gundabd: March on Gundabad
	content_source = realms_dlc
	type = character_event
	title = rangers.0467.t
	desc = rangers.0467.desc
	theme = war
	window = visit_settlement_window
	override_background = { reference = dwarven_gate }
	left_portrait = {
		character = root
		animation = marshal
	}
	center_portrait = {
		character = scope:farin 
		animation = aggressive_longaxe
		triggered_outfit = {
			outfit_tags = { dwarf_war_steel_outfit }
		}
	}
	right_portrait = {
		character = scope:gundabadholder
		animation = rage
	}
	lower_left_portrait = { 
		character = scope:thorin 
	}
	lower_center_portrait = {
		character = scope:nordri 
	}
	lower_right_portrait = {
		character = scope:andriel 
	}
	immediate = {
		title:c_mattugard.holder.top_liege = { save_scope_as = gundabadholder }
		character:lineofandriel = { save_scope_as = andriel } 
		character:lineofnorin2 = { save_scope_as = farin }
		title:c_throne_of_erebor.holder.top_liege.player_heir = { save_scope_as = thorin }
		remove_character_flag = eradan_ready_for_final 
		character:linegorin9 = { save_scope_as = nordri }
		every_ruler = {
			limit = {
				is_landless_adventurer = yes 
				has_character_flag = is_agandaur
				is_orc = yes
			}
			save_scope_as = agandaur
		}
	}
	option = { # He shall pay for what he did!
		name = rangers.0467.a
		show_as_tooltip = {
			random_list = {
				67 = { # Jebait: You die
					custom_tooltip = rangers.0467.a.failure 
					death = { death_reason = death_battle killer = scope:gundabadholder }
				}
				33 =  { # Jebait: You win 
					custom_tooltip = rangers.0467.a.success 
					scope:gundabadholder = { death = { death_reason = death_duel killer = scope:farin } }
				}
			}
		}
		hidden_effect = { # What actually happens 
			if = { # If the Agandaur orc is alive
				limit = {
					exists = scope:agandaur 
				}
				trigger_event = rangers.0468
			}
			else = { # If not, Thorin just kicks in the door
				trigger_event = rangers.0470
			}
		}
	}
}

rangers.0468 = { # Gundabad: Return of Agandaur
	content_source = realms_dlc
	type = character_event
	title = rangers.0468.t
	desc = rangers.0468.desc
	theme = dread
	window = visit_settlement_window
	override_background = { reference = battlefield }
	left_portrait = {
		character = root
		animation = shock
	}
	center_portrait = {
		character = scope:agandaur 
		animation = random_weapon_coup_degrace
		camera = camera_event_scheme_vs_center_look_left
		#outfit_tags = { military_outfit }
	}
	right_portrait = {
		character = scope:gundabad_troll_new
		animation = menacing
	}
	lower_left_portrait = { 
		character = scope:farin 
	}
	lower_center_portrait = {
		character = scope:thorin 
	}
	lower_right_portrait = {
		character = scope:andriel 
	}
	immediate = {
		title:c_mattugard.holder.top_liege = { save_scope_as = gundabadholder }
		scope:gundabadholder = {
			every_held_title = {
				limit = { tier >= tier_county }
				add_to_list = titles_to_transfer 
			}
		}
		title:k_gundabad = {
			if = {
				limit = {
					holder.top_liege = scope:gundabadholder
					holder.primary_title.tier < tier_kingdom
				}
				holder = {
					add_to_list = rulers_transferred
				}
			}
		}
		character:lineofandriel = { save_scope_as = andriel } 
		character:lineofnorin2 = { save_scope_as = farin }
		title:c_throne_of_erebor.holder.top_liege.player_heir = { save_scope_as = thorin }
		character:linegorin9 = { save_scope_as = nordri }
		create_character = { # Create a new troll
			culture = culture:cave_troll
			faith = faith:way_of_strength
			prowess = 45
			gender_female_chance = 0
			location = root.location
			save_scope_as = gundabad_troll_new
		}
		create_title_and_vassal_change = {
			type = swear_fealty
			add_claim_on_loss = yes
			save_scope_as = change
		}
		every_in_list = {
			list = titles_to_transfer
			change_title_holder = {
				holder = scope:agandaur
				change = scope:change
			}
		}
		every_in_list = {
			list = rulers_transferred
			change_liege = {
				liege = scope:agandaur
				change = scope:change
			}
		}
		resolve_title_and_vassal_change = scope:change 
		if = {
			limit = { scope:agandaur = { NOT = { has_title = title:k_gundabad } } }
			scope:agandaur = { get_title = title:k_gundabad } 
		}
		scope:gundabadholder = { death = { death_reason = death_assassination killer = scope:agandaur } }
	}
	option = { # Weesa in biiig trouble now
		name = rangers.0468.a
		duel = {
 			skill = prowess
 			target = scope:gundabad_troll_new
 			60 = {
				# You're successful
 				desc = rangers.0468.a.success
 				compare_modifier = {
 					value = scope:duel_value
 					multiplier = 3.5
 					min = -49
 				}
 				send_interface_toast = {
 					title = rangers.0468.a.success
 					left_icon = root
 					right_icon = scope:gundabad_troll_new
					custom_tooltip = rangers.0468.a.success
 				}
				add_martial_lifestyle_xp = medium_lifestyle_xp
				scope:gundabad_troll_new = { death = { death_reason = death_duel killer = root } }
				trigger_event = rangers.0469
 			}
 			40 = {
 				# You failed
 				desc = rangers.0468.a.failure
 				compare_modifier = {
 					value = scope:duel_value
 					multiplier = -3.5
 					min = -49
 				}
 				send_interface_toast = {
 					title = rangers.0468.a.failure
 					left_icon = root
 					right_icon = scope:gundabad_troll_new
					custom_tooltip = rangers.0468.a.failure
 				}
				death = { death_reason = death_duel killer = scope:gundabad_troll_new }
 			}
		}
	}
}

rangers.0469 = { # Gundabad: Time for an actual war
	content_source = realms_dlc
	type = character_event
	title = rangers.0469.t
	desc = rangers.0469.desc
	theme = war
	#window = visit_settlement_window
	override_background = { reference = wilderness_mountains }
	left_portrait = {
		character = root
		animation = marshal
	}
	right_portrait = {
		character = scope:gundabadholder
		animation = personality_callous
		#outfit_tags = { military_outfit }
	}
	lower_left_portrait = { 
		character = scope:thorin 
	}
	lower_center_portrait = {
		character = scope:farin 
	}
	lower_right_portrait = {
		character = scope:andriel 
	}
	immediate = {
		title:c_mattugard.holder.top_liege = { save_scope_as = gundabadholder }
		character:lineofandriel = { save_scope_as = andriel } 
		character:lineofnorin2 = { save_scope_as = farin }
		title:c_throne_of_erebor.holder.top_liege.player_heir = { save_scope_as = thorin } 
		character:linegorin9 = { save_scope_as = nordri }
	}	
	option = { # Time to bring out the big guns 
		name = rangers.0469.a 
		add_character_flag = eradan_final_war
		start_war = {
			casus_belli = avenge_nordinbad_cb
			target = title:c_mattugard.holder.top_liege
		}
	}
	after = {
		every_character_war = {
			limit = { using_cb = avenge_nordinbad_cb }
			add_attacker = title:k_erebor.holder 
			add_attacker = title:c_nordinbad.holder 
		}
	}
}

rangers.0470 = { # Gundabad: Thorin kicks in the door
	content_source = realms_dlc
	type = character_event
	title = rangers.0470.t
	desc = rangers.0470.desc
	theme = war
	#window = visit_settlement_window
	override_background = { reference = wilderness_mountains }
	left_portrait = {
		character = scope:thorin
		animation = war_attacker
		triggered_outfit = {
			outfit_tags = { dwarf_war_steel_outfit }
		}
	}
	right_portrait = {
		character = scope:gundabadholder
		animation = personality_callous
	}
	lower_left_portrait = { 
		character = root 
	}
	lower_center_portrait = {
		character = scope:farin 
	}
	lower_right_portrait = {
		character = scope:andriel 
	}
	immediate = {
		title:c_mattugard.holder.top_liege = { save_scope_as = gundabadholder }
		character:lineofandriel = { save_scope_as = andriel } 
		character:lineofnorin2 = { save_scope_as = farin }
		title:c_throne_of_erebor.holder.top_liege.player_heir = { save_scope_as = thorin } 
		character:linegorin9 = { save_scope_as = nordri }
	}	
	option = { # Time to bring out the big guns 
		name = rangers.0470.a 
		add_character_flag = eradan_final_war
		start_war = {
			casus_belli = avenge_nordinbad_cb
			target = title:c_mattugard.holder.top_liege
		}
	}
	after = {
		every_character_war = {
			limit = { using_cb = avenge_nordinbad_cb }
			add_attacker = title:k_erebor.holder 
			add_attacker = title:c_nordinbad.holder 
		}
	}
}

rangers.0471 = { # Gundabad: Win the final war
	content_source = realms_dlc
	type = character_event
	title = rangers.0471.t
	desc = rangers.0471.desc
	theme = legend
	window = visit_settlement_window
	override_background = { reference = wilderness_mountains }
	left_portrait = {
		character = root
		animation = celebrate_sword
	}
	right_portrait = {
		character = scope:gundabadholder
		animation = shock
		animate_if_dead = yes
	}
	lower_left_portrait = { 
		character = scope:thorin 
	}
	lower_center_portrait = {
		character = scope:farin 
	}
	lower_right_portrait = {
		character = scope:andriel 
	}
	immediate = {
		title:c_mattugard.holder.top_liege = { save_scope_as = gundabadholder }
		character:lineofandriel = { save_scope_as = andriel } 
		character:lineofnorin2 = { save_scope_as = farin }
		title:c_throne_of_erebor.holder.top_liege = { save_scope_as = ereborholder }
		title:c_throne_of_erebor.holder.top_liege.player_heir = { save_scope_as = thorin } 
		character:linegorin9 = { save_scope_as = nordri }
		scope:gundabadholder = { death = { death_reason = death_execution killer = scope:farin } }
		add_prestige = massive_prestige_gain
		title:c_mattugard = { add_to_list = avenged_titles_taken }
		title:c_gundabad = { add_to_list = avenged_titles_taken }
	}
	option = { # Gundabad is restored to Durin's Folk
		name = rangers.0471.a
		custom_tooltip = rangers.0471.a.tt
		random_character_active_contract = {
			limit = { has_task_contract_type = lotr_eradan_contract_final }
			complete_task_contract = success_standard
		}
		create_title_and_vassal_change = {
			type = returned
			save_scope_as = change
			add_claim_on_loss = no
		}
		every_in_list = {
			list = avenged_titles_taken
			set_county_culture = scope:thorin.culture
			set_county_faith = scope:thorin.faith
			change_title_holder = {
				holder = scope:thorin
				change = scope:change
				take_baronies = yes
			}
		}
		resolve_title_and_vassal_change = scope:change
		
		#domicile ?= { 
		#	change_provisions = miniscule_provisions_gain 
		#	move_domicile = title:c_gundabad.title_province
		#}
		hidden_effect = {
			contract_passive_spawn_effect = {
				SPAWN_CONTRACTS = 5
			}
		}
	}
	option = { # Nordinbad claims Gundabad
		name = rangers.0471.b
		custom_tooltip = rangers.0471.a.tt
		random_character_active_contract = {
			limit = { has_task_contract_type = lotr_eradan_contract_final }
			complete_task_contract = success_standard
		}
		create_title_and_vassal_change = {
			type = returned
			save_scope_as = change
			add_claim_on_loss = no
		}
		every_in_list = {
			list = avenged_titles_taken
			set_county_culture = scope:thorin.culture
			set_county_faith = scope:thorin.faith
			change_title_holder = {
				holder = scope:nordri
				change = scope:change
				take_baronies = yes
			}
		}
		resolve_title_and_vassal_change = scope:change
		
		domicile ?= { 
			change_provisions = miniscule_provisions_gain 
			move_domicile = title:c_gundabad.title_province
		}
		hidden_effect = {
			contract_passive_spawn_effect = {
				SPAWN_CONTRACTS = 5
			}
		}
	}
	after = {
		create_alliance = {
			target = title:c_gundabad.holder
			allied_through_owner = root
			allied_through_target = title:c_gundabad.holder
		}
		scope:thorin = {
			add_opinion = {
				modifier = perk_negotiated_alliance_opinion
				target = root
			}
		}
		create_title_and_vassal_change = {
			type = swear_fealty
			save_scope_as = fealty_change
		}
		title:c_gundabad.holder = {
			change_liege = {
				liege = scope:ereborholder
				change = scope:fealty_change
			}
			add_opinion = {
				modifier = became_vassal
				target = scope:ereborholder
				opinion = 10
			}
		}
		resolve_title_and_vassal_change = scope:fealty_change
		
		trigger_event = { # End of a Journey 
			id = rangers.0472 
			days = 5 
		}
	}
}

rangers.0472 = { # End of a Journey
	content_source = realms_dlc
	type = character_event
	title = rangers.0472.t
	desc = rangers.0472.desc
	theme = ring_quest
	window = visit_settlement_window
	override_background = { reference = eagles }
	left_portrait = {
		character = scope:farin
		animation = war_defender
		triggered_outfit = {
			outfit_tags = { dwarf_war_steel_outfit }
		}
	}
	center_portrait = {
		character = root
		animation = happiness
	}
	right_portrait = {
		character = scope:andriel 
		animation = personality_compassionate
	}
	immediate = {
		character:lineofandriel = { save_scope_as = andriel } 
		character:lineofnorin2 = { save_scope_as = farin }
		custom_tooltip = eradan_end_of_content
	}
	option = { # Thank you for playing Eradan's content <3 
		name = rangers.0472.a 
		add_stress = -20 
		give_nickname = nick_warrior_of_the_north
		add_character_flag = had_nickname_event
	}
}

### Eradan: Talk to the Locals Events ###

rangers.0701 = { # Sarn Ford: Main
	content_source = realms_dlc
	type = character_event
	title = rangers.0701.t
	desc = rangers.0701.desc
	theme = diplomacy_family_focus
	window = visit_settlement_window
	override_background = { reference = carrock }
	left_portrait = {
		character = root
		animation = personality_rational
	}
	center_portrait = {
		character = scope:farin
		animation = marshal_longaxe
	}
	right_portrait = {
		character = scope:andriel
		animation = holding_staff
	}
	lower_center_portrait = {
		character = scope:halbarad
	}
	lower_right_portrait = {
		character = scope:lorniel
	}
	immediate = {
		character:lineofandriel = { save_scope_as = andriel } 
		character:lineofnorin2 = { save_scope_as = farin }
		character:linehalbarad9 = { save_scope_as = halbarad }
		character:linehalbarad16 = { save_scope_as = lorniel }
	}

	option = { # Talk to Halbarad
		name = rangers.0701.a
		trigger = { NOT = { has_character_flag = spoken_with_halbarad } }
		custom_tooltip = rangers.0701.a.tt 
		trigger_event = rangers.0702
	}
	option = { # Talk to Lorniel
		trigger = { NOT = { has_character_flag = spoken_with_lorniel } }
		name = rangers.0701.b
		custom_tooltip = rangers.0701.b.tt 
		trigger_event = rangers.0703
	}
	option = { # I'm done here
		name = rangers.0701.c
		custom_tooltip = rangers.0701.c.tt 
	}
}

rangers.0702 = { # Sarn Ford: Halbarad
	content_source = realms_dlc
	type = character_event
	title = rangers.0702.t
	desc = rangers.0702.desc
	theme = diplomacy_family_focus
	window = visit_settlement_window
	override_background = { reference = carrock }
	left_portrait = {
		character = root
		animation = throne_room_conversation_1
	}
	center_portrait = {
		character = scope:andriel
		animation = personality_forgiving
	}
	right_portrait = {
		character = scope:halbarad 
		animation = marshal 
	}
	lower_left_portrait = {
		character = scope:farin
	}
	option = { # Good talk
		name = rangers.0702.a
		add_stress = -20
	}
	option = { # Do you have a contract for me?
		name = rangers.0702.b
		custom_tooltip = rangers.0702.b.tt
		hidden_effect = {
			contract_passive_spawn_effect = {
				SPAWN_CONTRACTS = 2
			}
		}
	}
	after = {
		add_character_flag = spoken_with_halbarad
		trigger_event = rangers.0701 # Back to main 
	}
}	

rangers.0703 = { # Sarn Ford: Lorniel
	content_source = realms_dlc
	type = character_event
	title = rangers.0703.t
	desc = rangers.0703.desc
	theme = diplomacy_family_focus
	window = visit_settlement_window
	override_background = { reference = carrock }
	left_portrait = {
		character = root
		animation = throne_room_conversation_1
	}
	center_portrait = {
		character = scope:andriel
		animation = personality_forgiving
	}
	right_portrait = {
		character = scope:lorniel 
		animation = personality_compassionate 
	}
	lower_left_portrait = {
		character = scope:farin
	}
	option = { # Good Talk
		name = rangers.0703.a 
		progress_towards_friend_effect = {
			REASON = friend_comforting_words
			CHARACTER = scope:lorniel
			OPINION = 25
		}
	}
	option = { # It was good seeing you 
		name = rangers.0703.b
		progress_towards_lover_effect = {
			CHARACTER = scope:lorniel
			REASON = lover_followed_around
			OPINION = 25
		}
	}
	option = { # Could you take a look at my wound?
		name = rangers.0703.c
		trigger = {
			OR = {
				has_trait = wounded_1
				has_trait = wounded_2
				has_trait = wounded_3
			}
		}
		if = {
			limit = { has_trait = wounded_1 }
			remove_trait = wounded_1
		}
		else_if = {
			limit = { has_trait = wounded_2 }
			remove_trait = wounded_2 
			add_trait = wounded_1
		}
		else_if = {
			limit = { has_trait = wounded_3 }
			remove_trait = wounded_3
			add_trait = wounded_2
		}	
	}
	after = {
		add_character_flag = spoken_with_lorniel
		trigger_event = rangers.0701 # Back to main 
	}
}	

rangers.0711 = { # Bree: Main
	content_source = realms_dlc
	type = character_event
	title = rangers.0711.t
	desc = rangers.0711.desc
	theme = diplomacy_family_focus
	window = visit_settlement_window
	override_background = { reference = daen_tavern }
	left_portrait = {
		character = root
		animation = personality_rational
	}
	center_portrait = {
		character = scope:farin
		animation = marshal_longaxe
	}
	right_portrait = {
		character = scope:andriel
		animation = holding_staff
	}
	lower_left_portrait = {
		character = scope:localsmith
	}
	lower_center_portrait = {
		character = scope:aragorn
	}
	lower_right_portrait = {
		character = scope:barliman
	}
	immediate = {
		character:lineofandriel = { save_scope_as = andriel } 
		character:lineofnorin2 = { save_scope_as = farin }
		character:lineisildur42 = { save_scope_as = aragorn }
		character:lineofbutterbur7 = { save_scope_as = barliman }
	}

	option = { # Talk to Aragorn
		name = rangers.0711.a
		trigger = { NOT = { has_character_flag = spoken_with_aragorn } }
		custom_tooltip = rangers.0711.a.tt 
		trigger_event = rangers.0712
	}
	option = { # Talk to Barliman
		trigger = { NOT = { has_character_flag = spoken_with_barliman } }
		name = rangers.0711.b
		custom_tooltip = rangers.0711.b.tt 
		trigger_event = rangers.0713
	}
	option = { # Talk to the local smith
		trigger = { NOT = { has_character_flag = spoken_with_smith } }
		name = rangers.0711.c
		custom_tooltip = rangers.0711.c.tt 
		trigger_event = rangers.0714
	}
	option = { # I'm done here
		name = rangers.0711.d
		custom_tooltip = rangers.0711.d.tt 
	}
}

rangers.0712 = { # Bree: Aragorn
	content_source = realms_dlc
	type = character_event
	title = rangers.0712.t
	desc = rangers.0712.desc
	theme = diplomacy_family_focus
	window = visit_settlement_window
	override_background = { reference = daen_tavern }
	left_portrait = {
		character = root
		animation = throne_room_conversation_1
	}
	center_portrait = {
		character = scope:farin
		animation = personality_callous
	}
	right_portrait = {
		character = scope:aragorn 
		animation = personality_compassionate 
	}
	lower_left_portrait = {
		character = scope:andriel
	}
	option = { # Thx for your guidance
		name = rangers.0712.a
		add_wanderer_lifestyle_xp = 500
	}
	option = { # Thx for your instruction
		name = rangers.0712.b
		add_martial_lifestyle_xp = 500
	}
	after = {
		add_character_flag = spoken_with_aragorn
		trigger_event = rangers.0711 # Back to main 
	}
}	

rangers.0713 = { # Bree: Barliman
	content_source = realms_dlc
	type = character_event
	title = rangers.0713.t
	desc = rangers.0713.desc
	theme = diplomacy_family_focus
	window = visit_settlement_window
	override_background = { reference = daen_tavern }
	left_portrait = {
		character = root
		animation = throne_room_conversation_1
	}
	center_portrait = {
		character = scope:farin
		animation = toast_goblet
	}
	right_portrait = {
		character = scope:barliman 
		animation = thinking 
	}
	lower_left_portrait = {
		character = scope:andriel
	}
	option = { # I'll buy a beer
		name = rangers.0713.a
		add_character_modifier = {
			modifier = ate_good_meal
			days = 180
		}
		add_stress = -15
		remove_short_term_gold = tiny_gold_value
	}
	option = { # Do you have a contract for me?
		name = rangers.0713.b
		custom_tooltip = rangers.0713.b.tt
		hidden_effect = {
			contract_passive_spawn_effect = {
				SPAWN_CONTRACTS = 2
			}
		}
	}
	after = {
		add_character_flag = spoken_with_barliman
		trigger_event = rangers.0711 # Back to main 
	}
}

rangers.0714 = { # Bree: Local Smith
	content_source = realms_dlc
	type = character_event
	title = rangers.0714.t
	desc = rangers.0714.desc
	theme = diplomacy_family_focus
	window = visit_settlement_window
	override_background = { reference = daen_tavern }
	left_portrait = {
		character = root
		animation = throne_room_conversation_1
	}
	center_portrait = {
		character = scope:andriel
		animation = interested
	}
	right_portrait = {
		character = scope:localsmith 
		animation = personality_callous 
	}
	lower_left_portrait = {
		character = scope:farin
	}
	immediate = {
		create_character = {
			dynasty = none
			location = root.location
			age = 34
			gender_female_chance = 0
			culture = culture:breemen
			faith = faith:faith_hobbit
			trait = artificer
			save_scope_as = localsmith
		}
	}
	option = { # I'll buy a sword
		name = rangers.0714.a
		custom_tooltip = rangers.0714.a.tt
		create_artifact_weapon_effect = {
			OWNER = root
			CREATOR = scope:localsmith
			SET_WEAPON_TYPE = flag:artifact_weapon_type_sword
		}
		remove_short_term_gold = minor_gold_value
	    hidden_effect = {
			if = {
	        	limit = { exists = scope:newly_created_artifact } # To avoid errors
	        	send_interface_toast = {
		        	title = rangers.0714.a.tt
		        	left_icon = root
		        	right_icon = scope:newly_created_artifact
		        	scope:newly_created_artifact = {
		        		set_owner = {
		        			target = root
							history = {
								location = title:c_bree.title_province
								actor = scope:localsmith
								recipient = root
								type = given
							}
						}
		        	}
		        }
	        }
		}
	}
	option = { # I'll buy a bow
		name = rangers.0714.b
		custom_tooltip = rangers.0714.b.tt
		create_artifact_weapon_effect = {
			OWNER = root
			CREATOR = scope:localsmith
			SET_WEAPON_TYPE = flag:artifact_weapon_type_bow
		}
		remove_short_term_gold = minor_gold_value
	    hidden_effect = {
			if = {
	        	limit = { exists = scope:newly_created_artifact } # To avoid errors
	        	send_interface_toast = {
		        	title = rangers.0714.b.tt
		        	left_icon = root
		        	right_icon = scope:newly_created_artifact
		        	scope:newly_created_artifact = {
		        		set_owner = {
		        			target = root
							history = {
								location = title:c_bree.title_province
								actor = scope:localsmith
								recipient = root
								type = given
							}
						}
		        	}
		        }
	        }
		}
	}
	option = { # I don't need anything 
		name = rangers.0714.c
		custom_tooltip = rangers.0714.c.tt 
	}
	after = {
		add_character_flag = spoken_with_smith
		trigger_event = rangers.0711 # Back to main 
	}
}		

rangers.0721 = { # Imladris: Main
	content_source = realms_dlc
	type = character_event
	title = rangers.0721.t
	desc = rangers.0721.desc
	theme = diplomacy_family_focus
	window = visit_settlement_window
	override_background = { reference = throne_room_rivendell }
	left_portrait = {
		character = root
		animation = personality_rational
	}
	center_portrait = {
		character = scope:andriel
		animation = personality_content
	}
	right_portrait = {
		character = scope:farin
		animation = personality_callous
	}
	lower_left_portrait = {
		character = scope:elrond
	}
	lower_center_portrait = {
		character = scope:elladan
	}
	lower_right_portrait = {
		character = scope:arwen
	}
	immediate = {
		character:lineofandriel = { save_scope_as = andriel } 
		character:lineofnorin2 = { save_scope_as = farin }
		character:lineisildur42 = { save_scope_as = aragorn }
		character:lineofelrond1 = { save_scope_as = elrond }
		character:lineofelrond2 = { save_scope_as = elladan }
		character:lineofelrond3 = { save_scope_as = elrohir }
		character:lineofelrond4 = { save_scope_as = arwen }
		character:lineofgandalf = { save_scope_as = gandalf }
	}

	option = { # Talk to Elrond
		name = rangers.0721.a
		trigger = { NOT = { has_character_flag = spoken_with_elrond } }
		custom_tooltip = rangers.0721.a.tt 
		trigger_event = rangers.0722
	}
	option = { # Talk to the Sons of Elrond
		trigger = { NOT = { has_character_flag = spoken_with_elrondsons } }
		name = rangers.0721.b
		custom_tooltip = rangers.0721.b.tt 
		trigger_event = rangers.0723
	}
	option = { # Talk to Gandalf
		trigger = { NOT = { has_character_flag = spoken_with_gandalf } }
		name = rangers.0721.c
		custom_tooltip = rangers.0721.c.tt 
		trigger_event = rangers.0724
	}
	option = { # Talk to Arwen
		trigger = { NOT = { has_character_flag = spoken_with_arwen } }
		name = rangers.0721.d
		custom_tooltip = rangers.0721.d.tt 
		trigger_event = rangers.0725
	}
	option = { # I'm done here
		name = rangers.0721.e
		custom_tooltip = rangers.0721.e.tt 
	}
}

rangers.0722 = { # Imladris: Elrond
	content_source = realms_dlc
	type = character_event
	title = rangers.0722.t
	desc = rangers.0722.desc
	theme = diplomacy_family_focus
	window = visit_settlement_window
	override_background = { reference = throne_room_rivendell }
	left_portrait = {
		character = root
		animation = throne_room_conversation_1
	}
	center_portrait = {
		character = scope:andriel
		animation = personality_compassionate
	}
	right_portrait = {
		character = scope:elrond
		animation = personality_rational
	}
	lower_left_portrait = {
		character = scope:farin
	}
	option = { # What news from abroad?
		name = rangers.0722.a
		add_diplomacy_lifestyle_xp = 500
	}
	option = { # Do you have a contract for me?
		name = rangers.0722.b
		custom_tooltip = rangers.0722.b.tt
		hidden_effect = {
			contract_passive_spawn_effect = {
				SPAWN_CONTRACTS = 2
			}
		}
	}
	after = {
		add_character_flag = spoken_with_elrond
		trigger_event = rangers.0721 # Back to main
	}
}

rangers.0723 = { # Imladris: Elladan & Elrohir
	content_source = realms_dlc
	type = character_event
	title = rangers.0723.t
	desc = rangers.0723.desc
	theme = diplomacy_family_focus
	window = visit_settlement_window
	override_background = { reference = throne_room_rivendell }
	left_portrait = {
		character = root
		animation = throne_room_conversation_1
	}
	center_portrait = {
		character = scope:elladan
		animation = throne_room_one_handed_passive_1
	}
	right_portrait = {
		character = scope:elrohir
		animation = marshal
	}
	lower_left_portrait = {
		character = scope:farin
	}
	lower_center_portrait = {
		character = scope:andriel 
	}
	option = { # How did you track him?
		name = rangers.0723.a
		add_intrigue_lifestyle_xp = 500
	}
	option = { # Would you like to spar with me?
		name = rangers.0723.b
		random_list = {
			25 = {
				add_prowess_skill = 1 
			}
			25 = {
				add_trait = lifestyle_blademaster
			}
			25 = {
				add_martial_lifestyle_xp = 500 
			}
			25 = {
				add_martial_lifestyle_perk_points = 1
			}
		}
	}
	after = {
		add_character_flag = spoken_with_elrondsons
		trigger_event = rangers.0721 # Back to main
	}
}

rangers.0724 = { # Imladris: Gandalf
	content_source = realms_dlc
	type = character_event
	title = rangers.0724.t
	desc = rangers.0724.desc
	theme = diplomacy_family_focus
	window = visit_settlement_window
	override_background = { reference = throne_room_rivendell }
	left_portrait = {
		character = root
		animation = throne_room_conversation_1
	}
	center_portrait = {
		character = scope:andriel
		animation = interested
	}
	right_portrait = {
		character = scope:gandalf
		animation = holding_staff
	}
	lower_left_portrait = {
		character = scope:farin
	}
	option = { # Are there other wizards active in the north?
		name = rangers.0724.a
		progress_towards_friend_effect = {
			REASON = friend_showed_personal_interest
			CHARACTER = scope:gandalf
			OPINION = default_friend_opinion
		}
	}
	option = { # What do you know about sorcery?
		name = rangers.0724.b
		add_crafting_lifestyle_xp = 500
	}
	after = {
		add_character_flag = spoken_with_gandalf
		trigger_event = rangers.0721 # Back to main
	}
}

rangers.0725 = { # Imladris: Arwen & Aragorn
	content_source = realms_dlc
	type = character_event
	title = rangers.0725.t
	desc = rangers.0725.desc
	theme = diplomacy_family_focus
	window = visit_settlement_window
	override_background = { reference = throne_room_rivendell }
	left_portrait = {
		character = root
		animation = throne_room_conversation_1
	}
	center_portrait = {
		character = scope:arwen
		animation = personality_compassionate
		camera = camera_event_scheme_vs_center_look_left
	}
	right_portrait = {
		character = scope:aragorn
		animation = personality_forgiving
	}
	lower_left_portrait = {
		character = scope:farin
	}
	lower_center_portrait = {
		character = scope:andriel 
	}
	option = { # Thx for the encouragement
		name = rangers.0725.a
		add_stress = -50
	}
	option = { # Take some supplies, friends
		name = rangers.0725.b
		domicile ?= { 
			change_provisions = major_provisions_gain 
		}
	}
	after = {
		add_character_flag = spoken_with_arwen
		trigger_event = rangers.0721 # Back to main
	}
}

rangers.0731 = { # Nordinbad: Main
	content_source = realms_dlc
	type = character_event
	title = rangers.0731.t
	desc = rangers.0731.desc
	theme = diplomacy_family_focus
	window = visit_settlement_window
	override_background = { reference = dwarven_gate }
	left_portrait = {
		character = root
		animation = personality_rational
	}
	center_portrait = {
		character = scope:farin
		animation = marshal_longaxe
	}
	right_portrait = {
		character = scope:andriel
		animation = holding_staff
	}
	lower_left_portrait = {
		character = scope:gundri
	}
	lower_center_portrait = {
		character = scope:gorin
	}
	lower_right_portrait = {
		character = scope:nordri
	}
	immediate = {
		character:lineofandriel = { save_scope_as = andriel } 
		character:lineofnorin2 = { save_scope_as = farin }
		character:linegorin7 = { save_scope_as = gorin }
		character:linegorin9 = { save_scope_as = nordri }
		character:lineofgundri1 = { save_scope_as = gundri }
	}

	option = { # Talk to Gorin, Lord of Nordinbad
		name = rangers.0731.a
		trigger = { NOT = { has_character_flag = spoken_with_gorin } }
		custom_tooltip = rangers.0731.a.tt 
		trigger_event = rangers.0732
	}
	option = { # Talk to Nordri, son of Gorin
		trigger = { NOT = { has_character_flag = spoken_with_nordri } }
		name = rangers.0731.b
		custom_tooltip = rangers.0731.b.tt 
		trigger_event = rangers.0733
	}
	option = { # Talk to Gundri
		trigger = { NOT = { has_character_flag = spoken_with_gundri } }
		name = rangers.0731.c
		custom_tooltip = rangers.0731.c.tt 
		trigger_event = rangers.0734
	}
	option = { # I'm done here
		name = rangers.0731.d
		custom_tooltip = rangers.0731.d.tt 
	}
}

rangers.0732 = { # Nordinbad: Gorin
	content_source = realms_dlc
	type = character_event
	title = rangers.0732.t
	desc = rangers.0732.desc
	theme = diplomacy_family_focus
	window = visit_settlement_window
	override_background = { reference = throne_room_dwarf }
	left_portrait = {
		character = root
		animation = throne_room_conversation_1
	}
	center_portrait = {
		character = scope:farin
		animation = marshal_longaxe
	}
	right_portrait = {
		character = scope:gorin 
		animation = thinking 
	}
	lower_left_portrait = {
		character = scope:andriel
	}
	option = { # It is astonishing how Nordinbad survived!
		name = rangers.0732.a
		add_prestige = medium_prestige_gain
		add_learning_lifestyle_xp = 200
	}
	option = { # Do you have a contract for me?
		name = rangers.0732.b
		custom_tooltip = rangers.0732.b.tt
		hidden_effect = {
			contract_passive_spawn_effect = {
				SPAWN_CONTRACTS = 2
			}
		}
	}
	after = {
		add_character_flag = spoken_with_gorin
		trigger_event = rangers.0731 # Back to main 
	}
}

rangers.0733 = { # Nordinbad: Nordri
	content_source = realms_dlc
	type = character_event
	title = rangers.0733.t
	desc = rangers.0733.desc
	theme = diplomacy_family_focus
	window = visit_settlement_window
	override_background = { reference = kitchen_dwarven }
	left_portrait = {
		character = root
		animation = throne_room_conversation_1
	}
	center_portrait = {
		character = scope:farin
		animation = interested
	}
	right_portrait = {
		character = scope:nordri 
		animation = happiness 
	}
	lower_left_portrait = {
		character = scope:andriel
	}
	option = { # I'll choose an axe for Farin
		name = rangers.0733.a
		custom_tooltip = rangers.0733.a.tt
		create_artifact_weapon_effect = {
			OWNER = scope:farin
			CREATOR = scope:nordri
			SET_WEAPON_TYPE = flag:artifact_weapon_type_axe
		}
	    hidden_effect = {
			if = {
	        	limit = { exists = scope:newly_created_artifact } # To avoid errors
	        	send_interface_toast = {
		        	title = rangers.0733.a.tt
		        	left_icon = scope:farin
		        	right_icon = scope:newly_created_artifact
		        	scope:newly_created_artifact = {
		        		set_owner = {
		        			target = scope:farin
							history = {
								location = title:c_nordinbad.title_province
								actor = scope:nordri
								recipient = scope:farin
								type = given
							}
						}
		        	}
		        }
	        }
		}
	}
	option = { # I'll choose a staff for Andriel
		name = rangers.0733.b
		custom_tooltip = rangers.0733.b.tt
		create_artifact_weapon_effect = {
			OWNER = scope:andriel
			CREATOR = scope:nordri
			SET_WEAPON_TYPE = flag:artifact_weapon_type_spear
		}
	    hidden_effect = {
			if = {
	        	limit = { exists = scope:newly_created_artifact } # To avoid errors
	        	send_interface_toast = {
		        	title = rangers.0733.b.tt
		        	left_icon = scope:andriel
		        	right_icon = scope:newly_created_artifact
		        	scope:newly_created_artifact = {
		        		set_owner = {
		        			target = scope:andriel
							history = {
								location = title:c_nordinbad.title_province
								actor = scope:nordri
								recipient = scope:andriel
								type = given
							}
						}
		        	}
		        }
	        }
		}
	}
	after = {
		add_character_flag = spoken_with_nordri
		trigger_event = rangers.0731 # Back to main 
	}
}		

rangers.0734 = { # Nordinbad: Gundri
	content_source = realms_dlc
	type = character_event
	title = rangers.0734.t
	desc = rangers.0734.desc
	theme = diplomacy_family_focus
	window = visit_settlement_window
	override_background = { reference = corridor_dwarven }
	left_portrait = {
		character = root
		animation = throne_room_conversation_1
	}
	center_portrait = {
		character = scope:farin
		animation = thinking
	}
	right_portrait = {
		character = scope:gundri 
		animation = personality_callous 
	}
	lower_left_portrait = {
		character = scope:andriel
	}
	option = { # It's amazing how the dwarves can fight underground
		name = rangers.0734.a
		add_trait = cavern_commander
		scope:farin = { add_trait = cavern_commander }
	}
	option = { # Can you show me a few fighting techniques?
		name = rangers.0734.b
		add_prowess_skill = 1 
		add_martial_skill = 1
	}
	after = {
		add_character_flag = spoken_with_gundri
		trigger_event = rangers.0731 # Back to main 
	}
}

rangers.0741 = { # Rhosgobel: Main
	content_source = realms_dlc
	type = character_event
	title = rangers.0741.t
	desc = rangers.0741.desc
	theme = diplomacy_family_focus
	window = visit_settlement_window
	override_background = { reference = eaves_of_lorien }
	left_portrait = {
		character = root
		animation = personality_rational
	}
	center_portrait = {
		character = scope:farin
		animation = interested
	}
	right_portrait = {
		character = scope:andriel
		animation = holding_staff
	}
	lower_center_portrait = {
		character = scope:radagast
	}
	lower_right_portrait = {
		trigger = { exists = scope:glorhirin }
		character = scope:glorhirin
	}
	immediate = { 
		character:lineofandriel = { save_scope_as = andriel } 
		character:lineofnorin2 = { save_scope_as = farin }
		character:lineofradagast = { save_scope_as = radagast }
		random_courtier = {
			limit = { has_character_flag = is_glorhirin }
			save_scope_as = glorhirin 
		}
	}
	option = { # Talk to Radagast
		name = rangers.0741.a
		trigger = { NOT = { has_character_flag = spoken_with_radagast } }
		custom_tooltip = rangers.0741.a.tt 
		trigger_event = rangers.0742
	}
	option = { # Talk to Glorhirin
		trigger = { 
			AND = {
				exists = scope:glorhirin 
				NOT = { has_character_flag = spoken_with_glorhirin } 
			}
		}
		name = rangers.0741.b
		custom_tooltip = rangers.0741.b.tt 
		trigger_event = rangers.0743
	}
	option = { # I'm done here
		name = rangers.0741.c
		custom_tooltip = rangers.0741.c.tt 
	}
}

rangers.0742 = { # Rhosgobel: Radagast
	content_source = realms_dlc
	type = character_event
	title = rangers.0742.t
	desc = rangers.0742.desc
	theme = diplomacy_family_focus
	window = visit_settlement_window
	override_background = { reference = eaves_of_lorien }
	left_portrait = {
		character = root
		animation = throne_room_conversation_1
	}
	center_portrait = {
		character = scope:andriel
		animation = thinking
	}
	right_portrait = {
		character = scope:radagast 
		animation = holding_staff 
	}
	lower_left_portrait = {
		character = scope:farin
	}
	option = { # Can I learn to talk to animals?
		name = rangers.0742.a
		add_learning_lifestyle_perk_points = 1
	}
	option = { # Gib contract
		name = rangers.0742.b
		custom_tooltip = rangers.0742.b.tt
		hidden_effect = {
			contract_passive_spawn_effect = {
				SPAWN_CONTRACTS = 2
			}
		}
	}
	after = {
		add_character_flag = spoken_with_radagast
		trigger_event = rangers.0741 # Back to main 
	}
}

rangers.0743 = { # Rhosgobel: Glorhirin
	content_source = realms_dlc
	type = character_event
	title = rangers.0743.t
	desc = rangers.0743.desc
	theme = diplomacy_family_focus
	window = visit_settlement_window
	override_background = { reference = eaves_of_lorien }
	left_portrait = {
		character = root
		animation = throne_room_conversation_1
	}
	center_portrait = {
		character = scope:andriel
		animation = personality_compassionate
	}
	right_portrait = {
		character = scope:glorhirin 
		animation = worry 
	}
	lower_left_portrait = {
		character = scope:farin
	}
	option = { # Thx my friend
		name = rangers.0743.a
		set_relation_friend = { target = scope:glorhirin }
	}
	option = { # Teach me how to navigate the forest
		name = rangers.0743.b
		if = { 
			limit = { has_trait = forest_fighter }
			add_trait_xp = {
				trait = forest_fighter
				value = 30 
			}
		}
		else = { add_trait = forest_fighter }
	}
	after = {
		add_character_flag = spoken_with_glorhirin
		trigger_event = rangers.0741 # Back to main 
	}
}

rangers.0751 = { # Erebor: Main
	content_source = realms_dlc
	type = character_event
	title = rangers.0751.t
	desc = rangers.0751.desc
	theme = diplomacy_family_focus
	window = visit_settlement_window
	override_background = { reference = throne_room_dwarf }
	left_portrait = {
		character = root
		animation = personality_rational
	}
	center_portrait = {
		character = scope:farin
		animation = interested
	}
	right_portrait = {
		character = scope:andriel
		animation = holding_staff
	}
	lower_center_portrait = {
		character = scope:ereborking
	}
	lower_right_portrait = {
		character = scope:ereborprince
	}
	immediate = { 
		character:lineofandriel = { save_scope_as = andriel } 
		character:lineofnorin2 = { save_scope_as = farin }
		title:c_throne_of_erebor.holder = { save_scope_as = ereborking }
		title:c_throne_of_erebor.holder.player_heir = { save_scope_as = ereborprince }
	}
	option = { # Talk to Dáin
		name = rangers.0751.a
		trigger = { NOT = { has_character_flag = spoken_with_dain } }
		custom_tooltip = rangers.0751.a.tt 
		trigger_event = rangers.0752
	}
	option = { # Talk to Thorin
		name = rangers.0751.b
		trigger = { NOT = { has_character_flag = spoken_with_thorin } }
		custom_tooltip = rangers.0751.b.tt 
		trigger_event = rangers.0753
	}
	option = { # I'm done here
		name = rangers.0751.c
		custom_tooltip = rangers.0751.c.tt 
	}
}

rangers.0752 = { # Erebor: Dáin Ironfoot
	content_source = realms_dlc
	type = character_event
	title = rangers.0752.t
	desc = rangers.0752.desc
	theme = diplomacy_family_focus
	window = visit_settlement_window
	override_background = { reference = market_dwarven }
	left_portrait = {
		character = root
		animation = throne_room_conversation_1
	}
	center_portrait = {
		character = scope:farin
		animation = thinking
	}
	right_portrait = {
		character = scope:ereborking 
		animation = personality_forgiving 
	}
	lower_left_portrait = {
		character = scope:andriel
	}
	option = { # Can I borrow some of your fighters?
		name = rangers.0752.a
		create_maa_regiment = {
			type = longbeard_heavy_infantry
			check_can_recruit = no
			size = 1
		}
	}
	option = { # Gib contract
		name = rangers.0752.b
		custom_tooltip = rangers.0752.b.tt
		hidden_effect = {
			contract_passive_spawn_effect = {
				SPAWN_CONTRACTS = 2
			}
		}
	}
	option = { # Gib alliance 
		name = rangers.0752.c
		trigger = { has_character_flag = eradan_avenge_nordinbad }
		create_alliance = {
			target = scope:ereborking
			allied_through_owner = root
			allied_through_target = scope:ereborking
		}
		scope:ereborking = {
			add_opinion = {
				modifier = perk_negotiated_alliance_opinion
				target = root
			}
		}
	}
	after =	{
		add_character_flag = spoken_with_dain
		trigger_event = rangers.0751 # Back to main 
	}
}

rangers.0753 = { # Erebor: Thorin Stonehelm
	content_source = realms_dlc
	type = character_event
	title = rangers.0753.t
	desc = rangers.0753.desc
	theme = diplomacy_family_focus
	window = visit_settlement_window
	override_background = { reference = dwarven_gate }
	left_portrait = {
		character = root
		animation = throne_room_conversation_1
	}
	center_portrait = {
		character = scope:farin
		animation = personality_rational
	}
	right_portrait = {
		character = scope:ereborprince 
		animation = marshal_axe 
		triggered_outfit = {
			outfit_tags = { dwarf_war_steel_outfit }
		}
	}
	lower_left_portrait = {
		character = scope:andriel
	}
	option = { # Sparring session
		name = rangers.0753.a
		if = { 
			limit = { has_trait = lifestyle_blademaster }
			add_trait_xp = {
				trait = lifestyle_blademaster
				value = 30 
			}
		}
		else = { add_trait = lifestyle_blademaster }
	}
	option = { # Any advice on going to the northern mountains?
		trigger = { NOT = { has_character_flag = eradan_avenge_nordinbad } }
		name = rangers.0753.b
		add_wanderer_lifestyle_xp = 500 
	}
	option = { # Help me avenge Nordinbad
		trigger = { has_character_flag = eradan_avenge_nordinbad }
		name = rangers.0753.c
		create_maa_regiment = {
			type = longbeard_pikemen
			check_can_recruit = no
			size = 1
		}
	}
	after = {
		add_character_flag = spoken_with_thorin
		trigger_event = rangers.0751 # Back to main 
	}
}

###############################
# Warden Thorondor of Rhudaur #
###############################

rangers.1000 = { # Orders from chieftain
	content_source = realms_dlc
	type = character_event
	title = rangers.1000.t
	desc = rangers.1000.desc
	theme = diplomacy_foreign_affairs_focus
	#window = visit_settlement_window
	override_background = { reference = wilderness_forest }
	left_portrait = {
		character = root
		animation = throne_room_conversation_1
	}
	right_portrait = {
		character = scope:arassuil
		animation = throne_room_one_handed_passive_1
	}
	lower_left_portrait = { character = scope:handir }
	immediate = { 
		character:lineisildur37 = { save_scope_as = arassuil } 
		character:lineoftarmea65brother = { save_scope_as = handir } 
		add_character_flag = is_thorondor_rhudaur
		add_character_modifier = eradan_experienced_traveler
	}
	option = { # We leave at once.
		name = rangers.1000.a
		custom_tooltip = rangers.1000.a.tt
		#scope:handir = { add_character_flag = is_thorondor_companion }
		start_travel_plan = { #Travel to Naithgardh
			destination = title:c_naithgardh.title_province
			players_use_planner = no
			on_arrival_event = rangers.1001
		}
	}
	#option = { # I still need time to prepare.
	#	name = rangers.1000.b
	#	custom_tooltip = rangers.1000.b.tt
	#	add_character_flag = thorondor_delay_naithgard
	#	scope:handir = { add_character_flag = is_thorondor_companion }
	#}
	option = { # AI doesn't do the event chain
		name = rangers.1000.b
		trigger = { is_ai = yes }
		add_prestige = miniscule_prestige_gain
		ai_chance = {
			base = 100 
		}
	}
}

rangers.1001 = { # Arrival to Naithgardh and orders
	content_source = realms_dlc
	type = character_event
	title = rangers.1001.t
	desc = rangers.1001.desc
	theme = laamp
	window = visit_settlement_window
	override_background = { reference = daen_tavern }
	center_portrait = {
		character = root
		animation = marshal
	}
	left_portrait = {
		character = scope:handir
		animation = writing
	}
	right_portrait = {
		character = scope:arassuil
		animation = debating
	}
	lower_left_portrait = {
		character = scope:arathon
	}
	immediate = { 
		character:lineisildur37 = { save_scope_as = arassuil } 
		character:lineoftarmea65brother = { save_scope_as = handir } 
		character:lineisildur37brother1 = { save_scope_as = arathon }
		hidden_effect = { add_contact = scope:arassuil }
		domicile ?= { 
			change_provisions = miniscule_provisions_gain 
			move_domicile = title:c_naithgardh.title_province
		}
		hidden_effect = {
			current_travel_plan ?= { abort_travel_plan = yes }
		}
	}
	option = { # Acknowledge & create the custom contract
		name = rangers.1001.a
		custom_tooltip = rangers.1001.a.tt
		hidden_effect = {
			root = {
				create_task_contract = {
					task_contract_type = lotr_thorondor_contract_cameth_brin
					task_contract_employer = scope:arassuil
					location = title:c_cameth_brin.title_province
					task_contract_tier = 4
					save_scope_as = created_contract
				}
			}
		}
		scope:arathon = {
			set_employer = root
		}
		spawn_army = {
			uses_supply = no
			inheritable = yes
			name = dunedain_reinforcments
			men_at_arms = {
				type = dunedain_wardens
				stacks = 4
			}
			men_at_arms = {
				type = dunedain_rangers
				stacks = 4
			}
			men_at_arms = {
				type = dunedain_outriders
				stacks = 2
			}
			men_at_arms = {
				type = trebuchet
				stacks = 2
			}
			location = root.location
		}
		#scope:arathon = { add_character_flag = is_thorondor_companion }
		#add_character_flag = thorondor_ready_for_cameth_brin
	}
}

# Cameth Brin contract

rangers.1002 = { # Arrival in Cameth Brin
	content_source = realms_dlc
	type = character_event
	title = rangers.1002.t
	desc = rangers.1002.desc
	theme = hunt_activity
	window = visit_settlement_window
	override_background = { reference = fornost }
	left_portrait = {
		character = scope:handir
		animation = bow_idle
	}
	center_portrait = {
		character = root
		animation = marshal
	}
	right_portrait = {
		character = scope:arathon
		animation = aggressive_axe
	}
	immediate = { 
		character:lineoftarmea65brother = { save_scope_as = handir } 
		character:lineisildur37brother1 = { save_scope_as = arathon }
		domicile ?= { 
			change_provisions = miniscule_provisions_gain 
			move_domicile = title:c_cameth_brin.title_province
		}
		hidden_effect = {
			current_travel_plan ?= { abort_travel_plan = yes }
		}
	}
	option = { # We're here, let's explore ...
		name = rangers.1002.a 
		add_prestige = miniscule_prestige_gain
		trigger_event = rangers.1003
	}
}

rangers.1003 = { # Cameth Brin: Goblins!
	content_source = realms_dlc
	type = character_event
	title = rangers.1003.t
	desc = rangers.1003.desc
	theme = hunt_activity
	#window = visit_settlement_window
	override_background = { reference = fornost }
	left_portrait = {
		character = root
		animation = marshal
	}
	right_portrait = {
		character = scope:cameth_brin_goblin
		animation = aggressive_mace
	}
	lower_left_portrait = {
		character = scope:handir
	}
	lower_right_portrait = {
		character = scope:arathon
	}
	immediate = { 
		character:lineoftarmea65brother = { save_scope_as = handir } 
		character:lineisildur37brother1 = { save_scope_as = arathon }
		create_character = {
			template = new_warrior_character
			dynasty = generate
			location = root.location
			gender_female_chance = 0
			save_scope_as = cameth_brin_goblin
			prowess = 14
			culture = culture:worauthai_madur
			faith = faith:way_of_strength
			after_creation = {
				scope:cameth_brin_goblin = {
					random_list = {
						1 = { give_nickname = nick_the_dreamer }
						1 = { give_nickname = nick_the_literate_one }
						1 = { give_nickname = nick_the_flogger }
						1 = { give_nickname = nick_the_disgusting }
						1 = { give_nickname = nick_the_angry }
						1 = { give_nickname = nick_the_stalker }
						1 = { give_nickname = nick_the_crafty }
						1 = { give_nickname = nick_the_funny_one }
						1 = { give_nickname = nick_the_filthy }
						1 = { give_nickname = nick_the_screamer }
						1 = { give_nickname = nick_the_bloated }
						1 = { give_nickname = nick_the_whiner }
					}
				}
			}
		}
	}
	option = { # Charge!
		name = rangers.1003.a 
		duel = {
 			skill = prowess
			value = high_skill_rating 
 			50 = {
				# You're successful
 				desc = rangers.1003.a.success
 				compare_modifier = {
 					value = scope:duel_value
 					multiplier = 3.5
 					min = -49
 				}
 				hidden_effect = { 
					send_interface_toast = {
						title = rangers.1003.a.success
						left_icon = root
						right_icon = scope:cameth_brin_goblin
						custom_tooltip = rangers.1003.a.success
					}
				}
				add_prestige = minor_prestige_gain
				scope:cameth_brin_goblin = { death = { death_reason = death_fight killer = root } }
 			}
 			50 = {
 				# You failed
 				desc = rangers.1003.a.failure
 				compare_modifier = {
 					value = scope:duel_value
 					multiplier = -3.5
 					min = -49
 				}
				hidden_effect = {
					send_interface_toast = {
						title = rangers.1003.a.failure
						left_icon = root
						right_icon = scope:cameth_brin_goblin
						custom_tooltip = rangers.1003.a.failure
					}
				}
				increase_wounds_effect = { REASON = fight }
				hidden_effect = { scope:cameth_brin_goblin = { silent_disappearance_effect = yes } }
 			}
		}
	}
	option = { # Shoot them!
		name = rangers.1003.b 
		custom_tooltip = rangers.1003.b.tt
		domicile = {
			change_provisions = minor_provisions_loss
		}
	}
	after = {
		trigger_event = rangers.1004 
	}
}

rangers.1004 = { # Cameth Brin: The Weapon Storage
	content_source = realms_dlc
	type = character_event
	title = rangers.1004.t
	desc = rangers.1004.desc
	theme = dread
	#window = visit_settlement_window
	override_background = { reference = ce1_catacombs }
	left_portrait = {
		character = root
		animation = survey
	}
	
	right_portrait = {
		character = scope:handir
		animation = throne_room_one_handed_passive_1
	}
	lower_center_portrait = {
		character = scope:arathon
	}
	immediate = { 
		character:lineoftarmea65brother = { save_scope_as = handir } 
		character:lineisildur37brother1 = { save_scope_as = arathon }
	}
	option = { # You find some Gold and Weapons in the Storage
		name = rangers.1004.a
		add_prestige = miniscule_prestige_gain
		add_gold = 200
		trigger_event = rangers.1005
	}
}

rangers.1005 = { # Cameth Brin Ambush
	content_source = realms_dlc
	type = character_event
	title = rangers.1005.t
	desc = rangers.1005.desc
	theme = hunt_activity
	#window = visit_settlement_window
	override_background = { reference = market_dunedain }
	left_portrait = {
		character = root
		animation = marshal
	}
	right_portrait = {
		character = scope:cameth_brin_ambush_goblin
		animation = aggressive_mace
	}
	lower_left_portrait = {
		character = scope:handir
	}
	lower_right_portrait = {
		character = scope:arathon
	}
	immediate = { 
		character:lineoftarmea65brother = { save_scope_as = handir } 
		character:lineisildur37brother1 = { save_scope_as = arathon }
		create_character = {
			template = new_warrior_character
			dynasty = generate
			location = root.location
			gender_female_chance = 0
			save_scope_as = cameth_brin_ambush_goblin
			prowess = 14
			culture = culture:worauthai_madur
			faith = faith:way_of_strength
			after_creation = {
				scope:cameth_brin_ambush_goblin = {
					random_list = {
						1 = { give_nickname = nick_the_dreamer }
						1 = { give_nickname = nick_the_literate_one }
						1 = { give_nickname = nick_the_flogger }
						1 = { give_nickname = nick_the_disgusting }
						1 = { give_nickname = nick_the_angry }
						1 = { give_nickname = nick_the_stalker }
						1 = { give_nickname = nick_the_crafty }
						1 = { give_nickname = nick_the_funny_one }
						1 = { give_nickname = nick_the_filthy }
						1 = { give_nickname = nick_the_screamer }
						1 = { give_nickname = nick_the_bloated }
						1 = { give_nickname = nick_the_whiner }
					}
				}
			}
		}
	}
	option = { # Charge!
		name = rangers.1005.a 
		duel = {
 			skill = prowess
			value = high_skill_rating 
 			50 = {
				# You're successful
 				desc = rangers.1005.a.success
 				compare_modifier = {
 					value = scope:duel_value
 					multiplier = 3.5
 					min = -49
 				}
 				hidden_effect = { 
					send_interface_toast = {
						title = rangers.1005.a.success
						left_icon = root
						right_icon = scope:cameth_brin_ambush_goblin
						custom_tooltip = rangers.1005.a.success
					}
				}
				add_prestige = minor_prestige_gain
				scope:cameth_brin_ambush_goblin = { death = { death_reason = death_fight killer = root } }
 			}
 			50 = {
 				# You failed
 				desc = rangers.1005.a.failure
 				compare_modifier = {
 					value = scope:duel_value
 					multiplier = -3.5
 					min = -49
 				}
				hidden_effect = {
					send_interface_toast = {
						title = rangers.1005.a.failure
						left_icon = root
						right_icon = scope:cameth_brin_ambush_goblin
						custom_tooltip = rangers.1005.a.failure
					}
				}
				increase_wounds_effect = { REASON = fight }
				hidden_effect = { scope:cameth_brin_ambush_goblin = { silent_disappearance_effect = yes } }
 			}
		}
	}
	option = { # Shoot them!
		name = rangers.1005.b 
		custom_tooltip = rangers.1005.b.tt
		domicile = {
			change_provisions = minor_provisions_loss
		}
	}
	after = {
		trigger_event = rangers.1006
	}
}

rangers.1006 = { # Cameth Brin Elven Scouts
	content_source = realms_dlc
	type = character_event
	title = rangers.1006.t
	desc = rangers.1006.desc
	theme = elven
	#window = visit_settlement_window
	override_background = { reference = eagles }
	left_portrait = {
		character = root
		animation = personality_honorable
	}
	right_portrait = {
		character = scope:imladris_scout
		animation = personality_compassionate
	}
	lower_left_portrait = {
		character = scope:handir
	}
	lower_right_portrait = {
		character = scope:arathon
	}
	immediate = { 
		character:lineoftarmea65brother = { save_scope_as = handir } 
		character:lineisildur37brother1 = { save_scope_as = arathon }
		character:lineoflumiel = { save_scope_as = imladris_scout }
	}
	option = { # We talk with the Scout
		name = rangers.1006.a
		add_prestige = miniscule_prestige_gain
	}
	after = {
		trigger_event = rangers.1007
	}
}

rangers.1007 = { # Cameth Brin Aftermath
	content_source = realms_dlc
	type = character_event
	title = rangers.1007.t
	desc = rangers.1007.desc
	theme = diplomacy
	#window = visit_settlement_window
	override_background = { reference = wilderness_forest }
	left_portrait = {
		character = root
		animation = personality_honorable
	}
	lower_left_portrait = {
		character = scope:handir
	}
	lower_right_portrait = {
		character = scope:arathon
	}
	immediate = { 
		character:lineoftarmea65brother = { save_scope_as = handir } 
		character:lineisildur37brother1 = { save_scope_as = arathon }
	}
	option = {
		name = rangers.1007.a
		add_prestige = miniscule_prestige_gain
		start_travel_plan = { #Travel to Naithgardh
			destination = title:c_naithgardh.title_province
			players_use_planner = no
			on_arrival_event = rangers.1008
		}
	}
}

rangers.1008 = { # Cameth Brin Aftermath
	content_source = realms_dlc
	type = character_event
	title = rangers.1008.t
	desc = rangers.1008.desc
	theme = laamp
	window = visit_settlement_window
	override_background = { reference = daen_tavern }
	center_portrait = {
		character = root
		animation = marshal
	}
	left_portrait = {
		character = scope:handir
		animation = writing
	}
	right_portrait = {
		character = scope:arassuil
		animation = debating
	}
	lower_left_portrait = {
		character = scope:arathon
	}
	immediate = { 
		character:lineisildur37 = { save_scope_as = arassuil } 
		character:lineoftarmea65brother = { save_scope_as = handir } 
		character:lineisildur37brother1 = { save_scope_as = arathon }
		add_character_flag = thorondor_ready_for_imladris
	}
	option = { # We talk with Arassuil
		name = rangers.1008.a
		add_prestige = miniscule_prestige_gain		
		random_character_active_contract = {
			limit = { has_task_contract_type = lotr_thorondor_contract_cameth_brin }
			complete_task_contract = success_standard
		}
		domicile ?= { 
			change_provisions = major_provisions_gain
			move_domicile = title:c_naithgardh.title_province
		}
		hidden_effect = {
			current_travel_plan ?= { abort_travel_plan = yes }
		}
		custom_tooltip = rangers.1008.a.tt
		hidden_effect = {
			root = {
				create_task_contract = {
					task_contract_type = lotr_thorondor_contract_imladris
					task_contract_employer = scope:arassuil
					location = title:c_imladris.title_province
					task_contract_tier = 4
					save_scope_as = created_contract
				}
			}
		}
	}
}

# Visiting Imladris

rangers.1009 = { # Rivendell
	content_source = realms_dlc
	type = character_event
	title = rangers.1009.t
	desc = rangers.1009.desc
	theme = diplomacy
	window = visit_settlement_window

	override_background = { reference = throne_room_rivendell }

	center_portrait = {
		character = root
		animation = personality_rational
	}
	right_portrait = {
		character = scope:elrond
		animation = personality_compassionate 
	}
	immediate = {
		character:lineofelrond1 = { save_scope_as = elrond }
	}

	option = {
		name = rangers.1009.a
		domicile ?= { 
			change_provisions = major_provisions_gain
			move_domicile = title:c_imladris.title_province
		}
		hidden_effect = {
			current_travel_plan ?= { abort_travel_plan = yes }
		}
	}

	after = {
		trigger_event = rangers.1010
	}
}

rangers.1010 = { # New companion
	content_source = realms_dlc
	type = character_event
	title = rangers.1010.t
	desc = rangers.1010.desc
	theme = laamp
	window = visit_settlement_window

	override_background = { reference = throne_room_rivendell }

	center_portrait = {
		character = root
		animation = personality_rational
	}

	right_portrait = {
		character = scope:lumiel
		animation = personality_compassionate
	}

	lower_right_portrait = {
		character = scope:elrond
	}
	immediate = {
		character:lineofelrond1 = { save_scope_as = elrond }
		character:lineoflumiel = { save_scope_as = lumiel }
		remove_character_flag = thorondor_ready_for_imladris
	}

	option = {
		name = rangers.1010.a
		random_character_active_contract = {
			limit = { has_task_contract_type = lotr_thorondor_contract_imladris }
			complete_task_contract = success_standard
		}
		scope:lumiel = {
			set_employer = root
		}
		spawn_army = {
			uses_supply = no
			inheritable = yes
			name = elven_volunteers
			men_at_arms = {
				type = high_elven_pikemen
				stacks = 2
			}
			men_at_arms = {
				type = high_elven_archers
				stacks = 2
			}
			men_at_arms = {
				type = high_elven_heavy_cavalry
				stacks = 1
			}
			location = root.location
		}
		custom_tooltip = rangers.1010.a.tt
	}
}

### Management Events ###

rangers.9001 = {
	hidden = yes 
	immediate = {
		title:d_northern_dunedain.holder = {
			trigger_event = rangers.0300 
		}
	}
}