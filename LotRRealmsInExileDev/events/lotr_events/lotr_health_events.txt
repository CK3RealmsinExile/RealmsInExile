namespace = lotr_health_events

lotr_health_events.3000 = { #apply Visible Disfigurement on_action pulse event
	scope = none
	hidden = yes

	immediate = {
		root = {
			lotr_random_visible_disfigurement_effect = yes
			trigger_event = {
				id = lotr_health_events.3001
			}
		}
	}
}

lotr_health_events.3001 = { #decision event to keep or remove the mask and apply disfigurement trait randomly
	type = character_event
	title = lotr_health_events.3001.t
	desc = {
		desc = lotr_health_events.3001.desc_intro
		first_valid = {
			triggered_desc = {
				trigger = {
					scope:disfigured_root = { has_inactive_trait = visible_disfigurement_1 }
				}
				desc = lotr_health_events.3001.desc_disfigurement_1
			}
			triggered_desc = {
				trigger = {
					scope:disfigured_root = { has_inactive_trait = visible_disfigurement_2 }
				}
				desc = lotr_health_events.3001.desc_disfigurement_2
			}
			triggered_desc = {
				trigger = {
					scope:disfigured_root = { has_inactive_trait = visible_disfigurement_3 }
				}
				desc = lotr_health_events.3001.desc_disfigurement_3
			}
			triggered_desc = {
				trigger = {
					scope:disfigured_root = { has_inactive_trait = visible_disfigurement_4 }
				}
				desc = lotr_health_events.3001.desc_disfigurement_4
			}
			triggered_desc = {
				trigger = {
					scope:disfigured_root = { has_inactive_trait = visible_disfigurement_5 }
				}
				desc = lotr_health_events.3001.desc_disfigurement_5
			}
		}
	}

	theme = recovery

	left_portrait = {
		character = root
		animation = horrified_reflection_01
	}

	immediate = {
		root = { save_scope_as = disfigured_root }
		add_character_flag = lotr_force_disfigurement_bandages
	}

	option = { #don't wear the mask
		name = lotr_health_events.3001.a

		ai_chance = {
			base = 0
			modifier = {
				ai_boldness >= medium_positive_ai_value
				add = 10
			}
		}
	}

	option = { #wear the mask
		name = lotr_health_events.3001.b
		add_character_modifier = wearing_disfigurement_mask_modifier

		ai_chance = {
			base = 0
			modifier = {
				ai_boldness < medium_positive_ai_value
				add = 10
			}
		}
	}

	option = { #wear a full facemask meant to cover your entire face
		name = lotr_health_events.3001.c
		add_character_flag = disfigurement_fully_masked
		add_character_modifier = wearing_disfigurement_mask_modifier

		ai_chance = {
			base = 0
			modifier = {
				ai_sociability <= very_high_negative_ai_value
				add = 10
			}
		}
	}

	after = {
		remove_character_flag = lotr_force_disfigurement_bandages
	}
}