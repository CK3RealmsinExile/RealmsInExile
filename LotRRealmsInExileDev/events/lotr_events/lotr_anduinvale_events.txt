namespace = anduin_vale

### Anduin Vale Events ###
#		anduin_vale.0101	 #Grimbeorn gets title 'the Old'
#		anduin_vale.0102	 #Aladagana event
#		anduin_vale.0106	 #Restore the Éothéod event
#		anduin_vale.0107	 #Integrate Twainmantle event

anduin_vale.0101 = { # Grimbeorn gets title 'the Old'
    hidden = yes
    trigger = {
		character:lineofbeorn2 = {
			is_alive = yes
		}
	}
    option = {
        give_nickname = nick_the_old
    }
}

anduin_vale.0102 = { # Aladegana event
	content_source = realms_dlc
	type = character_event
	title = anduin_vale.0102.t
	desc = anduin_vale.0102.desc
	theme = stewardship_duty_focus
	override_background = {
		reference = carrock
	}

	left_portrait = {
		character = root
		animation = personality_bold
	}
	immediate = {
		show_as_tooltip = {
			get_title = title:e_anduin_vale
			set_primary_title_to = title:e_anduin_vale
			root.dynasty = {
				add_dynasty_modifier = aladegan
				add_dynasty_prestige = 500
			}
		}
	}	
	option = { # 
		name = anduin_vale.0102.a
		custom_tooltip = anduin_vale.0102.a.tt
	}
}

anduin_vale.0106 = { # Restore the Éothéod event
	content_source = realms_dlc
	type = character_event
	title = anduin_vale.0106.t
	desc = anduin_vale.0106.desc
	theme = stewardship_duty_focus
	override_background = {
		reference = carrock
	}
	left_portrait = {
		character = root
		animation = personality_bold
	}
	immediate = {
		show_as_tooltip = {
			get_title = title:k_eotheod
			set_primary_title_to = title:k_eotheod
			title:k_langwell = {
				every_de_jure_county = {
					add_county_modifier = {
						modifier = resurgent_eotheod
						years = 50
					}
				}
			}
			
			every_held_title = {
				limit = { tier = tier_duchy }
				set_de_jure_liege_title = title:k_eotheod
			}
			
			destroy_title = title:k_langwell
			
			if = {
				limit ={
					NOR = {
						has_realm_law = crown_authority_2
						has_realm_law = crown_authority_3
					}
				}
				add_realm_law_skip_effects = crown_authority_2
			}
		
			title:k_anduin_vale = { set_capital_county = title:c_gladden_fields }
			title:k_eotheod = { set_de_jure_liege_title = title:e_anduin_vale }
		}
	}
	option = { # 
		name = anduin_vale.0106.a
		custom_tooltip = anduin_vale.0106.a.tt
	}
}

anduin_vale.0107 = { # Integrate Twainmantle
	content_source = realms_dlc
	type = character_event
	title = anduin_vale.0107.t
	desc = anduin_vale.0107.desc
	theme = stewardship_duty_focus
	override_background = {
		reference = wilderness_mountains
	}
	immediate = {
		show_as_tooltip = {
			title:c_twainmantle = {
				set_de_jure_liege_title = title:d_ronen_in_anduin
				change_development_level = 3
			}
		}
	}
	left_portrait = {
		character = root
		animation = horse_sword_shield
		camera = camera_event_horse_very_left
	}
	
	option = { # It's done.
		name = anduin_vale.0107.a
		add_prestige = miniscule_prestige_gain
	}
}


##############################################
##### KULTAMIELI EVENT CHAIN - T.A. 1349 #####
##############################################


anduin_vale.0110 = { # Confederation of Langwell Destroyed - Kultamieli POV
	content_source = realms_dlc
	type = character_event
	title = anduin_vale.0110.t
	desc = anduin_vale.0110.desc
	theme = stewardship_duty_focus
	override_background = {
		reference = carrock
	}
	left_portrait = {
		character = root
		animation = personality_callous
	}
	
	option = { # Muahaha
		name = anduin_vale.0110.a
		add_prestige = medium_prestige_gain
	}
}

anduin_vale.0111 = { # Confederation of Langwell Destroyed - Confederation Member POV
	content_source = realms_dlc
	type = character_event
	title = anduin_vale.0111.t
	desc = anduin_vale.0111.desc
	theme = stewardship_duty_focus
	override_background = {
		reference = carrock
	}
	left_portrait = {
		character = root
		animation = personality_bold
	}
	
	option = { # Oh no
		name = anduin_vale.0111.a
	}
}

anduin_vale.0112 = { # Confederation of Langwell Strengthened - Holden POV
	content_source = realms_dlc
	type = character_event
	title = anduin_vale.0112.t
	desc = anduin_vale.0112.desc
	theme = stewardship_duty_focus
	override_background = {
		reference = carrock
	}
	left_portrait = {
		character = root
		animation = personality_honorable
	}
	
	option = { # Defensive approach 
		name = anduin_vale.0112.a
		title:c_taurau.holder.top_liege = {
			trigger_event = anduin_vale.0113
		}
	}
	option = { # Offensive approach
		name = anduin_vale.0112.b
		title:c_marsham.holder.top_liege = {
			trigger_event = anduin_vale.0113
		}
	}
}

anduin_vale.0113 = { # Choose to stay or leave Confederation?
	content_source = realms_dlc
	type = character_event
	title = anduin_vale.0113.t
	desc = anduin_vale.0113.desc
	theme = stewardship_duty_focus
	override_background = {
		reference = carrock
	}
	left_portrait = {
		character = root
		animation = personality_vengeful
	}
	right_portrait = {
		character = character:linegarsind7
		animation = personality_bold
	}

	option = { # Leave
		name = anduin_vale.0113.a
		trigger = {
			AND = {
				is_ai = yes
				NOT = {
					character:linegarsind7 = {
						has_relation_friend = root
					}
				}
			}
		}
		root.confederation = {
			save_scope_as = confederation
			every_confederation_member = {
				limit = {
					NOT = {
						this = root
					}
				}
				add_to_list = confederation_members
			}
		}
		scope:confederation = {
			#Your confederation will survive, it has more members
			if = {
				limit = {
					any_confederation_member = {
						count >= 2
						NOT = {
							this = root
						}
					}
				}
				remove_confederation_member = root
			}
			#Your confederation is toast
			else = {
				disband_confederation = yes
			}
		}
	}
	option = { #Stay
		name = anduin_vale.0113.b
		trigger = {
			AND = {
				is_ai = yes
				character:linegarsind7 = {
					has_relation_friend = root
				}
				
			}
		}
	}

	option = { # PLAYER ONLY OPTION - STAY
		name = anduin_vale.0113.c
		trigger = {
			is_ai = no
		}
	}
	option = { # PLAYER ONLY OPTION - LEAVE
		name = anduin_vale.0113.d
		trigger = {
			is_ai = no
		}
		root.confederation = {
			save_scope_as = confederation
			every_confederation_member = {
				limit = {
					NOT = {
						this = root
					}
				}
				add_to_list = confederation_members
			}
		}
		scope:confederation = {
			#Your confederation will survive, it has more members
			if = {
				limit = {
					any_confederation_member = {
						count >= 2
						NOT = {
							this = root
						}
					}
				}
				remove_confederation_member = root
			}
			#Your confederation is toast
			else = {
				disband_confederation = yes
			}
		}
		every_in_list = {
			list = confederation_members
			custom = custom.every_confederation_member
			add_opinion = {
				modifier = turncoat_opinion
				target = root
				opinion = -20
			}
		}
	}

}

anduin_vale.0114 = { # Langwell Under Angmarrim Domination
	content_source = realms_dlc
	type = character_event
	title = anduin_vale.0114.t
	desc = anduin_vale.0114.desc
	theme = war
	override_background = {
		reference = throne_room_evil
	}
	left_portrait = {
		character = root
		animation = personality_greedy
	}
	right_portrait = {
		character = character:nazgul1
		animation = personality_bold
	}

	option = { # Gentle plundering - Historical Option
		name = anduin_vale.0114.a 
		every_held_title = {
			limit = {
				kingdom = title:k_langwell
				tier = tier_county
			}
			change_development_level = -1
		}
		root.top_liege = {
			trigger_event = {
				id = anduin_vale.0115
				days = 1
			}
			add_character_modifier = {
				modifier = modifier_langwell_slaves_angmar 
				years = 15
			}
			add_opinion = {
				modifier = pleased_opinion
				target = root
				opinion = 20
			}
		}
		ai_chance = {
			base = 0 
			modifier = { # Game Rule
				has_game_rule = default_ai_behavior
				add = 100
			}
			modifier = { # Game Rule
				has_game_rule = weighted_ai_behavior
				add = 50
			}
			modifier = { # Game Rule
				has_game_rule = random_ai_behavior
				add = 33
			}
		}
	}
	option = { # Heavy plundering 
		name = anduin_vale.0114.b 
		every_held_title = {
			limit = {
				kingdom = title:k_langwell
				tier = tier_county
			}
			change_development_level = -4
		}
		root.top_liege = {
			trigger_event = {
				id = anduin_vale.0115
				days = 1
			}
			add_character_modifier = {
				modifier = modifier_langwell_slaves_angmar_2 
				years = 15
			}
			add_opinion = {
				modifier = pleased_opinion
				target = root
				opinion = 60
			}
		}
		ai_chance = {
			base = 0 
			modifier = { # Game Rule
				has_game_rule = default_ai_behavior
				add = 0
			}
			modifier = { # Game Rule
				has_game_rule = weighted_ai_behavior
				add = 25
			}
			modifier = { # Game Rule
				has_game_rule = random_ai_behavior
				add = 33
			}
		}
	}
	option = { # Let it be
		name = anduin_vale.0114.c 
		root.top_liege = {
			trigger_event = {
				id = anduin_vale.0115
				days = 1
			}
			add_character_modifier = {
				modifier = modifier_langwell_slaves_angmar_3 
				years = 15
			}
			add_opinion = {
				modifier = annoyed_opinion
				target = root
				opinion = -25
			}
		}
		ai_chance = {
			base = 0 
			modifier = { # Game Rule
				has_game_rule = default_ai_behavior
				add = 0
			}
			modifier = { # Game Rule
				has_game_rule = weighted_ai_behavior
				add = 25
			}
			modifier = { # Game Rule
				has_game_rule = random_ai_behavior
				add = 33
			}
		}
	}
}

anduin_vale.0115 = { # Witch-King recieves canonical amount of Northman Slaves
	content_source = realms_dlc
	type = character_event	
	title = anduin_vale.0115.t
	desc = {
		first_valid = {
			triggered_desc = {
				trigger = {
					root = { has_character_modifier = modifier_langwell_slaves_angmar }
				}
				desc = anduin_vale.0115.desc.a
			}
			triggered_desc = {
				trigger = {
					root = { has_character_modifier = modifier_langwell_slaves_angmar_2 }
				}
				desc = anduin_vale.0115.desc.b
			}
			triggered_desc = {
				trigger = {
					root = { has_character_modifier = modifier_langwell_slaves_angmar_3 }
				}
				desc = anduin_vale.0115.desc.c
			}
			desc = anduin_vale.0115.desc
		}
	}
	theme = war

	override_background = {
		reference = throne_room_evil
	}
	left_portrait = {
		character = root
		animation = personality_bold
	}
	right_portrait = {
		character = character:lineurgal5
		animation = personality_callous
	}
	
	option = { 
		name = anduin_vale.0115.a
	}
}

anduin_vale.0116 = { # Kultamieli raids Taurau - Kultamieli POV
	content_source = realms_dlc
	type = character_event
	title = anduin_vale.0116.t
	desc = anduin_vale.0116.desc
	theme = war
	override_background = {
		reference = carrock
	}
	left_portrait = {
		character = root
		animation = personality_greedy
	}
	right_portrait = {
		character = character:lineedelgar9
		animation = personality_vengeful
	}

	option = { # Muahaha
		name = anduin_vale.0116.a
	}

}

anduin_vale.0117 = { # Kultamieli raids Taurau - Riculfo POV
	content_source = realms_dlc
	type = character_event
	title = anduin_vale.0117.t
	desc = anduin_vale.0117.desc
	theme = war
	override_background = {
		reference = burning_building
	}
	left_portrait = {
		character = root
		animation = personality_vengeful
	}
	right_portrait = {
		character = character:lineurgal5
		animation = personality_dishonorable
	}

	option = { # We Ride!
		name = anduin_vale.0117.a 
		trigger_event = {
			id = anduin_vale.0118
			days = 2
		}
		ai_chance = {
 			base = 100
 		}
	}

	option = { # It's ok
		name = anduin_vale.0117.b
		add_stress = 150
		title:c_taurau = { 
			add_county_modifier = { 
				modifier = taurau_raided_county_modifier
				years = 5
			}
		}
		ai_chance = {
 			base = 50
 			modifier = {
 				factor = 0.5
 				OR = {
 					has_trait = vengeful
 					has_trait = stubborn
 					has_trait = wrathful
 					has_trait = brave
 				}
 			}
 		}
	}
}

anduin_vale.0118 = { # Ambush!
	content_source = realms_dlc
	type = character_event
	title = anduin_vale.0118.t
	desc = anduin_vale.0118.desc
	theme = battle

	left_portrait = {
		character = root
		animation = fear
	}
	right_portrait = {
		character = scope:angmarrim_raider
		scripted_animation = duel_wield_weapon
	}

	immediate = {
		create_character = {
			save_scope_as = angmarrim_raider
			culture = character:lineurgal5.culture
			faith = character:lineurgal5.faith
			gender = male
			martial = 10
			employer = character:lineurgal5
		}
	}

	option = { # It's a trap!
		name = anduin_vale.0118.a
		duel = {
			skill = prowess 
			value = 50
			50 = { 
				compare_modifier = {
					value = scope:duel_value
					multiplier = 1
					min = -50
				}
				desc = anduin_vale.0118.a.duel_success
				add_prestige = 250
				character:lineurgal5 = {
					trigger_event = {
						id = anduin_vale.0119
						days = 2
					}
				}
			}
			50 = {
				compare_modifier = {
					value = scope:duel_value
					multiplier = -1
					min = -50
				}
				desc = anduin_vale.0118.a.duel_failure
				death = {
					death_reason = death_wounded_2
				}
				character:lineurgal5 = {
					trigger_event = {
						id = anduin_vale.0120 
						days = 2
					}
				}
			}
		}
	}
}

anduin_vale.0119 = { # Ambush failed 
	content_source = realms_dlc
	type = character_event
	title = anduin_vale.0119.t
	desc = anduin_vale.0119.desc
	theme = war
	override_background = {
		reference = burning_building
	}
	left_portrait = {
		character = root
		animation = personality_vengeful
	}
	right_portrait = {
		character = character:lineedelgar9
		animation = personality_bold
	}

	option = { # That's a shame
		name = anduin_vale.0119.a 
		remove_short_term_gold = medium_gold_value
	}

}

anduin_vale.0120 = { # Ambush suceeds
	content_source = realms_dlc
	type = character_event
	title = anduin_vale.0120.t
	desc = anduin_vale.0120.desc
	theme = war
	override_background = {
		reference = burning_building
	}
	left_portrait = {
		character = root
		animation = personality_bold
	}
	right_portrait = {
		character = character:lineedelgar9
		animation = pain
	}

	option = { # Good riddance
		name = anduin_vale.0120.a 
	}

}
