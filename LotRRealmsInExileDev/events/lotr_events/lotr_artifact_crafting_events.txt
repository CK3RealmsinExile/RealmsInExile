namespace = artifact_crafting

artifact_crafting.0001 = {
	content_source = realms_dlc
	type = character_event
	title = artifact_crafting.0001.t
	desc = {
		first_valid = {
			triggered_desc = {
				trigger = { scope:dragon_slaying_weapon_black_arrow = yes }
				desc = artifact_crafting.0001.desc_black_arrow
			}
			triggered_desc = {
				trigger = { scope:dragon_slaying_weapon_windlance_bolt = yes }
				desc = artifact_crafting.0001.desc_windlance
			}
		}
	}
	right_portrait = {
		character = root
		animation = steward
	}
	artifact = {
		trigger = { exists = scope:windlance_bolt }
		target = scope:windlance_bolt
		position = lower_center_portrait
	}
	artifact = {
		trigger = { exists = scope:black_arrow }
		target = scope:black_arrow
		position = lower_center_portrait
	}
	immediate = {
		if = {
			limit = { scope:dragon_slaying_weapon_black_arrow = yes }
			any_artifact = {
				limit = {
					has_variable = black_arrow
					has_variable = historical_unique_artifact
				}
				save_scope_as = black_arrow
			}
			if = {
				limit = { NOT = { exists = scope:black_arrow } }
				character:k_wastelands_holder = {
					create_artifact_black_arrow_effect = { OWNER = this }
					scope:newly_created_artifact ?= {
						set_variable = fake_artifact
						save_scope_as = black_arrow
					}
				}
			}
		}
		else = {
			if = {
				limit = {
					title:c_dale.holder = {
						random_artifact = {
							limit = {
								has_variable = windlance_bolt
								has_variable = historical_unique_artifact
							}
							save_scope_as = windlance_bolt
						}
					}
				}
			}
			else = {
				character:k_wastelands_holder = {
					create_artifact_windlance_bolt_effect = { OWNER = this }
					scope:newly_created_artifact ?= {
						set_variable = fake_artifact
						save_scope_as = windlance_bolt
					}
				}
			}
		}
	}
	option = {
		name = artifact_crafting.0001.a
		if = {
			limit = { scope:dragon_slaying_weapon_black_arrow = yes }
			create_artifact_black_arrow_generic_effect = { OWNER = this }
		}
		else = { create_artifact_windlance_bolt_effect = { OWNER = this } }
		set_variable = {
			name = forged_slayer_artifact
			years = 20
		}
	}
	option = {
		name = artifact_crafting.0001.b
	}
	after = {
		if = {
			limit = { character:k_wastelands_holder = { any_character_artifact = { has_variable = fake_artifact } } }
			character:k_wastelands_holder = {
				every_character_artifact = {
					limit = { has_variable = fake_artifact }
					add_to_list = artifacts_to_remove
				}
			}
			every_in_list = {
				list = artifacts_to_remove
				save_scope_as = artifact
				remove_from_list = this
				destroy_artifact = scope:artifact
			}
		}
	}
}