namespace = artifact_crafting

artifact_crafting.0001 = {
	content_source = realms_dlc
	type = character_event
	title = artifact_crafting.0001.t
	desc = {
		desc = artifact_crafting.0001.desc_intro
		first_valid = {
			triggered_desc = {
				trigger = { scope:dragon_slaying_weapon_black_arrow = yes }
				desc = artifact_crafting.0001.desc_black_arrow
			}
			triggered_desc = {
				trigger = { scope:dragon_slaying_weapon_windlance_bolt = yes }
				desc = artifact_crafting.0001.desc_windlance
			}
		}
	}
	theme = realm
	right_portrait = {
		character = root
		animation = steward
	}
	artifact = {
		trigger = { exists = scope:windlance_bolt }
		target = scope:windlance_bolt
		position = lower_center_portrait
	}
	artifact = {
		trigger = { exists = scope:black_arrow }
		target = scope:black_arrow
		position = lower_center_portrait
	}
	immediate = {
		hidden_effect = {
			if = {
				limit = { scope:dragon_slaying_weapon_black_arrow = yes }
				random_artifact = {
					limit = {
						has_variable = black_arrow
						has_variable = historical_unique_artifact
					}
					save_scope_as = black_arrow
				}
				if = {
					limit = { NOT = { exists = scope:black_arrow } }
					character:k_wastelands_holder = {
						create_artifact_black_arrow_generic_effect = { OWNER = this }
						scope:newly_created_artifact ?= {
							set_variable = fake_artifact
							save_scope_as = black_arrow
						}
					}
				}
			}
			else = {
				if = {
					limit = {
						any_artifact = {
							has_variable = windlance_bolt
							has_variable = historical_unique_artifact
						}
					}
					random_artifact = {
						limit = {
							has_variable = windlance_bolt
							has_variable = historical_unique_artifact
						}
						save_scope_as = windlance_bolt
					}
				}
				else = {
					character:k_wastelands_holder = {
						create_artifact_windlance_bolt_effect = { OWNER = this }
						scope:newly_created_artifact ?= {
							set_variable = fake_artifact
							save_scope_as = windlance_bolt
						}
					}
				}
			}
		}
		random_held_county = {
			limit = { title_province = { has_building_or_higher = dwarven_forge_01 } }
			save_scope_as = county
		}
	}
	option = {
		name = artifact_crafting.0001.a
		if = {
			limit = { scope:dragon_slaying_weapon_black_arrow = yes }
			create_artifact_black_arrow_generic_effect = { OWNER = this }
		}
		else = { create_artifact_windlance_bolt_effect = { OWNER = this } }
		custom_tooltip = forged_slayer_artifact_cooldown
		set_variable = {
			name = forged_slayer_artifact
			years = 20
		}
		remove_short_term_gold = 2500
	}
	option = {
		name = artifact_crafting.0001.b
	}
	after = {
		hidden_effect = {
			if = {
				limit = { character:k_wastelands_holder = { any_character_artifact = { has_variable = fake_artifact } } }
				if = {
					limit = { scope:black_arrow.artifact_owner ?= character:k_wastelands_holder }
					destroy_artifact ?= scope:black_arrow
				}
				else_if = {
					limit = { scope:windlance_bolt.artifact_owner ?= character:k_wastelands_holder }
					destroy_artifact ?= scope:windlance_bolt
				}
			}
		}
	}
}