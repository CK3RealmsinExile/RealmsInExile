namespace = goblin_yearly


###################################################################
### goblin_yearly.0001 - Intruders! by sakkar 			###
###################################################################

goblin_yearly.0001 = {
    content_source = realms_dlc
	type = character_event
	title = goblin_yearly.0001.t
	desc = goblin_yearly.0001.desc
	theme = martial_strategy_focus
	override_background = {
		reference = wilderness_underground
	}    

    left_portrait = {
		character = root
        animation = personality_bold
    }

    right_portrait = { 
		character ?= scope:goblin_char 
		animation = personality_coward
	}

    trigger = {
		AND = {
			is_goblin = yes
			NOT = {
				has_trait = craven
			}
		}
	}

    immediate = {
		if = {
			limit = {
				any_vassal_or_below = { is_ai = yes is_goblin = yes }
			}
			every_vassal_or_below = {
				limit = { is_ai = yes is_goblin = yes }
				add_to_list = goblin_characters
			}
		}
		random_in_list = {
			list = goblin_characters
			save_scope_as = goblin_char
		}

		if = {
			limit = { NOT = { exists = scope:dwarven_char } }
			if = {
				limit = {
					any_courtier_or_guest = { is_ai = yes is_goblin = yes }
				}
				every_courtier_or_guest = {
					limit = { is_ai = yes is_goblin = yes }
					add_to_list = goblin_characters
				}
			}
			random_in_list = {
				list = goblin_characters
				save_scope_as = goblin_char
			}
    	}
	}	

    option = {
		name = goblin_yearly.0001.a

		stress_impact = {
			compassionate = medium_stress_gain
			callous = minor_stress_loss
		}

		scope:goblin_char = {
			add_opinion = {
				modifier = disappointed_opinion
				opinion = -40
				target = root
			}
            add_prestige = -50
            remove_short_term_gold = 20
			
		}
	}

    option = {
		name = goblin_yearly.0001.b

		stress_impact = {
			honest = medium_stress_gain
			deceitful = minor_stress_loss
		}

        duel = {
			skill = intrigue
			value = average_skill_rating
			40 = {
				desc = goblin_yearly.0001.b.success
				compare_modifier = {
					value = scope:duel_value
					multiplier = 2
				}
				
                add_dread = major_dread_gain
                add_prestige = 100

                scope:goblin_char = {
                    add_opinion = {
	    			    modifier = pleased_opinion
		    		    opinion = 20
			    	    target = root
			        }
                    add_prestige = 100
                }    
			}
			60 = {
				desc = goblin_yearly.0001.b.failure
				compare_modifier = {
					value = scope:duel_value
					multiplier = -2
				}
				add_prestige = -50
                remove_short_term_gold = 20        

				scope:goblin_char = {
                    add_opinion = {
	    			    modifier = pleased_opinion
		    		    opinion = 20
			    	    target = root
			        }
                    add_prestige = -50
                } 
			}
		}
	}

    option = {
		name = goblin_yearly.0001.c

		stress_impact = {
			honest = medium_stress_gain
			deceitful = minor_stress_loss
		}

        duel = {
			skill = intrigue
			value = average_skill_rating
			60 = {
				desc = goblin_yearly.0001.c.success
				compare_modifier = {
					value = scope:duel_value
					multiplier = 2
				}

				add_character_modifier = {
					modifier = watchful_modifier
					days = watchful_modifier_duration
				}                

                scope:goblin_char = {
                    add_opinion = {
	    			    modifier = pleased_opinion
		    		    opinion = 20
			    	    target = root
			        }
                }    
			}
			40 = {
				desc = goblin_yearly.0001.c.failure
				compare_modifier = {
					value = scope:duel_value
					multiplier = -2
				}
				add_prestige = -50
                remove_short_term_gold = 20

				scope:goblin_char = {
                    add_opinion = {
	    			    modifier = pleased_opinion
		    		    opinion = 20
			    	    target = root
			        }
                    add_prestige = -50
                } 
			}
		}
	}
}
