namespace = wander_terilaen

wander_terilaen.1000 = { # Choosing a destination
    hidden = yes
    immediate = {
        if = {
            limit = { is_landed = yes}
            random_province = {
                limit = {
                    "squared_distance(root.capital_province)" <= squared_distance_large
                    OR = {
                        has_holding_type = city_holding
                        has_holding_type = castle_holding
                        has_holding_type = tribal_holding
						has_holding_type = settlement_holding
                    }
					county.culture = {
						is_human_culture = yes
					}
				}	
                save_scope_as = destination_terilaen
            }
        }
        trigger_event = wander_terilaen.1001
    }
}

wander_terilaen.1001 = { # Setting out
    title = wander_terilaen.1001.t
	type = character_event
	desc = wander_terilaen.1001.desc
	content_source = realms_dlc
	theme = elven
	override_background = { reference = throne_room }
	left_portrait = {
		character = root
		animation = personality_bold
	}
	option = { # I'm off
		name = wander_terilaen.1001.a
		custom_tooltip = wander_terilaen.1001.a.tt
		start_travel_plan = { #Travel to the forest
			destination = scope:destination_terilaen
			players_use_planner = no
			on_arrival_event = wander_terilaen.1002
		}
	}
}

wander_terilaen.1002 = { # Arrival - get a random event
	hidden = yes
	immediate = {
		root.location = { save_scope_as = destination_terilaen }
		#current_travel_plan ?= { abort_travel_plan = yes }
		trigger_event = {
			on_action = wander_terilaen_events
		}
	}
}

wander_terilaen.1010 = { # Physician
    title = wander_terilaen.1010.t
	type = character_event
	desc = wander_terilaen.1010.desc
	content_source = realms_dlc
	theme = learning
	override_background = { 
			trigger = { 
				scope:destination_terilaen = { has_holding_type = castle_holding } 
			}
			reference = courtyard_location 
	}
	override_background = { 
		trigger = { 
			scope:destination_terilaen = { has_holding_type = city_holding } 
		}
		reference = market
	}
	override_background = { 
		trigger = { 
			scope:destination_terilaen = {
				OR = {
					has_holding_type = settlement_holding
					has_holding_type = tribal_holding
				} 
			}
		}
		reference = market_tribal
	}
	left_portrait = {
		character = root
		animation = interested
    }
    option = {
        name = wander_terilaen.1010.a
        random_list = {
			50 = {
				add_learning_lifestyle_xp = 200
			}
			50 = {
				add_learning_lifestyle_perk_points = 1
			}
		}
    }
    after = {
        trigger_event = wander_terilaen.1099
    }
}

wander_terilaen.1015 = { # Minstrel
    title = wander_terilaen.1015.t
	type = character_event
	desc = wander_terilaen.1015.desc
	content_source = realms_dlc
	theme = learning
	override_background = { 
			trigger = { 
				scope:destination_terilaen = { has_holding_type = castle_holding } 
			}
			reference = courtyard_location 
	}
	override_background = { 
		trigger = { 
			scope:destination_terilaen = { has_holding_type = city_holding } 
		}
		reference = market
	}
	override_background = { 
		trigger = { 
			scope:destination_terilaen = {
				OR = {
					has_holding_type = settlement_holding
					has_holding_type = tribal_holding
				} 
			}
		}
		reference = market_tribal
	}
	left_portrait = {
		character = root
		animation = instrument_active
    }
    option = {
        name = wander_terilaen.1015.a
		random = {
			chance = 25
			if = {
				limit = { has_trait = lifestyle_poet }
				add_diplomacy_lifestyle_xp = 100
			}
			else = { add_trait = lifestyle_poet }
			add_stress = minor_stress_loss
		}
    }
    after = {
        trigger_event = wander_terilaen.1099
    }
}

wander_terilaen.1099 = { # Returning home
	title = wander_terilaen.1099.t
	type = character_event
	desc = wander_terilaen.1099.desc
	content_source = realms_dlc
	theme = elven
	override_background = { 
			trigger = { 
				scope:destination_terilaen = { has_holding_type = castle_holding } 
			}
			reference = courtyard_location 
	}
	override_background = { 
		trigger = { 
			scope:destination_terilaen = { has_holding_type = city_holding } 
		}
		reference = market
	}
	override_background = { 
		trigger = { 
			scope:destination_terilaen = {
				OR = {
					has_holding_type = settlement_holding
					has_holding_type = tribal_holding
				} 
			}
		}
		reference = market_tribal
	}
	left_portrait = {
		character = root
		animation = personality_content
	}
	option = { # I'm going home
		name = wander_terilaen.1099.a
		custom_tooltip = wander_terilaen.1099.a.tt
	}
}
