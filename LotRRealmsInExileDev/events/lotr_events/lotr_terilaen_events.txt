namespace = wander_terilaen

wander_terilaen.1000 = { # Choosing a destination
    hidden = yes
    immediate = {
        if = {
            limit = { is_landed = yes}
            random_province = {
                limit = {
                    "squared_distance(root.capital_province)" <= squared_distance_large
                    OR = {
                        has_holding_type = city_holding
                        has_holding_type = castle_holding
                        has_holding_type = tribal_holding
						has_holding_type = settlement_holding
                    }
					county.culture = {
						is_human_culture = yes
					}
				}	
                save_scope_as = destination_terilaen
            }
        }
        trigger_event = wander_terilaen.1001
    }
}

wander_terilaen.1001 = { # Setting out
    title = wander_terilaen.1001.t
	type = character_event
	desc = wander_terilaen.1001.desc
	content_source = realms_dlc
	theme = elven
	override_background = { reference = throne_room }
	left_portrait = {
		character = root
		animation = personality_bold
	}
	option = { # I'm off
		name = wander_terilaen.1001.a
		custom_tooltip = wander_terilaen.1001.a.tt
		start_travel_plan = { #Travel to the forest
			destination = scope:destination_terilaen
			players_use_planner = no
			on_arrival_event = wander_terilaen.1002
		}
	}
}

wander_terilaen.1002 = { # Arrival - get a random event
	hidden = yes
	immediate = {
		root.location = { save_scope_as = destination_terilaen }
		#current_travel_plan ?= { abort_travel_plan = yes }
		trigger_event = {
			on_action = wander_terilaen_events
		}
	}
}

wander_terilaen.1010 = { # Physician
    title = wander_terilaen.1010.t
	type = character_event
	desc = wander_terilaen.1010.desc
	content_source = realms_dlc
	theme = learning
	override_background = { 
			trigger = { 
				scope:destination_terilaen = { has_holding_type = castle_holding } 
			}
			reference = courtyard_location 
	}
	override_background = { 
		trigger = { 
			scope:destination_terilaen = { has_holding_type = city_holding } 
		}
		reference = market
	}
	override_background = { 
		trigger = { 
			scope:destination_terilaen = {
				OR = {
					has_holding_type = settlement_holding
					has_holding_type = tribal_holding
				} 
			}
		}
		reference = market_tribal
	}
	left_portrait = {
		character = root
		animation = interested
    }
    option = {
        name = wander_terilaen.1010.a
        random_list = {
			70 = {
				add_learning_lifestyle_xp = 200
			}
			30 = {
				add_learning_lifestyle_perk_points = 1
			}
		}
    }
    after = {
        trigger_event = wander_terilaen.1099
    }
}

wander_terilaen.1011 = { # Attacked!
	title = wander_terilaen.1011.t
	type = character_event
	desc = wander_terilaen.1011.desc
	content_source = realms_dlc
	theme = elven
	override_background = { 
			trigger = { 
				scope:destination_terilaen = { has_holding_type = castle_holding } 
			}
			reference = courtyard_location 
	}
	override_background = { 
		trigger = { 
			scope:destination_terilaen = { has_holding_type = city_holding } 
		}
		reference = market
	}
	override_background = { 
		trigger = { 
			scope:destination_terilaen = { has_holding_type = settlement_holding } 
		}
		reference = market_tribal
	}
	left_portrait = {
		character = root
		animation = shock
	}
	option = { # Fight them off
		name = wander_terilaen.1011.a
		duel = {
			skill = martial 
			value = 13

			20 = {
				compare_modifier = {
					value = scope:duel_value
					multiplier = 2
				}
				add_martial_lifestyle_xp = 200
				add_stress = 20
			}
			20 = {
				compare_modifier = {
					value = scope:duel_value
					multiplier = 1
				}
				increase_wounds_effect = { REASON = fight }
				add_elven_hope_effect = { VALUE = minor_elven_hope_loss HOPE_EFFECT = effect_elven_hope_terilaen }
			}
		}
	}
	option = { # Flee
		name = wander_terilaen.1011.b
		duel = {
			skill = martial
			value = 8

			20 = {
				compare_modifier = {
					value = scope:duel_value
					multiplier = 2
				}
				add_martial_lifestyle_xp = 100
				add_stress = 20
			}
			20 = {
				compare_modifier = {
					value = scope:duel_value
					multiplier = 1
				}
				increase_wounds_effect = { REASON = fight }
				add_elven_hope_effect = { VALUE = minor_elven_hope_loss HOPE_EFFECT = effect_elven_hope_terilaen }
			}
		}
	}
	after = {
		trigger_event = wander_terilaen.1099
	}
}

wander_terilaen.1012 = { # Delivering a human child!
	title = wander_terilaen.1012.t
	type = character_event
	desc = wander_terilaen.1012.desc
	content_source = realms_dlc
	theme = elven
	override_background = { 
			trigger = { 
				scope:destination_terilaen = { has_holding_type = castle_holding } 
			}
			reference = courtyard_location 
	}
	override_background = { 
		trigger = { 
			scope:destination_terilaen = { has_holding_type = city_holding } 
		}
		reference = market
	}
	override_background = { 
		trigger = { 
			scope:destination_terilaen = { has_holding_type = settlement_holding } 
		}
		reference = market_tribal
	}
	left_portrait = {
		character = root
		animation = physician
	}
	option = { # I will do my best
		name = wander_terilaen.1012.a
		duel = {
			skill = learning 
			value = 27

			20 = {
				compare_modifier = {
					value = scope:duel_value
					multiplier = 2
				}
				add_elven_hope_effect = { VALUE = medium_elven_hope_gain HOPE_EFFECT = effect_elven_hope_terilaen }
				add_stress = medium_stress_loss
			}
			20 = {
				compare_modifier = {
					value = scope:duel_value
					multiplier = 1
				}
				add_elven_hope_effect = { VALUE = medium_elven_hope_loss HOPE_EFFECT = effect_elven_hope_terilaen }
				add_stress = medium_stress_gain
			}
		}
	}
	after = {
		trigger_event = wander_terilaen.1099
	}
}

wander_terilaen.1013 = { # Talking with the local lord
	title = wander_terilaen.1013.t
	type = character_event
	desc = wander_terilaen.1013.desc
	content_source = realms_dlc
	theme = elven
	override_background = { 
			trigger = { 
				scope:destination_terilaen = { has_holding_type = castle_holding } 
			}
			reference = courtyard_location 
	}
	override_background = { 
		trigger = { 
			scope:destination_terilaen = { has_holding_type = city_holding } 
		}
		reference = market
	}
	override_background = { 
		trigger = { 
			scope:destination_terilaen = { has_holding_type = settlement_holding } 
		}
		reference = market_tribal
	}
	left_portrait = {
		character = root
		animation = chancellor
	}
	right_portrait = {
		character = scope:destination_terilaen.barony.holder
		animation = interested_left
	}
	option = { # Small Talk
		name = wander_terilaen.1013.a
		duel = {
			skill = diplomacy 
			value = 13

			20 = {
				compare_modifier = {
					value = scope:duel_value
					multiplier = 2
				}
				add_diplomacy_lifestyle_xp = 200
				add_prestige = medium_prestige_gain
			}
			20 = {
				compare_modifier = {
					value = scope:duel_value
					multiplier = 1
				}
				add_prestige = major_prestige_loss
			}
		}
	}
	option = { # Big Talk
		name = wander_terilaen.1013.b
		duel = {
			skill = diplomacy
			value = 19

			20 = {
				compare_modifier = {
					value = scope:duel_value
					multiplier = 2
				}
				add_diplomacy_lifestyle_xp = 100
				add_elven_hope_effect = { VALUE = medium_elven_hope_gain HOPE_EFFECT = effect_elven_hope_terilaen }
			}
			20 = {
				compare_modifier = {
					value = scope:duel_value
					multiplier = 1
				}
				add_stress = medium_stress_gain
				add_elven_hope_effect = { VALUE = medium_elven_hope_loss HOPE_EFFECT = effect_elven_hope_terilaen }
			}
		}
	}
	after = {
		trigger_event = wander_terilaen.1099
	}
}

wander_terilaen.1014 = { # Curing the leper
	title = wander_terilaen.1014.t
	type = character_event
	desc = wander_terilaen.1014.desc
	content_source = realms_dlc
	theme = elven
	override_background = { 
			trigger = { 
				scope:destination_terilaen = { has_holding_type = castle_holding } 
			}
			reference = courtyard_location 
	}
	override_background = { 
		trigger = { 
			scope:destination_terilaen = { has_holding_type = city_holding } 
		}
		reference = market
	}
	override_background = { 
		trigger = { 
			scope:destination_terilaen = { has_holding_type = settlement_holding } 
		}
		reference = market_tribal
	}
	left_portrait = {
		character = root
		animation = physician
	}
	option = { # I will
		name = wander_terilaen.1014.a
		duel = {
			skill = learning 
			value = 17

			20 = {
				compare_modifier = {
					value = scope:duel_value
					multiplier = 2
				}
				add_elven_hope_effect = { VALUE = minor_elven_hope_gain HOPE_EFFECT = effect_elven_hope_terilaen }
				add_piety = medium_piety_gain
			}
			20 = {
				compare_modifier = {
					value = scope:duel_value
					multiplier = 1
				}
				add_elven_hope_effect = { VALUE = minor_elven_hope_loss HOPE_EFFECT = effect_elven_hope_terilaen }
				add_stress = medium_stress_gain
			}
		}
	}
	after = {
		trigger_event = wander_terilaen.1099
	}
}

wander_terilaen.1015 = { # Minstrel
    title = wander_terilaen.1015.t
	type = character_event
	desc = wander_terilaen.1015.desc
	content_source = realms_dlc
	theme = learning
	override_background = { 
			trigger = { 
				scope:destination_terilaen = { has_holding_type = castle_holding } 
			}
			reference = courtyard_location 
	}
	override_background = { 
		trigger = { 
			scope:destination_terilaen = { has_holding_type = city_holding } 
		}
		reference = market
	}
	override_background = { 
		trigger = { 
			scope:destination_terilaen = {
				OR = {
					has_holding_type = settlement_holding
					has_holding_type = tribal_holding
				} 
			}
		}
		reference = market_tribal
	}
	left_portrait = {
		character = root
		animation = instrument_active
    }
    option = {
        name = wander_terilaen.1015.a
		random = {
			chance = 25
			if = {
				limit = { has_trait = lifestyle_poet }
				add_diplomacy_lifestyle_xp = 100
			}
			else = { add_trait = lifestyle_poet }
		}
		add_stress = minor_stress_loss
    }
    after = {
        trigger_event = wander_terilaen.1099
    }
}

wander_terilaen.1016 = { # Hired to fix a roof
	title = wander_terilaen.1016.t
	type = character_event
	desc = wander_terilaen.1016.desc
	content_source = realms_dlc
	theme = elven
	override_background = { 
			trigger = { 
				scope:destination_terilaen = { has_holding_type = castle_holding } 
			}
			reference = courtyard_location 
	}
	override_background = { 
		trigger = { 
			scope:destination_terilaen = { has_holding_type = city_holding } 
		}
		reference = market
	}
	override_background = { 
		trigger = { 
			scope:destination_terilaen = { has_holding_type = settlement_holding } 
		}
		reference = market_tribal
	}
	left_portrait = {
		character = root
		animation = steward
	}
	option = { # Sure
		name = wander_terilaen.1016.a
		duel = {
			skill = stewardship 
			value = 18

			20 = {
				compare_modifier = {
					value = scope:duel_value
					multiplier = 2
				}
				add_stewardship_lifestyle_xp = 200
				add_short_term_gold = 75
			}
			20 = {
				compare_modifier = {
					value = scope:duel_value
					multiplier = 1
				}
				add_prestige = major_prestige_loss
			}
		}
	}
	option = { # Sure, I'll do it for free
		name = wander_terilaen.1016.b
		duel = {
			skill = stewardship
			value = 18

			20 = {
				compare_modifier = {
					value = scope:duel_value
					multiplier = 2
				}
				add_stewardship_lifestyle_xp = 200
				add_elven_hope_effect = { VALUE = minor_elven_hope_gain HOPE_EFFECT = effect_elven_hope_terilaen }
			}
			20 = {
				compare_modifier = {
					value = scope:duel_value
					multiplier = 1
				}
				add_prestige = major_prestige_loss
			}
		}
	}
	after = {
		trigger_event = wander_terilaen.1099
	}
}

wander_terilaen.1017 = { # Hired to weave history
	title = wander_terilaen.1017.t
	type = character_event
	desc = wander_terilaen.1017.desc
	content_source = realms_dlc
	theme = elven
	override_background = { 
			trigger = { 
				scope:destination_terilaen = { has_holding_type = castle_holding } 
			}
			reference = courtyard_location 
	}
	override_background = { 
		trigger = { 
			scope:destination_terilaen = { has_holding_type = city_holding } 
		}
		reference = market
	}
	override_background = { 
		trigger = { 
			scope:destination_terilaen = { has_holding_type = settlement_holding } 
		}
		reference = market_tribal
	}
	left_portrait = {
		character = root
		animation = interested
	}
	option = { # I'll weave the history of this people
		name = wander_terilaen.1017.a
		duel = {
			skill = stewardship 
			value = 20

			20 = {
				compare_modifier = {
					value = scope:duel_value
					multiplier = 2
				}
				add_stewardship_lifestyle_xp = 200
				add_short_term_gold = 100
			}
			20 = {
				compare_modifier = {
					value = scope:duel_value
					multiplier = 1
				}
				add_prestige = major_prestige_loss
			}
		}
	}
	option = { # I'll weave a scene of Cuivienen
		name = wander_terilaen.1017.b
		duel = {
			skill = learning
			value = 30

			20 = {
				compare_modifier = {
					value = scope:duel_value
					multiplier = 2
				}
				add_prestige = major_prestige_gain
				add_short_term_gold = 15
				add_elven_hope_effect = { VALUE = medium_elven_hope_gain HOPE_EFFECT = effect_elven_hope_terilaen }
			}
			20 = {
				compare_modifier = {
					value = scope:duel_value
					multiplier = 1
				}
				add_prestige = major_prestige_loss
				add_elven_hope_effect = { VALUE = minor_elven_hope_loss HOPE_EFFECT = effect_elven_hope_terilaen }
			}
		}
	}
	after = {
		trigger_event = wander_terilaen.1099
	}
}

wander_terilaen.1099 = { # Returning home
	title = wander_terilaen.1099.t
	type = character_event
	desc = wander_terilaen.1099.desc
	content_source = realms_dlc
	theme = elven
	override_background = { 
			trigger = { 
				scope:destination_terilaen = { has_holding_type = castle_holding } 
			}
			reference = courtyard_location 
	}
	override_background = { 
		trigger = { 
			scope:destination_terilaen = { has_holding_type = city_holding } 
		}
		reference = market
	}
	override_background = { 
		trigger = { 
			scope:destination_terilaen = {
				OR = {
					has_holding_type = settlement_holding
					has_holding_type = tribal_holding
				} 
			}
		}
		reference = market_tribal
	}
	left_portrait = {
		character = root
		animation = personality_content
	}
	option = { # I'm going home
		name = wander_terilaen.1099.a
		custom_tooltip = wander_terilaen.1099.a.tt
	}
}
