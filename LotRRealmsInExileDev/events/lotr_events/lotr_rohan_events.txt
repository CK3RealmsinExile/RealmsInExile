namespace = rohan

#### Events about Edoras
#	rohan.2100 - 2123	King in Golden Hall event chain

#### Decision Events
#		rohan.2000-4	Oath of Eorl / Cirion
# 		rohan.2500		Invite Dwarves to the White Mountains

#### The Death of Éomund & Éomer and Éowyn's Tutelage
#		rohan.1200		Orcs spotted in the Emyn Muil. 
#		rohan.1201		Journey and eventual ambush by orcs.
#		rohan.1202		The death of Éomund
#		rohan.1203		Théodwyn becomes ill and dies.
#		rohan.1204		Éomer and Éowyn react, moving to Edoras.
#		rohan.1205		Éomer's trait assignment
#		rohan.1206		Éowyn's trait assignment


##########################################
# Theodred Events
##########################################
#	rohan.2200	Orcs in the Westfold
#	rohan.2201	Burning Villages
#	rohan.2202	Ambush at the Isen
#	rohan.2203	Aftermath of the Ambush at the Isen / Eomer takes Theodred back to Edoras.
#	rohan.2204	Le Morte de Theodred
#	rohan.2205	Burying a Child
#	rohan.2206	Muster the Rohirrim!
#	rohan.2207	Muster the Rohirrim - Grimsglade
#	rohan.2208	Muster the Rohirrim - Harrowdale
#	rohan.2209	Muster the Rohirrim - Eastfold
#	rohan.2210	Muster the Rohirrim - Eastemnet
#	rohan.2211	Muster the Rohirrim - Grimslade Men Arrive at Edoras
#	rohan.2212	Muster the Rohirrim - Harowdale Men Arrive at Edoras
#	rohan.2213	Muster the Rohirrim - Eastfold Men Arrive at Edoras
#	rohan.2214	Muster the Rohirrim - Eastemnet Men Arrive at Edoras
##########################################

##### Realm events
#	rohan.3000	Fall of Edoras
#	rohan.3001	Reclamation of Edoras

rohan.0002 = { #Eotheod Restoration Human Event
	content_source = realms_dlc
	type = character_event
	title = rohan.0002.t
	desc = rohan.0002.desc
	theme = realm
	override_background = {
		reference = edoras
	}
	left_portrait = {
		character = root
		animation = personality_honorable
	}

	right_portrait = {
		character = scope:unifier
		animation = personality_bold
	}
	
	immediate = { play_music_cue = lotr_cue_rohan }
	
	option = { #Convert
		name = rohan.0002.a
		set_culture = culture:eotheod
	}

	option = { #Cling to the old ways
		name = rohan.0002.b
	}

}

rohan.0100 = { # Status of the Northern Border (Independent Leofrings in the Wold/Eastemnet)
	content_source = realms_dlc
	type = character_event
	title = rohan.0100.t
	desc = rohan.0100.desc
	theme = realm
	override_background = {
		reference = edoras
	}
	left_portrait = {
		character = root
		animation = personality_honorable
	}

	trigger = {
		has_title = title:k_rohan
	}

	immediate = {
		save_scope_as = monarch_of_rohan
		character:lineofeorl1 = { save_scope_as = eorl }
		character:lineleofring1 = { save_scope_as = leofr }
	}

	option = { # They must recognize the authority of Edoras!
		name = rohan.0100.a
		ai_chance = {
			base = 0 # LotR: This should be tied to WotR mode.

			modifier = { # Game Rule
				has_game_rule = default_ai_behavior
				add = 100
			}

			modifier = { # Game Rule
				has_game_rule = weighted_ai_behavior
				add = 75
			}

			modifier = { # Game Rule
				has_game_rule = random_ai_behavior
				add = 50
			}
		}

		title:k_rohan = {
			every_de_jure_county_holder = {
            	limit = {
					is_independent_ruler = yes
					is_landed = yes
					highest_held_title_tier <= tier_duchy
					NOT = { THIS = scope:monarch_of_rohan }
					capital_county = { # If capital is in Rohan
						title_province = { geographical_region = middleearth_west_rohan }
					}
				}
				trigger_event = {
					id = rohan.0101
					days = { 3 10 }
				}
			}
		}
	}

	option = { # Leave them be, these few pastoralists are no threat to our authority...
		name = rohan.0100.b
		ai_chance = {
			base = 0 # LotR: This should be tied to WotR mode.

			modifier = { # Game Rule
				has_game_rule = weighted_ai_behavior
				add = 25
			}

			modifier = { # Game Rule
				has_game_rule = random_ai_behavior
				add = 50
			}
		}
	}
}

rohan.0101 = {
	type = letter_event
	sender = scope:sender
	opening = rohan.0101.opening
	desc = rohan.0101.desc

	trigger = {
		NOT = { is_at_war_with = title:k_rohan.holder }
		NOT = { root = title:k_rohan.holder }
	}

	on_trigger_fail = { #Trigger invitation again if it was blocked because the character was handling another invitation
		trigger_event = {
			id = rohan.0101
			days = 1
		}
	}

	immediate = {
		title:k_rohan.holder = {
			save_scope_as = sender
		}
		ROOT = {
			save_scope_as = recipient
		}
	}

	option = { 
		name = rohan.0101.a # We kneel before Edoras
		show_as_tooltip = {
			create_title_and_vassal_change = {
				type = swear_fealty
				save_scope_as = change
				add_claim_on_loss = no
			}
			change_liege = {
				liege = scope:sender
				change = scope:change
			}
			resolve_title_and_vassal_change = scope:change
		}
		hidden_effect = {
			scope:sender = { trigger_event = rohan.0102 }
		}

		ai_chance = {
			base = 0
			modifier = { # Game Rule
				has_game_rule = default_ai_behavior
				add = 100
			}

			modifier = { # Game Rule
				has_game_rule = weighted_ai_behavior
				add = 70
			}

			modifier = { # Game Rule
				has_game_rule = random_ai_behavior
				add = 50
			}
			opinion_modifier = {
				opinion_target = scope:sender
				multiplier = 1
			}
			modifier = {
				add = {
					value = root.ai_boldness
					multiply = -1
				}
			}
			modifier = {
				add = {
					value = root.ai_rationality
					multiply = 1
				}
			}

			modifier = { # Léomund is arrogant and fearful
				this = character:lineleofr5
				has_game_rule = default_ai_behavior
				add = -100
			}

			modifier = { # Léomund is arrogant and fearful
				this = character:lineleofr5
				has_game_rule = weighted_ai_behavior
				add = -50
			}
		}
	}

	option = {
		name = rohan.0101.b # I will remain independent
		show_as_tooltip = {
			if = {
				limit = {
					scope:recipient.primary_title.kingdom ?= title:k_rohan
				}
				scope:sender = {
					add_unpressed_claim = scope:recipient.primary_title
				}
			}
			add_prestige = 75
		}
		hidden_effect = {
			scope:sender = { trigger_event = rohan.0103 }
		}
		# if = {
		# 	limit = { is_ai = yes }
			#lotr_get_aggressive = yes
		# }
		ai_chance = {
			base = 0 # LotR: This should be tied to WotR mode.

			modifier = { # Game Rule
				has_game_rule = default_ai_behavior
				add = 0
			}

			modifier = { # Game Rule
				has_game_rule = weighted_ai_behavior
				add = 30
			}

			modifier = { # Game Rule
				has_game_rule = random_ai_behavior
				add = 50
			}

			modifier = { # Léomund is arrogant and fearful
				this = character:lineleofr5
				has_game_rule = default_ai_behavior
				add = 100
			}

			modifier = { # Léomund is arrogant and fearful
				this = character:lineleofr5
				has_game_rule = weighted_ai_behavior
				add = 50
			}
		}
	}
}

rohan.0102 = { # Subjugation accepted
	type = letter_event
	opening = rohan.0102.opening
	desc = rohan.0102.desc
	sender = scope:recipient

	immediate = {
		scope:recipient = {
			create_title_and_vassal_change = {
				type = swear_fealty
				save_scope_as = change
				add_claim_on_loss = no
			}
			change_liege = {
				liege = scope:sender
				change = scope:change
			}
			resolve_title_and_vassal_change = scope:change
		}
	}

	option = { # Wise choice
		name = rohan.0102.a
	}
}

rohan.0103 = { # Subjugation refused
	type = letter_event
	opening = rohan.0103.opening
	desc = rohan.0103.desc
	sender = {
		character = scope:recipient
		animation = personality_bold
	}

	immediate = {
		if = {
			limit = {
				scope:recipient.primary_title.kingdom ?= title:k_rohan
			}
			scope:sender = {
				add_unpressed_claim = scope:recipient.primary_title
			}
		}
		scope:recipient = { add_prestige = 75 }
	}

	option = { # How dare they!
		name = rohan.0103.a
	}
}

rohan.1200 = { # Orcs spotted in the Emyn Muil. 
	content_source = realms_dlc
	type = character_event
	title = rohan.1200.t
	desc = rohan.1200.desc
	theme = martial
	left_portrait = {
		character = root
		animation = anger
	}

	option = {
		name = rohan.1200.a # Rally the men! We ride at dawn!
		trigger_event = {
			id = rohan.1201
			days = { 10 20 }
		}
	}
}

rohan.1201 = { # Journey and eventual ambush by orcs.
	content_source = realms_dlc
	type = character_event
	title = rohan.1201.t
	desc = rohan.1201.desc
	theme = martial
	override_background = {
		reference = plains
	}

	left_portrait = {
		character = root
		animation = shock
	}

	option = {
		name = rohan.1201.a # We are ambushed!
		trigger_event = {
			id = rohan.1202
		}
	}
}

rohan.1202 = { # The death of Éomund
	content_source = realms_dlc
	type = character_event
	title = rohan.1202.t
	desc = rohan.1202.desc
	theme = martial
	override_background = {
		reference = battlefield
	}

	left_portrait = {
		character = root
		animation = pain
	}

	option = {
		name = rohan.1202.a # Argh! I am slain!
		death = {
			death_reason = death_battle 
		}
		character:6000032 = { 
			trigger_event = {
				id = rohan.1203
				days = 60
			}
		}
	}
}

rohan.1203 = { # Théodwyn becomes ill and dies.
	content_source = realms_dlc
	type = character_event
	title = rohan.1203.t
	desc = rohan.1203.desc
	theme = family
	override_background = {
		reference = edoras
	}
	left_portrait = {
		character = root
		animation = sick
	}

	option = {
		name = rohan.1203.a # My children...
		add_trait = pneumonic
		death = {
			death_reason = death_pneumonic 
		}
		character:6000018 = {
			trigger_event = {
				id = rohan.1204
				days = 5
			}
		}
		character:6000035 = {
			trigger_event = {
				id = rohan.1210
				days = 5
			}
		}
	}
}

rohan.1204 = { # Éomer reacts, moving to Edoras.
	content_source = realms_dlc
	type = character_event
	title = rohan.1204.t
	desc = rohan.1204.desc
	theme = family
	override_background = {
		reference = edoras
	}
	override_background = {
		reference = edoras
	}
	right_portrait = {
		character = root
		animation = grief
	}

	option = {
		name = rohan.1204.a # Uncle Théoden will take care of us.
		set_relation_guardian = character:6000017
		trigger_event = {
				id = rohan.1205
				days = 1825
			}
	}
}

rohan.1210 = { #Éowyn reacts, moving to Edoras.
	content_source = realms_dlc
	type = character_event
	title = rohan.1204.t
	desc = rohan.1204.desc
	theme = family
	override_background = {
		reference = edoras
	}

	right_portrait = {
		character = root
		animation = grief
	}

	option = {
		name = rohan.1204.a # Uncle Théoden will take care of us.
		set_relation_guardian = character:6000017
		trigger_event = { id = rohan.1206 days = 3285 }
	}
}

rohan.1205 = { # Éomer's trait assignment
	content_source = realms_dlc
	type = character_event
	title = rohan.1205.t
	desc = rohan.1205.desc
	theme = martial
	override_background = {
		reference = edoras
	}

	right_portrait = {
		character = root
		animation = personality_bold
	}
	
	immediate = { play_music_cue = lotr_cue_rohan }

	option = {
		name = rohan.1205.a # I will make my father proud.
		trigger_event = {
			id = rohan.1207
			days = 5
		}
		remove_trait = education_diplomacy_1
		remove_trait = education_diplomacy_2
		remove_trait = education_diplomacy_3
		remove_trait = education_diplomacy_4
		remove_trait = education_stewardship_1
		remove_trait = education_stewardship_2
		remove_trait = education_stewardship_3
		remove_trait = education_stewardship_4
		remove_trait = education_intrigue_1
		remove_trait = education_intrigue_2
		remove_trait = education_intrigue_3
		remove_trait = education_intrigue_4
		remove_trait = education_learning_1
		remove_trait = education_learning_2
		remove_trait = education_learning_3
		remove_trait = education_learning_4
		remove_trait = education_martial_1
		remove_trait = education_martial_2
		remove_trait = education_martial_3
		#remove_trait = craven
		#remove_trait = wrathful
		#remove_trait = lustful
		#remove_trait = ambitious
		#remove_trait = lazy
		#remove_trait = diligent
		#remove_trait = greedy
		#remove_trait = shy
		#remove_trait = deceitful
		#remove_trait = arrogant
		#remove_trait = arbitrary
		#remove_trait = impatient
		#remove_trait = gluttonous
		#remove_trait = paranoid
		#remove_trait = cynical
		#remove_trait = callous
		#remove_trait = sadistic
		#remove_trait = calm
		#remove_trait = chaste
		#remove_trait = content
		#remove_trait = fickle
		#remove_trait = generous
		#remove_trait = honest
		#remove_trait = humble
		#remove_trait = patient
		#remove_trait = trusting
		#remove_trait = zealous 
		#remove_trait = temperate
		#remove_trait = compassionate
		lotr_remove_personality_effect = yes # reuse this effect
	
		add_martial_skill = 4
		add_prowess_skill = 4
		add_trait = education_martial_4
		add_trait = lifestyle_blademaster
		add_trait = brave
		add_trait = stubborn
		add_trait = just
	}
}

rohan.1206 = { # Éowyn's trait assignment
	content_source = realms_dlc
	type = character_event
	title = rohan.1206.t
	desc = rohan.1206.desc
	theme = martial
	override_background = {
		reference = edoras
	}

	right_portrait = {
		character = root
		animation = personality_bold
	}
	
	immediate = { play_music_cue = lotr_cue_rohan }

	option = {
		name = rohan.1206.a # I will be a shieldmaiden of Rohan.
		remove_trait = education_diplomacy_1
		remove_trait = education_diplomacy_2
		remove_trait = education_diplomacy_3
		remove_trait = education_diplomacy_4
		remove_trait = education_stewardship_1
		remove_trait = education_stewardship_2
		remove_trait = education_stewardship_3
		remove_trait = education_stewardship_4
		remove_trait = education_intrigue_1
		remove_trait = education_intrigue_2
		remove_trait = education_intrigue_3
		remove_trait = education_intrigue_4
		remove_trait = education_learning_1
		remove_trait = education_learning_2
		remove_trait = education_learning_3
		remove_trait = education_learning_4
		remove_trait = education_martial_1
		#remove_trait = craven
		#remove_trait = wrathful
		#remove_trait = lustful
		#remove_trait = ambitious
		#remove_trait = lazy
		#remove_trait = stubborn
		#remove_trait = greedy
		#remove_trait = shy
		#remove_trait = deceitful
		#remove_trait = arrogant
		#remove_trait = arbitrary
		#remove_trait = impatient
		#remove_trait = gluttonous
		#remove_trait = paranoid
		#remove_trait = cynical
		#remove_trait = callous
		#remove_trait = sadistic
		#remove_trait = calm
		#remove_trait = chaste
		#remove_trait = content
		#remove_trait = fickle
		#remove_trait = generous
		#remove_trait = honest
		#remove_trait = humble
		#remove_trait = patient
		#remove_trait = trusting
		#remove_trait = zealous 
		#remove_trait = temperate
		lotr_remove_personality_effect = yes # reuse this effect
		
		add_martial_skill = 4
		add_prowess_skill = 4
		add_trait = education_martial_3
		add_trait = lifestyle_blademaster
		add_trait = shieldmaiden
		add_trait = brave
		add_trait = compassionate
		add_trait = diligent
		
		give_nickname = nick_the_fair
		add_character_flag = {
               flag = had_nickname_event
        }
	}
}

rohan.1207 = { # Éomer's marriage decision.
	content_source = realms_dlc
	type = character_event
	title = rohan.1207.t
	desc = rohan.1207.desc
	theme = family
	
	override_background = {
		reference = edoras
	}
	left_portrait = {
		character = root
		animation = personality_bold
	}

	option = {
		name = rohan.1207.a # Rohan requires my efforts. I shall wait for my time.
		ai_chance = {
			base = 0 # LotR: This should be tied to WotR mode.
			modifier = { # Game Rule
				has_game_rule = default_ai_behavior
				add = 100
			}
			modifier = { # Game Rule
				has_game_rule = weighted_ai_behavior
				add = 75
			}
			modifier = { # Game Rule
				has_game_rule = random_ai_behavior
				add = 50
			}
		}
	}
	option = {
		name = rohan.1207.b # I cannot wait! My father's line must endure!
		remove_trait = cannot_marry
		ai_chance = {
			base = 0 # LotR: This should be tied to WotR mode.
			modifier = { # Game Rule
				has_game_rule = default_ai_behavior
				add = 0
			}
			modifier = { # Game Rule
				has_game_rule = weighted_ai_behavior
				add = 25
			}
			modifier = { # Game Rule
				has_game_rule = random_ai_behavior
				add = 50
			}
		}
	}
}

rohan.1208 = { # Éomer's marriage decision part 2
	content_source = realms_dlc
	type = character_event
	title = rohan.1208.t
	desc = rohan.1208.desc
	theme = family

	left_portrait = {
		character = root
		animation = love
	}
	right_portrait = {
		character = character:dolamroth31
		animation = admiration
	}

	option = {
		name = rohan.1208.a # Marries Lothiriel.
		remove_trait = cannot_marry
		marry = character:dolamroth31
		set_relation_friend = character:dolamroth27
		ai_chance = {
			base = 0 # LotR: This should be tied to WotR mode.
			modifier = { # Game Rule
				has_game_rule = default_ai_behavior
				add = 100
			}
			modifier = { # Game Rule
				has_game_rule = weighted_ai_behavior
				add = 75
			}
			modifier = { # Game Rule
				has_game_rule = random_ai_behavior
				add = 50
			}
		}
	}
	option = {
		name = rohan.1208.b # Does not marry Lothiriel.
		remove_trait = cannot_marry
		set_relation_friend = character:dolamroth27
		add_trait = humble
		ai_chance = {
			base = 0 # LotR: This should be tied to WotR mode.
			modifier = { # Game Rule
				has_game_rule = default_ai_behavior
				add = 0
			}
			modifier = { # Game Rule
				has_game_rule = weighted_ai_behavior
				add = 25
			}
			modifier = { # Game Rule
				has_game_rule = random_ai_behavior
				add = 50
			}
		}
	}
}

rohan.1209 = { # Aragorn marries Lothiriel.
	content_source = realms_dlc
	type = character_event
	title = rohan.1209.t
	desc = rohan.1209.desc
	theme = family

	left_portrait = {
		character = root
		animation = sadness
	}

	option = {
		name = rohan.1209.a # It was foolish of me to wait...
		remove_trait = cannot_marry
	}
}

rohan.2000 = { # The Oath of Eorl - Gondor calls for aid!
	content_source = realms_dlc
	type = character_event
	title = rohan.2000.t
	desc = rohan.2000.desc
	theme = diplomacy_majesty_focus
	override_background = {
		reference = edoras
	}
	right_portrait = {
		character = root
		animation = personality_rational
	}
	
	immediate = { play_music_cue = lotr_cue_beacons }
	
	option = { # We shall join you in the field
		name = rohan.2000.a 
		scope:gondor = {
			every_character_war = {
				limit = {
					is_attacker = scope:gondor
					any_war_defender = { 
						highest_held_title_tier >= tier_kingdom
						NOT = { is_vassal_of = scope:gondor }
					}
				}
				add_attacker = root
			}
			every_character_war = {
				limit = {
					is_defender = scope:gondor
					any_war_attacker = { 
						highest_held_title_tier >= tier_kingdom 
						NOT = { is_vassal_of = scope:gondor }
					}
				}
				add_defender = root
			}
			trigger_event = {
				id = gondor.2001
				days = 1
			}
		}
		add_prestige = 250
		add_piety = 100
		ai_chance = {
			base = 50

			modifier = { # Double likelihood if not outnumbered
				lotr_armies_are_outnumbered = no
				factor = 2
			}

			ai_value_modifier = { # Honour can swing up to +/- 50, compassion and boldness up to +/- 25
				ai_honor = 0.5
				ai_compassion = 0.25
				ai_boldness = 0.25
			}	

			modifier = { # Zero likelihood if outnumbered
				lotr_armies_are_outnumbered = yes
				factor = 0
			}
		}
	}
	option = { # We shall send a large host
		name = rohan.2000.b
		add_character_modifier = {
			modifier = raised_large_oath_host_modifier
			years = 5
		}
		add_prestige = 200
		add_piety = 50
		remove_short_term_gold = 200
		scope:gondor = {
			trigger_event = {
				id = gondor.2002
				days = 1
			}
		}
		ai_chance = {
			base = 50

			modifier = { # Zero likelihood if outnumbered and in debt
				lotr_armies_are_outnumbered = yes
				gold < 0
				factor = 0
			}

			modifier = { # Double likelihood if outnumbered and not in debt
				lotr_armies_are_outnumbered = yes
				gold > 0
				factor = 2
			}

			modifier = { # Zero likelihood if not outnumbered
				lotr_armies_are_outnumbered = no
				factor = 0
			}

			ai_value_modifier = { # Greedy can swing up to +/- 50, honour up to +/- 25
				ai_greed = 0.5
				ai_honor = -0.25
			}		
		}
	}
	option = { # We shall send a meager host
		name = rohan.2000.c 
		add_character_modifier = {
			modifier = raised_small_oath_host_modifier
			years = 5
		}
		add_prestige = 100
		add_piety = 25
		remove_short_term_gold = 100
		scope:gondor = {
			trigger_event = {
				id = gondor.2003
				days = 1
			}
		}
		ai_chance = {
			base = 50

			modifier = { # Half likelihood if outnumbered and in debt
				lotr_armies_are_outnumbered = yes
				gold < 0
				factor = 0.5
			}

			modifier = { # Normal likelihood if outnumbered and not in debt
				lotr_armies_are_outnumbered = yes
				gold > 0
				factor = 1
			}

			modifier = { # Zero likelihood if not outnumbered
				lotr_armies_are_outnumbered = no
				factor = 0
			}

			ai_value_modifier = { # Greedy and honour can swing up to +/- 25
				ai_greed = 0.25
				ai_honor = -0.25
			}
		}
	}
	option = { # We have our own problems to deal with
		name = rohan.2000.d 
		scope:gondor = {
			add_opinion = {
				modifier = dishonoured_oath_of_eorl_opinion
				target = root
			}
			trigger_event = {
				id = gondor.2004
				days = 1
			}
		}
		ai_chance = {
			base = 50

			modifier = { # Double likelihood if outnumbered and in debt
				lotr_armies_are_outnumbered = yes
				gold < 0
				factor = 2
			}

			modifier = { # Zero likelihood if outnumbered and not in debt
				lotr_armies_are_outnumbered = yes
				gold > 0
				factor = 0
			}

			modifier = { # Zero likelihood if not outnumbered
				lotr_armies_are_outnumbered = no
				factor = 0
			}

			ai_value_modifier = { # Honour can swing up to +/- 50, boldness up to +/- 25
				ai_honor = -0.5
				ai_boldness = -0.25
			}
		}
	}
}

rohan.2001 = { # Gondor joins as an ally in our wars
	content_source = realms_dlc
	type = character_event
	title = rohan.2001.t
	desc = rohan.2001.desc
	theme = diplomacy_majesty_focus
	override_background = {
		reference = edoras
	}
	right_portrait = {
		character = root
		animation = happiness
	}
	
	immediate = { play_music_cue = lotr_cue_gondor }
	
	option = {
		name = rohan.2001.a
		custom_tooltip = "gondor_will_join_your_wars"
	}
}

rohan.2002 = { # Gondor sends a large host
	content_source = realms_dlc
	type = character_event
	title = rohan.2002.t
	desc = rohan.2002.desc
	theme = diplomacy_majesty_focus
	override_background = {
		reference = edoras
	}
	right_portrait = {
		character = root
		animation = personality_bold
	}
	
	immediate = { play_music_cue = lotr_cue_gondor }
	
	option = {
		name = rohan.2002.a 
		spawn_army = {
			levies = 1000
			men_at_arms = {
				type = gondorian_footmen
				stacks = 10
			}
			men_at_arms = {
				type = gondorian_bowmen
				stacks = 8
			}	
			men_at_arms = {
				type = armored_horsemen
				stacks = 2
			}
			location = capital_province
	#			war = war # optional. If set, the stack will disband after the war ends
			inheritable = yes
			uses_supply = yes
			name = oath_of_eorl_host_gondor_large	
		}
	}
}

rohan.2003 = { # Gondor sends a small host
	content_source = realms_dlc
	type = character_event
	title = rohan.2003.t
	desc = rohan.2003.desc
	theme = diplomacy_majesty_focus
	override_background = {
		reference = edoras
	}
	right_portrait = {
		character = root
		animation = disapproval
	}
	option = {
		name = rohan.2003.a 
		spawn_army = {
			levies = 1000
			men_at_arms = {
				type = gondorian_footmen
				stacks = 6
			}
			men_at_arms = {
				type = gondorian_bowmen
				stacks = 4
			}	
			location = capital_province
	#			war = war # optional. If set, the stack will disband after the war ends
			inheritable = yes
			uses_supply = yes
			name = oath_of_eorl_host_gondor_small	
		}
	}
}

rohan.2004 = { # Gondor did not answer the call
	content_source = realms_dlc
	type = character_event
	title = rohan.2004.t
	desc = rohan.2004.desc
	theme = diplomacy_majesty_focus
	override_background = {
		reference = edoras
	}
	right_portrait = {
		character = root
		animation = anger
	}
	option = {
		name = rohan.2004.a 
	}
}

rohan.2100 = { #King in the Golden Hall event chain
	content_source = realms_dlc
	type = character_event
	title = rohan.2100.t
	desc = rohan.2100.desc
	theme = diplomacy_majesty_focus

	override_background = {
		reference = edoras
	}

	right_portrait = {
		character = root
		animation = personality_honorable
	}

	trigger = {
		NOT = { has_character_flag = king_in_golden_hall_event }
		AND = {
			has_title = title:c_kingstead  # add a check here for whether root has held edoras for 10 years
			title:c_kingstead = { title_held_years >= 10 }
			culture = { any_parent_culture_or_above = { this = culture:eotheod } }
		}
	}
	
	immediate = { play_music_cue = lotr_cue_rohan }

	option = {
		name = rohan.2100.a 
		trigger_event = {
			id = rohan.2101
			days = 5 
		}
	}
	option = {
		name = rohan.2100.b 
		trigger_event = {
			id = rohan.2104
			days = 5 
		}
	}
	option = {
		name = rohan.2100.c 
		trigger_event = {
			id = rohan.2109
			days = 5 
		}
	}
	option = { # Ends event chain
		name = rohan.2100.d
	}

	after = {
		add_character_flag = {
			flag = king_in_golden_hall_event	
			years = 10
		}
	}
}

rohan.2101 = { # Ride out to plains
	content_source = realms_dlc
	type = character_event
	title = rohan.2101.t
	desc = rohan.2101.desc
	theme = diplomacy_majesty_focus
	override_background = {
		reference = edoras
	}
	right_portrait = {
		character = root
		animation = shock
	}

	option = { # Attempt to leap from the falling horse - prowess challenge
		name = rohan.2101.a 

		hidden_effect = {
			duel = { 
				skill = prowess
				value = medium_skill_rating
				60 = { # success
					compare_modifier = {
						value = scope:duel_value
					}
					trigger_event = {
						id = rohan.2112
						days = 3
					}
				}
				50 = { # failure
					trigger_event = {
						id = rohan.2113
						days = 3
					}
				}
			}
		}
	}

	option = { # Attempt to steady horse - martial challenge
		name = rohan.2101.b 

		hidden_effect = {
			duel = { 
				skill = martial
				value = medium_skill_rating
				60 = { # success
					compare_modifier = {
						value = scope:duel_value
					}
	
					trigger_event = {
						id = rohan.2114
						days = 3
					}
				}
				40 = { # failure
					trigger_event = {
						id = rohan.2115
						days = 3
					}
				}
			}
		}
	}

	option = { # accept fate
		name = rohan.2101.c 

		hidden_effect = {
			random_list = {
				30 = { # success
					trigger_event = {
						id = rohan.2116
						days = 3
					}
				}
				70 = { # failure
					trigger_event = {
						id = rohan.2117
						days = 3
					}
				}
			}
		}
	}
}

rohan.2104 = { # Headed to stables
	content_source = realms_dlc
	type = character_event
	title = rohan.2104.t
	desc = rohan.2104.desc
	theme = diplomacy_majesty_focus
	override_background = {
		reference = edoras
	}
	right_portrait = {
		character = root
		animation =  personality_forgiving
	}

	option = {
		name = rohan.2104.a
		trigger_event = {
			id = rohan.2105
			days = 3
		}
	}
	option = {
		name = rohan.2104.b
		trigger_event = {
			id = rohan.2106
			days = 3
		}
	}
	option = {
		name = rohan.2104.c
		trigger_event = {
			id = rohan.2107
			days = 3
		}
	}

}

rohan.2105 = {
	content_source = realms_dlc
	type = character_event
	title = rohan.2105.t
	desc = rohan.2105.desc
	theme = diplomacy_majesty_focus

	override_background = {
		reference = edoras
	}

	right_portrait = {
		character = root
		animation = personality_content
	}

	option = {
		name = rohan.2105.a
		trigger_event = {
			id = rohan.2108
			days = 3
		}
	}

}

rohan.2106 = {
	content_source = realms_dlc
	type = character_event
	title = rohan.2106.t
	desc = rohan.2106.desc
	theme = diplomacy_majesty_focus

	override_background = {
		reference = edoras
	}

	right_portrait = {
		character = root
		animation = admiration
	}
	
	option = {
		name = rohan.2106.a
		trigger_event = {
			id = rohan.2108
			days = 3
		}
	}
}

rohan.2107 = {
	content_source = realms_dlc
	type = character_event
	title = rohan.2107.t
	desc = rohan.2107.desc
	theme = diplomacy_majesty_focus

	override_background = {
		reference = edoras
	}

	right_portrait = {
		character = root
		animation = personality_content
	}

	option = {
		name = rohan.2107.a
		trigger_event = {
			id = rohan.2108
			days = 3
		}
	}
}

rohan.2108 = {
	content_source = realms_dlc
	type = character_event
	title = rohan.2108.t
	desc = rohan.2108.desc
	theme = diplomacy_majesty_focus

	override_background = {
		reference = edoras
	}

	right_portrait = {
		character = root
		animation = personality_bold
	}
	
	option = {
		name = rohan.2108.a
		add_character_modifier = {
			modifier = wisdom_of_brego
			years = 20
		}
	}
}

rohan.2109 = { # train with recruits
	content_source = realms_dlc
	type = character_event
	title = rohan.2109.t
	desc = rohan.2109.desc
	theme = diplomacy_family_focus

	override_background = {
		reference = edoras
	}

	right_portrait = {
		character = root
		animation = thinking
	}

	option = {
		name = rohan.2109.a
		hidden_effect = {
			duel = { 
				skill = martial
				value = medium_skill_rating
				65 = { # success
					compare_modifier = {
						value = scope:duel_value
					}
	
					trigger_event = {
						id = rohan.2118
						days = 3
					}
				}
				40 = { # failure
					trigger_event = {
						id = rohan.2119
						days = 3
					}
				}
			}
		}
	}

	option = {
		name = rohan.2109.b
		duel = { 
			skill = prowess
			value = medium_skill_rating
			30 = { # success
				compare_modifier = {
					value = scope:duel_value
				}

				trigger_event = {
					id = rohan.2120
					days = 3
				}
			}
			20 = { # failure

				trigger_event = {
					id = rohan.2121
					days = 3
				}
			}
		}
		
	}

	option = {
		name = rohan.2109.c
		hidden_effect = {
			duel = { 
				skill = martial
				value = medium_skill_rating
				60 = { # success
					compare_modifier = {
						value = scope:duel_value
					}
	
					trigger_event = {
						id = rohan.2122
						days = 3
					}
				}
				40 = { # failure
					trigger_event = {
						id = rohan.2123
						days = 3
					}
				}
			}
		}
	}
}

rohan.2112 = { # Success A rohan.2101
	content_source = realms_dlc
	type = character_event
	title = rohan.2112.t
	desc = rohan.2112.desc
	theme = diplomacy_family_focus

	right_portrait = {
		character = root
		animation = shock
	}

	override_background = {
		reference = edoras
	}

	option = {
		name = rohan.2112.a
		add_character_modifier = {
			modifier = rider_of_the_mark
			years = 5
		}
		random = {
			chance = 20
			add_trait = reckless
		}
		random = {
			chance = 20
			add_trait = open_terrain_expert 
		}
	}
}

rohan.2113 = { # Failure A rohan.2101
	content_source = realms_dlc
	type = character_event
	title = rohan.2113.t
	desc = rohan.2113.desc
	theme = diplomacy_family_focus

	override_background = {
		reference = edoras
	}
	
	right_portrait = {
		character = root
		animation = pain
	}

	option = {
		increase_wounds_effect = { REASON = fight }
		name = rohan.2113.a
	}
}

rohan.2114 = { # Success B rohan.2101
	content_source = realms_dlc
	type = character_event
	title = rohan.2114.t
	desc = rohan.2114.desc
	theme = diplomacy_family_focus

	override_background = {
		reference = edoras
	}

	right_portrait = {
		character = root
		animation = personality_bold
	}

	option = {
		name = rohan.2114.a
		add_character_modifier = {
			modifier = rider_of_the_mark
			years = 5
		}
		random = {
			chance = 20
			add_trait = cautious_leader 
		}
		random = {
			chance = 20
			add_trait = open_terrain_expert 
		}
	}
}

rohan.2115 = { # Failure B rohan.2101
	content_source = realms_dlc
	type = character_event
	title = rohan.2115.t
	desc = rohan.2115.desc
	theme = diplomacy_family_focus

	override_background = {
		reference = edoras
	}

	right_portrait = {
		character = root
		animation = shock
	}

	option = {
		name = rohan.2115.a
		increase_wounds_effect = { REASON = fight }
	}
}

rohan.2116 = { # Success C rohan.2101
	content_source = realms_dlc
	type = character_event
	title = rohan.2116.t
	desc = rohan.2116.desc
	theme = diplomacy_family_focus

	override_background = {
		reference = edoras
	}

	right_portrait = {
		character = root
		animation = personality_bold
	}

	option = {
		name = rohan.2116.a
		add_character_modifier = {
			modifier = rider_of_the_mark
			years = 5
		}
		random = {
			chance = 25
			add_trait = open_terrain_expert 
		}
	}
}

rohan.2117 = { # Failure C rohan.2101
	content_source = realms_dlc
	type = character_event
	title = rohan.2117.t
	desc = rohan.2117.desc
	theme = diplomacy_family_focus

	override_background = {
		reference = edoras
	}

	right_portrait = {
		character = root
		animation = pain
	}

	option = {
		name = rohan.2117.a
		increase_wounds_effect = { REASON = fight }
	}
}

rohan.2118 = {  # rohan.2109.a.success
	content_source = realms_dlc
	type = character_event
	title = rohan.2118.t
	desc = rohan.2118.desc
	theme = diplomacy_family_focus

	override_background = {
		reference = edoras
	}

	right_portrait = {
		character = root
		animation = aggressive_sword
	}

	option = {
		name = rohan.2118.a
		add_character_modifier = {
			modifier = blood_eorl_the_young
			years = 5
		}
		random = {
			chance = 25
			add_trait = aggressive_attacker 
		}
	}
}

rohan.2119 = { # rohan.2109.a.failure
	content_source = realms_dlc
	type = character_event
	title = rohan.2119.t
	desc = rohan.2119.desc
	theme = diplomacy_family_focus

	override_background = {
		reference = edoras
	}

	right_portrait = {
		character = root
		animation = disapproval
	}
	
	option = {
		name = rohan.2119.a
		add_stress = 50
	}
}

rohan.2120 = { # rohan.2109.b.success
	content_source = realms_dlc
	type = character_event
	title = rohan.2120.t
	desc = rohan.2120.desc
	theme = diplomacy_family_focus

	override_background = {
		reference = edoras
	}

	right_portrait = {
		character = root
		animation = personality_forgiving
	}

	option = {
		name = rohan.2120.a
		add_character_modifier = {
			modifier = blood_eorl_the_young
			years = 5
		}
		random = {
			chance = 25
			add_trait = cautious_leader
		}

	}
}

rohan.2121 = { # rohan.2109.b.failure
	content_source = realms_dlc
	type = character_event
	title = rohan.2121.t
	desc = rohan.2121.desc
	theme = diplomacy_family_focus

	override_background = {
		reference = edoras
	}

	right_portrait = {
		character = root
		animation = sadness
	}

	option = {
		name = rohan.2121.a

		add_stress = 50
	}
}

rohan.2122 = { # rohan.2109.c.success
	content_source = realms_dlc
	type = character_event
	title = rohan.2122.t
	desc = rohan.2122.desc
	theme = diplomacy_family_focus

	override_background = {
		reference = edoras
	}

	right_portrait = {
		character = root
		animation = personality_forgiving
	}

	option = {
		name = rohan.2122.a
		add_character_modifier = {
			modifier = blood_eorl_the_young
			years = 5
		}
		random = {
			chance = 40 
			add_trait = flexible_leader
		}
	}
}

rohan.2123 = { # rohan.2109.c.failure
	content_source = realms_dlc
	type = character_event
	title = rohan.2123.t
	desc = rohan.2123.desc
	theme = diplomacy_family_focus

	override_background = {
		reference = edoras
	}

	right_portrait = {
		character = root
		animation = shock
	}

	option = {
		name = rohan.2123.a

		add_stress = 50
	}
}

# Orcs in the Westfold
rohan.2200 = {
	content_source = realms_dlc
	type = character_event
	title = rohan.2200.t
	desc = rohan.2200.desc
	theme = martial
	orphan = yes
	left_portrait = {
		character = root
		animation = anger
	}
	
	option = { # Ride out to meet them.
		name = rohan.2200.a
		custom_tooltip = rohan.2200.a.tt
		trigger_event = {
			id = rohan.2201
			days = 10
		}
		ai_chance = {
			base = 0 # LotR: This should be tied to WotR mode.
			modifier = { # Game Rule
				has_game_rule = default_ai_behavior
				add = 100
			}
			modifier = { # Game Rule
				has_game_rule = weighted_ai_behavior
				add = 75
			}
			modifier = { # Game Rule
				has_game_rule = random_ai_behavior
				add = 50
			}
		}
	}
	option = { # I must speak with my father. Ride to Edoras.
		name = rohan.2200.b
		trigger = { # Edoras needs to actually be Rohirric
			title:k_rohan.holder ?= {
				dynasty = ROOT.dynasty
				is_independent_ruler = yes
			}
		}
		custom_tooltip = rohan.2200.b.tt
		trigger_event = {
			id = rohan.2215
			days = 10
		}
		ai_chance = {
			base = 0 # LotR: This should be tied to WotR mode.
			modifier = { # Game Rule
				has_game_rule = default_ai_behavior
				add = 0
			}
			modifier = { # Game Rule
				has_game_rule = weighted_ai_behavior
				add = 25
			}
			modifier = { # Game Rule
				has_game_rule = random_ai_behavior
				add = 50
			}
		}
	}
	
	option = { # fallback if edoras isnt ruled by rohirrim
		trigger = { always = no }
		fallback = yes
		name = rohan.2201.c
	}
}

# Burning Villages
rohan.2201 = {
	content_source = realms_dlc
	type = character_event
	title = rohan.2201.t
	desc = rohan.2201.desc
	theme = martial

	left_portrait = {
		character = root
		animation = paranoia
	}

	option = { # Investigate further. Ford the Isen.
		name = rohan.2201.a
		trigger_event = {
			id = rohan.2202
			days = 2
		}
		ai_chance = {
			base = 0 # LotR: This should be tied to WotR mode.
			modifier = { # Game Rule
				has_game_rule = default_ai_behavior
				add = 100
			}
			modifier = { # Game Rule
				has_game_rule = weighted_ai_behavior
				add = 75
			}
			modifier = { # Game Rule
				has_game_rule = random_ai_behavior
				add = 50
			}
		}
	}
	option = { # Heed the advice of your captains. Ride to Edoras.
		name = rohan.2201.b
		trigger = { # Edoras needs to actually be Rohirric
			title:k_rohan.holder ?= {
				dynasty = ROOT.dynasty
				is_independent_ruler = yes
			}
		}
		trigger_event = {
			id = rohan.2215
			days = 7
		}
		ai_chance = {
			base = 0 # LotR: This should be tied to WotR mode.
			modifier = { # Game Rule
				has_game_rule = default_ai_behavior
				add = 0
			}
			modifier = { # Game Rule
				has_game_rule = weighted_ai_behavior
				add = 25
			}
			modifier = { # Game Rule
				has_game_rule = random_ai_behavior
				add = 50
			}
		}
	}
	
	option = { # fallback if edoras isnt ruled by rohirrim
		trigger = { always = no }
		fallback = yes
		name = rohan.2201.c
	}
}

# Ambush at the Isen
rohan.2202 = {
	content_source = realms_dlc
	type = character_event
	title = rohan.2202.t
	desc = rohan.2202.desc
	theme = battle

	left_portrait = {
		character = root
		animation = disbelief
	}

	option = { # It's a trap!
		name = rohan.2202.a
		trigger_event = {
			id = rohan.2203
			days = 2
		}
	}
}

# Aftermath of the Ambush at the Isen / Eomer takes Theodred back to Edoras.
rohan.2203 = {
	content_source = realms_dlc
	type = character_event
	title = rohan.2203.t
	desc = rohan.2203.desc
	theme = battle

	left_portrait = {
		character = root
		animation = severelyinjured
	}

	option = { # Theodred may not survive the ensuing nights. 
		name = rohan.2203.a
		trigger_event = {
			id = rohan.2204
			days = 12
		}
		increase_wounds_effect = { REASON = fight }
		increase_wounds_effect = { REASON = fight }
		increase_wounds_effect = { REASON = fight }
	}
}

# Le Morte de Theodred
rohan.2204 = {
	content_source = realms_dlc
	type = character_event
	title = rohan.2204.t
	desc = rohan.2204.desc
	theme = death

	left_portrait = {
		character = root
		animation = sick
	}

	option = { # Theodred dies in his sleep.
		name = rohan.2204.a
		death = {
			death_reason = death_wounded_2
		}
		character:6000017 = { # Theoden is informed.
			trigger_event = {
				id = rohan.2205
			}
		}
	}
}

# Burying a Child
rohan.2205 = {
	content_source = realms_dlc
	type = character_event
	title = rohan.2205.t
	desc = rohan.2205.desc
	theme = crown

	left_portrait = {
		character = root
		animation = sadness
	}
	
	right_portrait = {
		character = character:lineofsaruman
		animation = idle
	}

	option = { # No father should ever have to bury their child.
		name = rohan.2205.a
		if = {
			limit = {
				has_title = title:k_rohan
			}
			trigger_event = {
				id = rohan.2206
			}
		}
		add_stress = 30
	}
}

# Muster the Rohirrim!
rohan.2206 = {
	content_source = realms_dlc
	type = character_event
	title = rohan.2206.t
	desc = rohan.2206.desc
	theme = martial

	trigger = { # To make sure it really is the eorlings and not sauron or someone else
		has_title = title:k_rohan
		is_independent_ruler = yes
		dynasty = dynasty:dynasty_eorl
		culture = { has_cultural_tradition = tradition_riders_of_the_mark }
		NOT = {
			is_ai = yes
		}
	}

	left_portrait = {
		character = root
		animation = personality_bold
	}

	option = { # Send out the riders!
		name = rohan.2206.a
		custom_tooltip = rohan.2206.a.tt
		title:c_grimslade.holder = { 
			trigger_event = {
				id = rohan.2207
				days = 2
			}
		}
		title:c_upfolde.holder = { 
			trigger_event = {
				id = rohan.2208
				days = 2
			}
		}
		title:c_aldburg.holder = { 
			trigger_event = {
				id = rohan.2209
				days = 2
			}
		}
		title:c_eormengrund.holder = { 
			trigger_event = {
				id = rohan.2210
				days = 2
			}
		}
	}
}

# Muster the Rohirrim - Grimsglade
rohan.2207 = {
	content_source = realms_dlc
	type = character_event
	title = rohan.2207.t
	desc = rohan.2207.desc
	theme = martial

	right_portrait = {
		character = character:6000017
		animation = personality_bold
	}
	
	left_portrait = {
		character = root
		animation = admiration
	}

	option = { # Send reinforcments to Edoras!
		name = rohan.2207.a
		title:k_rohan.holder = { 
			trigger_event = {
				id = rohan.2211
				days = 2
			}
		}
		ai_chance = {
			base = 0 # LotR: This should be tied to WotR mode.
			modifier = { # Game Rule
				has_game_rule = default_ai_behavior
				add = 100
			}
			modifier = { # Game Rule
				has_game_rule = weighted_ai_behavior
				add = 75
			}
			modifier = { # Game Rule
				has_game_rule = random_ai_behavior
				add = 50
			}
		}
	}
	option = { # Do not reinforcments to Edoras.
		name = rohan.2207.b
		ai_chance = {
			base = 0 # LotR: This should be tied to WotR mode.
			modifier = { # Game Rule
				has_game_rule = default_ai_behavior
				add = 0
			}
			modifier = { # Game Rule
				has_game_rule = weighted_ai_behavior
				add = 25
			}
			modifier = { # Game Rule
				has_game_rule = random_ai_behavior
				add = 50
			}
		}
	}
}

# Muster the Rohirrim - Harrowdale
rohan.2208 = {
	content_source = realms_dlc
	type = character_event
	title = rohan.2208.t
	desc = rohan.2208.desc
	theme = martial

	right_portrait = {
		character = character:6000017
		animation = personality_bold
	}
	
	left_portrait = {
		character = root
		animation = admiration
	}

	option = { # Send reinforcments to Edoras!
		name = rohan.2208.a
		title:k_rohan.holder = { 
			trigger_event = {
				id = rohan.2212
				days = 4
			}
		}
		ai_chance = {
			base = 0 # LotR: This should be tied to WotR mode.
			modifier = { # Game Rule
				has_game_rule = default_ai_behavior
				add = 100
			}
			modifier = { # Game Rule
				has_game_rule = weighted_ai_behavior
				add = 75
			}
			modifier = { # Game Rule
				has_game_rule = random_ai_behavior
				add = 50
			}
		}
	}
	option = { # Do not reinforcments to Edoras.
		name = rohan.2208.b
		ai_chance = {
			base = 0 # LotR: This should be tied to WotR mode.
			modifier = { # Game Rule
				has_game_rule = default_ai_behavior
				add = 0
			}
			modifier = { # Game Rule
				has_game_rule = weighted_ai_behavior
				add = 25
			}
			modifier = { # Game Rule
				has_game_rule = random_ai_behavior
				add = 50
			}
		}
	}
}

# Muster the Rohirrim - Eastfold
rohan.2209 = {
	content_source = realms_dlc
	type = character_event
	title = rohan.2209.t
	desc = rohan.2209.desc
	theme = martial

	right_portrait = {
		character = character:6000017
		animation = personality_bold
	}
	
	left_portrait = {
		character = root
		animation = admiration
	}

	option = { # Send reinforcments to Edoras!
		name = rohan.2209.a
		title:k_rohan.holder = { 
			trigger_event = {
				id = rohan.2213
				days = 6
			}
		}
		ai_chance = {
			base = 0 # LotR: This should be tied to WotR mode.
			modifier = { # Game Rule
				has_game_rule = default_ai_behavior
				add = 100
			}
			modifier = { # Game Rule
				has_game_rule = weighted_ai_behavior
				add = 75
			}
			modifier = { # Game Rule
				has_game_rule = random_ai_behavior
				add = 50
			}
		}
	}
	option = { # Do not reinforcments to Edoras.
		name = rohan.2209.b
		ai_chance = {
			base = 0 # LotR: This should be tied to WotR mode.
			modifier = { # Game Rule
				has_game_rule = default_ai_behavior
				add = 0
			}
			modifier = { # Game Rule
				has_game_rule = weighted_ai_behavior
				add = 25
			}
			modifier = { # Game Rule
				has_game_rule = random_ai_behavior
				add = 50
			}
		}
	}
}

# Muster the Rohirrim - Eastemnet
rohan.2210 = {
	content_source = realms_dlc
	type = character_event
	title = rohan.2210.t
	desc = rohan.2210.desc
	theme = martial

	right_portrait = {
		character = character:6000017
		animation = personality_bold
	}
	
	left_portrait = {
		character = root
		animation = admiration
	}

	option = { # Send reinforcments to Edoras!
		name = rohan.2210.a
		title:k_rohan.holder = { 
			trigger_event = {
				id = rohan.2214
				days = 9
			}
		}
		ai_chance = {
			base = 0 # LotR: This should be tied to WotR mode.
			modifier = { # Game Rule
				has_game_rule = default_ai_behavior
				add = 100
			}
			modifier = { # Game Rule
				has_game_rule = weighted_ai_behavior
				add = 75
			}
			modifier = { # Game Rule
				has_game_rule = random_ai_behavior
				add = 50
			}
		}
	}
	option = { # Do not reinforcments to Edoras.
		name = rohan.2210.b
		ai_chance = {
			base = 0 # LotR: This should be tied to WotR mode.
			modifier = { # Game Rule
				has_game_rule = default_ai_behavior
				add = 0
			}
			modifier = { # Game Rule
				has_game_rule = weighted_ai_behavior
				add = 25
			}
			modifier = { # Game Rule
				has_game_rule = random_ai_behavior
				add = 50
			}
		}
	}
}

# Muster the Rohirrim - Grimslade Men Arrive at Edoras
rohan.2211 = {
	content_source = realms_dlc
	type = character_event
	title = rohan.2211.t
	desc = rohan.2211.desc
	theme = martial

	right_portrait = {
		character = root
		animation = personality_bold
	}
	
	option = { 
		name = rohan.2211.a
		spawn_army = {		  
			uses_supply = no
			inheritable = no
			name = mustered_rohirrim_event_troops_grimslade
			levies = 500
			men_at_arms = {
				type = eotheod_horse_archers
				stacks = 4
			}
			men_at_arms = {
				type = eotheod_horse_axemen
				stacks = 4
			}
			location = capital_province
		}
	}
}

# Muster the Rohirrim - Harowdale Men Arrive at Edoras
rohan.2212 = {
	content_source = realms_dlc
	type = character_event
	title = rohan.2212.t
	desc = rohan.2212.desc
	theme = martial

	right_portrait = {
		character = root
		animation = personality_bold
	}
	
	option = { 
		name = rohan.2212.a
		spawn_army = {		  
			uses_supply = no
			inheritable = no
			name = mustered_rohirrim_event_troops_upfolde
			levies = 500
			men_at_arms = {
				type = helmingas_warriors
				stacks = 5
			}
			men_at_arms = {
				type = westfolders
				stacks = 4
			}
			men_at_arms = {
				type = westfolders
				stacks = 4
			}
			location = capital_province
		}
	}
}

# Muster the Rohirrim - Eastfold Men Arrive at Edoras
rohan.2213 = {
	content_source = realms_dlc
	type = character_event
	title = rohan.2213.t
	desc = rohan.2213.desc
	theme = martial

	right_portrait = {
		character = root
		animation = personality_bold
	}
	
	option = { 
		name = rohan.2213.a
		spawn_army = {		  
			uses_supply = no
			inheritable = no
			name = mustered_rohirrim_event_troops_eastfold
			levies = 500
			men_at_arms = {
				type = helmingas_warriors
				stacks = 8
			}
			men_at_arms = {
				type = helmingas_warriors
				stacks = 2
			}
			men_at_arms = {
				type = eotheod_light_horsemen
				stacks = 6
			}
			location = capital_province
		}
	}
}

# Muster the Rohirrim - Eastemnet Men Arrive at Edoras
rohan.2214 = {
	content_source = realms_dlc
	type = character_event
	title = rohan.2214.t
	desc = rohan.2214.desc
	theme = martial

	right_portrait = {
		character = root
		animation = personality_bold
	}
	
	option = { 
		name = rohan.2214.a
		spawn_army = {		  
			uses_supply = no
			inheritable = no
			name = mustered_rohirrim_event_troops_eastemnet
			levies = 500
			men_at_arms = {
				type = eotheod_light_horsemen
				stacks = 4
			}
			men_at_arms = {
				type = eotheod_horse_archers
				stacks = 3
			}
			men_at_arms = {
				type = eotheod_horse_axemen
				stacks = 2
			}
			location = capital_province
		}
		title:c_isengard.holder = { # Sauruman officially declares war.
			trigger_event = {
				id = rohan.2216
				days = 3
			}
		}
	}
}

rohan.2215 = { # Theodred at Edoras / Convinces his father to Muster.
	content_source = realms_dlc
	type = character_event
	title = rohan.2215.t
	desc = rohan.2215.desc
	theme = martial

	trigger = {
		character:6000017 = {
			has_title = title:k_rohan
			is_independent_ruler = yes
		}
	}

	left_portrait = {
		character = root
		animation = admiration
	}
	
	right_portrait = {
		character = character:6000017
		animation = personality_bold
	}
	
	option = { 
		name = rohan.2215.a
		character:6000017 = { # Muster of the Rohirrim
			trigger_event = {
				id = rohan.2206
			}
		}
		#trigger_event = {
		#	id = rohan.2216
		#	days = 7
		#}
	}
}

### Sauruman declares war on Rohan

rohan.2216 = { 
	content_source = realms_dlc
	type = character_event
	title = rohan.2216.t
	desc = rohan.2216.desc
	theme = dread
	left_portrait = {
		character = root
		animation = war_attacker
	}
	option = {
		name = rohan.2216.a
		start_war = {
			casus_belli = rohan_war_cb
			target = title:k_rohan.holder
			target_title = title:k_rohan
		}
	}
}

### Sauruman loses the war / the March of the Ents

rohan.2217 = { 
	content_source = realms_dlc
	type = character_event
	title = rohan.2217.t
	desc = rohan.2217.desc
	orphan = yes # LotR - TODO - Figure out why? Presumably partially implemented.
	theme = battle
	left_portrait = {
		character = root
		animation = anger
	}
	option = {
		name = rohan.2217.a
		destroy_title = title:e_isengard_unleashed 
		every_living_character = {
			trigger_event = {
				id = rohan.2218
				days = 3
			}
		}
		trigger_event = {
			id = rohan.2219
			days = 5
		}
	}
}

rohan.2218 = { # Global March of the Ents event.
	content_source = realms_dlc
	type = character_event
	title = rohan.2218.t
	desc = rohan.2218.desc
	theme = martial
	override_background = {
		reference = flooded_isengard
	}
	right_portrait = {
		character = character:lineofsaruman
		animation = anger
	}
	left_portrait = {
		character = character:6000017
		animation = personality_bold
	}
	option = {
		name = rohan.2218.a # There is hope for Man! 
	}
	option = {
		name = rohan.2218.b # Cursed Man-folk! They only delay the inevitable! 
	}
}

rohan.2219 = { # Saruman's choice...
	content_source = realms_dlc
	type = character_event
	title = rohan.2219.t
	desc = rohan.2219.desc
	theme = martial
	override_background = {
		reference = flooded_isengard
	}
	right_portrait = {
		character = root
		animation = anger
	}
	left_portrait = {
		character = character:6000017
		animation = personality_bold
	}
	option = {
		name = rohan.2219.a # Stay evil. 
		trigger_event = {
			id = rohan.2220
		}
		ai_chance = {
			base = 0 # LotR: This should be tied to WotR mode.
			modifier = { # Game Rule
				has_game_rule = default_ai_behavior
				add = 100
			}
			modifier = { # Game Rule
				has_game_rule = weighted_ai_behavior
				add = 75
			}
			modifier = { # Game Rule
				has_game_rule = random_ai_behavior
				add = 50
			}
		}
	}
	option = {
		name = rohan.2219.b # Try to become good. Theoden decides your fate.
		set_character_faith = faith:faith_ainur
		set_culture = culture:istari
		title:k_rohan.holder = {
			trigger_event = {
				id = rohan.2221
			}
		}
		ai_chance = {
			base = 0 # LotR: This should be tied to WotR mode.
			modifier = { # Game Rule
				has_game_rule = default_ai_behavior
				add = 0
			}
			modifier = { # Game Rule
				has_game_rule = weighted_ai_behavior
				add = 25
			}
			modifier = { # Game Rule
				has_game_rule = random_ai_behavior
				add = 50
			}
		}
	}
}

rohan.2220 = { # The death of Saruman 1 - killed by Grima
	content_source = realms_dlc
	type = character_event
	title = rohan.2220.t
	desc = rohan.2220.desc
	theme = martial
	override_background = {
		reference = flooded_isengard
	}
	
	right_portrait = {
		character = root
		animation = shock
	}
	left_portrait = {
		character = character:6000044
		animation = anger
	}
	option = {
		name = rohan.2220.a 
		death = {
			death_reason = death_murder
			killer = character:6000044
		}
		title:k_rohan.holder = {
			get_title = title:d_isengard
			get_title = title:c_isengard
			trigger_event = {
				id = rohan.2222
			}
		}
	}
}

rohan.2221 = { # Theoden's judgement
	content_source = realms_dlc
	type = character_event
	title = rohan.2221.t
	desc = rohan.2221.desc
	theme = martial
	override_background = {
		reference = flooded_isengard
	}
	right_portrait = {
		character = character:lineofsaruman
		animation = shame
	}
	left_portrait = {
		character = root
		animation = personality_bold
	}
	option = {
		name = rohan.2221.a # There shall be no mercy!
		add_prestige = 200
		get_title = title:d_isengard
		get_title = title:c_isengard
		character:lineofsaruman = {
			death = {
				death_reason = death_execution
				killer = root
			}
		}
		ai_chance = {
			base = 0 # LotR: This should be tied to WotR mode.
			modifier = { # Game Rule
				has_game_rule = default_ai_behavior
				add = 100
			}
			modifier = { # Game Rule
				has_game_rule = weighted_ai_behavior
				add = 75
			}
			modifier = { # Game Rule
				has_game_rule = random_ai_behavior
				add = 50
			}
		}
	}
	option = {
		name = rohan.2221.b # Show mercy.
		custom_tooltip = rohan.2221.b.tt
		add_piety = 200
		ai_chance = {
			base = 0 # LotR: This should be tied to WotR mode.
			modifier = { # Game Rule
				has_game_rule = default_ai_behavior
				add = 0
			}
			modifier = { # Game Rule
				has_game_rule = weighted_ai_behavior
				add = 25
			}
			modifier = { # Game Rule
				has_game_rule = random_ai_behavior
				add = 50
			}
		}
	}
}

rohan.2222 = { # Theoden is informed of Saruman's death.
	content_source = realms_dlc
	type = character_event
	title = rohan.2222.t
	desc = rohan.2222.desc
	theme = battle
	right_portrait = {
		character = character:lineofsaruman
		animation = shock
	}
	left_portrait = {
		character = character:6000044
		animation = anger
	}
	option = {
		name = rohan.2222.a # Vengance, at last.
	}
}

### Invite Dwarves to the White Mountains ###

rohan.2500 = { # Decide which dwarf-realm to contact
	content_source = realms_dlc
	type = character_event
	title = rohan.2500.t
	desc = rohan.2500.desc
	theme = realm
	window = visit_settlement_window
	left_portrait = {
		character = root
		animation = personality_rational
	}
	lower_left_portrait = { character = scope:ereborking }
	lower_center_portrait = { character = scope:belegostking }
	lower_right_portrait = { character = scope:buzradumking }
	
	immediate = { #Get the dwarven kings if they exist
		root = { save_scope_as = whitemountainsinviter }
		if = {
			limit = {
				exists = title:k_erebor.holder
				title:k_erebor.holder = { 
					is_dwarf = yes
					faith_is_good = yes
				}
			}
			title:k_erebor.holder = { save_scope_as = ereborking }
		}
		if = {
			limit = {
				exists = title:k_iron_hills.holder
				title:k_iron_hills.holder = { 
					is_dwarf = yes
					faith_is_good = yes
				}
				NOT = {
					title:k_iron_hills.holder = { has_title = title:k_erebor }
				}
			}
			title:k_iron_hills.holder = { save_scope_as = ironhillsking }
		}
		if = {
			limit = {
				exists = title:k_khazad_dum.holder
				title:k_khazad_dum.holder = { 
					is_dwarf = yes
					faith_is_good = yes
				}
			}
			title:k_khazad_dum.holder = { save_scope_as = moriaking }
		}
		if = {
			limit = {
				exists = title:k_belegost.holder
				title:k_belegost.holder = { 
					is_dwarf = yes
					faith_is_good = yes
				}
			}
			title:k_belegost.holder = { save_scope_as = belegostking }
		}
		if = {
			limit = {
				exists = title:k_buzra_dum.holder
				title:k_buzra_dum.holder = { 
					is_dwarf = yes
					faith_is_good = yes
				}
			}
			title:k_buzra_dum.holder = { save_scope_as = buzradumking }
		}
		if = {
			limit = {
				exists = title:k_barazimab_ul.holder
				title:k_barazimab_ul.holder = { 
					is_dwarf = yes
					faith_is_good = yes
				}
			}
			title:k_barazimab_ul.holder = { save_scope_as = barazimabulking }
		}
		if = {
			limit = {
				exists = title:k_blackflame.holder
				title:k_blackflame.holder = { 
					is_dwarf = yes
					faith_is_good = yes
				}
			}
			title:k_blackflame.holder = { save_scope_as = blackflameking }
		}
		if = {
			limit = {
				exists = title:k_grey_mountains.holder
				title:k_grey_mountains.holder = { 
					is_dwarf = yes
					faith_is_good = yes
				}
			}
			title:k_grey_mountains.holder = { save_scope_as = greymountainsking }
		}
		if = {
			limit = {
				exists = title:k_gundabad.holder
				title:k_gundabad.holder = { 
					is_dwarf = yes
					faith_is_good = yes
				}
			}
			title:k_gundabad.holder = { save_scope_as = gundabadking }
		}
		#Fallback - random dwarven adventurer
		create_character = { # 
			age = { 140 200 }
			gender = male
			culture = culture:longbeards
			faith = faith:faith_khazad
			location = root.location
			dynasty = create
			trait = adventurer
			save_scope_as = whitemountainsking
			# after_creation = {
				# add_character_flag = whitemountainskingchosen
			# }
		}
		
	}
	
	option = { # Send a message to the King of Erebor
		name = rohan.2500.a
		trigger = { exists = title:k_erebor.holder }
		custom_tooltip = rohan.2500.a.tt
		title:k_erebor.holder = { 
			trigger_event = {
				id = rohan.2501
				days = 60
			}
		}
	}
	option = { # Send a message to the King of the Iron Hills
		name = rohan.2500.b 
		trigger = { 
			exists = title:k_iron_hills.holder
			NOT = {
				title:k_iron_hills.holder = { has_title = title:k_erebor }
			}
		}
		custom_tooltip = rohan.2500.b.tt
		title:k_iron_hills.holder = { 
			trigger_event = {
				id = rohan.2501
				days = 60
			}
		}
	}
	option = { # Send a message to the King of Moria
		name = rohan.2500.c 
		trigger = { exists = title:k_khazad_dum.holder }
		custom_tooltip = rohan.2500.c.tt
		title:k_khazad_dum.holder = { 
			trigger_event = {
				id = rohan.2501
				days = 60
			}
		}
	}
	option = { # Send a message to the King of Belegost
		name = rohan.2500.d 
		trigger = { exists = title:k_belegost.holder }
		custom_tooltip = rohan.2500.d.tt
		title:k_belegost.holder = { 
			trigger_event = {
				id = rohan.2501
				days = 60
			}
		}
	}
	option = { # Send a message to the King of Buzra-Dûm
		name = rohan.2500.e 
		trigger = { exists = title:k_buzra_dum.holder }
		custom_tooltip = rohan.2500.e.tt
		title:k_buzra_dum.holder = { 
			trigger_event = {
				id = rohan.2501
				days = 60
			}
		}
	}
	option = { # Send a message to the King of Barazimabûl
		name = rohan.2500.f 
		trigger = { exists = title:k_barazimab_ul.holder }
		custom_tooltip = rohan.2500.f.tt
		title:k_barazimab_ul.holder = { 
			trigger_event = {
				id = rohan.2501
				days = 60
			}
		}
	}
	option = { # Send a message to the King of Blackflame
		name = rohan.2500.g
		trigger = { exists = title:k_blackflame.holder }
		custom_tooltip = rohan.2500.g.tt
		title:k_blackflame.holder = { 
			trigger_event = {
				id = rohan.2501
				days = 60
			}
		}
	}
	option = { # Send a message to the King of the Grey Mountains
		name = rohan.2500.h
		trigger = { exists = title:k_grey_mountains.holder }
		custom_tooltip = rohan.2500.h.tt
		title:k_grey_mountains.holder = { 
			trigger_event = {
				id = rohan.2501
				days = 60
			}
		}
	}
	option = { # Send a message to the King of Gundabad
		name = rohan.2500.i
		trigger = { exists = title:k_gundabad.holder }
		custom_tooltip = rohan.2500.i.tt
		title:k_gundabad.holder = { 
			trigger_event = {
				id = rohan.2501
				days = 60
			}
		}
	}
	option = { # FALLBACK - if no dwarf king exists
		name = rohan.2500.j 
		trigger = {
			NOR = {
				exists = title:k_erebor.holder
				exists = title:k_iron_hills.holder
				exists = title:k_khazad_dum.holder
				exists = title:k_belegost.holder
				exists = title:k_buzra_dum.holder
				exists = title:k_barazimab_ul.holder
				exists = title:k_blackflame.holder
				exists = title:k_grey_mountains.holder
				exists = title:k_gundabad.holder
			}
		}
		custom_tooltip = rohan.2500.j.tt 
		scope:whitemountainsking = {
			add_character_flag = whitemountainssettler
		}
		trigger_event = {
			id = rohan.2502
			days = 90
		}
	}
}

rohan.2501 = { # Dwarf King decides who to send to the White Mountain
	content_source = realms_dlc
	type = character_event
	title = rohan.2501.t
	desc = rohan.2501.desc
	theme = realm
	window = visit_settlement_window
	right_portrait = {
		character = root
		animation = personality_rational
	}
	left_portrait = {
		character = scope:whitemountainsinviter
		animation = personality_honorable
	}
	lower_left_portrait = { character = scope:candidate1 }
	lower_center_portrait = { character = scope:candidate2 }
	lower_right_portrait = { character = scope:candidate3 }
	
	immediate = {
		character:lineofdurin100 = { save_scope_as = gimli }
		root = { save_scope_as = chosen_dwarfking }
		random_knight = { 
			limit = {
				is_landed = no
				NOT = { is_player_heir_of = root }
			}
			save_scope_as = candidate1 
		}
		random_close_or_extended_family_member = {
			limit = {
				root.primary_title = {
					place_in_line_of_succession = {
						target = prev
						value > 2
					}
				}
				is_ruler = no
			}
			save_scope_as = candidate2
		}
		random_courtier_or_guest = { 
			limit = { NOT = { is_player_heir_of = root } }
			save_scope_as = candidate3 
		}	
	}
	
	option = { # A knight
		name = rohan.2501.a 
		custom_tooltip = rohan.2501.a.tt
		scope:candidate1 = { add_character_flag = whitemountainssettler }
		scope:whitemountainsinviter = {
			add_courtier = scope:candidate1
			trigger_event = {
				id = rohan.2502
				days = 60
			}
		}
	}
	
	option = { # A family member
		name = rohan.2501.b 
		trigger = { exists = scope:candidate2 }
		custom_tooltip = rohan.2501.b.tt
		scope:candidate2 = { add_character_flag = whitemountainssettler }
		scope:whitemountainsinviter = {
			add_courtier = scope:candidate2
			trigger_event = {
				id = rohan.2502
				days = 60
			}
		}
	}

	option = { # A courtier
		name = rohan.2501.c 
		custom_tooltip = rohan.2501.c.tt
		scope:candidate3 = { add_character_flag = whitemountainssettler }
		scope:whitemountainsinviter = {
			add_courtier = scope:candidate3
			trigger_event = {
				id = rohan.2502
				days = 60
			}
		}
	}

	option = { # Gimli, son of Glóin
		name = rohan.2501.d 
		trigger = {
			has_title = title:k_erebor
			exists = scope:gimli
			scope:gimli = { is_ruler = no }
		}
		custom_tooltip = rohan.2501.d.tt
		scope:gimli = { add_character_flag = whitemountainssettler }
		scope:whitemountainsinviter = {
			add_courtier = scope:gimli
			trigger_event = {
				id = rohan.2502
				days = 60
			}
		}
		ai_chance = {
			base = 100
		}
	}	
	
	after = {
		
	}
}

rohan.2502 = { # Dwarven settler arrives at hosts's court, decide how much you want to fund them
	content_source = realms_dlc
	type = character_event
	title = rohan.2502.t
	desc = rohan.2502.desc
	theme = realm
	window = visit_settlement_window
	left_portrait = {
		character = root
		animation = personality_rational
	}
	right_portrait = {
		character = scope:whitemountainssettler
		animation = personality_honorable
	}
	immediate = {
		every_courtier = {
			limit = {
				has_character_flag = whitemountainssettler
			}
			save_scope_as = whitemountainssettler
		}
		# if = {
		# 	limit = {
		# 		completely_controls = title:c_emyndunendor #Trig Note - Not an entrance 
		# 	}
		# 	title:c_crystal_depths = { save_scope_as = target_county }
		# }
		if = {
			limit = {
				completely_controls = title:c_helmsdeep 
			}
			title:c_glittering_caves = { save_scope_as = target_county }
		}
		else_if = {
			limit = {
				completely_controls = title:c_emyn_glaur 
			}
			title:c_neuaddcarreg = { save_scope_as = target_county }
		}
		else_if = {
			limit = {
				completely_controls = title:c_imrathion
			}
			title:c_cartref_gorllewin = { save_scope_as = target_county }
		}
		if = {
			#check if he is still alive and not in prison
			limit = {
				OR = {
					scope:whitemountainssettler = {
						OR = {
							is_alive = no
							is_imprisoned = yes
						}
					}
					NOT = { exists = scope:whitemountainssettler } 
				}
			}
			create_character = { # 
				age = { 140 200 }
				gender = male
				culture = culture:longbeards
				faith = faith:faith_khazad
				location = root.location
				dynasty = create
				trait = adventurer
				save_scope_as = whitemountainssettler
			}
		}
	}
	
	option = { # Fund them with a large sum
		name = rohan.2502.a 
		remove_short_term_gold = massive_gold_value
		custom_tooltip = rohan.2502.a.tt
		add_character_flag = large_sum_white_mountains
		trigger_event = {
			id = rohan.2503
			days = 60 
		}
	}
	option = { # Fund them with a medium sum
		name = rohan.2502.b 
		remove_short_term_gold = major_gold_value
		custom_tooltip = rohan.2502.b.tt
		add_character_flag = medium_sum_white_mountains
		trigger_event = {
			id = rohan.2503
			days = 60 
		}
	}
	option = { # Fund them with a minor sum
		name = rohan.2502.c 
		remove_short_term_gold = medium_gold_value
		custom_tooltip = rohan.2502.c.tt
		add_character_flag = minor_sum_white_mountains
		trigger_event = {
			id = rohan.2503
			days = 60 
		}
	}
	option = { # Give them no funds at all
		name = rohan.2502.d 
		add_prestige = medium_prestige_loss
		custom_tooltip = rohan.2502.d.tt
		add_character_flag = no_funds_white_mountains
		trigger_event = {
			id = rohan.2503
			days = 60 
		}
	}
}

rohan.2503 = { # Check if the target county is empty. Check if the settler is still alive
	hidden = yes
	immediate = {
		hidden_effect = {
			if = {
				#check if he is still alive and not in prison
				limit = {
					OR = {
						scope:whitemountainssettler = {
							OR = {
								is_alive = no
								is_imprisoned = yes
							}
						}
						NOT = { exists = scope:whitemountainssettler } 
					}
				}
				create_character = { # 
					age = { 140 200 }
					gender = male
					culture = culture:longbeards
					faith = faith:faith_khazad
					location = root.location
					dynasty = create
					trait = adventurer
					save_scope_as = whitemountainssettler
				}
			}
 		}
		if = {
			limit = {
				scope:target_county = {
					any_county_province = { 
						NOT = { has_holding_type = wastelands_holding }
					}
				}
			}
			scope:target_county = {
				ordered_neighboring_county = {
					limit = {
						title_province = { terrain = halls }
						#any_county_province = { has_holding_type = wastelands_holding }
					}
					save_scope_as = target_county
					root = {
						trigger_event = { # Check again
							id = rohan.2503
							days = 1
						}
					}
				}
			}
		}
		else = {
			trigger_event = rohan.2504
		}
	}
}

rohan.2504 = { # The colony is completed
	content_source = realms_dlc
	type = character_event
	title = rohan.2504.t
	desc = rohan.2504.desc
	theme = realm
	window = visit_settlement_window
	right_portrait = {
		character = root
		animation = personality_honorable
	}
	left_portrait = {
		character = scope:whitemountainssettler
		animation = happiness
	}
	lower_center_portrait = { character = scope:chosen_dwarfking }
	immediate = {
		scope:target_county = { title_province = { set_holding_type = dwarven_holding } }

		# Transfer the target title
		create_title_and_vassal_change = {
			type = returned
			save_scope_as = change
			add_claim_on_loss = no
		}

		scope:target_county = {
			set_county_culture = scope:whitemountainssettler.culture
			set_county_faith = scope:whitemountainssettler.faith
			generate_coa = yes
		}

		scope:target_county = {
			change_title_holder = {
				holder = scope:whitemountainssettler
				change = scope:change
			}			
		}
		
		scope:whitemountainssettler = {
			becomes_independent = { change = scope:change }
		}

		resolve_title_and_vassal_change = scope:change
		
		scope:target_county = {
			generate_coa = yes

		}
		
		hidden_effect = {
			scope:whitemountainssettler = {
				change_government = feudal_government
			}
		}
		
		if = {
			limit =  {
				has_character_flag = large_sum_white_mountains
			}
			scope:target_county = {
				random_list = {
					1 = { scope:target_county.title_province = { add_building = dwarven_fungal_farm_04 } }
					1 = { scope:target_county.title_province = { add_building = dwarven_ale_house_04 } }
					1 = { scope:target_county.title_province = { add_building = dwarven_terrace_farm_04 } }
					1 = { scope:target_county.title_province = { add_building = dwarven_quarry_04 } }
				}
				random_list = {
					1 = { scope:target_county.title_province = { add_building = dwarven_crafts_04 } }
					1 = { scope:target_county.title_province = { add_building = dwarven_toolmaker_guild_04 } }
					1 = { scope:target_county.title_province = { add_building = dwarven_vaults_04 } }
					1 = { scope:target_county.title_province = { add_building = dwarven_roads_04 } }
				}
			}
			scope:target_county.title_province = { add_building = dwarven_depths_02 }
			scope:target_county = { change_development_level = 6 }
		}
		else_if = {
			limit =  {
				has_character_flag = medium_sum_white_mountains
			}
			scope:target_county = {
				random_list = {
					1 = { scope:target_county.title_province = { add_building = dwarven_fungal_farm_02 } }
					1 = { scope:target_county.title_province = { add_building = dwarven_ale_house_02 } }
					1 = { scope:target_county.title_province = { add_building = dwarven_terrace_farm_02 } }
					1 = { scope:target_county.title_province = { add_building = dwarven_quarry_02 } }
				}
				random_list = {
					1 = { scope:target_county.title_province = { add_building = dwarven_crafts_03 } }
					1 = { scope:target_county.title_province = { add_building = dwarven_toolmaker_guild_03 } }
					1 = { scope:target_county.title_province = { add_building = dwarven_vaults_03 } }
					1 = { scope:target_county.title_province = { add_building = dwarven_roads_03 } }
				}
			}
			scope:target_county = { change_development_level = 4 }
		}
		else_if = {
			limit = {
				has_character_flag = minor_sum_white_mountains
			}
			scope:target_county = {
				random_list = {
					1 = { scope:target_county.title_province = { add_building = dwarven_fungal_farm_02 } }
					1 = { scope:target_county.title_province = { add_building = dwarven_ale_house_02 } }
					1 = { scope:target_county.title_province = { add_building = dwarven_terrace_farm_02 } }
					1 = { scope:target_county.title_province = { add_building = dwarven_quarry_02 } }
					1 = { scope:target_county.title_province = { add_building = dwarven_crafts_02 } }
					1 = { scope:target_county.title_province = { add_building = dwarven_toolmaker_guild_02 } }
					1 = { scope:target_county.title_province = { add_building = dwarven_vaults_02 } }
					1 = { scope:target_county.title_province = { add_building = dwarven_roads_02 } }
				}
			}
			scope:target_county = { change_development_level = 3 }
		}
		else = {
			scope:target_county = { change_development_level = 2 }
		}			
	}

	option = { # Best of luck to you, new neighbours
		trigger = {
			NOT = { has_character_flag = no_funds_white_mountains }
		}
		name = rohan.2504.a              
		scope:whitemountainssettler = {
			add_opinion = {
				modifier = grateful_opinion
				opinion = 50
				target = root
			}
		}
		if = {
			limit = {
				has_defensive_alliance = no
			}
			scope:whitemountainssettler = {
				add_to_variable_list = {
					name = defensive_allies
					target = root
				}
			}
			root = {
				add_to_variable_list = {
					name = defensive_allies
					target = scope:whitemountainssettler
				}
			}
			custom_tooltip = rohan.2504.a.tt
		}
	}
	option = { # I hope they're not angry I didn't fund them
		trigger = { has_character_flag = no_funds_white_mountains }
		name = rohan.2504.b 
	}
	option = { # Switch to playing as the new dwarven ruler
		trigger = { is_ai = no }
		name = rohan.2504.c 
		#custom_tooltip = rohan.2504.c.tt
		if = {
			limit = {
				has_defensive_alliance = no
			}
			scope:whitemountainssettler = {
				add_to_variable_list = {
					name = defensive_allies
					target = root
				}
			}
			root = {
				add_to_variable_list = {
					name = defensive_allies
					target = scope:whitemountainssettler
				}
			}
		}
		set_player_character = scope:whitemountainssettler
	}
	
	after = {
		scope:chosen_dwarfking = { # Bring the news to the king that sent the dwarves
			trigger_event = {
				id = rohan.2505
				days = 5
			}
		}
		
		# Give the new ruler a few starting courtiers
		create_character = { 
			template = random_dwarf_template
			age = { 80 120 }
			culture = scope:whitemountainssettler.culture
			faith = scope:whitemountainssettler.faith
			gender = male
			random_traits = yes
			employer = scope:whitemountainssettler
		}
		create_character = { 
			template = random_dwarf_template
			age = { 80 120 }
			culture = scope:whitemountainssettler.culture
			faith = scope:whitemountainssettler.faith
			gender = female
			random_traits = yes
			employer = scope:whitemountainssettler
		}
		create_character = { 
			template = random_dwarf_template
			age = { 80 120 }
			culture = scope:whitemountainssettler.culture
			faith = scope:whitemountainssettler.faith
			gender = male
			random_traits = yes
			employer = scope:whitemountainssettler
		}
		
		create_character = { 
			template = random_dwarf_template
			culture = scope:whitemountainssettler.culture
			faith = scope:whitemountainssettler.faith
			gender = male
			random_traits = yes
			employer = scope:whitemountainssettler
		}
		
		create_character = { 
			template = random_dwarf_template
			culture = scope:whitemountainssettler.culture
			faith = scope:whitemountainssettler.faith
			gender = female
			random_traits = yes
			employer = scope:whitemountainssettler
		}
	}
}

rohan.2505 = { # Receive the news of the completed colony
	content_source = realms_dlc
	type = character_event
	title = rohan.2505.t
	desc = rohan.2505.desc
	theme = realm
	window = visit_settlement_window
	right_portrait = {
		character = root
		animation = personality_honorable
	}
	left_portrait = {
		character = scope:whitemountainssettler
		animation = happiness
	}
	lower_center_portrait = { character = scope:whitemountainsinviter }
	
	option = { # We wish them the best of luck
		name = rohan.2505.a  
		add_prestige = minor_prestige_gain
		scope:whitemountainssettler = {
			add_opinion = {
				modifier = grateful_opinion
				opinion = 50
				target = root
			}
		}
	}
	option = { # They owe me their fealty
		name = rohan.2505.b 
		scope:whitemountainssettler = {
			add_opinion = {
				modifier = angry_opinion
				opinion = -30
				target = root
			}
		}
		scope:whitemountainssettler = {
			create_title_and_vassal_change = {
				type = swear_fealty
				save_scope_as = change
				add_claim_on_loss = no
			}
			change_liege = {
				liege = root
				change = scope:change
			}
			resolve_title_and_vassal_change = scope:change
		}
	}
	option = { # Switch to playing as the new dwarven ruler in the White Mountains
		trigger = { is_ai = no }
		name = rohan.2505.c 
		set_player_character = scope:whitemountainssettler
	}
}

### Enter/Leave realm events ###
rohan.3000 = { # Fall of Edoras
	content_source = realms_dlc
	type = character_event
	title = rohan.3000.t
	desc = rohan.3000.desc
	theme = battle
	trigger = { culture = { has_cultural_pillar = heritage_northron } } #Should only trigger for Rohan
	cooldown = { days = 3 }
	left_portrait = {
		character = root
		animation = rage
	}
	
	option = { #This can't be happening...
		name = rohan.3000.a
		add_prestige = medium_prestige_loss
	}
}

rohan.3001 = { # Edoras reclaimed
	content_source = realms_dlc
	type = character_event
	title = rohan.3001.t
	desc = rohan.3001.desc
	theme = war
	trigger = { culture = { has_cultural_pillar = heritage_northron } } #Should only trigger for Rohan
	cooldown = { days = 3 }
	override_background = {
		reference = edoras
	}
	left_portrait = {
		character = root
		animation = marshal_shield
	}
	
	option = { #We did it!
		name = rohan.3001.a
		add_prestige = medium_prestige_gain
	}
}

rohan.3002 = { # Fall of Helm's Deep
	content_source = realms_dlc
	type = character_event
	title = rohan.3002.t
	desc = rohan.3002.desc
	theme = battle
	trigger = { culture = { has_cultural_pillar = heritage_northron } } #Should only trigger for Rohan
	cooldown = { days = 3 }
	left_portrait = {
		character = root
		animation = worry
	}
	
	option = { #This can't be happening...
		name = rohan.3002.a
		add_prestige = medium_prestige_loss
	}
}

rohan.3003 = { # The Hornburg reclaimed
	content_source = realms_dlc
	type = character_event
	title = rohan.3003.t
	desc = rohan.3003.desc
	theme = war
	trigger = { culture = { has_cultural_pillar = heritage_northron } } #Should only trigger for Rohan
	cooldown = { days = 3 }
	left_portrait = {
		character = root
		animation = marshal_shield
	}
	
	option = { #We did it!
		name = rohan.3003.a
		add_prestige = medium_prestige_gain
	}
}

rohan.3004 = { # Isengard conquered
	content_source = realms_dlc
	type = character_event
	title = rohan.3004.t
	desc = rohan.3004.desc
	theme = war
	trigger = { culture = { has_cultural_pillar = heritage_northron } } #Should only trigger for Rohan
	cooldown = { days = 3 }
	left_portrait = {
		character = root
		animation = marshal_shield
	}
	
	option = { #We did it!
		name = rohan.3004.a
		add_prestige = medium_prestige_gain
	}
}