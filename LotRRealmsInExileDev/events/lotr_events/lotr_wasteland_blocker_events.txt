#########################################
# COLONISATION BLOCKER CLEARANCE EVENTS #
#########################################

###############
## Wolf Den
# wasteland_blocker.0001 — Clearing out the Wolves
## Bear Den
# wasteland_blocker.0011 — Yoh-gi
# wasteland_blocker.0012 — Beargild
## Spider Nest
# wasteland_blocker.0021 — The Great Web
# wasteland_blocker.0021 — Attacop
## Bandits
# wasteland_blocker.0031 — The Outcasts
# wasteland_blocker.0032 — The Corral
## Drakes
# wasteland_blocker.0041 — Life Finds a Way
# wasteland_blocker.0042 — Drakes' Nest
## Flooded Lands
# wasteland_blocker.0051 — Ditch and Drain
# wasteland_blocker.0052 — Marsh Fever

namespace = wasteland_blocker

## Wolf Den
wasteland_blocker.0001 = { # Clearing out the Wolves
	type = character_event
	title = wasteland_blocker.0001.t
	desc = wasteland_blocker.0001.desc
	theme = hunting

	left_portrait = {
		character = root
		animation = personality_bold
	}
	
	right_portrait = {
		character = scope:knight
		animation = war_defender
	}
	
	lower_center_portrait = {
		character = scope:hooked_character
	}

	immediate = {
		if = {
			limit = { 
				any_knight = { 
					is_ai = yes
					count > 0
				}
			}
			ordered_knight = {
				limit = { is_ai = yes }
				order_by = prowess
				save_scope_as = knight
			}
		}
		if = {
			limit = { 
				any_hooked_character = { 
					is_ai = yes
					count > 0
				}
			}
			ordered_hooked_character = {
				limit = { is_ai = yes }
				order_by = prowess
				save_scope_as = hooked_character
			}
		}
	}

	option = { # Take them on myself
		name = wasteland_blocker.0001.a
		skill = prowess
		duel = {
			skill = prowess 
			value = 10
			30 = { 
				compare_modifier = {
					value = scope:duel_value
					multiplier = 2
					min = -10
				}
				desc = wasteland_blocker.0001.a.duel_success
				send_interface_toast = {
					left_icon = root
					add_prestige = 100
					title = wasteland_blocker.0001.success.toast.t
					scope:obstacle_province = { remove_building = wolf_den_cleared }
				}
			}
			30 = {
				compare_modifier = {
					value = scope:duel_value
					multiplier = -2
					min = -25
				}
				desc = wasteland_blocker.0001.a.duel_failure
				send_interface_toast = {
					left_icon = root
					title = wasteland_blocker.0001.failure.toast.t
					add_prestige = -150
					increase_wounds_effect = { REASON = hunting_accident }
					hidden_effect = { scope:obstacle_province = { remove_building = wolf_den_cleared } }
					scope:obstacle_province = { add_building = wolf_den }
				}
			}
		}
		stress_impact = {
			brave = minor_stress_loss
			craven = medium_stress_gain
		}
	}
	
	option = { # Send a skilled knight
		name = wasteland_blocker.0001.b
		trigger = { 
			any_knight = { 
				is_ai = yes
				count > 0
			} 
		}
		scope:knight = {
			duel = {
				skill = prowess 
				value = 10
				30 = { 
					compare_modifier = {
						value = scope:duel_value
						multiplier = 2
						min = -10
					}
					desc = wasteland_blocker.0001.b.duel_success
					root = {
						send_interface_toast = {
							left_icon = root
							right_icon = scope:knight
							scope:knight = { add_prestige = 100 }
							title = wasteland_blocker.0001.success.toast.t
							scope:obstacle_province = { remove_building = wolf_den_cleared }
						}
					}
				}
				30 = {
					compare_modifier = {
						value = scope:duel_value
						multiplier = -2
						min = -25
					}
					desc = wasteland_blocker.0001.b.duel_failure
					root = {
						send_interface_toast = {
							left_icon = root
							right_icon = scope:knight
							title = wasteland_blocker.0001.failure.toast.t
							scope:knight = { add_prestige = -150 }
							increase_wounds_effect = { REASON = hunting_accident }
							hidden_effect = { scope:obstacle_province = { remove_building = wolf_den_cleared } }
							scope:obstacle_province = { add_building = wolf_den }
						}
					}
				}
			}
		}
		stress_impact = {
			humble = minor_stress_loss
			arrogant = medium_stress_gain
		}
	}
	
	option = { # Send a hooked character
		name = wasteland_blocker.0001.c
		trigger = { 
			any_hooked_character = { 
				is_ai = yes
				count > 0
			}
		}
		use_hook = scope:hooked_character
		scope:hooked_character = {
			duel = {
				skill = prowess 
				value = 10
				30 = { 
					compare_modifier = {
						value = scope:duel_value
						multiplier = 2
						min = -10
					}
					desc = wasteland_blocker.0001.c.duel_success
					root = {
						send_interface_toast = {
							left_icon = root
							right_icon = scope:hooked_character
							scope:hooked_character = { add_prestige = 100 }
							title = wasteland_blocker.0001.success.toast.t
							scope:obstacle_province = { remove_building = wolf_den_cleared }
						}
					}
				}
				30 = {
					compare_modifier = {
						value = scope:duel_value
						multiplier = -2
						min = -25
					}
					desc = wasteland_blocker.0001.c.duel_failure
					root = {
						send_interface_toast = {
							left_icon = root
							right_icon = scope:hooked_character
							title = wasteland_blocker.0001.failure.toast.t
							scope:hooked_character = { add_prestige = -150 }
							increase_wounds_effect = { REASON = hunting_accident }
							hidden_effect = { scope:obstacle_province = { remove_building = wolf_den_cleared } }
							scope:obstacle_province = { add_building = wolf_den }
						}
					}
				}
			}
		}
		stress_impact = {
			vengeful = minor_stress_loss
			compassionate = minor_stress_gain
		}
	}
	
	option = { # Hire skilled mercenaries
		name = wasteland_blocker.0001.d
		remove_short_term_gold = 100
		random_list = { 
			85 = {
				send_interface_toast = {
					left_icon = root
					title = wasteland_blocker.0001.success.toast.t
					scope:obstacle_province = { remove_building = wolf_den_cleared }
				}
			}
			15 = {
				send_interface_toast = {
					left_icon = root
					title = wasteland_blocker.0001.failure.toast.t
					hidden_effect = { scope:obstacle_province = { remove_building = wolf_den_cleared } }
					scope:obstacle_province = { add_building = wolf_den }
				}
			}
		}
		stress_impact = {
			greedy = minor_stress_gain
		}
	}
	
	option = { # Leave the wolves alone
		name = wasteland_blocker.0001.e
		hidden_effect = { scope:obstacle_province = { remove_building = wolf_den_cleared } }
		scope:obstacle_province = { add_building = wolf_den }
	}
}

## Bear Den
wasteland_blocker.0011 = { # Yoh-gi
	type = character_event
	title = wasteland_blocker.0011.t
	desc = wasteland_blocker.0011.desc
	theme = hunting

	left_portrait = {
		character = root
		animation = personality_bold
	}
	
	option = { # Dispatch the ranger expedition
		name = wasteland_blocker.0011.a
		trigger = {
			martial >= prowess
		}
		skill = martial
		duel = {
			skill = martial 
			value = 10
			30 = { 
				compare_modifier = {
					value = scope:duel_value
					multiplier = 2
					min = -10
				}
				desc = wasteland_blocker.0011.a.duel_success
				send_interface_toast = {
					left_icon = root
					title = wasteland_blocker.0011.success.toast.t
					scope:obstacle_province = { remove_building = bear_den_cleared }
				}
			}
			30 = {
				compare_modifier = {
					value = scope:duel_value
					multiplier = -2
					min = -25
				}
				desc = wasteland_blocker.0011.a.duel_failure
				send_interface_toast = {
					left_icon = root
					title = wasteland_blocker.0011.failure.toast.t
					hidden_effect = { scope:obstacle_province = { remove_building = bear_den_cleared } }
					scope:obstacle_province = { add_building = bear_den }
				}
			}
		}
	}

	option = { # Dispatch the bear personally
		name = wasteland_blocker.0011.c
		trigger = {
			martial < prowess
		}
		skill = prowess
		duel = {
			skill = prowess 
			value = 10
			30 = { 
				compare_modifier = {
					value = scope:duel_value
					multiplier = 2
					min = -10
				}
				desc = wasteland_blocker.0011.c.duel_success
				send_interface_toast = {
					left_icon = root
					add_prestige = 100
					title = wasteland_blocker.0011.success.toast.t
					scope:obstacle_province = { remove_building = bear_den_cleared }
				}
			}
			30 = {
				compare_modifier = {
					value = scope:duel_value
					multiplier = -2
					min = -25
				}
				desc = wasteland_blocker.0011.c.duel_failure
				send_interface_toast = {
					left_icon = root
					title = wasteland_blocker.0011.failure.toast.t
					add_prestige = -50
					increase_wounds_effect = { REASON = hunting_accident }
					hidden_effect = { scope:obstacle_province = { remove_building = bear_den_cleared } }
					scope:obstacle_province = { add_building = bear_den }
				}
			}
		}
		stress_impact = {
			brave = minor_stress_loss
			craven = medium_stress_gain
		}
	}	
			
	option = { # Pay the smith to build his trap
		name = wasteland_blocker.0011.b
		remove_short_term_gold = 50
		random_list = { 
			70 = {
				send_interface_toast = {
					left_icon = root
					title = wasteland_blocker.0011.success.toast.t
					scope:obstacle_province = { remove_building = bear_den_cleared }
				}
			}
			30 = {
				send_interface_toast = {
					left_icon = root
					title = wasteland_blocker.0011.failure.toast.t
					hidden_effect = { scope:obstacle_province = { remove_building = bear_den_cleared } }
					scope:obstacle_province = { add_building = bear_den }
				}
			}
		}
		stress_impact = {
			greedy = minor_stress_gain
		}
	}

	option = { # Leave the wolves alone
		name = wasteland_blocker.0011.d
		hidden_effect = { scope:obstacle_province = { remove_building = bear_den_cleared } }
		scope:obstacle_province = { add_building = bear_den }
	}
}

wasteland_blocker.0012 = { # Beargild
	type = character_event
	title = wasteland_blocker.0012.t
	desc = {
		desc = wasteland_blocker.0012.desc.1
		triggered_desc = { # Evil response to bear cub
			trigger = { 
				faith_is_evil = yes
			} 
			desc = wasteland_blocker.0012.desc.2.evil
		}
		triggered_desc = { # Non-evil response to bear cub
			trigger = { 
				faith_is_evil = no
			} 
			desc = wasteland_blocker.0012.desc.2.good
		}
	}
	theme = hunting

	left_portrait = {
		character = root
		animation = sadness
	}
	
	option = { # I must put it out of its misery
		name = wasteland_blocker.0012.a
		scope:obstacle_province = { remove_building = bear_den_cleared }
		if = {
			limit = {
				OR = {
					faith_is_good = yes
					faith = { has_doctrine = tenet_sanctity_of_nature }
				}
			}
			add_piety = -100
			add_stress = 50
		}
		else = {
			add_stress = -30
		}
		stress_impact = {
			compassionate = minor_stress_gain
			sadistic = medium_stress_loss
		}
	}
			
	option = { # Try to raise the cub
		name = wasteland_blocker.0012.b
		scope:obstacle_province = { remove_building = bear_den_cleared }
		remove_short_term_gold = 75
		random_list = { 
			10 = {
				send_interface_toast = {
					left_icon = root
					title = wasteland_blocker.0012.b.success.toast.t
					add_character_modifier = {
						modifier = pet_bear_modifier
						years = 18
					}
				}
			}
			90 = {
				send_interface_toast = {
					left_icon = root
					title = wasteland_blocker.0012.b.failure.toast.t
				}
			}
		}
		stress_impact = {
			compassionate = minor_stress_loss
		}
	}

	option = { # Leave the cub to fend for itself
		name = wasteland_blocker.0012.c
		hidden_effect = { scope:obstacle_province = { remove_building = bear_den_cleared } }
		scope:obstacle_province = { add_building = bear_den }
		if = {
			limit = {
				OR = {
					faith_is_good = yes
					faith = { has_doctrine = tenet_sanctity_of_nature }
				}
			}
			add_piety = 100
			add_stress = -50
		}
		else = {
			add_stress = 30
		}
		stress_impact = {
			compassionate = medium_stress_gain
			callous = medium_stress_loss
		}
	}
}

## Spider Nest
wasteland_blocker.0021 = { # The Great Web
	type = character_event
	title = wasteland_blocker.0021.t
	desc = wasteland_blocker.0021.desc
	theme = hunting

	left_portrait = {
		character = root
		animation = personality_honorable
	}

	right_portrait = {
		character = scope:knight
		animation = disgust
	}
	
	immediate = {
		if = {
			limit = { 
				any_knight = { 
					is_ai = yes
					count > 0
				}
			}
			ordered_knight = {
				limit = { is_ai = yes }
				order_by = prowess
				save_scope_as = knight
			}
		}
	}

	option = { # Let us take axes to the trees, and swords to whatever survives!
		name = wasteland_blocker.0021.a
		skill = prowess
		duel = {
			skill = prowess 
			value = 14
			30 = { 
				compare_modifier = {
					value = scope:duel_value
					multiplier = 3
					min = -1
				}
				desc = wasteland_blocker.0021.a.duel_success
				send_interface_toast = {
					left_icon = root
					add_prestige = 150
					title = wasteland_blocker.0021.success.toast.t
					scope:obstacle_province = { remove_building = spider_nest_cleared }
				}
			}
			40 = {
				compare_modifier = {
					value = scope:duel_value
					multiplier = -3
					min = -35
				}
				desc = wasteland_blocker.0021.a.duel_failure
				send_interface_toast = {
					left_icon = root
					title = wasteland_blocker.0021.failure.toast.t
					add_prestige = -75
					increase_wounds_effect = { REASON = hunting_accident }
					hidden_effect = { scope:obstacle_province = { remove_building = spider_nest_cleared } }
					scope:obstacle_province = { add_building = spider_nest }
				}
			}
		}
		stress_impact = {
			craven = medium_stress_gain
			brave = minor_stress_loss
		}
	}
			
	option = { # Send for my archers, they'll soon be rid of them.
		name = wasteland_blocker.0021.b
		skill = martial
		duel = {
			skill = martial 
			value = 12
			40 = { 
				compare_modifier = {
					value = scope:duel_value
					multiplier = 2
					min = -10
				}
				desc = wasteland_blocker.0021.b.duel_success
				send_interface_toast = {
					left_icon = root
					add_prestige = 50
					title = wasteland_blocker.0021.success.toast.t
					scope:obstacle_province = { remove_building = spider_nest_cleared }
				}
			}
			30 = {
				compare_modifier = {
					value = scope:duel_value
					multiplier = -2
					min = -25
				}
				desc = wasteland_blocker.0021.b.duel_failure
				send_interface_toast = {
					left_icon = root
					title = wasteland_blocker.0021.failure.toast.t
					add_prestige = -100
					hidden_effect = { scope:obstacle_province = { remove_building = spider_nest_cleared } }
					scope:obstacle_province = { add_building = spider_nest }
				}
			}
		}
	}

	option = { # Bring me fire... we'll burn them out!
		name = wasteland_blocker.0021.c
		custom_tooltip = wasteland_blocker.0021.c.tt
		scope:obstacle_province = { remove_building = spider_nest_cleared }
		random = {
			chance = 20
			make_settlement_county_wilderness = {
				COUNTY = scope:obstacle_province.county
			}
		}
	}

	option = { # Did I mention I'm arachnophobic?
		name = wasteland_blocker.0021.d
		hidden_effect = { scope:obstacle_province = { remove_building = spider_nest_cleared } }
		scope:obstacle_province = { add_building = spider_nest }
	}
}

wasteland_blocker.0022 = { # Attercop
	type = character_event
	title = wasteland_blocker.0022.t
	desc = wasteland_blocker.0022.desc
	theme = hunting

	left_portrait = {
		character = root
		animation = stress
	}

	right_portrait = {
		character = scope:colonist
		animation = fear
	}
	
	immediate = {
		create_character = {
			template = peasant_character
			dynasty = none
			culture = scope:obstacle_province.culture
			faith = scope:obstacle_province.faith
			location = scope:obstacle_province
			gender_female_chance = 50
			save_scope_as = colonist
			after_creation = {
				remove_trait = peasant_leader
			}
		}
	}

	option = { # Devote some of my men to purge them.
		name = wasteland_blocker.0022.a
		add_character_modifier = {
			modifier = levies_aiding_colony_modifier
			years = 5
		}
		random_list = { 
			85 = {
				send_interface_toast = {
					left_icon = root
					title = wasteland_blocker.0021.success.toast.t
					scope:obstacle_province = { remove_building = spider_nest_cleared }
				}
			}
			15 = {
				send_interface_toast = {
					left_icon = root
					title = wasteland_blocker.0021.failure.toast.t
					hidden_effect = { scope:obstacle_province = { remove_building = spider_nest_cleared } }
					scope:obstacle_province = { add_building = spider_nest }
				}
			}
		}
	}
			
	option = { # I will trust this task to hired professionals.
		name = wasteland_blocker.0022.b
		remove_short_term_gold = 100
		random_list = { 
			70 = {
				send_interface_toast = {
					left_icon = root
					title = wasteland_blocker.0021.success.toast.t
					scope:obstacle_province = { remove_building = spider_nest_cleared }
				}
			}
			30 = {
				send_interface_toast = {
					left_icon = root
					title = wasteland_blocker.0021.failure.toast.t
					hidden_effect = { scope:obstacle_province = { remove_building = spider_nest_cleared } }
					scope:obstacle_province = { add_building = spider_nest }
				}
			}
		}
		stress_impact = {
			greedy = minor_stress_gain
		}
	}

	option = { # Bring me fire... we'll burn them out!
		name = wasteland_blocker.0022.c
		hidden_effect = { scope:obstacle_province = { remove_building = spider_nest_cleared } }
		scope:obstacle_province = { add_building = spider_nest }
		stress_impact = {
			compassionate = minor_stress_gain
		}
	}

	after = {
		scope:colonist = {
			silent_disappearance_effect = yes
		}
	}	

}

## Bandits
wasteland_blocker.0031 = { # The Outcasts
	type = character_event
	title = wasteland_blocker.0031.t
	desc = {
		desc = wasteland_blocker.0031.desc.1
		triggered_desc = { # Has Marshal
			trigger = { 
				any_martial_councillor = {
					count > 0
				}
			} 
			desc = wasteland_blocker.0031.desc.2.marshal
		}
		triggered_desc = { # No has Marshal
			trigger = { 
				any_martial_councillor = {
					count = 0
				}
			} 
			desc = wasteland_blocker.0031.desc.2.knight
		}
		triggered_desc = { # Has Spymaster
			trigger = { 
				any_intrigue_councillor = {
					count > 0
				}
			} 
			desc = wasteland_blocker.0031.desc.3.spymaster
		}
		triggered_desc = { # No has Spymaster
			trigger = { 
				any_intrigue_councillor = {
					count = 0
				}
			} 
			desc = wasteland_blocker.0031.desc.3.scholar
		}
	}
	theme = realm

	left_portrait = {
		character = root
		animation = personality_rational
	}

	right_portrait = {
		character = scope:spymaster
		animation = flirtation
	}

	lower_center_portrait = {
		character = scope:marshal
	}
	
	immediate = {
		if = {
			limit = {
				any_martial_councillor = {
					count > 0
				}
			}
			random_martial_councillor = {
				save_scope_as = marshal
			}
		}
		else ={
			ordered_courtier = {
				order_by = martial
				save_scope_as = marshal
			}
		}
		if = {
			limit = {
				any_intrigue_councillor = {
					count > 0
				}
			}
			random_intrigue_councillor = {
				save_scope_as = spymaster
			}
		}
		else ={
			ordered_courtier = {
				limit = { NOT = { this = scope:marshal } }
				order_by = learning
				save_scope_as = spymaster
			}
		}
	}

	option = { # I don’t care who was there first. Settle this with swords!
		name = wasteland_blocker.0031.a
		skill = martial
		duel = {
			skill = martial 
			value = 8
			40 = { 
				compare_modifier = {
					value = scope:duel_value
					multiplier = 2
					min = -10
				}
				desc = wasteland_blocker.0031.a.duel_success
				send_interface_toast = {
					left_icon = root
					add_prestige = 50
					title = wasteland_blocker.0031.success.toast.t
					scope:obstacle_province = { remove_building = bandits_cleared }
				}
			}
			30 = {
				compare_modifier = {
					value = scope:duel_value
					multiplier = -2
					min = -25
				}
				desc = wasteland_blocker.0031.a.duel_failure
				send_interface_toast = {
					left_icon = root
					title = wasteland_blocker.0031.failure.toast.t
					add_prestige = -150
					hidden_effect = { scope:obstacle_province = { remove_building = bandits_cleared } }
					scope:obstacle_province = { add_building = bandits }
				}
			}
		}
		reverse_add_opinion = {
			modifier = pleased_opinion
			opinion = 20
			target = scope:marshal
		}
		reverse_add_opinion = {
			modifier = disappointed_opinion
			opinion = -20
			target = scope:spymaster
		}
		stress_impact = {
			just = medium_stress_gain
			calm = minor_stress_gain
			patient = minor_stress_gain
			impatient = minor_stress_loss
			wrathful = minor_stress_loss
			arbitrary = minor_stress_loss
		}
	}
			
	option = { # Pardon the outlaws and restore them to their lands.
		name = wasteland_blocker.0031.b
		skill = stewardship
		duel = {
			skill = stewardship 
			value = 8
			40 = { 
				compare_modifier = {
					value = scope:duel_value
					multiplier = 2
					min = -10
				}
				desc = wasteland_blocker.0031.b.duel_success
				send_interface_toast = {
					left_icon = root
					add_prestige = 50
					title = wasteland_blocker.0031.success.toast.t
					scope:obstacle_province = { remove_building = bandits_cleared }
				}
			}
			30 = {
				compare_modifier = {
					value = scope:duel_value
					multiplier = -2
					min = -25
				}
				desc = wasteland_blocker.0031.b.duel_failure
				send_interface_toast = {
					left_icon = root
					title = wasteland_blocker.0031.failure.toast.t
					add_prestige = -150
					hidden_effect = { scope:obstacle_province = { remove_building = bandits_cleared } }
					scope:obstacle_province = { add_building = bandits }
				}
			}
		}
		reverse_add_opinion = {
			modifier = pleased_opinion
			opinion = 20
			target = scope:spymaster
		}
		reverse_add_opinion = {
			modifier = disappointed_opinion
			opinion = -20
			target = scope:marshal
		}
		stress_impact = {
			vengeful = minor_stress_gain
			callous = minor_stress_gain
			compassionate = minor_stress_loss
			forgiving = minor_stress_loss
		}
	}

	option = { # I will find the truth of the matter myself...
		name = wasteland_blocker.0031.c
		skill = diplomacy
		duel = {
			skill = diplomacy 
			value = 14
			30 = { 
				compare_modifier = {
					value = scope:duel_value
					multiplier = 3
					min = -1
				}
				desc = wasteland_blocker.0031.c.duel_success
				send_interface_toast = {
					left_icon = root
					add_prestige = 50
					title = wasteland_blocker.0031.success.toast.t
					reverse_add_opinion = {
						modifier = pleased_opinion
						opinion = 30
						target = scope:spymaster
					}
					reverse_add_opinion = {
						modifier = pleased_opinion
						opinion = 30
						target = scope:marshal
					}
					scope:obstacle_province = { remove_building = bandits_cleared }
				}
			}
			40 = {
				compare_modifier = {
					value = scope:duel_value
					multiplier = -3
					min = -35
				}
				desc = wasteland_blocker.0031.c.duel_failure
				send_interface_toast = {
					left_icon = root
					title = wasteland_blocker.0031.failure.toast.t
					reverse_add_opinion = {
						modifier = disappointed_opinion
						opinion = -30
						target = scope:spymaster
					}
					reverse_add_opinion = {
						modifier = disappointed_opinion
						opinion = -30
						target = scope:marshal
					}
					add_prestige = -150
					hidden_effect = { scope:obstacle_province = { remove_building = bandits_cleared } }
					scope:obstacle_province = { add_building = bandits }
				}
			}
		}
		stress_impact = {
			just = minor_stress_loss
			gregarious = minor_stress_loss
			patient = minor_stress_loss
			impatient = minor_stress_gain
			shy = medium_stress_gain
			arbitrary = minor_stress_gain
		}
	}

	option = { # Leave the bandits alone
		name = wasteland_blocker.0031.d
		hidden_effect = { scope:obstacle_province = { remove_building = bandits_cleared } }
		scope:obstacle_province = { add_building = bandits }
		reverse_add_opinion = {
			modifier = disappointed_opinion
			opinion = -10
			target = scope:spymaster
		}
		reverse_add_opinion = {
			modifier = disappointed_opinion
			opinion = -10
			target = scope:marshal
		}
		stress_impact = {
			lazy = minor_stress_loss
		}
	}

}

wasteland_blocker.0032 = { # The Corral
	type = character_event
	title = wasteland_blocker.0032.t
	desc = {
		triggered_desc = { # Has Marshal
			trigger = { 
				any_martial_councillor = {
					count > 0
				}
			} 
			desc = wasteland_blocker.0032.desc.marshal
		}
		triggered_desc = { # No has Marshal
			trigger = { 
				any_martial_councillor = {
					count = 0
				}
			} 
			desc = wasteland_blocker.0032.desc.knight
		}
	}
	theme = realm

	left_portrait = {
		character = root
		animation = personality_cynical
	}

	right_portrait = {
		character = scope:marshal
		animation = happiness
	}
	
	immediate = {
		if = {
			limit = {
				any_martial_councillor = {
					count > 0
				}
			}
			random_martial_councillor = {
				save_scope_as = marshal
			}
		}
		else ={
			ordered_courtier = {
				order_by = martial
				save_scope_as = marshal
			}
		}
	}

	option = { # Crush them!
		name = wasteland_blocker.0032.a
		skill = martial
		duel = {
			skill = martial 
			value = 10
			30 = { 
				compare_modifier = {
					value = scope:duel_value
					multiplier = 2
					min = -10
				}
				desc = wasteland_blocker.0032.a.duel_success
				send_interface_toast = {
					left_icon = root
					add_prestige = 50
					title = wasteland_blocker.0031.success.toast.t
					scope:obstacle_province = { remove_building = bandits_cleared }
				}
			}
			30 = {
				compare_modifier = {
					value = scope:duel_value
					multiplier = -2
					min = -25
				}
				desc = wasteland_blocker.0032.a.duel_failure
				send_interface_toast = {
					left_icon = root
					title = wasteland_blocker.0031.failure.toast.t
					add_prestige = -100
					hidden_effect = { scope:obstacle_province = { remove_building = bandits_cleared } }
					scope:obstacle_province = { add_building = bandits }
				}
			}
		}
		stress_impact = {
			calm = minor_stress_gain
			patient = minor_stress_gain
			impatient = minor_stress_loss
			wrathful = minor_stress_loss
			arbitrary = minor_stress_loss
		}
	}
			
	option = { # What if they could be persuaded to enlist?
		name = wasteland_blocker.0032.b
		skill = diplomacy
		duel = {
			skill = diplomacy 
			value = 14
			30 = {
				compare_modifier = {
					value = scope:duel_value
					multiplier = 2
					min = -15
				}
				desc = wasteland_blocker.0032.b.duel_success
				scope:obstacle_province = {
					add_province_modifier = {
						modifier = enlisted_bandits_province_modifier
						years = 30
					}
				}
				send_interface_toast = {
					left_icon = root
					title = wasteland_blocker.0031.success.toast.t
					scope:obstacle_province = { remove_building = bandits_cleared }
				}
			}
			30 = {
				compare_modifier = {
					value = scope:duel_value
					multiplier = -2
					min = -29
				}
				desc = wasteland_blocker.0032.b.duel_failure
				send_interface_toast = {
					left_icon = root
					title = wasteland_blocker.0031.failure.toast.t
					add_prestige = -150
					hidden_effect = { scope:obstacle_province = { remove_building = bandits_cleared } }
					scope:obstacle_province = { add_building = bandits }
				}
			}
		}
		stress_impact = {
			vengeful = minor_stress_gain
			forgiving = minor_stress_loss
		}
	}

	option = { # I suppose I could pay their travel expenses...
		name = wasteland_blocker.0032.c
		remove_short_term_gold = 125
		add_prestige = -25
		scope:obstacle_province = { remove_building = bandits_cleared }
		stress_impact = {
			greedy = minor_stress_gain
			generous = minor_stress_loss
			compassionate = minor_stress_loss
		}
	}

}

## Drakes
wasteland_blocker.0041 = { # Life Finds a Way
	type = character_event
	title = wasteland_blocker.0041.t
	desc = wasteland_blocker.0041.desc
	theme = hunting

	left_portrait = {
		character = root
		animation = fear
	}

	right_portrait = {
		character = scope:hammund
		animation = happiness
	}

	override_background = {
		reference = wilderness_mountains
	}
	
	immediate = {
		create_character = {
			template = peasant_character
			dynasty = none
			name = Hammund
			age = { 80 90 }
			culture = culture:woodmen
			faith = faith:faith_woodmen
			location = scope:obstacle_province
			gender_female_chance = 0
			save_scope_as = hammund
			after_creation = {
				remove_trait = peasant_leader
			}
		}
	}

	option = { # Attempt to slay the drake
		name = wasteland_blocker.0041.a
		skill = prowess
		duel = {
			skill = prowess 
			value = 18
			30 = { 
				compare_modifier = {
					value = scope:duel_value
					multiplier = 3
					min = -20
				}
				desc = wasteland_blocker.0041.a.duel_success
				send_interface_toast = {
					left_icon = root
					add_prestige = 200
					title = wasteland_blocker.0041.success.toast.t
					scope:obstacle_province = { remove_building = dragon_attack_cleared }
				}
			}
			30 = {
				compare_modifier = {
					value = scope:duel_value
					multiplier = -3
					min = -25
				}
				desc = wasteland_blocker.0041.a.duel_failure
				send_interface_toast = {
					left_icon = root
					title = wasteland_blocker.0041.failure.toast.t
					add_prestige = -100
					increase_wounds_effect = { REASON = hunting_accident }
					hidden_effect = { scope:obstacle_province = { remove_building = dragon_attack_cleared } }
					scope:obstacle_province = { add_building = dragon_attack }
				}
			}
		}
		stress_impact = {
			brave = minor_stress_loss
			craven = major_stress_gain
		}
	}
			
	option = { # Run away!
		name = wasteland_blocker.0041.b
		hidden_effect = { scope:obstacle_province = { remove_building = dragon_attack_cleared } }
		scope:obstacle_province = { add_building = dragon_attack }
		random = {
			chance = 30
			make_settlement_county_wilderness = {
				COUNTY = scope:obstacle_province.county
			}
		}
		stress_impact = {
			brave = medium_stress_gain
			craven = minor_stress_loss
		}
	}

	after = {
		scope:hammund = {
			death = { death_reason = death_burned }
		}
	}
}

wasteland_blocker.0042 = { # Drakes’ Nest
	type = character_event
	title = wasteland_blocker.0042.t
	desc = wasteland_blocker.0042.desc
	theme = realm

	left_portrait = {
		character = root
		animation = personality_honorable
	}

	right_portrait = {
		character = scope:knight
		animation = personality_bold
	}
	
	immediate = {
		random_knight = {
			limit = { is_ai = yes }
			save_scope_as = knight
		}
	}

	option = { # Succeed and be rewarded!
		name = wasteland_blocker.0042.a
		scope:knight = {
			duel = {
				skill = prowess 
				value = 18
				30 = { 
					compare_modifier = {
						value = scope:duel_value
						multiplier = 3
						min = -20
					}
					desc = wasteland_blocker.0042.a.duel_success
					root = {
						send_interface_toast = {
							left_icon = root
							scope:knight = { add_prestige = 400 }
							pay_short_term_income = {
								target = scope:knight
								years = 1
							}
							title = wasteland_blocker.0041.success.toast.t
							scope:obstacle_province = { remove_building = dragon_attack_cleared }
						}
					}
				}
				30 = {
					compare_modifier = {
						value = scope:duel_value
						multiplier = -3
						min = -25
					}
					desc = wasteland_blocker.0042.a.duel_failure
					root = {
						send_interface_toast = {
							left_icon = root
							title = wasteland_blocker.0041.failure.toast.t
							scope:knight = { death = { death_reason = death_burned } }
							hidden_effect = { scope:obstacle_province = { remove_building = dragon_attack_cleared } }
							scope:obstacle_province = { add_building = dragon_attack }
						}
					}
				}
			}
		}
		stress_impact = {
			greedy = medium_stress_gain
			generous = minor_stress_loss
		}
	}
			
	option = { # Just do it
		name = wasteland_blocker.0042.b
		reverse_add_opinion = {
			modifier = disappointed_opinion
			opinion = -30
			target = scope:knight
		}
		scope:knight = {
			duel = {
				skill = prowess 
				value = 21
				30 = { 
					compare_modifier = {
						value = scope:duel_value
						multiplier = 3
						min = -20
					}
					desc = wasteland_blocker.0042.a.duel_success
					root = {
						send_interface_toast = {
							left_icon = root
							scope:knight = { add_prestige = 500 }
							title = wasteland_blocker.0041.success.toast.t
							scope:obstacle_province = { remove_building = dragon_attack_cleared }
						}
					}
				}
				30 = {
					compare_modifier = {
						value = scope:duel_value
						multiplier = -3
						min = -25
					}
					desc = wasteland_blocker.0042.a.duel_failure
					root = {
						send_interface_toast = {
							left_icon = root
							title = wasteland_blocker.0041.failure.toast.t
							scope:knight = { death = { death_reason = death_burned } }
							hidden_effect = { scope:obstacle_province = { remove_building = dragon_attack_cleared } }
							scope:obstacle_province = { add_building = dragon_attack }
						}
					}
				}
			}
		}
		stress_impact = {
			greedy = minor_stress_loss
			generous = minor_stress_gain
		}
	}

	option = { # I shall do it myself
		name = wasteland_blocker.0042.c
		skill = prowess
		duel = {
			skill = prowess 
			value = 18
			30 = { 
				compare_modifier = {
					value = scope:duel_value
					multiplier = 3
					min = -20
				}
				desc = wasteland_blocker.0041.a.duel_success
				send_interface_toast = {
					left_icon = root
					add_prestige = 200
					title = wasteland_blocker.0041.success.toast.t
					scope:obstacle_province = { remove_building = dragon_attack_cleared }
				}
			}
			30 = {
				compare_modifier = {
					value = scope:duel_value
					multiplier = -3
					min = -25
				}
				desc = wasteland_blocker.0041.a.duel_failure
				send_interface_toast = {
					left_icon = root
					title = wasteland_blocker.0041.failure.toast.t
					add_prestige = -100
					increase_wounds_effect = { REASON = hunting_accident }
					hidden_effect = { scope:obstacle_province = { remove_building = dragon_attack_cleared } }
					scope:obstacle_province = { add_building = dragon_attack }
				}
			}
		}
		stress_impact = {
			brave = minor_stress_loss
			craven = major_stress_gain
		}
	}

	option = { # Not so fast...
		name = wasteland_blocker.0042.d
		hidden_effect = { scope:obstacle_province = { remove_building = dragon_attack_cleared } }
		scope:obstacle_province = { add_building = dragon_attack }
	}

}

## Flooded Lands
wasteland_blocker.0051 = { # Ditch and Drain
	type = character_event
	title = wasteland_blocker.0051.t
	desc = wasteland_blocker.0051.desc
	theme = realm

	left_portrait = {
		character = root
		animation = personality_rational
	}

	override_background = {
		reference = wilderness_wetlands
	}

	option = { # I shall oversee a relief effort and invest in fresh labour
		name = wasteland_blocker.0051.a
		skill = stewardship
		duel = {
			skill = stewardship 
			value = 10
			30 = { 
				compare_modifier = {
					value = scope:duel_value
					multiplier = 2
					min = -10
				}
				desc = wasteland_blocker.0051.a.duel_success
				send_interface_toast = {
					left_icon = root
					remove_short_term_gold = 100
					add_prestige = 50
					title = wasteland_blocker.0051.success.toast.t
					scope:obstacle_province = { remove_building = flooded_lands_cleared }
				}
			}
			30 = {
				compare_modifier = {
					value = scope:duel_value
					multiplier = -2
					min = -25
				}
				desc = wasteland_blocker.0051.a.duel_failure
				send_interface_toast = {
					left_icon = root
					title = wasteland_blocker.0051.failure.toast.t
					remove_short_term_gold = 200
					add_prestige = -50
					scope:obstacle_province = { remove_building = flooded_lands_cleared }
				}
			}
		}
		stress_impact = {
			diligent = minor_stress_loss
			lazy = minor_stress_gain
		}
	}

	option = { # Dedicate some troops to help reconstruct and finish the dyke
		name = wasteland_blocker.0051.b
		add_character_modifier = {
			modifier = levies_aiding_colony_modifier
			years = 5
		}
		remove_short_term_gold = 125
		scope:obstacle_province = { remove_building = flooded_lands_cleared }
	}

	option = { # Maybe this colony was doomed from the start...
		name = wasteland_blocker.0051.c
		hidden_effect = { scope:obstacle_province = { remove_building = flooded_lands_cleared } }
		scope:obstacle_province = { add_building = flooded_lands }
		random = {
			chance = 20
			make_settlement_county_wilderness = {
				COUNTY = scope:obstacle_province.county
			}
		}
	}

}

wasteland_blocker.0052 = { # Marsh Fever
	type = character_event
	title = wasteland_blocker.0052.t
	desc = wasteland_blocker.0052.desc
	theme = realm

	left_portrait = {
		character = root
		animation = stress
	}

	right_portrait = {
		character = scope:colonist
		animation = sick
	}

	override_background = {
		reference = wilderness_wetlands
	}

	trigger = {
		is_elf = no
		NOT = { has_character_flag = had_event_wasteland_blocker_0052 }
		scope:obstacle_province.county = { NOT = { has_county_modifier = colony_disease_recovery_county_modifier } }
	}

	on_trigger_fail = {
		trigger_event = wasteland_blocker.0051
	}

	immediate = {
		add_character_flag = {
			flag = had_event_wasteland_blocker_0052
			years = 20
		}
		create_character = {
			template = peasant_character
			dynasty = none
			culture = scope:obstacle_province.culture
			faith = scope:obstacle_province.faith
			location = scope:obstacle_province
			gender_female_chance = 50
			save_scope_as = colonist
			after_creation = {
				remove_trait = peasant_leader
				add_trait = ill
			}
		}
	}

	option = { # They shall get what they need.
		name = wasteland_blocker.0052.a
		remove_short_term_gold = 100
		scope:obstacle_province.county = {
			add_county_modifier = {
				modifier = colony_disease_recovery_county_modifier
				years = 2
			}
		}
		stress_impact = {
			compassionate = minor_stress_loss
			callous = minor_stress_gain
		}
	}

	option = { # I will persuade the clergy that charity is needed.
		name = wasteland_blocker.0052.b
		add_piety = -200
		scope:obstacle_province.county = {
			add_county_modifier = {
				modifier = colony_disease_recovery_county_modifier
				years = 4
			}
		}
		stress_impact = {
			greedy = minor_stress_loss
			generous = minor_stress_gain
		}
	}

	option = { # If they’d worked harder to drain the marshes this wouldn’t be a problem!
		name = wasteland_blocker.0052.c
		scope:obstacle_province.county = {
			add_county_modifier = {
				modifier = colony_disease_recovery_county_modifier
				years = 8
			}
		}
		random = {
			chance = 50
			make_settlement_county_wilderness = {
				COUNTY = scope:obstacle_province.county
			}
		}
		stress_impact = {
			compassionate = medium_stress_gain
			callous = minor_stress_loss
			sadistic = minor_stress_loss
			lazy = minor_stress_loss
		}
	}

	after = {
		scope:colonist = {
			silent_disappearance_effect = yes
		}
		hidden_effect = { scope:obstacle_province = { remove_building = flooded_lands_cleared } }
		scope:obstacle_province = { add_building = flooded_lands }
	}

}

## Collapsed Ceilings
wasteland_blocker.0053 = { # Further Cave-Ins
	type = character_event
	title = wasteland_blocker.0053.t
	desc = wasteland_blocker.0053.desc
	theme = realm

	left_portrait = {
		character = root
		animation = personality_rational
	}

	override_background = {
		reference = wilderness_underground
	}

	option = { # Just keep digging!
		name = wasteland_blocker.0053.a
		skill = stewardship
		duel = {
			skill = stewardship 
			value = 6
			30 = { 
				compare_modifier = {
					value = scope:duel_value
					multiplier = 2
					min = -10
				}
				desc = wasteland_blocker.0053.a.duel_success
				send_interface_toast = {
					left_icon = root
					title = wasteland_blocker.0053.success.toast.t
					scope:obstacle_province = { remove_building = collapsed_ceiling_cleared }
					add_prestige = 80
				}
			}
			30 = {
				compare_modifier = {
					value = scope:duel_value
					multiplier = -2
					min = -25
				}
				desc = wasteland_blocker.0053.a.duel_failure
				hidden_effect = { scope:obstacle_province = { remove_building = collapsed_ceiling_cleared } }
				send_interface_toast = {
					left_icon = root
					title = wasteland_blocker.0053.failure.toast.t
					scope:obstacle_province = { add_building = collapsed_ceiling }
					make_settlement_county_wilderness = {
						COUNTY = scope:obstacle_province.county
					}
					add_prestige = -100
				}
			}
		}
		stress_impact = {
			arbitrary = minor_stress_loss
			lazy = minor_stress_loss
		}
	}

	option = { # Hire professional engineers
		name = {
			trigger = {
				faith.religion = religion:forces_of_evil_religion
			}
			text = wasteland_blocker.0053.b_orc # Just throw more slaves at it!
		}
		name = wasteland_blocker.0053.b # Hire professional engineers
		remove_short_term_gold = 150
		scope:obstacle_province = { remove_building = collapsed_ceiling_cleared }
		stress_impact = {
			greedy = minor_stress_gain
		}
	}

	option = { # Abandon the project...
		name = wasteland_blocker.0053.c
		custom_tooltip = wasteland_blocker.0053.c.tt
		trigger = {
			is_ai = no
		}
		hidden_effect = { scope:obstacle_province = { remove_building = collapsed_ceiling_cleared } }
		scope:obstacle_province = { add_building = collapsed_ceiling }
		make_settlement_county_wilderness = {
			COUNTY = scope:obstacle_province.county
		}
		add_prestige = -100
	}

}

wasteland_blocker.0054 = { # Unexpected Treasure
	type = character_event
	title = wasteland_blocker.0054.t
	desc = wasteland_blocker.0054.desc
	theme = realm

	left_portrait = {
		character = root
		animation = personality_rational
	}

	right_portrait = {
		character = scope:steward
		animation = personality_honorable
	}

	override_background = {
		reference = wilderness_underground
	}

	immediate = {
		cp:councillor_steward = {
			save_scope_as = steward
		}
	}
	option = { # Excellent! Guards, seize all of it.
		name = wasteland_blocker.0054.a
		hidden_effect = { scope:obstacle_province = { remove_building = collapsed_ceiling_cleared } }
		add_tyranny = 10
		add_gold = 150
		scope:obstacle_province = {
			add_county_modifier = {
				modifier = governance_1054_upset_peasants_modifier
				years = 5
			}
		}
		stress_impact = {
			generous = minor_stress_gain
			just = minor_stress_gain
		}
	}

	option = { # I will take my share, the rest will be split fairly.
		name = wasteland_blocker.0054.b
		hidden_effect = { scope:obstacle_province = { remove_building = collapsed_ceiling_cleared } }
		add_gold = 60
		stress_impact = {
			greedy = medium_stress_gain
			generous = minor_stress_loss
			arbitrary = minor_stress_gain
			just = minor_stress_loss
			compassionate = minor_stress_loss
		}
		scope:obstacle_province = { 
			change_development_progress = 75
		}
	}

}

## Flooded Tunnels



## Stale Air
wasteland_blocker.0055 = { # Toxic Leak!
	type = character_event
	title = wasteland_blocker.0055.t
	desc = wasteland_blocker.0055.desc
	theme = realm

	left_portrait = {
		character = root
		animation = stress
	}

	right_portrait = {
		character = scope:colonist
		animation = sick
	}

	override_background = {
		reference = wilderness_underground
	}

	trigger = {
		is_elf = no
		NOT = { has_character_flag = had_event_wasteland_blocker_0052 }
		scope:obstacle_province.county = { NOT = { has_county_modifier = colony_disease_recovery_county_modifier } }
	}

	on_trigger_fail = {
		trigger_event = wasteland_blocker.0051
	}

	immediate = {
		add_character_flag = {
			flag = had_event_wasteland_blocker_0052
			years = 20
		}
		create_character = {
			template = peasant_character
			dynasty = none
			culture = scope:obstacle_province.culture
			faith = scope:obstacle_province.faith
			location = scope:obstacle_province
			gender_female_chance = 50
			save_scope_as = colonist
			after_creation = {
				remove_trait = peasant_leader
				add_trait = ill
			}
		}
	}

	option = { # I know what can help, you need to take the following precautions
		trigger = {
			OR = {
				trait = herbalist
				trait = lifestyle_physician
			}
		}
		name = wasteland_blocker.0055.a
		custom_tooltip = wasteland_blocker.0055.a.tt
		scope:obstacle_province.county = {
			add_county_modifier = {
				modifier = colony_disease_recovery_county_modifier
				years = 2
			}
		}
		hidden_effect = { scope:obstacle_province = { remove_building = stale_air_cleared } }
	}

	option = { # They shall get what they need.
		name = wasteland_blocker.0055.b
		custom_tooltip = wasteland_blocker.0055.b.tt
		remove_short_term_gold = 100
		scope:obstacle_province.county = {
			add_county_modifier = {
				modifier = colony_disease_recovery_county_modifier
				years = 4
			}
		}
		stress_impact = {
			compassionate = minor_stress_loss
			callous = minor_stress_gain
		}
		hidden_effect = { scope:obstacle_province = { remove_building = stale_air_cleared } }
		scope:obstacle_province = { add_building = stale_air }
	}

	option = { # You're on your own.
		name = wasteland_blocker.0055.c
		custom_tooltip = wasteland_blocker.0055.c.tt
		scope:obstacle_province.county = {
			add_county_modifier = {
				modifier = colony_disease_recovery_county_modifier
				years = 8
			}
		}
		random = {
			chance = 50
			make_settlement_county_wilderness = {
				COUNTY = scope:obstacle_province.county
			}
		}
		hidden_effect = { scope:obstacle_province = { remove_building = stale_air_cleared } }
		scope:obstacle_province = { add_building = stale_air }

		stress_impact = {
			compassionate = medium_stress_gain
			callous = minor_stress_loss
			sadistic = minor_stress_loss
			lazy = minor_stress_loss
		}
	}

	after = {
		scope:colonist = {
			silent_disappearance_effect = yes
		}
	}

}


## Strange Creatures