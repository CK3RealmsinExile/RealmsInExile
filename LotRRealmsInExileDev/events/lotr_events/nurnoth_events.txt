namespace = nurnoth

nurnoth.0001 = {
	hidden = yes

	trigger = {
		is_from_ruler_designer = no
		culture = culture:nurnoth
		faith = faith:faith_nurn_slave
		NOT = {
			any_secret = { secret_type = secret_crypto_religionist }
			exists = secret_faith
			secret_faith = faith:faith_nurn_good
		}
	}


	immediate = {
		random_list = {
			50 = {
				modifier = {
					has_trait = brave
					add = 10
				}
				modifier = {
					has_trait = just
					add = 10
				}
				modifier = {
					has_trait = stubborn
					add = 10
				}
				modifier = {
					has_trait = craven
					add = -10
				}
				modifier = {
					has_trait = paranoid
					add = -10
				}
				modifier = {
					has_trait = sadistic
					add = -10
				}
				make_character_crypto_religionist_effect = { CRYPTO_RELIGION = faith:faith_nurn_good }
			}
			50 = {
				modifier = {
					has_trait = brave
					add = -10
				}
				modifier = {
					has_trait = just
					add = -10
				}
				modifier = {
					has_trait = stubborn
					add = -10
				}
				modifier = {
					has_trait = craven
					add = 10
				}
				modifier = {
					has_trait = paranoid
					add = 10
				}
				modifier = {
					has_trait = sadistic
					add = 10
				}
			}
		}
	}

}

nurnoth.0002 = {
	title = nurnoth.0002.t
	desc = nurnoth.0002.desc
	theme = stewardship_duty_focus

	override_background = {     
		reference = lone_lands
	}

	right_portrait = {
		character = root
		animation = personality_honorable
	}

	left_portrait = {
		character = scope:slave_leader
		animation = personality_generous
	}
	

	immediate = {
		culture:nurnoth = {
			remove_culture_tradition = tradition_spartan
			remove_culture_tradition = tradition_loyal_soldiers
			add_culture_tradition = tradition_collective_lands
			if = {
				limit = {
					has_dlc_feature = legacy_of_persia
				}
				add_culture_tradition = tradition_fp3_fierce_independence
			}
		}
		hidden_effect = { 
			create_character = {
				location = root.capital_province
				culture = culture:nurnoth
				faith = faith:faith_donan
				gender = male
				age = { 30 50 }
				random_traits = no
				random_traits_list = {
					count = 2
					gregarious = {}
					ambitious = {}
					temperate  = {}
					generous = {}
					diligent = {}
					honest = {}
					compassionate = {}
					stubborn = {}
				}
				trait = just
				trait = brave
				trait = peasant_leader
				trait = education_diplomacy_4
				gender_female_chance = 0
				save_scope_as = slave_leader
			}
		}
	}

	option = { # Invite Elves from Woodland Realm
		name = nurnoth.0002.a
		custom_tooltip = nurnoth.0002.a_tt
		
		create_title_and_vassal_change = {
			type = granted
			save_scope_as = change
			add_claim_on_loss = no
		}
		title:c_henneth_anun = {
			change_title_holder = {
				holder = scope:ithilien_elf
				change = scope:change
			}
		}
		title:b_cormallen = {
			change_title_holder = {
				holder = scope:ithilien_elf
				change = scope:change
			}
		}
		title:c_coruvegil = {
			change_title_holder = {
				holder = scope:ithilien_elf
				change = scope:change
			}
		}
		title:c_asgaril = {
			change_title_holder = {
				holder = scope:ithilien_elf
				change = scope:change
			}
		}
		title:b_larnach = {
			change_title_holder = {
				holder = scope:ithilien_elf
				change = scope:change
			}
		}
		title:d_forithilien = {
			change_title_holder = {
				holder = scope:ithilien_elf
				change = scope:change
			}
		}
		custom_tooltip = nurnoth.0002.forithilien_renamed
		title:d_forithilien = { 
			set_title_name = d_elven_ithilien
			set_coa = d_elven_ithilien
			set_color_from_title = title:d_elven_ithilien
		}
		resolve_title_and_vassal_change = scope:change

		title:c_henneth_anun = {
			set_county_culture = scope:ithilien_elf.culture
			set_county_faith = scope:ithilien_elf.faith
		}
		title:c_coruvegil = {
			set_county_culture = scope:ithilien_elf.culture
			set_county_faith = scope:ithilien_elf.faith
		}
		title:c_asgaril = {
			set_county_culture = scope:ithilien_elf.culture
			set_county_faith = scope:ithilien_elf.faith
		}
		scope:ithilien_elf = {
			add_opinion = {
				target = root
				modifier = invite_elves_edhellond
				years = 10
			}
			hidden_effect = {
				add_gold = 300
				add_prestige = 750
				add_piety = 500
			}
		}

		apply_elven_influence_ithilien = yes
		title:c_henneth_anun.title_province = {
			add_building = elven_settlement_02
			add_building = wonder_henneth_annun_02_refuge
			add_building = elven_forestry_01
		}
	}
	after = {
		trigger_event = nurnoth.0002

		# Some elven characters to make sure the elf has some nice courtiers
		create_character = { 
			employer = title:c_henneth_anun.holder
			culture = culture:lasgalendrim
			faith = faith:faith_eldar
			gender = female
			age = { 100 6950 }
			random_traits = yes
		}
		create_character = {
			employer = title:c_henneth_anun.holder
			culture = culture:lasgalendrim
			faith = faith:faith_eldar
			gender = female
			age = { 100 6950 }
			random_traits = yes
		}
		create_character = {
			employer = title:c_henneth_anun.holder
			culture = culture:lasgalendrim
			faith = faith:faith_eldar
			gender = male
			age = { 100 6950 }
			random_traits = yes
		}
		create_character = { 
			employer = title:c_henneth_anun.holder
			culture = culture:lasgalendrim
			faith = faith:faith_eldar
			gender = male
			age = { 100 6950 }
			random_traits = yes
		}
	}
}

nurnoth.0002 = { # Swap over to elves in Ithilien event
	title = nurnoth.0002.t
	desc = nurnoth.0002.desc
	theme = stewardship_duty_focus

	override_background = {     
		reference = ithilien_forest_throne
	}

	right_portrait = {
		character = root
		animation = admiration
	}

	left_portrait = {
		character = title:c_henneth_anun.holder
		animation = personality_content
	}
	
	option = {
		name = nurnoth.0002.a
		ai_chance = {
			base = 100
		}
	}

	option = {
		name = nurnoth.0002.b
		set_player_character = title:c_henneth_anun.holder

		ai_chance = {
			base = 0
		}
	}
}

