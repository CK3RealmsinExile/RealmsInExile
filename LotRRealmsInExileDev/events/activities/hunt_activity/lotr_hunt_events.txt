namespace = lotr_hunt

################
#
#		lotr_hunt.0001 - 0100 Events for becoming rivals
#		lotr_hunt.0101 - 0150 Events for attempted murders
#		
#		lotr_hunt.0151 - 0200 Random Hunt Events
#
#
################

lotr_hunt.0001 = { #Bloodied Boast
	type = character_event
	title = lotr_hunt.0001.t
	desc = lotr_hunt.0001.desc
	theme = hunt_activity
	cooldown = { weeks = 1 }

	left_portrait = {
		character = root
		animation = worry
		trigger = { is_in_list = attendees }
	}

	right_portrait = {
		character = scope:host
		trigger = {
			NOR = {
				this = root
				this = scope:invalidated_culprit
			}
		}
		animation = stress
	}

	lower_center_portrait = {
		character = scope:invalidated_culprit
		trigger = {
			exists = scope:invalidated_culprit
			NOT = { scope:invalidated_culprit = root }
		}
	}

	lower_right_portrait = {
		character = scope:invalidated_flavor
		trigger = {
			exists = scope:invalidated_flavor
			NOR = {
				scope:invalidated_flavor = root
				scope:invalidated_flavor = scope:host
			}
		}
	}

	trigger = {
		# No need for invalidation ping for botched scheme targets
		NOR = {
			scope:invalidated_flavor ?= root
			scope:invalidated_culprit ?= root
		}
	}

	immediate = {
		if = {
			limit = {
				NOT = { this = scope:host }
			}
			hunt_invalidation_event_effect = yes
		}
		show_as_tooltip = {
			if = {
				limit = {
					exists = scope:invalidated_culprit
				}
				scope:invalidated_flavor = {
					add_opinion = {
						target = scope:invalidated_culprit
						modifier = attempted_murder_me_crime
					}
				}
			}
		}
	}

	option = {
		name = lotr_hunt.0001.a
		ai_chance = {
			base = 100
		}
	}

	option = {
		name = lotr_hunt.0001.a
		trigger = { this = scope:host }
		scope:activity = {
			set_variable = {
				name = hunt_invalidated
				value = flag:assassination_attempt
			}
			set_variable = {
				name = hunt_invalidated_flavor
				value = scope:invalidated_flavor
			}
			set_variable = {
				name = hunt_invalidated_culprit
				value = scope:invalidated_culprit
			}
		}
		hunt_invalidation_event_effect = yes
		ai_chance = {
			base = 25
		}
	}
}

lotr_hunt.0002 = { #Arrow in the Back
	type = character_event
	title = lotr_hunt.0002.t
	desc = lotr_hunt.0002.desc
	theme = hunt_activity
	cooldown = { weeks = 1 }

	left_portrait = {
		character = root
		animation = worry
		trigger = { is_in_list = attendees }
	}

	right_portrait = {
		character = scope:host
		trigger = {
			NOR = {
				this = root
				this = scope:invalidated_culprit
			}
		}
		animation = stress
	}

	lower_center_portrait = {
		character = scope:invalidated_culprit
		trigger = {
			exists = scope:invalidated_culprit
			NOT = { scope:invalidated_culprit = root }
		}
	}

	lower_right_portrait = {
		character = scope:invalidated_flavor
		trigger = {
			exists = scope:invalidated_flavor
			NOR = {
				scope:invalidated_flavor = root
				scope:invalidated_flavor = scope:host
			}
		}
	}

	trigger = {
		# No need for invalidation ping for botched scheme targets
		NOR = {
			scope:invalidated_flavor ?= root
			scope:invalidated_culprit ?= root
		}
	}

	immediate = {
		if = {
			limit = {
				NOT = { this = scope:host }
			}
			hunt_invalidation_event_effect = yes
		}
		show_as_tooltip = {
			if = {
				limit = {
					exists = scope:invalidated_culprit
				}
				scope:invalidated_flavor = {
					add_opinion = {
						target = scope:invalidated_culprit
						modifier = attempted_murder_me_crime
					}
				}
			}
		}
	}

	option = {
		name = lotr_hunt.0002.a
		ai_chance = {
			base = 100
		}
	}

	option = {
		name = lotr_hunt.0002.b
		trigger = { this = scope:host }
		scope:activity = {
			set_variable = {
				name = hunt_invalidated
				value = flag:assassination_attempt
			}
			set_variable = {
				name = hunt_invalidated_flavor
				value = scope:invalidated_flavor
			}
			set_variable = {
				name = hunt_invalidated_culprit
				value = scope:invalidated_culprit
			}
		}
		hunt_invalidation_event_effect = yes
		ai_chance = {
			base = 25
		}
	}
}

lotr_hunt.0003 = { #Stolen Kill
	type = character_event
	title = lotr_hunt.0003.t
	desc = lotr_hunt.0003.desc
	theme = hunt_activity
	cooldown = { weeks = 1 }

	left_portrait = {
		character = root
		animation = worry
		trigger = { is_in_list = attendees }
	}

	right_portrait = {
		character = scope:host
		trigger = {
			NOR = {
				this = root
				this = scope:invalidated_culprit
			}
		}
		animation = stress
	}

	lower_center_portrait = {
		character = scope:invalidated_culprit
		trigger = {
			exists = scope:invalidated_culprit
			NOT = { scope:invalidated_culprit = root }
		}
	}

	lower_right_portrait = {
		character = scope:invalidated_flavor
		trigger = {
			exists = scope:invalidated_flavor
			NOR = {
				scope:invalidated_flavor = root
				scope:invalidated_flavor = scope:host
			}
		}
	}

	trigger = {
		# No need for invalidation ping for botched scheme targets
		NOR = {
			scope:invalidated_flavor ?= root
			scope:invalidated_culprit ?= root
		}
	}

	immediate = {
		if = {
			limit = {
				NOT = { this = scope:host }
			}
			hunt_invalidation_event_effect = yes
		}
		show_as_tooltip = {
			if = {
				limit = {
					exists = scope:invalidated_culprit
				}
				scope:invalidated_flavor = {
					add_opinion = {
						target = scope:invalidated_culprit
						modifier = attempted_murder_me_crime
					}
				}
			}
		}
	}

	option = {
		name = lotr_hunt.0003.a
		ai_chance = {
			base = 100
		}
	}

	option = {
		name = lotr_hunt.0003.b
		trigger = { this = scope:host }
		scope:activity = {
			set_variable = {
				name = hunt_invalidated
				value = flag:assassination_attempt
			}
			set_variable = {
				name = hunt_invalidated_flavor
				value = scope:invalidated_flavor
			}
			set_variable = {
				name = hunt_invalidated_culprit
				value = scope:invalidated_culprit
			}
		}
		hunt_invalidation_event_effect = yes
		ai_chance = {
			base = 25
		}
	}
}

lotr_hunt.0004 = { #Coward’s Retreat
	type = character_event
	title = lotr_hunt.0004.t
	desc = lotr_hunt.0004.desc
	theme = hunt_activity
	cooldown = { weeks = 1 }

	left_portrait = {
		character = root
		animation = worry
		trigger = { is_in_list = attendees }
	}

	right_portrait = {
		character = scope:host
		trigger = {
			NOR = {
				this = root
				this = scope:invalidated_culprit
			}
		}
		animation = stress
	}

	lower_center_portrait = {
		character = scope:invalidated_culprit
		trigger = {
			exists = scope:invalidated_culprit
			NOT = { scope:invalidated_culprit = root }
		}
	}

	lower_right_portrait = {
		character = scope:invalidated_flavor
		trigger = {
			exists = scope:invalidated_flavor
			NOR = {
				scope:invalidated_flavor = root
				scope:invalidated_flavor = scope:host
			}
		}
	}

	trigger = {
		# No need for invalidation ping for botched scheme targets
		NOR = {
			scope:invalidated_flavor ?= root
			scope:invalidated_culprit ?= root
		}
	}

	immediate = {
		if = {
			limit = {
				NOT = { this = scope:host }
			}
			hunt_invalidation_event_effect = yes
		}
		show_as_tooltip = {
			if = {
				limit = {
					exists = scope:invalidated_culprit
				}
				scope:invalidated_flavor = {
					add_opinion = {
						target = scope:invalidated_culprit
						modifier = attempted_murder_me_crime
					}
				}
			}
		}
	}

	option = {
		name = lotr_hunt.0004.a
		ai_chance = {
			base = 100
		}
	}

	option = {
		name = lotr_hunt.0004.b
		trigger = { this = scope:host }
		scope:activity = {
			set_variable = {
				name = hunt_invalidated
				value = flag:assassination_attempt
			}
			set_variable = {
				name = hunt_invalidated_flavor
				value = scope:invalidated_flavor
			}
			set_variable = {
				name = hunt_invalidated_culprit
				value = scope:invalidated_culprit
			}
		}
		hunt_invalidation_event_effect = yes
		ai_chance = {
			base = 25
		}
	}
}

lotr_hunt.0005 = { #Drink-Spilled Duel
	type = character_event
	title = lotr_hunt.0005.t
	desc = lotr_hunt.0005.desc
	theme = hunt_activity
	cooldown = { weeks = 1 }

	left_portrait = {
		character = root
		animation = worry
		trigger = { is_in_list = attendees }
	}

	right_portrait = {
		character = scope:host
		trigger = {
			NOR = {
				this = root
				this = scope:invalidated_culprit
			}
		}
		animation = stress
	}

	lower_center_portrait = {
		character = scope:invalidated_culprit
		trigger = {
			exists = scope:invalidated_culprit
			NOT = { scope:invalidated_culprit = root }
		}
	}

	lower_right_portrait = {
		character = scope:invalidated_flavor
		trigger = {
			exists = scope:invalidated_flavor
			NOR = {
				scope:invalidated_flavor = root
				scope:invalidated_flavor = scope:host
			}
		}
	}

	trigger = {
		# No need for invalidation ping for botched scheme targets
		NOR = {
			scope:invalidated_flavor ?= root
			scope:invalidated_culprit ?= root
		}
	}

	immediate = {
		if = {
			limit = {
				NOT = { this = scope:host }
			}
			hunt_invalidation_event_effect = yes
		}
		show_as_tooltip = {
			if = {
				limit = {
					exists = scope:invalidated_culprit
				}
				scope:invalidated_flavor = {
					add_opinion = {
						target = scope:invalidated_culprit
						modifier = attempted_murder_me_crime
					}
				}
			}
		}
	}

	option = {
		name = lotr_hunt.0005.a
		ai_chance = {
			base = 100
		}
	}

	option = {
		name = lotr_hunt.0005.b
		trigger = { this = scope:host }
		scope:activity = {
			set_variable = {
				name = hunt_invalidated
				value = flag:assassination_attempt
			}
			set_variable = {
				name = hunt_invalidated_flavor
				value = scope:invalidated_flavor
			}
			set_variable = {
				name = hunt_invalidated_culprit
				value = scope:invalidated_culprit
			}
		}
		hunt_invalidation_event_effect = yes
		ai_chance = {
			base = 25
		}
	}
}

#######################
#	You encounter a big spider in Mirkwood
#	by Kyrenic
#######################

lotr_hunt.0151 = {
	type = activity_event
	content_source = realms_dlc
	title = lotr_hunt.0151.t
	desc = lotr_hunt.0151.desc
	theme = hunt_activity
	left_portrait = {
		character = root
		scripted_animation = bow_drawn
	}
	trigger = {
		is_elf = yes
		scope:activity.activity_location = { geographical_region = middleearth_west_rhovanion_mirkwood }
 	}
	
	cooldown = { years = 10 }
 
 	option = { # Fight the spider!
		name = lotr_hunt.0151.a

		duel = {
		    skill = prowess
		 	value = 10

		 	50 = {
		 		desc = lotr_hunt.0151.a.success
		 		custom_tooltip = lotr_hunt.0151.a.success.tt
		 		compare_modifier = {
		 			value = scope:duel_value
		 			multiplier = 3
		 			min = -50
		 			max = 50
		 		}
		 		trigger_event = lotr_hunt.0152
		 	}

		 	50 = {
		 		desc = lotr_hunt.0151.a.failure
		 		custom_tooltip = lotr_hunt.0151.a.failure.tt
		 		compare_modifier = {
		 			value = scope:duel_value
		 			multiplier = -3
		 			min = -50
		 			max = 50
		 		}
		 		trigger_event = lotr_hunt.0153
		 	}
		}

		ai_chance = {
			base = 100
			modifier = {
				add = 50
				OR = {
					has_trait = brave
				}
			}
			modifier = {
				add = 25
				OR = {
					has_trait = vengeful
					has_trait = stubborn
				}
			}
		}
 	}
 
 	option = { # Quietly retreat
		name = lotr_hunt.0151.b
		add_prestige = medium_prestige_loss
		ai_chance = {
			base = 100
			modifier = {
				add = 50
				OR = {
					has_trait = craven
				}
			}
			modifier = {
				add = 25
				OR = {
					has_trait = vengeful
					has_trait = stubborn
				}
			}
		}
 	}
}

#######################
#	You slay the spider
#	by Kyrenic
#######################

lotr_hunt.0152 = {
 	type = activity_event
	content_source = realms_dlc
 	title = lotr_hunt.0152.t
 	desc = lotr_hunt.0152.desc
 	theme = hunt_activity
 	left_portrait = root
 	
 	trigger = { is_elf = yes }

 	immediate = { hunt_activity_success_change_effect = { CHANGE = increase_medium } }

 	option = { # Triumph!
 		name = lotr_hunt.0152.a
 		add_prestige = medium_prestige_gain
 		add_gold = minor_gold_value
 		random_list = {
 			pick = 1
 			unique = yes
			95 = {
 			} 			
			5 = {
 			}
 		}

 		ai_chance = {
 			base = 100
 		}
 	}

 	after = {
 	}
}

#######################
#	You are beaten by the spiders
#	by Kyrenic
#######################

lotr_hunt.0153 = {
 	type = activity_event
	content_source = realms_dlc
 	title = lotr_hunt.0153.t
 	desc = lotr_hunt.0153.desc
 	theme = hunt_activity
 	left_portrait = root	

 	trigger = { is_elf = yes }

 	immediate = { hunt_activity_success_change_effect = { CHANGE = decrease_minor } }
 	option = { # Defeated...
 		name = lotr_hunt.0153.a
 		add_prestige = minor_prestige_loss
 		add_stress = minor_stress_impact_gain
 		add_trait = wounded_1
 		ai_chance = {
 			base = 100
 		}
 	}
 	after = {
 	}
}

#######################
#	You come across another hunting party
#	by Kyrenic
#######################

lotr_hunt.0154 = {
 	type = activity_event
	content_source = realms_dlc
 	title = lotr_hunt.0154.t
 	desc = lotr_hunt.0154.desc
 	theme = hunt_activity
 	left_portrait = root
	
 	trigger = { is_elf = yes }
	
	cooldown = { years = 10 }

 	option = { # Go meet them
 		name = lotr_hunt.0154.a
 		add_prestige = minor_prestige_gain
 		if = {
 			limit = { has_trait = shy }
 			add_stress = minor_stress_impact_gain
 		}
 		if = {
 			limit = { has_trait = gregarious }
 			add_stress = minor_stress_impact_loss
 		}
 		trigger_event = lotr_hunt.0155

 		ai_chance = {
 			base = 100
 			modifier = {
 				add = 100
 				OR = {
 					has_trait = gregarious
 				}
 			}
 		}
 	}

 	option = { # Leave them alone
 		name = lotr_hunt.0154.b
 		add_piety = minor_piety_gain

 		if = {
 			limit = { has_trait = shy }
 			add_stress = minor_stress_impact_loss
 		}

 		if = {
 			limit = { has_trait = gregarious }
 			add_stress = minor_stress_impact_gain
 		}

 		ai_chance = {
 			base = 100
 			modifier = {
 				add = 100
 				OR = {
 					has_trait = shy
 				}
 			}
 		}
 	}
}

#######################
#	Meeting the other hunting party
#	by Kyrenic
#######################

lotr_hunt.0155 = {
 	type = activity_event
	content_source = realms_dlc
 	title = lotr_hunt.0155.t
 	desc = lotr_hunt.0155.desc
 	theme = hunt_activity
	left_portrait = {
		character = root
		animation = laugh
	}
	
 	trigger = { is_elf = yes }

 	immediate = { hunt_activity_success_change_effect = { CHANGE = increase_minor } }

 	option = { # Say your goodbyes
 		name = lotr_hunt.0155.a

 		ai_chance = {
 			base = 100
		}
	}

 	after = { }
}

#######################
#	You meet a Huorn
#	by Kyrenic
#######################

lotr_hunt.0156 = {
 	type = activity_event
	content_source = realms_dlc
 	title = lotr_hunt.0156.t
 	desc = lotr_hunt.0156.desc
	theme = hunt_activity
 	left_portrait = root
	
	trigger = {
		is_elf = yes
		scope:activity.activity_location = { geographical_region = middleearth_west_rhovanion_mirkwood }
 	}
	
	cooldown = { years = 10 }

 	option = { # Try to reason with the Huorn
 		name = lotr_hunt.0156.a
		
 		duel = {
 			skill = diplomacy
 			value = 10

 			50 = {
 				desc = lotr_hunt.0156.a.success
 				custom_tooltip = lotr_hunt.0156.a.success.tt
 				compare_modifier = {
 					value = scope:duel_value
 					multiplier = 3
 					min = -50
 					max = 50
 				}
 				trigger_event = lotr_hunt.0157
 			}

 			50 = {
 				desc = lotr_hunt.0156.a.failure
 				custom_tooltip = lotr_hunt.0156.a.failure.tt
 				compare_modifier = {
 					value = scope:duel_value
 					multiplier = -3
 					min = -50
 					max = 50
 				}
 				trigger_event = lotr_hunt.0158
 			}
 		}

 		if = { limit = { has_trait = brave } add_stress = medium_stress_impact_gain }
 		if = { limit = { OR = { has_trait = impatient has_trait = wrathful } } add_stress = minor_stress_impact_gain }

 		ai_chance = {
 			base = 100
 			modifier = {
 				add = 100
 				OR = {
 					has_trait = calm
 					has_trait = craven
 					has_trait = patient
 				}
 			}
 			modifier = {
 				add = 100
 				diplomacy > 14
 			}
 		}
 	}

 	option = { # Slay the beast!
 		name = lotr_hunt.0156.b

 		duel = {
 			skill = prowess
 			value = 10

 			50 = {
 				desc = lotr_hunt.0156.b.success
 				custom_tooltip = lotr_hunt.0156.b.success.tt
 				compare_modifier = {
 					value = scope:duel_value
 					multiplier = 3
 					min = -50
 					max = 50
 				}
 				trigger_event = lotr_hunt.0159
 			}

 			50 = {
 				desc = lotr_hunt.0156.b.failure
 				custom_tooltip = lotr_hunt.0156.b.failure.tt
 				compare_modifier = {
 					value = scope:duel_value
 					multiplier = -3
 					min = -50
 					max = 50
 				}
 				trigger_event = lotr_hunt.0160
 			}
 		}

 		if = { limit = { has_trait = craven } add_stress = medium_stress_impact_gain }
 		if = { limit = { OR = { has_trait = patient has_trait = calm } } add_stress = minor_stress_impact_gain }

 		ai_chance = {
 			base = 100
 			modifier = {
 				add = 100
 				OR = {
 					has_trait = wrathful
 					has_trait = brave
 					has_trait = impatient
 				}
 			}
 			modifier = {
 				add = 100
 				prowess > 14
 			}
 		}
 	}
}

#######################
#	You diplomacy'd the Huorn
#	by Kyrenic
#######################

lotr_hunt.0157 = {
 	type = activity_event
	content_source = realms_dlc
 	title = lotr_hunt.0157.t
 	desc = lotr_hunt.0157.desc
 	theme = hunt_activity
 	left_portrait = root
	
	trigger = {
		is_elf = yes
		scope:activity.activity_location = { geographical_region = middleearth_west_rhovanion_mirkwood }
 	}

    immediate = { hunt_activity_success_change_effect = { CHANGE = increase_medium } }

 	option = { # You diplomacy'd the Huorn
 		name = lotr_hunt.0157.a

 		add_prestige = medium_prestige_gain
 		add_piety = minor_piety_gain

 		ai_chance = {
 			base = 100
 		}
 	}

 	after = { }
}

#######################
#	The Huorn takes one of your party
#	by Kyrenic
#######################

lotr_hunt.0158 = {
 	type = activity_event
	content_source = realms_dlc
 	title = lotr_hunt.0158.t
 	desc = lotr_hunt.0158.desc
 	theme = hunt_activity
 	left_portrait = root
	
	trigger = {
		is_elf = yes
		scope:activity.activity_location = { geographical_region = middleearth_west_rhovanion_mirkwood }
		always = no # Jamie-san - disabling until someone localises 4029 and 4030
 	}

 	immediate = { hunt_activity_success_change_effect = { CHANGE = decrease_medium } }

 	option = { # :(
 		name = lotr_hunt.0158.a

 		add_prestige = minor_prestige_loss
 		add_trait = wounded_1

 		if = {
 			limit = { NOR = { has_trait = callous has_trait = sadistic has_trait = depressed_1 has_trait = depressed_genetic } }
 			random_list = {
 				pick = 1
 				unique = yes

 				95 = {
 					custom_tooltip = lotr_hunt.0158.a.tt
 				}

 				5 = {
 					add_trait = depressed_1
 				}
 			}
 		}

 		ai_chance = {
 			base = 100
 		}
 	}

 	after = { }
}

#######################
#	You fight off the Huorn
#	by Kyrenic
#######################

lotr_hunt.0159 = {
	type = activity_event
	content_source = realms_dlc
	title = lotr_hunt.0159.t
	desc = lotr_hunt.0159.desc
	theme = hunt_activity
	left_portrait = root
	
	trigger = {
		is_elf = yes
		scope:activity.activity_location = { geographical_region = middleearth_west_rhovanion_mirkwood }
	}

	immediate = {
		hunt_activity_success_change_effect = { CHANGE = increase_minor } }

	option = { # You fought off the Huorn
		name = lotr_hunt.0159.a

		ai_chance = {
			base = 100
		}
	}

 	after = { }
}

#######################
#	You cannot compete with the Huorn
#	by Kyrenic
#######################

lotr_hunt.0160 = {
	type = activity_event
	content_source = realms_dlc
	title = lotr_hunt.0160.t
	desc = lotr_hunt.0160.desc
	theme = hunt_activity
	left_portrait = root
	
	trigger = {
		is_elf = yes
		scope:activity.activity_location = { geographical_region = middleearth_west_rhovanion_mirkwood }
	}

	immediate = { hunt_activity_success_change_effect = { CHANGE = decrease_medium } }

	option = { # You are defeated
		name = lotr_hunt.0160.a
		increase_wounds_effect = { REASON = fight }
		ai_chance = {
			base = 100
		}
	}

 	after = { }
}

#######################
#	Your Meara finds a mate
#	by Brice Underhill
#######################

lotr_hunt.0161 = {
	type = activity_event
	content_source = realms_dlc
	title = lotr_hunt.0161.t
	desc = lotr_hunt.0161.desc
	theme = hunt_activity
	left_portrait = root
	
	trigger = {
		and = {
			has_character_modifier = meara_story_modifier
			not = {
				has_character_flag = meara_mate
			}
		}
	}

	option = { # Let your horse have fun
		name = lotr_hunt.0161.a
		scope:activity = {
			add_activity_log_entry = {
				key = hunt_meara_mate_log
				character = root
				
				#Effect
				root = {
					hunt_activity_success_change_effect = { CHANGE = decrease_minor }
					stress_impact = {
						chaste = minor_stress_impact_gain
						compassionate = minor_stress_impact_loss
					}
					add_character_flag = {
						flag = meara_mate
						years = 10
					}
				}
			}
		}
		trigger_event = {
			id = warhorse.1502 #A foal is born
			days = { 330 365 }
		}

		ai_chance = {
			base = 100
			modifier = {
				add = 50
				OR = {
					has_trait = compassionate
					has_trait = lustful
				}
			}
			modifier = {
				add = 100
				has_character_modifier = bonded_with_meara_modifier
			}
		}
	}

	option = { # No time to frolick
		name = lotr_hunt.0161.b
		scope:activity = {
			add_activity_log_entry = {
				key = hunt_meara_focus_log
				character = root
				
				#Effect
				root = {
					hunter_progress_point_gain_effect = { CHANGE = 1 RANDOM_CHANGE = 1 }
					add_prestige = minor_prestige_gain
					hunt_activity_success_change_effect = { CHANGE = increase_minor }
					stress_impact = {
						compassionate = minor_stress_impact_gain
						chaste = minor_stress_impact_loss
						diligent = minor_stress_impact_loss
					}
				}
			}
		}
		ai_chance = {
			base = 100
			modifier = {
				add = 50
				OR = {
					has_trait = chaste
					has_trait = diligent
				}
			}
		}
	}
}


######################
# Marauding band of Mountain Orcs
# by Fredsch
# Compatched to version 1.9 by FilivsTerrae
######################

lotr_hunt.0162 = {
	type = activity_event
	title = lotr_hunt.0162.t
	desc = {
		desc = lotr_hunt.0162.desc
		desc = lotr_hunt.0162.desc.a
	}
	theme = hunt_activity
	
	left_portrait = {
		character = root
		animation = shock
	}
	right_portrait = {
		character = scope:enemy_commander
		animation = anger
	}
	lower_left_portrait = {
		character = scope:similar_participant
	}

	trigger = {
		faith_is_evil = no
		is_ai = no

		scope:activity = {	#Test if a suitable companion is in the hunting party
			any_attending_character = {
				NOT = { this = root }
				is_ai = yes
				#is_adult = yes
				is_lotr_adult = yes
				is_physically_able_ai_adult = yes
                can_be_knight_trigger = { ARMY_OWNER = scope:host }
			}
		}

		OR = {	#Test if there is an orc county within a range of 4 counties
			scope:activity.activity_location.county = {
				any_neighboring_county = {
					culture = { is_orc_culture = yes } 
				}
			}

			scope:activity.activity_location.county = {
				any_neighboring_county = {
					
					any_neighboring_county = {
						culture = { is_orc_culture = yes } 
					}
				}
			}

			scope:activity.activity_location.county = {
				any_neighboring_county = {
					
					any_neighboring_county = {
						
						any_neighboring_county = {
							culture = { is_orc_culture = yes } 
						}
					}
				}
			}

			scope:activity.activity_location.county = {
				any_neighboring_county = {
					
					any_neighboring_county = {
						
						any_neighboring_county = {

							any_neighboring_county = {
								culture = { is_orc_culture = yes } 
							}
						}
					}
				}
			}
		}
	}

	cooldown = { years = 10 }

	weight_multiplier = {
		base = 1
		modifier = {
			add = -0.5
			employs_court_position = master_of_hunt_court_position
		}
	}

	immediate = {
		scope:activity = { #Find a suitable character for root to hang out with on his hunt
			every_attending_character = { 
				limit = {
					NOT = { this = root }
					is_ai = yes
					#is_adult = yes
					is_lotr_adult = yes
					is_alive = yes
					is_physically_able_ai_adult = yes
					can_be_knight_trigger = { ARMY_OWNER = scope:host }
				}
				add_to_list = similar_participants
			}
		}
		random_in_list = {
			list = similar_participants

			limit = { is_knight = yes } #Preferably a knight.

			alternative_limit = { is_lotr_adult = yes } #Find someone. Anyone.
				
			save_scope_as = similar_participant
		}
			
		scope:activity.activity_location.county = {
			every_neighboring_county = {
				if = { 
					limit = { culture = { is_orc_culture = yes } } 
					add_to_list = orc_county_list
				}
				
				every_neighboring_county = {
					if = { 
						limit = { culture = { is_orc_culture = yes } } 
						add_to_list = orc_county_list
					}
					
					every_neighboring_county = {
						if = { 
							limit = { culture = { is_orc_culture = yes } } 
							add_to_list = orc_county_list
						}

						every_neighboring_county = {
							if = { 
								limit = { culture = { is_orc_culture = yes } } 
								add_to_list = orc_county_list
							}
						}
					}
				}
			}
			
			random_in_list = {
				list = orc_county_list
				save_scope_as = orc_county
			}
		}
		
		create_character = {
			template = new_commander_character				
			culture = scope:orc_county.culture
			faith = scope:orc_county.faith
			gender_female_chance = 50
			location = scope:activity.activity_location
			after_creation = {
				save_scope_as = enemy_commander
			}
		}
	}

	option = { # Fight the Orc Captain
		name = lotr_hunt.0162.a
		configure_start_single_combat_effect = {
			SC_INITIATOR = root
			SC_ATTACKER = root
			SC_DEFENDER = scope:enemy_commander
			FATALITY = always
			FIXED = no
			LOCALE = terrain_scope
			OUTPUT_EVENT = lotr_hunt.0163
			INVALIDATION_EVENT = fp1_tbc.0102
		}

		stress_impact = {
			craven = major_stress_impact_gain
			brave = minor_stress_impact_loss
			zealous = minor_stress_impact_loss
		}

		ai_chance = {
			modifier = {
				add = {
					value = root.prowess
				}
			}
			modifier = {
				add = {
					value = scope:enemy_commander.prowess
					multiply = -1
				}
			}
			modifier = {
				add = {
					value = root.ai_boldness
				}
			}
		}
	}

	option = { # Fight together + Hunter || Relevant Terrain Expert
		name = lotr_hunt.0162.b
		trigger = {
			OR = {
				AND = {
					has_trait = lifestyle_hunter
					has_trait_xp = {
						trait = lifestyle_hunter
						value >= 50
					}
				}
				AND = {
					has_trait = open_terrain_expert
					scope:activity.activity_location = {
						OR = {
							terrain = steppe
							terrain = plains
							terrain = farmlands
						}
					}	
				}
				AND = {
					has_trait = rough_terrain_expert
					scope:activity.activity_location = {
						OR = {
							terrain = hills
							terrain = mountains
							terrain = wetlands
							terrain = volcanic_plains
						}
					}	
				}
				AND = {
					has_trait = forest_fighter
					scope:activity.activity_location = {
						OR = {
							terrain = forest
							terrain = taiga
						}
					}	
				}
				AND = {
					has_trait = jungle_stalker
					scope:activity.activity_location = { terrain = jungle }	
				}
			}
		}

		duel = {
			skills = { martial prowess }
			target = scope:enemy_commander
			8 = {
				desc = lotr_hunt.0162.b.critical_success
				compare_modifier = {
					value = scope:duel_value
					multiplier = 2
					min = 1
				}
				send_interface_toast = {		
					title = lotr_hunt.0162.b.critical_success			
					add_prestige = medium_prestige_gain
			 		add_gold = minor_gold_value
					scope:similar_participant = {
						add_prestige = medium_prestige_gain
					}
					scope:enemy_commander = {
						death = {
							death_reason = death_battle
							killer = root
						}
					}
				}

				hunt_activity_success_change_effect = { CHANGE = increase_minor }
			}
			
			2 = {
				desc = lotr_hunt.0162.b.success
				compare_modifier = {
					value = scope:duel_value
					multiplier = 0.5
					min = 0.5
				}
				send_interface_toast = {	
					title = lotr_hunt.0162.b.success
					add_prestige = medium_prestige_gain
			 		add_gold = minor_gold_value
					increase_wounds_no_death_effect = { REASON = battle }
					scope:similar_participant = {
						death = {
							death_reason = death_battle
							killer = scope:enemy_commander
						}
					}
					scope:enemy_commander = {
						death = {
							death_reason = death_battle
							killer = root
						}
					}
				}

				hunt_activity_success_change_effect = { CHANGE = decrease_minor }
			}

			2 = {
				desc = lotr_hunt.0162.b.failure
				compare_modifier = {
					value = scope:duel_value
					multiplier = -0.5
				}
				send_interface_toast = {	
					title = lotr_hunt.0162.b.failure
					add_prestige = medium_prestige_loss
					increase_wounds_no_death_effect = { REASON = battle }
					scope:similar_participant = {
						add_prestige = medium_prestige_loss
						increase_wounds_no_death_effect = { REASON = battle }
					}
				}

				scope:activity.activity_location.county = {
					add_county_modifier = {
						modifier = recently_looted_modifier
						months = 3
					}
				}

				hunt_activity_success_change_effect = { CHANGE = decrease_major }
			}
		}
		
		stress_impact = {
			craven = minor_stress_impact_gain
			brave = minor_stress_impact_loss
			zealous = minor_stress_impact_loss
		}

		ai_chance = {
			base = 5
			modifier = {
                add = {
					value = root.prowess
				}
            }
            modifier = {
                add = {
					value = scope:enemy_commander.prowess
					multiply = -1
				} 
            }
			modifier = {
				add = {
					value = root.martial
				}
			}
			modifier = {
				add = {
					value = scope:enemy_commander.martial
					multiply = -1
				}
			}
		}
	}

	option = { # Fight together
		name = lotr_hunt.0162.c
		
		duel = {
			skills = { martial prowess }
			target = scope:enemy_commander
			4 = {
				desc = lotr_hunt.0162.c.critical_success
				compare_modifier = {
					value = scope:duel_value
					min = 0.5
				}
				send_interface_toast = {		
					title = lotr_hunt.0162.c.critical_success			
					add_prestige = medium_prestige_gain
			 		add_gold = minor_gold_value
					scope:similar_participant = {
						add_prestige = medium_prestige_gain
					}
					scope:enemy_commander = {
						death = {
							death_reason = death_battle
							killer = root
						}
					}
				}

				hunt_activity_success_change_effect = { CHANGE = increase_minor }
			}
			
			2 = {
				desc = lotr_hunt.0162.c.success
				compare_modifier = {
					value = scope:duel_value
					multiplier = 0.5
					min = 0.5
				}
				send_interface_toast = {	
					title = lotr_hunt.0162.c.success
					add_prestige = medium_prestige_gain
			 		add_gold = minor_gold_value
					increase_wounds_no_death_effect = { REASON = battle }
					scope:similar_participant = {
						death = {
							death_reason = death_battle
							killer = scope:enemy_commander
						}
					}
					scope:enemy_commander = {
						death = {
							death_reason = death_battle
							killer = root
						}
					}
				}

				hunt_activity_success_change_effect = { CHANGE = decrease_minor }
			}
			
			4 = {
				desc = lotr_hunt.0162.c.failure
				compare_modifier = {
					value = scope:duel_value
					multiplier = -0.5
				}
				send_interface_toast = {	
					title = lotr_hunt.0162.c.failure
					add_prestige = medium_prestige_loss
					increase_wounds_no_death_effect = { REASON = battle }
					scope:similar_participant = {
						add_prestige = medium_prestige_loss
						increase_wounds_no_death_effect = { REASON = battle }
					}
				}

				scope:activity.activity_location.county = {
					add_county_modifier = {
						modifier = recently_looted_modifier
						months = 3
					}
				}

				hunt_activity_success_change_effect = { CHANGE = decrease_major }
			}
		}
		
		stress_impact = {
			craven = minor_stress_impact_gain
			brave = minor_stress_impact_loss
			zealous = minor_stress_impact_loss
		}
		
		ai_chance = {
			modifier = {
                add = {
					value = root.prowess
				}
            }
            modifier = {
                add = {
					value = scope:enemy_commander.prowess
					multiply = -1
				} 
            }
			modifier = {
				add = {
					value = root.martial
				}
			}
			modifier = {
				add = {
					value = scope:enemy_commander.martial
					multiply = -1
				}
			}
		}
	}

	option = { # Retreat
		name = lotr_hunt.0162.d
		add_prestige = major_prestige_loss
		
		scope:activity.activity_location.county = {
			add_county_modifier = {
				modifier = recently_looted_modifier
				months = 7
			}
		}

		hunt_activity_success_change_effect = { CHANGE = decrease_major }
		
		stress_impact = {
			craven = minor_stress_impact_loss
			brave = minor_stress_impact_gain
			zealous = minor_stress_impact_gain
		}
		
		ai_chance = {
			modifier = {
                add = {
					value = root.prowess
				}
            }
            modifier = {
                add = {
					value = scope:enemy_commander.prowess
					multiply = -1
				} 
            }
			modifier = {
				add = {
					value = root.martial
				}
			}
			modifier = {
				add = {
					value = scope:enemy_commander.martial
					multiply = -1
				}
			}
			modifier = {
				add = {
					value = root.ai_boldness
					multiply = -1
				}
			}
		}
	}

 	after = { }
}

lotr_hunt.0163 = {
	type = activity_event
	title = lotr_hunt.0163.t
	desc = lotr_hunt.0163.desc
	theme = hunt_activity
	override_background = { reference = battlefield }

	trigger = { is_landed = yes }	#prevents this event firing for the RNG Orc commander if it wins the single combat.  Without this line, the event fires for the orc and the error log complains.
	
	left_portrait = {
		character = root
		animation = celebrate_sword
	}

	option = { # Continue hunt
		name = lotr_hunt.0163.a

		add_prestige = medium_prestige_gain
 		add_gold = minor_gold_value
		hunt_activity_success_change_effect = { CHANGE = increase_minor }

		ai_chance = { base = 1 }
	}

	#Option 2: declare hunt already successful and take orc skull/teeth/bones as trophy?

 	after = { }
}
