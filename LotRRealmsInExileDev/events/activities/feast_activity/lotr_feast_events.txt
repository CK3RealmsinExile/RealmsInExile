namespace = lotr_feast

################
#
#		### Orc Feast Events ###
#		lotr_feast.0050 - 0100 Events for becoming rivals 
#		lotr_feast.0101 - 0150 Events for attempted murders
#
#		### Elven Feast Events ###
#		lotr_feast.1000 - 1200
################   
# rival_tried_to_kill_me
# rival_grave_insult
# rival_attacked_dissent
# rival_historical
#  
########################
### ORC FEAST EVENTS ###
########################

scripted_trigger character_is_orc_and_adult = {
	is_orc = yes	# is_orc includes is_goblin
	is_lotr_adult = yes
	NOT = { this = root }
}

scripted_trigger orc_has_any_relationships_with_root = {
	has_relation_rival = root
	has_relation_nemesis = root
	has_relation_soulmate = root
	has_relation_lover = root
	has_relation_best_friend = root
	has_relation_friend = root
	has_relation_blood_brother = root
}

lotr_feast.0001 = {  # The Orc Draught
	content_source = realms_dlc
	
	type = activity_event
	title = lotr_feast.0001.t
	desc = lotr_feast.0001.desc
	theme = feast_activity

	left_portrait = {
		character = root
		animation = happiness
	}

	right_portrait = {
		character = scope:orc_participant
		animation = laugh
	}

	cooldown = { years = 1 }

	trigger = {
		is_orc = yes	# is_orc includes is_goblin
		NOR = {
			has_character_modifier = empowered_by_orc_brew_1_modifier
			has_character_modifier = empowered_by_orc_brew_2_modifier
			has_character_modifier = empowered_by_orc_brew_3_modifier
			has_character_modifier = empowered_by_orc_brew_4_modifier
		}
		# We check if any character is valid
		involved_activity = {
			any_attending_character = {
				character_is_orc_and_adult = yes
			}
		}
	}

	weight_multiplier = {
		base = 1
		
		# Some characters are more prone to drinking.
		## Gluttonous.
		modifier = {
			add = 0.25
			has_trait = gluttonous
		}
		## Drunkard.
		modifier = {
			add = 0.25
			has_trait = drunkard
		}
	}

	immediate = {
		involved_activity = {
			random_attending_character = {
				limit = { character_is_orc_and_adult = yes }
				save_scope_as = orc_participant
			}
		}
	}

	option = {  # drink more brew
		name = lotr_feast.0001.a

		random_list = {
			30 = {
				add_character_modifier = {
					modifier = empowered_by_orc_brew_1_modifier
					years = 2
				}
			}

			30 = {
				add_character_modifier = {
					modifier = empowered_by_orc_brew_2_modifier
					years = 2
				}
			}

			30 = {
				add_character_modifier = {
					modifier = empowered_by_orc_brew_3_modifier
					years = 2
				}
			}

			10 = {
				add_character_modifier = {
					modifier = empowered_by_orc_brew_4_modifier
					years = 2
				}
			}			
		}

		random_list = {
			95 = { # nothing happens
			}

			5 = { # adding drunkard trait
				add_trait = drunkard
			}
		}
	}

	option = {  # one was enough
		name = lotr_feast.0001.b

		stress_impact = {
			temperate = minor_stress_loss
			gluttonous = minor_stress_gain	
			drunkard = medium_stress_gain	
		}
	}
}

lotr_feast.0050 = { #Challenge Across the Table
	type = activity_event
	title = lotr_feast.0050.t
	desc = lotr_feast.0050.desc
	theme = feast_activity

	left_portrait = {
		character = root
		animation = admiration
	}

	right_portrait = {
		character = scope:orc_potential_rival
		animation = shock
	}

	cooldown = { years = 1 }

	trigger = {
		is_orc = yes

		# We check if any character is valid
		involved_activity = {
			any_attending_character = {
				character_is_orc_and_adult = yes
				orc_has_any_relationships_with_root = no
			}
		}
	}

	immediate = {
		scope:activity = {
			random_attending_character = {
				limit = {
					character_is_orc_and_adult = yes
					orc_has_any_relationships_with_root = no
				}
				save_scope_as = orc_potential_rival
			}
		}
	}

	option = {
		name = lotr_feast.0050.a
		ai_chance = { base = 100 }

		set_relation_rival = {
			target = scope:orc_potential_rival
			reason = rival_food_fight
		}
		add_prestige = minor_prestige_gain
	}

	option = {
		name = lotr_feast.0050.b
		ai_chance = { base = 0 }
		remove_short_term_gold = minor_gold_value
	}
}

lotr_feast.0051 = { #The Overturned Table
	type = activity_event
	title = lotr_feast.0051.t
	desc = lotr_feast.0051.desc
	theme = feast_activity

	left_portrait = {
		character = root
		animation = admiration
	}

	right_portrait = {
		character = scope:orc_potential_rival
		animation = shock
	}

	cooldown = { years = 1 }

	trigger = {
		is_orc = yes

		# We check if any character is valid
		involved_activity = {
			any_attending_character = {
				character_is_orc_and_adult = yes
				orc_has_any_relationships_with_root = no
			}
		}
	}

	immediate = {
		scope:activity = {
			random_attending_character = {
				limit = {
					character_is_orc_and_adult = yes
					orc_has_any_relationships_with_root = no
				}
				save_scope_as = orc_potential_rival
			}
		}
	}

	option = { # Prestige reward, rivalry/nemesis formed
		name = lotr_feast.0051.a
		ai_chance = { base = 100 }

		set_relation_rival = {
			target = scope:orc_potential_rival
			reason = rival_food_fight
		}
		add_prestige = minor_prestige_gain
	}

	option = { # Lose gold to replace destroyed feast food
		name = lotr_feast.0051.b
		ai_chance = { base = 0 }
		remove_short_term_gold = minor_gold_value

	}
}

lotr_feast.0052 = { #Loud Lies
	type = activity_event
	title = lotr_feast.0052.t
	desc = lotr_feast.0052.desc
	theme = feast_activity
	left_portrait = {
		character = root
		animation = admiration
	}

	right_portrait = {
		character = scope:orc_potential_rival
		animation = shock
	}

	cooldown = { years = 1 }

	trigger = {
		is_orc = yes
		# We check if any character is valid
		involved_activity = {
			any_attending_character = {
				character_is_orc_and_adult = yes
				orc_has_any_relationships_with_root = no
			}
		}
	}

	immediate = {
		scope:activity = {
			random_attending_character = {
				limit = {
					character_is_orc_and_adult = yes
					orc_has_any_relationships_with_root = no
				}
				save_scope_as = orc_potential_rival
			}
		}
	}

	option = { # Gain prestige, rivalry/nemesis
		name = lotr_feast.0052.a
		ai_chance = { base = 100 }
		set_relation_rival = {
			target = scope:orc_potential_rival
			reason = rival_grave_insult
		}
		duel = {
			skills = { prowess martial }
			value = decent_skill_rating
			# Success.
			50 = {
				compare_modifier = {
					value = scope:duel_value
					multiplier = 0.5
				}
				send_interface_toast = {
					type = event_toast_text_and_effect_good
					title = lotr_feast.0052.positive.t
					desc = lotr_feast.0052.positive.desc
					left_icon = root
					scope:orc_potential_rival = { increase_wounds_no_death_effect = { REASON = fight } }
					add_prestige = minor_prestige_gain
				}
			}
			# Failure.
			50 = {
				compare_modifier = {
					value = scope:duel_value
					multiplier = -0.5
				}
				send_interface_toast = {
					type = event_toast_text_and_effect_bad
					title = lotr_feast.0052.negative.t
					desc = lotr_feast.0052.negative.desc
					left_icon = root
					add_stress = minor_stress_gain
					increase_wounds_no_death_effect = { REASON = fight }
					add_prestige = minor_prestige_loss
				}
			}
		}
	}

	option = { # Lose prestige
		name = lotr_feast.0052.b
		ai_chance = { base = 0 }
		add_prestige = medium_prestige_loss
	}
}

lotr_feast.0053 = { #Burned Brag
	type = activity_event
	title = lotr_feast.0053.t
	desc = lotr_feast.0053.desc
	theme = feast_activity

	left_portrait = {
		character = root
		animation = admiration
	}

	right_portrait = {
		character = scope:orc_potential_rival
		animation = shock
	}

	cooldown = { years = 1 }

	trigger = {
		is_orc = yes

		# We check if any character is valid
		involved_activity = {
			any_attending_character = {
				character_is_orc_and_adult = yes
				orc_has_any_relationships_with_root = no
			}
		}
	}

	weight_multiplier = {
		base = 1
	}

	immediate = {
		scope:activity = {
			random_attending_character = {
				limit = {
					character_is_orc_and_adult = yes
					orc_has_any_relationships_with_root = no
				}
				save_scope_as = orc_potential_rival
			}
		}
	}

	option = {
		name = lotr_feast.0053.a
		ai_chance = { base = 100 }
		set_relation_rival = {
			target = scope:orc_potential_rival
			reason = rival_grave_insult
		}

		duel = {
			skill = prowess
			value = decent_skill_rating
			# Success.
			50 = {
				compare_modifier = {
					value = scope:duel_value
					multiplier = 0.5
				}
				send_interface_toast = {
					type = event_toast_text_and_effect_good
					title = lotr_feast.0053.positive.t
					desc = lotr_feast.0053.positive.desc
					left_icon = root
					scope:orc_potential_rival = { increase_wounds_no_death_effect = { REASON = fight } }
					add_prestige = minor_prestige_gain
				}
			}
			# Failure.
			50 = {
				compare_modifier = {
					value = scope:duel_value
					multiplier = -0.5
				}
				send_interface_toast = {
					type = event_toast_text_and_effect_bad
					title = lotr_feast.0053.negative.t
					desc = lotr_feast.0053.negative.desc
					left_icon = root
					add_stress = minor_stress_gain
					increase_wounds_no_death_effect = { REASON = fight }
					add_prestige = minor_prestige_loss
				}
			}
		}
	}

	option = {
		name = lotr_feast.0053.b
		ai_chance = { base = 0 }
		add_prestige = medium_prestige_loss
	}
}

lotr_feast.0054 = { #Dance of Insults
	type = activity_event
	title = lotr_feast.0054.t
	desc = lotr_feast.0054.desc
	theme = feast_activity

	left_portrait = {
		character = root
		animation = admiration
	}

	right_portrait = {
		character = scope:orc_potential_rival
		animation = shock
	}

	cooldown = { years = 1 }

	trigger = {
		is_orc = yes

		involved_activity = {
			any_attending_character = {
				character_is_orc_and_adult = yes
				orc_has_any_relationships_with_root = no
			}
		}
	}

	immediate = {
		scope:activity = {
			random_attending_character = {
				limit = {
					character_is_orc_and_adult = yes
					orc_has_any_relationships_with_root = no
				}
				save_scope_as = orc_potential_rival
			}
		}
	}

	option = { # Gain prestige, rivalry/nemesis
		name = lotr_feast.0054.a
		ai_chance = { base = 100 }
		set_relation_rival = {
			target = scope:orc_potential_rival
			reason = rival_grave_insult
		}
		duel = {
			skills = { prowess diplomacy }
			value = decent_skill_rating
			# Success.
			50 = {
				compare_modifier = {
					value = scope:duel_value
					multiplier = 0.5
				}
				send_interface_toast = {
					type = event_toast_text_and_effect_good
					title = lotr_feast.0054.positive.t
					desc = lotr_feast.0054.positive.desc
					left_icon = root
					scope:orc_potential_rival = { increase_wounds_no_death_effect = { REASON = fight } }
					add_prestige = minor_prestige_gain
				}
			}
			# Failure.
			50 = {
				compare_modifier = {
					value = scope:duel_value
					multiplier = -0.5
				}
				send_interface_toast = {
					type = event_toast_text_and_effect_bad
					title = lotr_feast.0054.negative.t
					desc = lotr_feast.0054.negative.desc
					left_icon = root
					add_stress = minor_stress_gain
					increase_wounds_no_death_effect = { REASON = fight }
					add_prestige = minor_prestige_loss
				}
			}
		}
	}

	option = { # Lose prestige
		name = lotr_feast.0054.b
		ai_chance = { base = 0 }
		add_prestige = medium_prestige_loss
	}
}

##########################
### Elven Feast Events ###
##########################

# Motivating Speeach ~ Aerien
lotr_feast.1000 = {
	type = activity_event
	title = lotr_feast.1000.t
	desc = lotr_feast.1000.desc
	theme = feast_activity
	left_portrait = {
		character = root
		animation = storyteller
	}
	center_portrait = {
		character = scope:listening_elf
		animation = interested
	}
	right_portrait = {
		character = scope:attentive_elf
		animation = personality_callous
	}

	cooldown = { years = 1 }

	trigger = {
		# Correct intent for raising hope
		is_elf = yes
	}
	
	immediate = {
		scope:activity = {
			random_attending_character = { 
				limit = { NOT = { this = root } }
				save_scope_as = listening_elf 
			}
			random_attending_character = {
				limit = { NOT = { this = root } }
				save_scope_as = attentive_elf 
			}
		}
	}
	
	option = { # Make a speech to raise hope
		name = lotr_feast.0050.a 
		add_elven_hope_effect = { VALUE = minor_elven_hope_gain HOPE_EFFECT = effect_elven_hope_inspiring_speech }
	}
	
	option = { # Just enjoy the atmosphere instead
		name = lotr_feast.1000.b
		add_stress = -30
	}
}
