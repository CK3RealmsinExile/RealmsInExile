namespace = lotr_feast

## Orc Feast Events
#   lotr_feast.0001  -   The Orc Draught  - Sakkar 

## Elven Feast Events
#	lotr_feast.0050  -   Motivating Speeach ~ Aerien

########################
### ORC FEAST EVENTS ###
########################

scripted_trigger orc_feast_0001_orc_trigger = {
	is_orc = yes	# is_orc includes is_goblin
	is_adult = yes
	NOT = { this = root }
}

lotr_feast.0001 = {  # The Orc Draught
	content_source = realms_dlc
	orphan = yes
	
	type = activity_event
	title = lotr_feast.0001.t
	desc = lotr_feast.0001.desc
	theme = feast_activity

	left_portrait = {
		character = root
		animation = happiness
	}

	right_portrait = {
		character = scope:orc_participant
		animation = laugh
	}

	cooldown = { years = 1 }

	trigger = {
		is_orc = yes	# is_orc includes is_goblin
		NOR = {
			has_character_modifier = empowered_by_orc_brew_1_modifier
			has_character_modifier = empowered_by_orc_brew_2_modifier
			has_character_modifier = empowered_by_orc_brew_3_modifier
			has_character_modifier = empowered_by_orc_brew_4_modifier
		}
		# We check if any character is valid
		involved_activity = {
			any_attending_character = {
				orc_feast_0001_orc_trigger = yes
			}
		}
	}

	weight_multiplier = {
		base = 1
		
		# Some characters are more prone to drinking.
		## Gluttonous.
		modifier = {
			add = 0.25
			has_trait = gluttonous
		}
		## Drunkard.
		modifier = {
			add = 0.25
			has_trait = drunkard
		}
	}

	immediate = {
		involved_activity = {
			random_attending_character = {
				limit = { orc_feast_0001_orc_trigger = yes }
				save_scope_as = orc_participant
			}
		}
	}

	option = {  # drink more brew
		name = lotr_feast.0001.a

		random_list = {
			30 = {
				add_character_modifier = {
					modifier = empowered_by_orc_brew_1_modifier
					years = 2
				}
			}

			30 = {
				add_character_modifier = {
					modifier = empowered_by_orc_brew_2_modifier
					years = 2
				}
			}

			30 = {
				add_character_modifier = {
					modifier = empowered_by_orc_brew_3_modifier
					years = 2
				}
			}

			10 = {
				add_character_modifier = {
					modifier = empowered_by_orc_brew_4_modifier
					years = 2
				}
			}			
		}

		random_list = {
			95 = { # nothing happens
			}

			5 = { # adding drunkard trait
				add_trait = drunkard
			}
		}
	}

	option = {  # one was enough
		name = lotr_feast.0001.b

		stress_impact = {
			temperate = minor_stress_loss
			gluttonous = minor_stress_gain	
			drunkard = medium_stress_gain	
		}
	}
}

#### Elven Feast Events ####

# Motivating Speech
lotr_feast.0050 = {
	type = activity_event
	title = lotr_feast.0050.t
	desc = lotr_feast.0050.desc
	theme = feast_activity
	left_portrait = {
		character = root
		animation = storyteller
	}
	center_portrait = {
		character = scope:listening_elf
		animation = interested
	}
	right_portrait = {
		character = scope:attentive_elf
		animation = personality_callous
	}

	cooldown = { years = 1 }

	trigger = {
		# Correct intent for raising hope
		has_activity_intent = inspire_hope_intent
	}
	
	immediate = {
		scope:activity = {
			random_attending_character = { 
				limit = { NOT = { this = root } }
				save_scope_as = listening_elf 
			}
			random_attending_character = {
				limit = { NOT = { this = root } }
				save_scope_as = attentive_elf 
			}
		}
	}
	
	option = { # Make a speech to raise hope
		name = lotr_feast.0050.a 
		add_elven_hope_effect = { VALUE = minor_elven_hope_gain HOPE_EFFECT = effect_elven_very_low_hope }
	}
	
	option = { # Just enjoy the atmosphere instead
		name = lotr_feast.0050.b
		add_stress = -30
	}
}