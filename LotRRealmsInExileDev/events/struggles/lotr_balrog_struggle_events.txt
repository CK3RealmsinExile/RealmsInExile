namespace = balrog_struggle

# 0000-0999 - Maintenance
# 1000-1999 - Decision Events
# 2000-2999 - Minor Balrog Events
# 3000-3999 - Major Balrog Events
# 4000-4999 - Armageddon Balrog Events

## Decisions Events
# Serve the Balrog ending decision event - attmept
balrog_struggle.1001 = {
	content_source = realms_dlc
	type = character_event
	title = balrog_struggle.1001.t
	desc = balrog_struggle.1001.desc
	theme = faith
	override_background = {
		reference = mining_activity
	}

	right_portrait = {
		character = root
		animation = personality_honorable
	}
	
	option = {
		name = balrog_struggle.1001.a
		duel = {
			skill = learning
			value = 20
			20 = {
				compare_modifier = {
					value = scope:duel_value
					multiplier = 2
				}
				trigger_event = balrog_struggle.1002
				show_as_tooltip = {
					get_title = title:e_servants_of_the_dark_flame
					give_nickname = nick_flamesworn
					custom_tooltip = {
						text = balrog_struggle.1002.effect3
					}
					custom_tooltip = {
						text = balrog_struggle.1002.effect
					}
					add_prestige = 1000
					add_piety = 750
					dynasty = { 
						add_dynasty_prestige = 750
						add_dynasty_prestige_level = 1
					}
					faith:faith_balrog_cult = {
						add_doctrine = doctrine_temporal_head
					}
				}
			}

			20 = {
				compare_modifier = {
					value = scope:duel_value
					multiplier = -1
				}
				trigger_event = balrog_struggle.1003
				show_as_tooltip = {
					death = {
						death_reason = death_burned
					}
				}
			}
		}
	}
	
	option = {
		name = balrog_struggle.1001.b
		duel = {
			skill = diplomacy
			value = 20
			20 = {
				compare_modifier = {
					value = scope:duel_value
					multiplier = 2
				}
				trigger_event = balrog_struggle.1002
				show_as_tooltip = {
					get_title = title:e_servants_of_the_dark_flame
					give_nickname = nick_flamesworn
					custom_tooltip = {
						text = balrog_struggle.1002.effect3
					}
					custom_tooltip = {
						text = balrog_struggle.1002.effect
					}
					add_prestige = 1000
					add_piety = 750
					dynasty = { 
						add_dynasty_prestige = 750
						add_dynasty_prestige_level = 1
					}
					faith:faith_balrog_cult = {
						add_doctrine = doctrine_temporal_head
					}
				}
			}

			20 = {
				compare_modifier = {
					value = scope:duel_value
					multiplier = -1
				}
				trigger_event = balrog_struggle.1003
				show_as_tooltip = {
					death = {
						death_reason = death_burned
					}
				}
			}
		}
	}
	
	option = {
		name = balrog_struggle.1001.c
	}
}

# Serve the Balrog ending decision event - success
balrog_struggle.1002 = {
	content_source = realms_dlc
	type = character_event
	title = balrog_struggle.1002.t
	desc = balrog_struggle.1002.desc
	theme = faith
	override_background = {
		reference = mining_activity
	}

	right_portrait = {
		character = root
		animation = personality_bold
	}
	
	option = {
		name = balrog_struggle.1002.a
		get_title = title:e_servants_of_the_dark_flame
		give_nickname = nick_flamesworn
		custom_tooltip = {
			text = balrog_struggle.1002.effect3
		}
		custom_tooltip = {
			text = balrog_struggle.1002.effect
		}
		add_prestige = 1000
		add_piety = 750
		dynasty = { 
			add_dynasty_prestige = 750
			add_dynasty_prestige_level = 1
		}
		faith:faith_balrog_cult = {
			add_doctrine = doctrine_temporal_head
		}
	}

	after = {
		faith:faith_balrog_cult = {
			custom_tooltip = {
				text = balrog_struggle.1002.effect2
				set_religious_head_title = title:e_servants_of_the_dark_flame
			}
		}
	}
}

# Serve the Balrog ending decision event - failure
balrog_struggle.1003 = {
	content_source = realms_dlc
	type = character_event
	title = balrog_struggle.1003.t
	desc = balrog_struggle.1003.desc
	theme = faith
	override_background = {
		reference = mining_activity
	}

	right_portrait = {
		character = root
		animation = fear
	}
	
	option = {
		name = balrog_struggle.1003.a
		death = {
			death_reason = death_burned
		}
	}
}

## Minor Balrog Events

balrog_struggle.2001 = { # The Watching Darkness
	content_source = realms_dlc
	type = character_event
	title = balrog_struggle.2001.t
	desc = balrog_struggle.2001.desc
	theme = faith
	override_background = {
		reference = mining_activity
	}

	right_portrait = {
		character = root
		animation = paranoia
	}
	
	option = {
		name = balrog_struggle.2001.a
		stress_impact = {
			base = 25
			paranoid = 15
			craven = 15
			brave = -10
		}
		if = {
			limit = {
				has_trait = trusting
			}
			random = {
				chance = 30
				hidden_effect = {
					remove_trait = trusting
				}
				send_interface_toast = {
					title = balrog_struggle.2001.a.paranoid
					left_icon = root
					add_trait = paranoid
				}
			}
		}
		else_if = {
			limit = {
				has_trait = brave
			}
			random = {
				chance = 30
				hidden_effect = {
					remove_trait = brave
				}
				send_interface_toast = {
					title = balrog_struggle.2001.a.craven
					left_icon = root
					add_trait = craven
				}
			}
		}
		else_if = {
			limit = {
				NOT = { has_trait = lunatic_1 }
			}
			random = {
				chance = 10
				send_interface_toast = {
					title = balrog_struggle.2001.a.lunatic
					left_icon = root
					add_trait = lunatic_1
				}
			}
		}
	}
}

balrog_struggle.2011 = { # A Narrow Escape
	content_source = realms_dlc
	type = character_event
	title = balrog_struggle.2011.t
	desc = balrog_struggle.2011.desc
	theme = faith
	override_background = {
		reference = mining_activity
	}

	right_portrait = {
		character = root
		animation = pain
	}
	
	option = {
		name = balrog_struggle.2011.a
		stress_impact = {
			base = 25
			craven = 15
			brave = -10
		}
		random = {
			chance = 35
			send_interface_toast = {
				title = balrog_struggle.2011.a.wounds
				left_icon = root
				increase_wounds_no_death_effect = { REASON = wounds }
			}
		}
	}
}

balrog_struggle.2021 = { # Path of Destruction
	content_source = realms_dlc
	type = character_event
	title = balrog_struggle.2021.t
	desc = balrog_struggle.2021.desc
	theme = faith
	override_background = {
		reference = mining_activity
	}

	right_portrait = {
		character = root
		animation = stress
	}

	trigger = {
		any_held_county = { 
			title_province = {
				num_buildings > 1
				terrain = halls
			}
			kingdom = title:k_khazad_dum
		}
	}

	immediate = {
		add_stress = 10
		random_held_county = {
			limit = { 
				title_province = {
					num_buildings > 1
					terrain = halls
				}
				kingdom = title:k_khazad_dum
			}
			save_scope_as = selected_county
		}
	}
	
	option = {
		name = balrog_struggle.2021.a
		remove_short_term_gold = major_gold_value
	}

	option = {
		name = balrog_struggle.2021.b
		remove_random_building_underground = { COUNTY = scope:selected_county }
		scope:selected_county = {
			add_county_modifier = {
				modifier = lotr_balrog_path_of_destruction_county_modifier
				years = 5
			}
		}
	}
}

balrog_struggle.2171 = {
	content_source = realms_dlc
	type = character_event
	title = balrog_struggle.2171.t
	desc = balrog_struggle.2171.desc
	theme = faith
	override_background = {
		reference = mining_activity
	}

	right_portrait = {
		character = root
		animation = worry
	}

	trigger = {
		any_held_county = { 
			title_province = {
				num_buildings > 1
				terrain = halls
			}
			kingdom = title:k_khazad_dum
		}
	}

	immediate = {
		random_held_county = {
			limit = { 
				title_province = {
					num_buildings > 1
					terrain = halls
				}
				kingdom = title:k_khazad_dum
			}
			save_scope_as = selected_county
		}
	}
	
	option = { # try and save it
		name = balrog_struggle.2171.a
		duel = {
			skill = stewardship
			skill = learning
			value = 10
			
			20 = { # Win
				desc = balrog_struggle.2171.tt.win
				compare_modifier = {
					value = scope:duel_value
					multiplier = 1
				}
				remove_short_term_gold = minor_gold_value
				add_prestige = 50
				send_interface_toast = {
					title = balrog_struggle.2171.tt.1
					left_icon = root
				}
			}

			20 = { # Lose
				desc = balrog_struggle.2171.tt.lost
				compare_modifier = {
					value = scope:duel_value
					multiplier = -1
				}
				custom_tooltip = balrog_struggle.2171.tt.lost_building
				send_interface_toast = {
					title = balrog_struggle.2171.tt.2
					left_icon = root
					remove_random_building_underground = { COUNTY = scope:selected_county }
				}
			}
		}
	}

	option = { # Let it burn
		name = balrog_struggle.2171.b
		custom_tooltip = balrog_struggle.2171.tt.lost_building
		
		send_interface_toast = {
			title = balrog_struggle.2171.tt.2
			left_icon = root
			remove_random_building_underground = { COUNTY = scope:selected_county }
		}
	}
}