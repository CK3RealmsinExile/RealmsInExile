namespace = orc_government_events

####
# # Ideas #
# Young Orc challenges first challenger "Jumping in front "
# Bribe a challenger orc (hook, council positions, title, gold, claim) to not fight, based on personality traits	
# After a certain number of challengers have been slain (say 5), have a MASSIVE increase in orcs willing to just take the claim OR be bribed
#
####

##### Event IDs #####
# 
# FOR KINGS AND HIGHER
# orc_government_events.0050 - 0500 ==> Events that can reduce the number of challengers, such as bribes, other challengers, blackmail, etc.
# From the above events, only **one** event will be picked from the pool, with the player deciding they'll either bribe/blackmail, etc. OR they will actually fight.
# Gives a decent chance for a wide pool of variety, while still giving the player a chance to avoid bloodshed/reduce numbers of challengers
#
# FOR DUKES AND COUNTS
# orc_government_events.1050 - 1500
############################

##############################
### Local Scripted Effects ###
##############################
# Assumes a ""scope:new_ruler"", referring to the new ruler of the top liege title
scripted_effect refuse_orc_inheritance_duel_effect = { # Every challenger gets a Pressed claim
	add_pressed_claim = scope:new_ruler.primary_title
}

scripted_effect sort_final_orc_challenger_list_effect = {
	every_in_list = {
		variable = final_orc_challengers
		save_scope_as = challenger_char
		root = {
			add_to_variable_list = { name = temp_orc_challengers target = scope:challenger_char }
		}
	}
	
	clear_variable_list = final_orc_challengers

	while = {
		limit = {
			has_variable_list = temp_orc_challengers
			variable_list_size = {
				name = temp_orc_challengers
				value > 0
			}
		}
		root = { save_scope_as = orc_challenger_liege } 
		ordered_in_list = { #Save the character with the highest success chance
			variable = temp_orc_challengers
			order_by = {
				value = 0
				add = lotr_orc_succession_martial_weighting
				add = lotr_orc_succession_intrigue_weighting
				add = lotr_orc_succession_prowess_weighting
				add = lotr_orc_succession_learning_weighting
				add = lotr_orc_succession_relationship_weighting
				add = lotr_orc_succession_ordering_troops_weighting
				add = lotr_orc_succession_dread_weighting
			}
			max = 1
			save_scope_as = new_challenger_char
			
			root = {
				remove_list_variable = {
					name = temp_orc_challengers
					target = scope:new_challenger_char
				}
			}
		}
		if = { #Esnure we're not adding the character twice to the ordered list
			limit = {
				NOT = {
					is_target_in_variable_list = {
						name = final_orc_challengers
						target = scope:new_challenger_char
					}
				}
			}
			root = { add_to_variable_list = { name = final_orc_challengers target = scope:new_challenger_char } }
		}
	}
}

scripted_effect grab_scariest_orc_from_challenger_list_effect = {
	if = {
		limit = {
			trigger_if = {
				limit = { exists = scope:orc_fighting_ruler  scope:orc_fighting_ruler = { is_alive = yes } }
				NOT = {
					is_target_in_variable_list = {
						name = final_orc_challengers
						target = scope:orc_fighting_ruler
					}
				}
			}
		}
		ordered_in_list = {
			variable = final_orc_challengers
			order_by = {
				value = 0
				add = lotr_orc_succession_martial_weighting
				add = lotr_orc_succession_intrigue_weighting
				add = lotr_orc_succession_prowess_weighting
				add = lotr_orc_succession_learning_weighting
				add = lotr_orc_succession_relationship_weighting
				add = lotr_orc_succession_ordering_troops_weighting
				add = lotr_orc_succession_dread_weighting
			}
			max = 1
			save_scope_as = orc_fighting_ruler
		}
	}
}

scripted_effect clear_orc_challenger_variable_list_effect = {
	clear_variable_list = orc_challengers
}

scripted_effect start_orc_duel_effect = {
	lotr_orc_government_succession_single_combat_effect = {
		SC_INITIATOR = scope:orc_fighting_ruler
		SC_ATTACKER = scope:orc_fighting_ruler
		SC_DEFENDER = scope:defending_ruler
		FATALITY = always
		FIXED = no
		LOCALE = terrain_scope
		OUTPUT_EVENT = lotr_orc_government_single_combat.1006
		INVALIDATION_EVENT = lotr_orc_government_single_combat.1006
	}
}

scripted_effect proceed_to_next_orc_challenger_fight = {
	$DEFENDING_RULER$ = {
		random_in_list = {
			variable = final_orc_challengers
			limit = { this = $ORC_CHALLENGER$ }
			save_scope_as = orc_to_be_removed
		}
		remove_list_variable = {
			name = final_orc_challengers
			target = scope:orc_to_be_removed
		}

		grab_scariest_orc_from_challenger_list_effect = yes

		trigger_event = {
			on_action = lotr_orc_government_persaude_challenger_events
		}
	}
}

scripted_effect grab_cheering_orcs_effect = {
	random_courtier_or_guest = {
		save_scope_as = spectator_1
	}
	random_courtier_or_guest = {
		limit = { this != scope:spectator_1 }
		save_scope_as = spectator_2
	}
	random_courtier_or_guest = {
		limit = {
			this != scope:spectator_1
			this != scope:spectator_2
		}
		save_scope_as = spectator_3
	}
	random_courtier_or_guest = {
		limit = {
			this != scope:spectator_1
			this != scope:spectator_2
			this != scope:spectator_3
		}
		save_scope_as = spectator_4
	}
	random_courtier_or_guest = {
		limit = {
			this != scope:spectator_1
			this != scope:spectator_2
			this != scope:spectator_3
			this != scope:spectator_4
		}
		save_scope_as = spectator_5
	}
}
###############################
### Local Scripted Triggers ###
###############################
scripted_trigger orc_succession_duel_has_participants_left = {
	trigger_if = {
		limit = { has_variable_list = final_orc_challengers }
		any_in_list = {
			variable = final_orc_challengers
			is_alive = yes
		}
	}
	trigger_else = {
		always = no
	}
}

scripted_trigger orc_has_access_to_courtroom = {
	highest_held_title_tier > tier_duchy
}
### Initial setup of ""potential"" challengers for the throne
orc_government_events.0001 = {
    hidden = yes

    immediate = {
		if = {
			limit = { has_realm_law = orc_authority_1 }
			debug_log = "ORC_SUCCESSION: REALM LAW 1"
		}
		if = {
			limit = { has_realm_law = orc_authority_2 }
			debug_log = "ORC_SUCCESSION: REALM LAW 2"
		}
		if = {
			limit = { has_realm_law = orc_authority_3 }
			debug_log = "ORC_SUCCESSION: REALM LAW 3"
		}
		if = {
			limit = { has_realm_law = orc_authority_4 }
			debug_log = "ORC_SUCCESSION: REALM LAW 4"
		}
		if = {
			limit = { has_realm_law = orc_authority_5 }
			debug_log = "ORC_SUCCESSION: REALM LAW 5"
		}
        switch = {
			trigger = has_realm_law

			orc_authority_1 = { create_orc_challenger_list_authority_0 = yes debug_log = "ORC_SUCCESSION: REALM LAW 1" }
			orc_authority_2 = { create_orc_challenger_list_authority_1 = yes debug_log = "ORC_SUCCESSION: REALM LAW 2" }
			orc_authority_3 = { create_orc_challenger_list_authority_2 = yes debug_log = "ORC_SUCCESSION: REALM LAW 3" }
			orc_authority_4 = { create_orc_challenger_list_authority_3 = yes debug_log = "ORC_SUCCESSION: REALM LAW 4" }
			orc_authority_5 = { create_orc_challenger_list_authority_4 = yes debug_log = "ORC_SUCCESSION: REALM LAW 5" }
		}

        save_scope_as = new_ruler

		
        every_in_list = { # Challenger decides they DO want to challenge the new ruler
            variable = orc_challengers
			debug_log = "ORC_SUCCESSION: ITERATE ORC CHALLENGER LIST"
            trigger_event = orc_government_events.0002
        }

        ### Clean-up ###
        clear_orc_challenger_variable_list_effect = yes
		if = {
			limit = { has_variable_list = final_orc_challengers }
			trigger_event = {
				id = orc_government_events.0004
				days = 1
			}
		}
		else_if = {
			limit = { orc_has_access_to_courtroom = yes }
			set_variable = {
				name = no_orc_challenged_you
				days = 14
			}
			trigger_event = { 
				id = orc_government_events.0500
				days = 1
			}
		}
		else_if = {
			limit = { orc_has_access_to_courtroom = no }
			set_variable = {
				name = no_orc_challenged_you
				days = 14
			}
			trigger_event = { 
				id = orc_government_events.1500
				days = 1
			}
		}
    }
}

### Challenger decides on whether to accept the challenge
orc_government_events.0002 = {
    content_source = realms_dlc
	type = character_event
	title = orc_government_events.0002.t
	desc = orc_government_events.0002.desc
	theme = orcs

    right_portrait = {
		character = root 
		animation = aggressive_sword
	}

    left_portrait = {
		character = scope:new_ruler
        animation = celebrate_longaxe
    }

    option = { #Accept the challenge
        name = orc_government_events.0002.a
        scope:new_ruler = {
            add_to_variable_list = { name = final_orc_challengers target = root }
        }
		debug_log = "ORC_SUCCESSION: Accepted the challenge"

		ai_chance = {
			base = 0
		   
		   ### Powerful vassal
		    modifier = {
		   		add = 20
				is_powerful_vassal_of = scope:new_ruler
		    }
		   ### Army Strength
			modifier = {
				add = 5
				prowess < scope:new_ruler.prowess
				current_military_strength < scope:new_ruler.current_military_strength
			}
			modifier = {
				add = 10
				prowess < scope:new_ruler.prowess
				current_military_strength < scope:new_ruler.current_military_strength.mult2
			}
			modifier = {
				add = 10
				prowess > scope:new_ruler.prowess
				current_military_strength < scope:new_ruler.current_military_strength
			}
			modifier = {
				add = 20
				prowess > scope:new_ruler.prowess
				current_military_strength < scope:new_ruler.current_military_strength.mult2
			}
			modifier = {
				add = -5
				prowess > scope:new_ruler.prowess
				current_military_strength > scope:new_ruler.current_military_strength
			}
			modifier = {
				add = -10
				prowess > scope:new_ruler.prowess
				current_military_strength > scope:new_ruler.current_military_strength.mult2
			}
			modifier = {
				add = -10
				prowess < scope:new_ruler.prowess
				current_military_strength > scope:new_ruler.current_military_strength
			}
			modifier = {
				add = -20
				prowess < scope:new_ruler.prowess
				current_military_strength > scope:new_ruler.current_military_strength.mult2
			}
		   ### Prowess
		    modifier = {
				add = scope:new_ruler.prowess.div2.neg
			}
		    modifier = {
				add = prowess
			}
		   ### Education Traits + Values
		    modifier = {
				add = scope:new_ruler.martial.div3.neg
			}
		    modifier = {
				add = martial.div2
			}
			modifier = {
				add = intrigue.div2
			}
			modifier = {
				add = learning.div3
			}
			modifier = {
				add = 10
				OR = {
					has_trait = education_martial_1
					has_trait = education_martial_2
				}
			}
			modifier = {
				add = 15
				OR = {
					has_trait = education_martial_3
					has_trait = education_martial_4
				}
			}
			modifier = {
				add = 20
				has_trait = education_martial_5
			}
			modifier = {
				add = -10
				scope:new_ruler = { 
					OR = {
						has_trait = education_martial_3
						has_trait = education_martial_4
					}
				}
			}
			modifier = {
				add = -15
				scope:new_ruler = { has_trait = education_martial_5 }
			}
			modifier = {
				add = 5
				OR = {
					has_trait = education_intrigue_1
					has_trait = education_intrigue_2
				}
			}
			modifier = {
				add = 10
				OR = {
					has_trait = education_intrigue_3
					has_trait = education_intrigue_4
				}
			}
			modifier = {
				add = 15
				has_trait = education_intrigue_5
			}
			modifier = {
				add = -5
				scope:new_ruler = {
					OR = {
						has_trait = education_intrigue_3
						has_trait = education_intrigue_4
					}
				}
			}
			modifier = {
				add = -10
				scope:new_ruler = { has_trait = education_intrigue_5 }
			}
			modifier = {
				add = 3
				OR = {
					has_trait = education_learning_1
					has_trait = education_learning_2
				}
			}
			modifier = {
				add = 5
				OR = {
					has_trait = education_learning_3
					has_trait = education_learning_4
				}
			}
			modifier = {
				add = 10
				has_trait = education_learning_5
			}
			modifier = {
				add = -3
				scope:new_ruler = {
					OR = {
						has_trait = education_learning_3
						has_trait = education_learning_4
					}
				}
			}
			modifier = {
				add = -5
				scope:new_ruler = { has_trait = education_learning_5 }
			}
		   ### Prowess Traits
			modifier = {
				add = 3
				has_trait = lifestyle_hunter
			}
			modifier = {
				add = -3
				scope:new_ruler = {
					has_trait = lifestyle_hunter
				}
			}
			modifier = {
				add = -5
				has_trait = physique_bad_1
			}
			modifier = {
				add = -10
				has_trait = physique_bad_2
			}
			modifier = {
				add = -15
				has_trait = physique_bad_3
			}
			modifier = {
				add = 5
				scope:new_ruler = {
					has_trait = physique_bad_1
				}
			}
			modifier = {
				add = 10
				scope:new_ruler = {
					has_trait = physique_bad_2
				} 
			}
			modifier = {
				add = 15
				scope:new_ruler = {
					has_trait = physique_bad_3
				}
			}
			modifier = {
				add = 5
				has_trait = physique_good_1
			}
			modifier = {
				add = 10
				has_trait = physique_good_2
			}
			modifier = {
				add = 15
				has_trait = physique_good_3
			}
			modifier = {
				add = -3
				scope:new_ruler = {
					has_trait = physique_good_1
				}
			}
			modifier = {
				add = -5
				scope:new_ruler = {
					has_trait = physique_good_2
				}
			}
			modifier = {
				add = -10
				scope:new_ruler = {
					has_trait = physique_good_3
				}
			}
			modifier = {
				add = 15
				has_trait = strong
			}
			modifier = {
				add = -10
				scope:new_ruler = {
					has_trait = strong
				}
			}
			modifier = {
				add = 15
				has_trait = berserker
			}
			modifier = {
				add = -10
				scope:new_ruler = {
					has_trait = berserker
				}
			}
			modifier = {
				add = -10
				scope:new_ruler = {
					has_trait = lifestyle_blademaster
					has_trait_xp = {
						trait = lifestyle_blademaster
						value <= 50
					}
				}
			}
			modifier = {
				add = -20
				scope:new_ruler = {
					has_trait = lifestyle_blademaster
					has_trait_xp = {
						trait = lifestyle_blademaster
						value = 100
					}
				}
			}
			modifier = {
				add = 15
				has_trait = lifestyle_blademaster
				has_trait_xp = {
					trait = lifestyle_blademaster
					value <= 50
				}
			}
			modifier = {
				add = 30
				has_trait = lifestyle_blademaster
				has_trait_xp = {
					trait = lifestyle_blademaster
					value = 100
				}
			}
		   ### Hooks
			modifier = {
				add = -5
				has_weak_hook = scope:new_ruler
			}
			modifier = {
				add = -15
				has_strong_hook = scope:new_ruler
			}
		   ### Relationships
			modifier = {
				add = -30
				OR = {
					has_relation_best_friend = scope:new_ruler
					has_relation_blood_brother = scope:new_ruler
				}
			}
			modifier = {
				add = -20
				has_relation_friend = scope:new_ruler
			}
			modifier = {
				add = -20
				has_relation_lover = scope:new_ruler
			}
			modifier = {
				add = 40
				has_relation_nemesis = scope:new_ruler
			}
			modifier = {
				add = 20
				has_relation_rival = scope:new_ruler
			}
		   ### Has lower dread than the current ruler
			modifier = {
				factor = 0.75
				dread < scope:new_ruler.dread
			}
			modifier = {
				factor = 0.50
				dread.mult2 < scope:new_ruler.dread
			}
		   ### Personality Traits
			modifier = {
				add = 10
				has_trait = brave
			}
			modifier = {
				add = 5
				has_trait = arrogant
			}
			modifier = {
				add = 15
				has_trait = ambitious
			}
			modifier = {
				add = -5
				has_trait = content
			}
			modifier = {
				add = -10
				has_trait = craven
			}
			modifier = {
				add = -5
				has_trait = humble
			}
			modifier = {
				add = -15
				has_trait = loyal
			}
		   ### AI Value Modifiers (zeal, rationality, compassion, etc.)
		    ai_value_modifier = {
				ai_vengefulness = 1.5
				ai_greed = 1.5
			}
		}
    }

    option = { #Stay as vassal/courtier, but take a reward
        name = orc_government_events.0002.b

        refuse_orc_inheritance_duel_effect = yes
		debug_log = "ORC_SUCCESSION: Stayed as vassal/courtier"
		ai_chance = {
			base = 0
	
		   ### Prowess
		    modifier = {
				add = scope:new_ruler.prowess.div2
			}
		    modifier = {
				add = prowess.neg
			}
		   ### Education Traits + Values
		    modifier = {
				add = scope:new_ruler.martial.div3
			}
		    modifier = {
				add = martial.div2.neg
			}
			modifier = {
				add = intrigue.div2.neg
			}
			modifier = {
				add = learning.div3.neg
			}
			modifier = {
				add = -10
				OR = {
					has_trait = education_martial_1
					has_trait = education_martial_2
				}
			}
			modifier = {
				add = -15
				OR = {
					has_trait = education_martial_3
					has_trait = education_martial_4
				}
			}
			modifier = {
				add = -20
				has_trait = education_martial_5
			}
			modifier = {
				add = 10
				scope:new_ruler = { 
					OR = {
						has_trait = education_martial_3
						has_trait = education_martial_4
					}
				}
			}
			modifier = {
				add = 15
				scope:new_ruler = { has_trait = education_martial_5 }
			}
			modifier = {
				add = -5
				OR = {
					has_trait = education_intrigue_1
					has_trait = education_intrigue_2
				}
			}
			modifier = {
				add = -10
				OR = {
					has_trait = education_intrigue_3
					has_trait = education_intrigue_4
				}
			}
			modifier = {
				add = -15
				has_trait = education_intrigue_5
			}
			modifier = {
				add = 5
				scope:new_ruler = {
					OR = {
						has_trait = education_intrigue_3
						has_trait = education_intrigue_4
					}
				}
			}
			modifier = {
				add = 10
				scope:new_ruler = { has_trait = education_intrigue_5 }
			}
			modifier = {
				add = -3
				OR = {
					has_trait = education_learning_1
					has_trait = education_learning_2
				}
			}
			modifier = {
				add = -5
				OR = {
					has_trait = education_learning_3
					has_trait = education_learning_4
				}
			}
			modifier = {
				add = -10
				has_trait = education_learning_5
			}
			modifier = {
				add = 3
				scope:new_ruler = {
					OR = {
						has_trait = education_learning_3
						has_trait = education_learning_4
					}
				}
			}
			modifier = {
				add = 5
				scope:new_ruler = { has_trait = education_learning_5 }
			}
		   ### Prowess Traits
			modifier = {
				add = -3
				has_trait = lifestyle_hunter
			}
			modifier = {
				add = 3
				scope:new_ruler = {
					has_trait = lifestyle_hunter
				}
			}
			modifier = {
				add = 10
				has_trait = physique_bad_1
			}
			modifier = {
				add = 15
				has_trait = physique_bad_2
			}
			modifier = {
				add = 20
				has_trait = physique_bad_3
			}
			modifier = {
				add = -10
				scope:new_ruler = {
					has_trait = physique_bad_1
				}
			}
			modifier = {
				add = -15
				scope:new_ruler = {
					has_trait = physique_bad_2
				} 
			}
			modifier = {
				add = -20
				scope:new_ruler = {
					has_trait = physique_bad_3
				}
			}
			modifier = {
				add = -3
				has_trait = physique_good_1
			}
			modifier = {
				add = -5
				has_trait = physique_good_2
			}
			modifier = {
				add = -10
				has_trait = physique_good_3
			}
			modifier = {
				add = 5
				scope:new_ruler = {
					has_trait = physique_good_1
				}
			}
			modifier = {
				add = 10
				scope:new_ruler = {
					has_trait = physique_good_2
				}
			}
			modifier = {
				add = 15
				scope:new_ruler = {
					has_trait = physique_good_3
				}
			}
			modifier = {
				add = -10
				has_trait = strong
			}
			modifier = {
				add = 15
				scope:new_ruler = {
					has_trait = strong
				}
			}
			modifier = {
				add = -10
				has_trait = berserker
			}
			modifier = {
				add = 15
				scope:new_ruler = {
					has_trait = berserker
				}
			}
			modifier = {
				add = 15
				scope:new_ruler = {
					has_trait = lifestyle_blademaster
					has_trait_xp = {
						trait = lifestyle_blademaster
						value <= 50
					}
				}
			}
			modifier = {
				add = 25
				scope:new_ruler = {
					has_trait = lifestyle_blademaster
					has_trait_xp = {
						trait = lifestyle_blademaster
						value = 100
					}
				}
			}
			modifier = {
				add = -20
				has_trait = lifestyle_blademaster
				has_trait_xp = {
					trait = lifestyle_blademaster
					value <= 50
				}
			}
			modifier = {
				add = -25
				has_trait = lifestyle_blademaster
				has_trait_xp = {
					trait = lifestyle_blademaster
					value = 100
				}
			}
		   ### Hooks
			modifier = {
				add = 10
				has_weak_hook = scope:new_ruler
			}
			modifier = {
				add = 25
				has_strong_hook = scope:new_ruler
			}
		   ### Relationships
			modifier = {
				add = 20
				OR = {
					has_relation_best_friend = scope:new_ruler
					has_relation_blood_brother = scope:new_ruler
				}
			}
			modifier = {
				add = 10
				has_relation_friend = scope:new_ruler
			}
			modifier = {
				add = 10
				has_relation_lover = scope:new_ruler
			}
			modifier = {
				add = -20
				has_relation_nemesis = scope:new_ruler
			}
			modifier = {
				add = -10
				has_relation_rival = scope:new_ruler
			}
		   ### Has lower dread than the current ruler
			modifier = {
				factor = 1.25
				dread < scope:new_ruler.dread
			}
			modifier = {
				factor = 1.50
				dread.mult2 < scope:new_ruler.dread
			}
		   ### Personality Traits
			modifier = {
				add = -10
				has_trait = brave
			}
			modifier = {
				add = -5
				has_trait = arrogant
			}
			modifier = {
				add = -10
				has_trait = ambitious
			}
			modifier = {
				add = 5
				has_trait = content
			}
			modifier = {
				add = 15
				has_trait = craven
			}
			modifier = {
				add = 5
				has_trait = humble
			}
			modifier = {
				add = 15
				has_trait = loyal
			}
		   ### AI Value Modifiers (zeal, rationality, compassion, etc.)
		    ai_value_modifier = {
				ai_vengefulness = 0.75
				ai_greed = 2
			}
		}
    }

    option = { #So scared of new liege, no challenge
        name = orc_government_events.0002.c

		ai_chance = {
			base = 5
			
			modifier = {
				add = 30
				has_trait = loyal
			}

			ai_value_modifier = {
				ai_greed = 0.25
			}
		}
    }
}

# Start the dueling process. Strongest orc is lined up first.
orc_government_events.0004 = {
    content_source = realms_dlc
	type = character_event
	title = orc_government_events.0004.t
	desc = orc_government_events.0004.desc
	theme = orcs

    right_portrait = {
		character = root 
		animation = thinking
	}

	override_background = {
		reference = wilderness_underground
	}

	immediate = {
		every_in_list = {
			variable = final_orc_challengers
			root = {
				increase_variable = {
					NAME = challenger_count
					AMOUNT = 1
				}
			}
		}
		
		# Sort out the list of challengers, according to who'm is the strongest
		sort_final_orc_challenger_list_effect = yes

		#Grab the strongest orc from the challenger list
		grab_scariest_orc_from_challenger_list_effect = yes #Saved as `orc_fighting_ruler`

		#Grab cheering orcs on the sidelines
		grab_cheering_orcs_effect = yes

		root = { save_scope_as = defending_ruler }
	}

    option = { #Start the duelling process
        name = orc_government_events.0004.a
		custom_tooltip = orc_government_events.0004.a.tt
		trigger_event = { on_action = lotr_orc_government_persaude_challenger_events }
		# Select the first challenger orc, and fire the persaude event on-actions.
		ai_chance = { #TODO: Add some minor AI weighting
			base = 100
		}
    }

    option = { #First challenger, you can take the empire title! Here ya' go
        name = orc_government_events.0004.b
		trigger = { has_variable_list = final_orc_challengers }
		# Give main title to main challenger, and resume the fight for the 
		# new main challenger against the other challengers

		scope:defending_ruler = {
			ordered_in_list = {
				variable = final_orc_challengers
				order_by = {
					value = 0
					add = lotr_orc_succession_martial_weighting
					add = lotr_orc_succession_intrigue_weighting
					add = lotr_orc_succession_prowess_weighting
					add = lotr_orc_succession_learning_weighting
					add = lotr_orc_succession_relationship_weighting
					add = lotr_orc_succession_ordering_troops_weighting
					add = lotr_orc_succession_dread_weighting
					multiply = -1
				}
				save_scope_as = transfer_orc_list
				scope:orc_fighting_ruler = {
					add_to_variable_list = { name = final_orc_challengers target = scope:transfer_orc_list }
				}
			}
			if = {
				limit = { scope:orc_fighting_ruler = { is_ruler = no } }
				create_title_and_vassal_change = {
					type = granted
					save_scope_as = change
					add_claim_on_loss = no
				}
				random_held_title = {
					title_tier = county 
					change_title_holder = {
						holder = scope:orc_fighting_ruler
						change = scope:change
					}
				}
				resolve_title_and_vassal_change = scope:change
			}
			create_title_and_vassal_change = {
				type = granted
				save_scope_as = change
				add_claim_on_loss = no
			}
			every_held_title = {
				limit = { tier = scope:defending_ruler.primary_title.tier }
				change_title_holder = {
					holder = scope:orc_fighting_ruler
					change = scope:change
				}
			}
			resolve_title_and_vassal_change = scope:change
			
			create_title_and_vassal_change = {
				type = swear_fealty
				save_scope_as = change
				add_claim_on_loss = no
			}
			change_liege = {
				liege = scope:orc_fighting_ruler
				change = scope:change
			}
			resolve_title_and_vassal_change = scope:change
		}
		scope:orc_fighting_ruler = { trigger_event = orc_government_events.0004 }

		ai_chance = { #TODO: Add some minor AI weighting
			base = 0
		}
    }

    option = { #LAAMP here I come! (DLC locked)
        name = orc_government_events.0004.c
		trigger = { 
			has_dlc_feature = roads_to_power 
			has_variable_list = final_orc_challengers
		}
		# Just turn into a LAAMP and give all titles to main challenger.
		# New ruler fights against the other challengers as normal

		scope:defending_ruler = {
			if = {
				limit = { is_ruler = yes }
				ordered_in_list = {
					variable = final_orc_challengers
					order_by = {
						value = 0
						add = lotr_orc_succession_martial_weighting
						add = lotr_orc_succession_intrigue_weighting
						add = lotr_orc_succession_prowess_weighting
						add = lotr_orc_succession_learning_weighting
						add = lotr_orc_succession_relationship_weighting
						add = lotr_orc_succession_ordering_troops_weighting
						add = lotr_orc_succession_dread_weighting
						multiply = -1
					}
					save_scope_as = transfer_orc_list
					scope:orc_fighting_ruler = {
						add_to_variable_list = { name = final_orc_challengers target = scope:transfer_orc_list }
					}
				}

				### First give a county. This is for if the fighitng orc is landless. Otherwise, it'll try giving titles like empire/kingdoms/duchies first, which cause errors
				create_title_and_vassal_change = {
					type = granted
					save_scope_as = change
					add_claim_on_loss = no
				}
				random_held_title = { 
					limit = { tier = tier_county }
					change_title_holder = {
						holder = scope:orc_fighting_ruler
						change = scope:change
					}
				}
				resolve_title_and_vassal_change = scope:change


				### Afterwards, give the rest of the titles
				create_title_and_vassal_change = {
					type = granted
					save_scope_as = change
					add_claim_on_loss = no
				}
				every_held_title = {
					limit = { tier > tier_barony }
					change_title_holder = {
						holder = scope:orc_fighting_ruler
						change = scope:change
					}
				}
				resolve_title_and_vassal_change = scope:change

				scope:orc_fighting_ruler = { trigger_event = orc_government_events.0004 }
			}
			create_landless_adventurer_title_effect = {
				REASON = flag:voluntary
				FLAVOR_CHAR = scope:defending_ruler
			}
		}

		ai_chance = { #TODO: Add some minor AI weighting
			base = 0
		}
    }
}

#Orc reconsiders whether they're willing to fight the current ruler
orc_government_events.0049 = {
    content_source = realms_dlc
	type = character_event
	title = orc_government_events.0049.t
	desc = orc_government_events.0049.desc
	theme = orcs

    right_portrait = {
		character = root 
		animation = aggressive_sword
	}

	immediate = { }

	###
	# Both options should take the following into account:
	#	- Current number of challengers killed (needs custom tracking)
	#		- Will need to track how many of the challengers have been killed by the ruler. Use variable list or simple variable counter
	#   - Whether the ruler has been injured
	#	- Prowess difference
	#	- Martial/intrigue/learning difference
	# 	- Prowess traits, such as berserker, blademaster, etc.
	#	- Relationships (especially rivalries/nemesis)
	#	- Type of claim (based off of realm law)
	#	- Dread
	#	- General personality traits such as brave or wrathful

    option = { #Continue fighting, I'm the biggest-baddest orcy around!
        name = orc_government_events.0049.a
    }

    option = { #Fuck it, I like living. Let him have his titles
        name = orc_government_events.0049.b
		
    }
}

####################################################################################
### Random Persuasion events to stop challengers | KINGS, EMPERORS, & HEGEMONIES ###
####################################################################################

#Attempt to bribe the orc challenger. 
orc_government_events.0050 = {
    content_source = realms_dlc
	type = court_event
	title = orc_government_events.0050.t
	desc = orc_government_events.0050.desc
	theme = orcs

    court_scene = {
		button_position_character = scope:my_foe
		court_event_force_open = yes
		show_timeout_info = no
		should_pause_time = no
		roles = {
			# First, we take each scoped relevant scoped character.
			scope:defending_ruler ?= {
				role = lotr_orc_heir
			}
			scope:orc_fighting_ruler ?= {
				role = lotr_orc_heir_challenger
			}
		}
	}

	widgets = {
		widget = {
			gui = "lotr_orc_succession_event_widget"
			container = "custom_widgets_container"
		}
	}

	weight_multiplier = {
		base = 50

		modifier = {
			factor = 2
			scope:orc_fighting_ruler = { has_trait = greedy }
		}
		modifier = {
			factor = 2
			scope:defending_ruler = { # Tier difference is 2 titles or more (e.g., count vs king) 
				tier_difference = { 
					target = scope:orc_fighting_ruler
					value >= 2
				}	
			}
		}
	}

	trigger = {
		scope:defending_ruler = { orc_has_access_to_courtroom = yes }
		scope:defending_ruler = { orc_succession_duel_has_participants_left = yes }
	}

    option = { #The orc that is being bribed acceptance chance for the "initial" bribe | Losing the skill duel  also means that other orcs see you as weak, so higher chance they'll actually fight
        name = orc_government_events.0050.a
		# Stewardship duel, high value
		
		scope:defending_ruler = {
			duel = {
				skill = stewardship
				value = high_skill_rating
				50 = { #Blackmail them successfully
					compare_modifier = {
						value = scope:duel_value
						multiplier = 3.5
						# Always give _some_ chance.
						min = -39
					}
					desc = orc_government_events.0050.a.higher_stewardship_successful
					send_interface_toast = {
						type = event_toast_effect_good
						title = orc_government_events.0050.a.higher_stewardship_successful
						left_icon = scope:defending_ruler
						random_list = {
							10 = { #Random title claim for 1 title
								ordered_held_title = {
									order_by = tier
									limit = {
										save_temporary_scope_as = title_scope
										NOT = { scope:orc_fighting_ruler = { has_claim_on = scope:title_scope } }
									}
									max = 1
									scope:orc_fighting_ruler = { add_unpressed_claim = prev }
								}
							}
							10 = { #Some gold
								pay_short_term_gold = {
									target = scope:orc_fighting_ruler
									gold = medium_gold_value
								}
							}
							10 = { #Weak favour Hook
								trigger = { #Make sure they don't already have a hook on the ruler
									scope:orc_fighting_ruler = {
										NOR = {
											has_weak_hook = scope:defending_ruler
											has_strong_hook = scope:defending_ruler
										}
									}
								}
								scope:orc_fighting_ruler = {
									add_hook = {
										type = favor_hook
										target = scope:defending_ruler
									}
								}
							}
							10 = { #Vassal contract for gold can be decreased
								trigger = {
									scope:orc_fighting_ruler.liege = scope:defending_ruler
									scope:orc_fighting_ruler = { is_landed = yes }
									scope:orc_fighting_ruler = { 
										vassal_contract_obligation_level_can_be_decreased = orcish_government_taxes
									}
								}
								scope:orc_fighting_ruler = {
									vassal_contract_decrease_obligation_level = orcish_government_taxes
								}
							}
							10 = { #Vassal contract for prestige can be decreased
								trigger = {
									scope:orc_fighting_ruler.liege = scope:defending_ruler
									scope:orc_fighting_ruler = { is_landed = yes }
									scope:orc_fighting_ruler = { 
										vassal_contract_obligation_level_can_be_decreased = orcish_government_prestige
									}
								}
								scope:orc_fighting_ruler = {
									vassal_contract_decrease_obligation_level = orcish_government_prestige
								}
							}
						}
					}
					set_variable = {
						name = orc_challenger_persuaded
						days = 30
					}
				}
				50 = { #Fail to blackmail them
					compare_modifier = {
						value = scope:duel_value
						multiplier = -3.5
						# Limit how low the off-chance can go.
						min = -19
					}
					desc = orc_government_events.0050.a.higher_stewardship_fail
					send_interface_toast = {
						type = event_toast_effect_bad
						title = orc_government_events.0050.a.higher_stewardship_fail
						left_icon = scope:defending_ruler
					}
					custom_tooltip = orc_government_events.orc_challenger_not_persuaded
				}
			}
		}
    }

    option = { #The orc that is being bribed acceptance chance for a higher bribe | Losing the skill duel  also means that other orcs see you as weak, so higher chance they'll actually fight
        name = orc_government_events.0050.b
		# Stewardship duel, medium value
		scope:defending_ruler = {
			duel = {
				skill = stewardship
				value = medium_skill_rating
				50 = { #Blackmail them successfully
					compare_modifier = {
						value = scope:duel_value
						multiplier = 3.5
						# Always give _some_ chance.
						min = -39
					}
					desc = orc_government_events.0050.b.stewardship_successful
					send_interface_toast = {
						type = event_toast_effect_good
						title = orc_government_events.0050.b.stewardship_successful
						left_icon = scope:defending_ruler
						random_list = {
							10 = { #Random title claim for 3 titles
								ordered_held_title = {
									order_by = tier
									limit = {
										save_temporary_scope_as = title_scope
										NOT = { scope:orc_fighting_ruler = { has_claim_on = scope:title_scope } }
									}
									max = 3
									scope:orc_fighting_ruler = { add_pressed_claim = prev }
								}
							}
							10 = { #A lot of gold
								pay_short_term_gold = {
									target = scope:orc_fighting_ruler
									gold = massive_gold_value
								}
							}
							10 = { #A strong favour Hook
								trigger = { #Make sure they don't already have a hook on the ruler
									scope:orc_fighting_ruler = {
										NOR = {
											has_weak_hook = scope:defending_ruler
											has_strong_hook = scope:defending_ruler
										}
									}
								}
								scope:orc_fighting_ruler = {
									add_hook = {
										type = strong_favor_hook
										target = scope:defending_ruler
									}
								}
							}
							10 = { #Vassal contract for gold can be decreased TWICE
								trigger = {
									scope:orc_fighting_ruler.liege = scope:defending_ruler
									scope:orc_fighting_ruler = { 
										vassal_contract_obligation_level:orcish_government_taxes >= 3
									}
								}
								scope:orc_fighting_ruler = {
									vassal_contract_decrease_obligation_level = orcish_government_taxes
									vassal_contract_decrease_obligation_level = orcish_government_taxes
								}
							}
							10 = { #Vassal contract for prestige can be decreased TWICE
								trigger = {
									scope:orc_fighting_ruler.liege = scope:defending_ruler
									scope:orc_fighting_ruler = { 
										vassal_contract_obligation_level:orcish_government_prestige >= 3
									}
								}
								scope:orc_fighting_ruler = {
									vassal_contract_decrease_obligation_level = orcish_government_prestige
									vassal_contract_decrease_obligation_level = orcish_government_prestige
								}
							}
						}
					}
					set_variable = {
						name = orc_challenger_persuaded
						days = 30
					}
				}
				50 = { #Fail to blackmail them
					compare_modifier = {
						value = scope:duel_value
						multiplier = -3.5
						# Limit how low the off-chance can go.
						min = -19
					}
					desc = orc_government_events.0050.b.stewardship_fail
					send_interface_toast = {
						type = event_toast_effect_bad
						title = orc_government_events.0050.b.stewardship_fail
						left_icon = scope:defending_ruler
					}
					custom_tooltip = orc_government_events.orc_challenger_not_persuaded
				}
			}
		}
    }

    option = { #Refuse to bribe the orc
        name = orc_government_events.0050.c
    }

	after = {
		if = {
			limit = { scope:defending_ruler = { NOT = { has_variable = orc_challenger_persuaded } } }
			start_orc_duel_effect = yes
		} else = {
			proceed_to_next_orc_challenger_fight = { 
				DEFENDING_RULER = scope:defending_ruler
				ORC_CHALLENGER = scope:orc_fighting_ruler
			}
		}
	}
}

#Attempt to blackmail the orc challenger.
orc_government_events.0051 = {
    content_source = realms_dlc
	type = court_event
	title = orc_government_events.0051.t
	desc = orc_government_events.0051.desc
	theme = orcs

    right_portrait = {
		character = scope:orc_fighting_ruler 
		animation = aggressive_sword
	}

	weight_multiplier = {
		base = 50

		modifier = {
			factor = 2
			any_hooked_character = { this = scope:orc_fighting_ruler }
		}
	}

	trigger = {
		scope:defending_ruler = {
			orc_has_access_to_courtroom = yes
			orc_succession_duel_has_participants_left = yes
		}
	}

	widgets = {
		widget = {
			gui = "lotr_orc_succession_event_widget"
			container = "custom_widgets_container"
		}
	}

    option = { #The orc that is being blackmailed skill check | Losing the skill duel also means that other orcs see you as weak, so higher chance they'll actually fight
        name = orc_government_events.0051.a
		# Intrigue duel
		scope:defending_ruler = {
			duel = {
				skill = intrigue
				value = high_skill_rating
				50 = { #Blackmail them successfully
					compare_modifier = {
						value = scope:duel_value
						multiplier = 3.5
						# Always give _some_ chance.
						min = -39
					}
					desc = orc_government_events.0051.a.blackmail_successful
					send_interface_toast = {
						type = event_toast_effect_good
						title = orc_government_events.0051.a.blackmail_successful
						left_icon = scope:defending_ruler
					}
					set_variable = {
						name = orc_challenger_persuaded
						days = 30
					}
				}
				50 = { #Fail to blackmail them
					compare_modifier = {
						value = scope:duel_value
						multiplier = -3.5
						# Limit how low the off-chance can go.
						min = -19
					}
					desc = orc_government_events.0051.a.blackmail_fail
					send_interface_toast = {
						type = event_toast_effect_bad
						title = orc_government_events.0051.a.blackmail_fail
						left_icon = scope:defending_ruler
					}
					custom_tooltip = orc_government_events.orc_challenger_not_persuaded
				}
			}
		}
    }

    option = { #The orc that is being blackmailed + bribed skill check | Losing the skill duel also means that other orcs see you as weak, so higher chance they'll actually fight
        name = orc_government_events.0051.b
		# Intrigue + Stewardship duel
		# Intrigue duel
		scope:defending_ruler = {
			duel = {
				skills = { intrigue stewardship }
				value = high_skill_rating
				50 = { #Blackmail them successfully
					compare_modifier = {
						value = scope:duel_value
						multiplier = 3.5
						# Always give _some_ chance.
						min = -39
					}
					desc = orc_government_events.0051.b.blackmail_and_stewardship_successful
					send_interface_toast = {
						type = event_toast_effect_good
						title = orc_government_events.0051.b.blackmail_and_stewardship_successful
						left_icon = scope:defending_ruler
						if = {
							limit = { scope:orc_fighting_ruler = { highest_held_title_tier = tier_barony } }
							pay_short_term_gold = {
								target = scope:orc_fighting_ruler
								gold = tiny_gold_value
							}
						}
						else_if = {
							limit = { scope:orc_fighting_ruler = { highest_held_title_tier = tier_county } }
							pay_short_term_gold = {
								target = scope:orc_fighting_ruler
								gold = minor_gold_value
							}
						}
						else_if = {
							limit = { scope:orc_fighting_ruler = { highest_held_title_tier = tier_duchy } }
							pay_short_term_gold = {
								target = scope:orc_fighting_ruler
								gold = medium_gold_value
							}
						}
						else_if = {
							limit = { scope:orc_fighting_ruler = { highest_held_title_tier = tier_kingdom } }
							pay_short_term_gold = {
								target = scope:orc_fighting_ruler
								gold = major_gold_value
							}
						}
						else_if = {
							limit = { scope:orc_fighting_ruler = { highest_held_title_tier = tier_empire } }
							pay_short_term_gold = {
								target = scope:orc_fighting_ruler
								gold = massive_gold_value
							}
						}
					}
					set_variable = {
						name = orc_challenger_persuaded
						days = 30
					}
				}
				50 = { #Fail to blackmail them
					compare_modifier = {
						value = scope:duel_value
						multiplier = -3.5
						# Limit how low the off-chance can go.
						min = -19
					}
					desc = orc_government_events.0051.b.blackmail_and_stewardship_fail
					send_interface_toast = {
						type = event_toast_effect_bad
						title = orc_government_events.0051.b.blackmail_and_stewardship_fail
						left_icon = scope:defending_ruler
					}
					custom_tooltip = orc_government_events.orc_challenger_not_persuaded
				}
			}
		}
    }

    option = { #Refuse to use blackmail
        name = orc_government_events.0051.c
		custom_tooltip = orc_government_events.orc_challenger_not_persuaded
    }

	after = {
		if = {
			limit = { scope:defending_ruler = { NOT = { has_variable = orc_challenger_persuaded } } }
			start_orc_duel_effect = yes
		} else = {
			proceed_to_next_orc_challenger_fight = { 
				DEFENDING_RULER = scope:defending_ruler
				ORC_CHALLENGER = scope:orc_fighting_ruler
			}
		}
	}
}

#An upstart orc jumps the line, and now challenges the main challenger so they can get to you quicker. You look on.
orc_government_events.0052 = {
    content_source = realms_dlc
	type = court_event
	title = orc_government_events.0052.t
	desc = orc_government_events.0052.desc
	theme = orcs

    court_scene = {
		button_position_character = scope:character_b
		court_event_force_open = yes
		show_timeout_info = no
		should_pause_time = no
		roles = {
			# First, we take each scoped relevant scoped character.
			scope:upstart_orc ?= {
				role = lotr_orc_heir
			}
			scope:orc_fighting_ruler ?= {
				role = lotr_orc_heir_challenger
			}
		}
	}

	trigger = {
		scope:defending_ruler = {
			orc_has_access_to_courtroom = yes
			orc_succession_duel_has_participants_left = yes
			variable_list_size = {
				name = final_orc_challengers
				value >= 2
			}
		}
	}

	widgets = {
		widget = {
			gui = "lotr_orc_succession_event_widget"
			container = "custom_widgets_container"
		}
	}

	immediate = {
		scope:defending_ruler = {
			random_in_list = {
				variable = final_orc_challengers
				limit = { this != scope:orc_fighting_ruler }
				save_scope_as = upstart_orc
			}
		}
	}

	option = { #Skill check between main challenger and up-start orc. Skill check should use their values. Will be a "shortened" version of the duel, for the players' sake.
        name = orc_government_events.0052.a
		# Prowess duel between the 2 orcs
		# Winner fights you, loser dies
		scope:upstart_orc = {
			duel = {
				skill = prowess
				target = scope:orc_fighting_ruler
				50 = { #Upstart orc wins, and duels you
					desc = orc_government_events.0052.a.success
					compare_modifier = {
						value = scope:duel_value
						multiplier = 3.5
					}
					send_interface_toast = {
						title = orc_government_events.0052.a.success
						left_icon = scope:upstart_orc
					}
					custom_tooltip = orc_government_events.0052.a.success.tt
					scope:defending_ruler = {
						random_in_list = {
							variable = final_orc_challengers
							limit = { this = scope:orc_fighting_ruler }
							save_scope_as = orc_to_be_removed
						}
						remove_list_variable = {
							name = final_orc_challengers
							target = scope:orc_to_be_removed
						}
					}
					scope:upstart_orc = { save_scope_as = orc_fighting_ruler }
				}
				50 = { #Upstart orc loses, dies, and proceed with duel as normal
					desc = orc_government_events.0052.a.failure
					compare_modifier = {
						value = scope:duel_value
						multiplier = -3.5
					}
					send_interface_toast = {
						title = orc_government_events.0052.a.failure
						left_icon = scope:upstart_orc
					}
					custom_tooltip = orc_government_events.0052.a.failure.tt
					scope:defending_ruler = {
						random_in_list = {
							variable = final_orc_challengers
							limit = { this = scope:upstart_orc }
							save_scope_as = orc_to_be_removed
						}
						remove_list_variable = {
							name = final_orc_challengers
							target = scope:orc_to_be_removed
						}
					}
				}
			}
		}
    }

	option = { #Player can put a stop to it, having a guaranteed fight with both, before other challengers reconsider
        name = orc_government_events.0052.b
		#If player intervenes, this lowers the subsequent chances of other challengers fighting him. After all, if you're willing to fight both of these orcs, you're a bad ass
		custom_tooltip = orc_government_events.0052.b.tt
		custom_tooltip = orc_government_events.0052.b.tt.2
    }

	after = {
		if = {
			limit = { scope:defending_ruler = { NOT = { has_variable = orc_challenger_persuaded } } }
			start_orc_duel_effect = yes
		} else = {
			proceed_to_next_orc_challenger_fight = { 
				DEFENDING_RULER = scope:defending_ruler
				ORC_CHALLENGER = scope:orc_fighting_ruler
			}
		}
	}
}

#You won! You've asserted your dominance
orc_government_events.0500 = {
    content_source = realms_dlc
	type = court_event
	title = orc_government_events.0500.t
	theme = orcs
	desc = {
		first_valid = {
			triggered_desc = {
				trigger = { has_variable = no_orc_challenged_you }
				desc = orc_government_events.0500.desc.unchallenged
			}
			desc = orc_government_events.0500.desc
		}
	}

	trigger = {
		trigger_if = {
			limit = { exists = scope:defending_ruler }
			scope:defending_ruler = { orc_succession_duel_has_participants_left = no }
		}
		orc_has_access_to_courtroom = yes
	}

	court_scene = {
		button_position_character = root
		court_event_force_open = yes
		show_timeout_info = no
		should_pause_time = no
		roles = {
			# First, we take each scoped relevant scoped character.
			root ?= {
				role = lotr_orc_heir
				animation = celebrate_sword
			}
		}
	}

	option = {
		name = orc_government_events.0500.a
		add_dread = 50
		add_legitimacy = medium_legitimacy_gain
	}
}

#####################################################################
### Random Persuasion events to stop challengers | COUNTS & DUKES ###
#####################################################################

#Attempt to bribe the orc challenger. 
orc_government_events.1050 = {
    content_source = realms_dlc
	type = character_event
	title = orc_government_events.0050.t
	desc = orc_government_events.0050.desc
	theme = orcs

    left_portrait = {
		character = scope:defending_ruler 
		animation = bribing
	}

    right_portrait = {
		character = scope:orc_fighting_ruler 
		animation = thinking
	}

	override_background = { reference = wilderness_underground }

	widgets = {
		widget = {
			gui = "lotr_orc_succession_event_widget"
			container = "custom_widgets_container"
		}
	}

	weight_multiplier = {
		base = 50

		modifier = {
			factor = 2
			scope:orc_fighting_ruler = { has_trait = greedy }
		}
		modifier = {
			factor = 2
			scope:defending_ruler = { # Tier difference is 2 titles or more (e.g., count vs king) 
				tier_difference = { 
					target = scope:orc_fighting_ruler
					value >= 2
				}	
			}
		}
	}

	trigger = {
		scope:defending_ruler = { orc_has_access_to_courtroom = no }
		scope:defending_ruler = { orc_succession_duel_has_participants_left = yes }
	}

    option = { #The orc that is being bribed acceptance chance for the "initial" bribe | Losing the skill duel  also means that other orcs see you as weak, so higher chance they'll actually fight
        name = orc_government_events.0050.a
		# Stewardship duel, high value
		
		scope:defending_ruler = {
			duel = {
				skill = stewardship
				value = high_skill_rating
				50 = { #Blackmail them successfully
					compare_modifier = {
						value = scope:duel_value
						multiplier = 3.5
						# Always give _some_ chance.
						min = -39
					}
					desc = orc_government_events.0050.a.higher_stewardship_successful
					send_interface_toast = {
						type = event_toast_effect_good
						title = orc_government_events.0050.a.higher_stewardship_successful
						left_icon = scope:defending_ruler
						random_list = {
							10 = { #Random title claim for 1 title
								ordered_held_title = {
									order_by = tier
									limit = {
										save_temporary_scope_as = title_scope
										NOT = { scope:orc_fighting_ruler = { has_claim_on = scope:title_scope } }
									}
									max = 1
									scope:orc_fighting_ruler = { add_unpressed_claim = prev }
								}
							}
							10 = { #Some gold
								pay_short_term_gold = {
									target = scope:orc_fighting_ruler
									gold = medium_gold_value
								}
							}
							10 = { #Weak favour Hook
								trigger = { #Make sure they don't already have a hook on the ruler
									scope:orc_fighting_ruler = {
										NOR = {
											has_weak_hook = scope:defending_ruler
											has_strong_hook = scope:defending_ruler
										}
									}
								}
								scope:orc_fighting_ruler = {
									add_hook = {
										type = favor_hook
										target = scope:defending_ruler
									}
								}
							}
							10 = { #Vassal contract for gold can be decreased
								trigger = {
									scope:orc_fighting_ruler.liege = scope:defending_ruler
									scope:orc_fighting_ruler = { is_landed = yes }
									scope:orc_fighting_ruler = { 
										vassal_contract_obligation_level_can_be_decreased = orcish_government_taxes
									}
								}
								scope:orc_fighting_ruler = {
									vassal_contract_decrease_obligation_level = orcish_government_taxes
								}
							}
							10 = { #Vassal contract for prestige can be decreased
								trigger = {
									scope:orc_fighting_ruler.liege = scope:defending_ruler
									scope:orc_fighting_ruler = { is_landed = yes }
									scope:orc_fighting_ruler = { 
										vassal_contract_obligation_level_can_be_decreased = orcish_government_prestige
									}
								}
								scope:orc_fighting_ruler = {
									vassal_contract_decrease_obligation_level = orcish_government_prestige
								}
							}
						}
					}
					set_variable = {
						name = orc_challenger_persuaded
						days = 30
					}
				}
				50 = { #Fail to blackmail them
					compare_modifier = {
						value = scope:duel_value
						multiplier = -3.5
						# Limit how low the off-chance can go.
						min = -19
					}
					desc = orc_government_events.0050.a.higher_stewardship_fail
					send_interface_toast = {
						type = event_toast_effect_bad
						title = orc_government_events.0050.a.higher_stewardship_fail
						left_icon = scope:defending_ruler
					}
					custom_tooltip = orc_government_events.orc_challenger_not_persuaded
				}
			}
		}
    }

    option = { #The orc that is being bribed acceptance chance for a higher bribe | Losing the skill duel  also means that other orcs see you as weak, so higher chance they'll actually fight
        name = orc_government_events.0050.b
		# Stewardship duel, medium value
		scope:defending_ruler = {
			duel = {
				skill = stewardship
				value = medium_skill_rating
				50 = { #Blackmail them successfully
					compare_modifier = {
						value = scope:duel_value
						multiplier = 3.5
						# Always give _some_ chance.
						min = -39
					}
					desc = orc_government_events.0050.b.stewardship_successful
					send_interface_toast = {
						type = event_toast_effect_good
						title = orc_government_events.0050.b.stewardship_successful
						left_icon = scope:defending_ruler
						random_list = {
							10 = { #Random title claim for 3 titles
								ordered_held_title = {
									order_by = tier
									limit = {
										save_temporary_scope_as = title_scope
										NOT = { scope:orc_fighting_ruler = { has_claim_on = scope:title_scope } }
									}
									max = 3
									scope:orc_fighting_ruler = { add_pressed_claim = prev }
								}
							}
							10 = { #A lot of gold
								pay_short_term_gold = {
									target = scope:orc_fighting_ruler
									gold = massive_gold_value
								}
							}
							10 = { #A strong favour Hook
								trigger = { #Make sure they don't already have a hook on the ruler
									scope:orc_fighting_ruler = {
										NOR = {
											has_weak_hook = scope:defending_ruler
											has_strong_hook = scope:defending_ruler
										}
									}
								}
								scope:orc_fighting_ruler = {
									add_hook = {
										type = strong_favor_hook
										target = scope:defending_ruler
									}
								}
							}
							10 = { #Vassal contract for gold can be decreased TWICE
								trigger = {
									scope:orc_fighting_ruler.liege = scope:defending_ruler
									scope:orc_fighting_ruler = { 
										vassal_contract_obligation_level:orcish_government_taxes >= 3
									}
								}
								scope:orc_fighting_ruler = {
									vassal_contract_decrease_obligation_level = orcish_government_taxes
									vassal_contract_decrease_obligation_level = orcish_government_taxes
								}
							}
							10 = { #Vassal contract for prestige can be decreased TWICE
								trigger = {
									scope:orc_fighting_ruler.liege = scope:defending_ruler
									scope:orc_fighting_ruler = { 
										vassal_contract_obligation_level:orcish_government_prestige >= 3
									}
								}
								scope:orc_fighting_ruler = {
									vassal_contract_decrease_obligation_level = orcish_government_prestige
									vassal_contract_decrease_obligation_level = orcish_government_prestige
								}
							}
						}
					}
					set_variable = {
						name = orc_challenger_persuaded
						days = 30
					}
				}
				50 = { #Fail to blackmail them
					compare_modifier = {
						value = scope:duel_value
						multiplier = -3.5
						# Limit how low the off-chance can go.
						min = -19
					}
					desc = orc_government_events.0050.b.stewardship_fail
					send_interface_toast = {
						type = event_toast_effect_bad
						title = orc_government_events.0050.b.stewardship_fail
						left_icon = scope:defending_ruler
					}
					custom_tooltip = orc_government_events.orc_challenger_not_persuaded
				}
			}
		}
    }

    option = { #Refuse to bribe the orc
        name = orc_government_events.0050.c
    }

	after = {
		if = {
			limit = { scope:defending_ruler = { NOT = { has_variable = orc_challenger_persuaded } } }
			start_orc_duel_effect = yes
		} else = {
			proceed_to_next_orc_challenger_fight = { 
				DEFENDING_RULER = scope:defending_ruler
				ORC_CHALLENGER = scope:orc_fighting_ruler
			}
		}
	}
}

#Attempt to blackmail the orc challenger.
orc_government_events.1051 = {
    content_source = realms_dlc
	type = character_event
	title = orc_government_events.0051.t
	desc = orc_government_events.0051.desc
	theme = orcs

    left_portrait = {
		character = scope:defending_ruler 
		animation = spymaster
	}

    right_portrait = {
		character = scope:orc_fighting_ruler 
		animation = anger
	}

	override_background = { reference = wilderness_underground }

	weight_multiplier = {
		base = 50

		modifier = {
			factor = 2
			any_hooked_character = { this = scope:orc_fighting_ruler }
		}
	}

	trigger = {
		scope:defending_ruler = {
			orc_has_access_to_courtroom = no
			orc_succession_duel_has_participants_left = yes
			
		}
	}

    option = { #The orc that is being blackmailed skill check | Losing the skill duel also means that other orcs see you as weak, so higher chance they'll actually fight
        name = orc_government_events.0051.a
		# Intrigue duel
		scope:defending_ruler = {
			duel = {
				skill = intrigue
				value = high_skill_rating
				50 = { #Blackmail them successfully
					compare_modifier = {
						value = scope:duel_value
						multiplier = 3.5
						# Always give _some_ chance.
						min = -39
					}
					desc = orc_government_events.0051.a.blackmail_successful
					send_interface_toast = {
						type = event_toast_effect_good
						title = orc_government_events.0051.a.blackmail_successful
						left_icon = scope:defending_ruler
					}
					set_variable = {
						name = orc_challenger_persuaded
						days = 30
					}
				}
				50 = { #Fail to blackmail them
					compare_modifier = {
						value = scope:duel_value
						multiplier = -3.5
						# Limit how low the off-chance can go.
						min = -19
					}
					desc = orc_government_events.0051.a.blackmail_fail
					send_interface_toast = {
						type = event_toast_effect_bad
						title = orc_government_events.0051.a.blackmail_fail
						left_icon = scope:defending_ruler
					}
					custom_tooltip = orc_government_events.orc_challenger_not_persuaded
				}
			}
		}
    }

    option = { #The orc that is being blackmailed + bribed skill check | Losing the skill duel also means that other orcs see you as weak, so higher chance they'll actually fight
        name = orc_government_events.0051.b
		# Intrigue + Stewardship duel
		# Intrigue duel
		scope:defending_ruler = {
			duel = {
				skills = { intrigue stewardship }
				value = high_skill_rating
				50 = { #Blackmail them successfully
					compare_modifier = {
						value = scope:duel_value
						multiplier = 3.5
						# Always give _some_ chance.
						min = -39
					}
					desc = orc_government_events.0051.b.blackmail_and_stewardship_successful
					send_interface_toast = {
						type = event_toast_effect_good
						title = orc_government_events.0051.b.blackmail_and_stewardship_successful
						left_icon = scope:defending_ruler
						if = {
							limit = { scope:orc_fighting_ruler = { highest_held_title_tier = tier_barony } }
							pay_short_term_gold = {
								target = scope:orc_fighting_ruler
								gold = tiny_gold_value
							}
						}
						else_if = {
							limit = { scope:orc_fighting_ruler = { highest_held_title_tier = tier_county } }
							pay_short_term_gold = {
								target = scope:orc_fighting_ruler
								gold = minor_gold_value
							}
						}
						else_if = {
							limit = { scope:orc_fighting_ruler = { highest_held_title_tier = tier_duchy } }
							pay_short_term_gold = {
								target = scope:orc_fighting_ruler
								gold = medium_gold_value
							}
						}
						else_if = {
							limit = { scope:orc_fighting_ruler = { highest_held_title_tier = tier_kingdom } }
							pay_short_term_gold = {
								target = scope:orc_fighting_ruler
								gold = major_gold_value
							}
						}
						else_if = {
							limit = { scope:orc_fighting_ruler = { highest_held_title_tier = tier_empire } }
							pay_short_term_gold = {
								target = scope:orc_fighting_ruler
								gold = massive_gold_value
							}
						}
					}
					set_variable = {
						name = orc_challenger_persuaded
						days = 30
					}
				}
				50 = { #Fail to blackmail them
					compare_modifier = {
						value = scope:duel_value
						multiplier = -3.5
						# Limit how low the off-chance can go.
						min = -19
					}
					desc = orc_government_events.0051.b.blackmail_and_stewardship_fail
					send_interface_toast = {
						type = event_toast_effect_bad
						title = orc_government_events.0051.b.blackmail_and_stewardship_fail
						left_icon = scope:defending_ruler
					}
					custom_tooltip = orc_government_events.orc_challenger_not_persuaded
				}
			}
		}
    }

    option = { #Refuse to use blackmail
        name = orc_government_events.0051.c
		custom_tooltip = orc_government_events.orc_challenger_not_persuaded
    }

	after = {
		if = {
			limit = { scope:defending_ruler = { NOT = { has_variable = orc_challenger_persuaded } } }
			start_orc_duel_effect = yes
		} else = {
			proceed_to_next_orc_challenger_fight = { 
				DEFENDING_RULER = scope:defending_ruler
				ORC_CHALLENGER = scope:orc_fighting_ruler
			}
		}
	}
}

#An upstart orc jumps the line, and now challenges the main challenger so they can get to you quicker. You look on.
orc_government_events.1052 = {
    content_source = realms_dlc
	type = character_event
	title = orc_government_events.0052.t
	desc = orc_government_events.0052.desc
	theme = orcs

	override_background = { reference = wilderness_underground }

    left_portrait = {
		character = scope:upstart_orc 
		animation = aggressive_axe
	}

    right_portrait = {
		character = scope:orc_fighting_ruler 
		animation = aggressive_sword
	}

	trigger = {
		scope:defending_ruler = {
			orc_has_access_to_courtroom = no
			orc_succession_duel_has_participants_left = yes
			variable_list_size = {
				name = final_orc_challengers
				value >= 2
			}
		}
	}

	immediate = {
		scope:defending_ruler = {
			random_in_list = {
				variable = final_orc_challengers
				limit = { this != scope:orc_fighting_ruler }
				save_scope_as = upstart_orc
			}
		}
	}

	option = { #Skill check between main challenger and up-start orc. Skill check should use their values. Will be a "shortened" version of the duel, for the players' sake.
        name = orc_government_events.0052.a
		# Prowess duel between the 2 orcs
		# Winner fights you, loser dies
		scope:upstart_orc = {
			duel = {
				skill = prowess
				target = scope:orc_fighting_ruler
				50 = { #Upstart orc wins, and duels you
					desc = orc_government_events.0052.a.success
					compare_modifier = {
						value = scope:duel_value
						multiplier = 3.5
					}
					send_interface_toast = {
						title = orc_government_events.0052.a.success
						left_icon = scope:upstart_orc
					}
					custom_tooltip = orc_government_events.0052.a.success.tt
					scope:defending_ruler = {
						random_in_list = {
							variable = final_orc_challengers
							limit = { this = scope:orc_fighting_ruler }
							save_scope_as = orc_to_be_removed
						}
						remove_list_variable = {
							name = final_orc_challengers
							target = scope:orc_to_be_removed
						}
					}
					scope:upstart_orc = { save_scope_as = orc_fighting_ruler }
				}
				50 = { #Upstart orc loses, dies, and proceed with duel as normal
					desc = orc_government_events.0052.a.failure
					compare_modifier = {
						value = scope:duel_value
						multiplier = -3.5
					}
					send_interface_toast = {
						title = orc_government_events.0052.a.failure
						left_icon = scope:upstart_orc
					}
					custom_tooltip = orc_government_events.0052.a.failure.tt
					scope:defending_ruler = {
						random_in_list = {
							variable = final_orc_challengers
							limit = { this = scope:upstart_orc }
							save_scope_as = orc_to_be_removed
						}
						remove_list_variable = {
							name = final_orc_challengers
							target = scope:orc_to_be_removed
						}
					}
				}
			}
		}
    }

	option = { #Player can put a stop to it, having a guaranteed fight with both, before other challengers reconsider
        name = orc_government_events.0052.b
		#If player intervenes, this lowers the subsequent chances of other challengers fighting him. After all, if you're willing to fight both of these orcs, you're a bad ass
		custom_tooltip = orc_government_events.0052.b.tt
		custom_tooltip = orc_government_events.0052.b.tt.2
    }

	after = {
		if = {
			limit = { scope:defending_ruler = { NOT = { has_variable = orc_challenger_persuaded } } }
			start_orc_duel_effect = yes
		} else = {
			proceed_to_next_orc_challenger_fight = { 
				DEFENDING_RULER = scope:defending_ruler
				ORC_CHALLENGER = scope:orc_fighting_ruler
			}
		}
	}
}


orc_government_events.1500 = {
    content_source = realms_dlc
	type = character_event
	title = orc_government_events.0500.t
	desc = {
		first_valid = {
			triggered_desc = {
				trigger = { has_variable = no_orc_challenged_you }
				desc = orc_government_events.0500.desc.unchallenged
			}
			desc = orc_government_events.0500.desc
		}
	}
	theme = orcs

    left_portrait = {
		character = root 
		animation = duel_celebrate
	}

	trigger = {
		trigger_if = {
			limit = { exists = scope:defending_ruler }
			scope:defending_ruler = { orc_succession_duel_has_participants_left = no }
		}
		orc_has_access_to_courtroom = no
	}

	option = {
		name = orc_government_events.0500.a
		add_dread = 50
		add_legitimacy = medium_legitimacy_gain
	}
}


############################
###		Debug Events	 ###
############################

orc_government_events.2000 = {
	hidden = yes
	orphan = yes
	immediate = {
		# As with portraits, we do our general character setup stuff in this event.
		random_courtier_or_guest = { save_scope_as = character_a }
		random_courtier_or_guest = {
			limit = { this != scope:character_a }
			save_scope_as = character_b
		}
		random_courtier_or_guest = {
			limit = {
				this != scope:character_a
				this != scope:character_b
			}
			save_scope_as = character_c
		}
		random_courtier_or_guest = {
			limit = {
				this != scope:character_a
				this != scope:character_b
				this != scope:character_c
			}
			save_scope_as = character_d
		}
		random_courtier_or_guest = {
			limit = {
				this != scope:character_a
				this != scope:character_b
				this != scope:character_c
				this != scope:character_d
			}
			save_scope_as = character_e
		}
		random_courtier_or_guest = {
			limit = {
				this != scope:character_a
				this != scope:character_b
				this != scope:character_c
				this != scope:character_d
				this != scope:character_e
			}
			save_scope_as = character_f
		}
		random_courtier_or_guest = {
			limit = {
				this != scope:character_a
				this != scope:character_b
				this != scope:character_c
				this != scope:character_d
				this != scope:character_e
				this != scope:character_f
			}
			save_scope_as = character_g
		}
		trigger_event = orc_government_events.2001
	}
}

orc_government_events.2001 = {
    content_source = realms_dlc
	type = court_event
	title = orc_government_events.0002.t
	desc = orc_government_events.0002.desc
	theme = orcs

    court_scene = {
		button_position_character = scope:character_b
		court_event_force_open = yes
		show_timeout_info = no
		should_pause_time = no
		roles = {
			# First, we take each scoped relevant scoped character.
			root ?= {
				role = lotr_orc_heir
			}
			scope:character_b ?= {
				role = lotr_orc_heir_challenger
			}
			scope:character_c ?= {
				role = lotr_orc_heir_spectator_1
			}
			scope:character_d ?= {
				role = lotr_orc_heir_spectator_2
			}
			scope:character_e ?= {
				role = lotr_orc_heir_spectator_3
			}
			scope:character_f ?= {
				role = lotr_orc_heir_spectator_4
			}
			scope:character_g ?= {
				role = lotr_orc_heir_spectator_5
			}
		}
	}

	# Court events, as with all events, require at least one option to display.
	option = {
		name = hold_court.0001.a
	}
}