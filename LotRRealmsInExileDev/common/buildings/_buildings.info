You can define

== Structure ==

name_of_the_building = {

	# How many levies does the building give ( int or named value )
	# default = 0
	#
	levy = 200

	# How much garrison does the building give ( int or named value )
	# default = 0
	#
	max_garrison = 100

	# Garrison monthly refill rate ( fixed point or named value ) in the inverval of [0..1]
	# Every month garrison increased by this fraction of max garrison
	# default = 0
	#
	garrison_reinforcement_factor = 0.01

	# Number of days it takes to construct this building ( int or named value )
	# default = 0
	#
	construction_time = 720

	type = regular/special/duchy_capital	# Specifies whether this is a regular building, a special building, or a duchy capital building. Regular by default

	# Which asset does the building use
	#
	asset = {

		# specifies wheter to use a mesh or an entity. Meshes are more performant and should be preferred.
		#
		type = pdxmesh/entity

		# The name of the mesh or the entity ( string )
		# Can have multiple entries, combined with 'names'
		# Note that they must all be entities, or all be meshes
		#
		name = "western_castle_01_level_03_mesh"
		name = "western_castle_01_level_04_mesh"

		# Names of meshes or entities ( array of strings )
		# To randomize between multiple meshes/entities
		# Note that they must all be entities, or all be meshes
		# Combined with 'name'
		#
		names = { "western_castle_01_level_03a_mesh" "western_castle_01_level_03b_mesh" "western_castle_01_level_03c_mesh" }

		# Path to illustration shown in the county view ( string )
		# Texture can be accessed in GUI: "[Holding.GetIllustration]"
		#
		illustration = "path/to/image.dds"

		# Associated sound effect and an optional parameter
		# Can also be just soundeffect = "event:..." if no parameter is needed
		# Can have multiple sound effects
		#
		soundeffect = { soundeffect = "event:/SFX/Ambience/3DMapEmitters/Holdings/Generic/sfx_amb_3d_holdings_generic_castle_01" soundparameter = { "Tier" = 2.0 } }

		# Governments that prefer this asset to be shown
		governments = { tribal_government }

		# Province IDs in which this asset is preferred ( array of int )
		# Has a higher priority than graphical region
		#
		provinces = { 496 1000 }

		# Graphical regions in which this asset is preferred ( array of strings )
		# This is the most important criterion when selecting the asset, with the exception of government and province
		# Should match entries in geographical regions database
		#
		graphical_regions = { graphical_mena graphical_mediterranean }

		# Graphical cultures that prefer this asset to be shown ( array of flags )
		# Should match 'building_gfx' in cultures database
		#
		graphical_cultures = { western_building_gfx mediterranean_building_gfx }

		# Graphical faiths that prefer this asset to be shown ( array of strings )
		# Priority is faith > religion > family, so Catholic graphical_faith overrides Abrahamic graphical_faith
		# Should match 'graphical_faith' in religion database
		#
		graphical_faiths = { catholic_gfx orthodox_gfx }

		# Required DLC flag ( dlc flag )
		# Assets marked with a DLC flag require matching DLC to be enabled
		#
		requires_dlc_flag = the_northern_lords
	}

	# Trigger: is the building enabled?
	# Else won't give any effects to holder, and not be constructible ( see can_construct* below ).
	# If is_graphical_background = yes, this controls whether the building can be shown in the province.
	# Scopes:
	#	root ( province ) 			province where building is located
	#	scope:holder ( character )	holder of the barony title
	#	scope:county ( title )		is the county title the province belongs to
	#
	is_enabled = {}

	# Trigger: can the building be repaired?
	# Only Great Buildings can be ruined and repaired
	# Scopes:
	#	root ( province ) 			province where building is located
	#	scope:holder ( character )	holder of the barony title
	#	scope:county ( title )		is the county title the province belongs to
	#
	can_rebuild = {}

	# Triggers can the building be constructed?
	# Use this instead of is_enabled if you want to allow rulers to "use" the building
	# after getting the holding, but to disallow that they construct it.
	# Note that is_enabled (see above) is always called together with can_construct_potential.
	# To be able to construct a building all 3 triggers must evaluate to true
	# Not used if is_graphical_background = yes
	# scopes: root is the province; scope:holder is the holder of the province; county is the county title the province belongs to
	#
	can_construct_potential = {}				# Whether the building even appears in the build menu
												# For upgrades it is identical to can_construct_showing_failures_only.
	can_construct_showing_failures_only = {}	# Trigger will show only failuers. Use for temporary effects player can overcome
	can_construct = {}							# Trigger will show both filled and missing requirements

	# Shall disabled building still show in the build menu. Will still use can_construct_potential ( bool )
	# default: no
	#
	show_disabled = yes/no	# if set to yes,

	# How much cost does the building cost ( scripted cost )
	#
	cost = { gold = 500 ... }

	# The next upgrade for this building chain
	#
	next_building = castle_02

	# Custom description for effects indirectly provided by building ( dynamic description )
	# No scope is provided
	#
	effect_desc = dynamic_description

	# A modifier applied to the owner of the holding
	#
	character_modifier = {
		modifier_name = modifier_value
	}

	# Applied if the character's culture has the parameter
	character_culture_modifier = {
		parameter = culture param
	}
	# Applied if the character's faith has the parameter
	character_faith_modifier = {
		parameter = faith param
	}

	# A modifier applied to the owner of the province if the dynasty of the county holder has a specific perk
	#
	characer_dynasty_modifier = {
		county_holder_dynasty_perk = fp2_urbanism_legacy_1 # The name of the perk
		modifier_name = modifier_value
	}

	# A modifier applied to the province
	#
	province_modifier = {
		modifier_name = modifier_value
	}

	# A modifier applied to the province only if province's county culture has this parameter
	#
	province_culture_modifier = {
		parameter = culture_param
		modifier_name = modifier_value
	}

	# A modifier applied to the province only if province's county faith has this parameter
	#
	province_faith_modifier = {
		parameter = faith_param
		modifier_name = modifier_value
	}

	# A modifier applied to the province only if it matches all listed criteria
	# culture parameter (optional), terrain type, coastal or riverside
	province_terrain_modifier = {

		parameter = culture_param			# (optional)

		terrain =terrain_type				# From terrain database (optional, if empty - any terrait)

		is_coastal = yes/no					# Apply modifier on coastal, non-coastal, or any province
											# (optional, default is both coastal and non-coastal)

		is_riverside = yes/no				# Apply modifier on provinces only next to a big river or not next to a riger province
											# (optional, default is both riverside and not)
	}

	# A modifier applied to the province if the dynasty of the county holder has a specific perk
	#
	province_dynasty_modifier = {
		county_holder_dynasty_perk = fp2_urbanism_legacy_1
		modifier_name = modifier_value
	}

	# A modifier applied to the entire county
	# All provinces in the county can stack the same county modifier together
	#
	county_modifier = {
		modifier_name = modifier_value
	}

	# A modifier applied to the county only if county culture has this parameter
	#
	county_culture_modifier = {
		parameter = culture_param
		modifier_name = modifier_value
	}

	# A modifier applied to the county only if province's county faith has this parameter
	#
	county_faith_modifier = {
		parameter = faith_param
		modifier_name = modifier_value
	}

	# A modifier applied to every de jure county in the duchy. Can only be used (and only works) for duchy capital buildings
	#
	duchy_capital_county_modifier = {
		modifier_name = modifier_value
	}

	# A modifier applied to the entire county if any situation the county is involved in has the specified parameter in its current phase.
	# All provinces in the county can stack the same county modifier together
    county_situation_modifier = {
        parameter = situation_parameter
		modifier_name = modifier_value
    }

	# A modifier applied to the province if any situation the county is involved in has the specified parameter in its current phase.
    province_situation_modifier = {
        parameter = situation_parameter         
		modifier_name = modifier_value
    }
 
	# A modifier applied to the owner of the holding if any situation the county is involved in has the specified parameter in its current phase.
    character_situation_modifier = {
        parameter = situation_parameter
		modifier_name = modifier_value
    } 
  
	# A modifier applied to every de jure county in the duchy if any situation the county is involved in has the specified parameter in its current phase.
	# Can only be used (and only works) for duchy capital buildings.
    duchy_capital_county_situation_modifier = {
        parameter = situation_parameter
		modifier_name = modifier_value
    }  

	# A modifier applied to every de jure county in the duchy if county culture has specified parameter
	# Can only be used (and only works) for duchy capital buildings
	#
	duchy_capital_county_culture_modifier = {
		parameter = culture_param
		modifier_name = modifier_value
	}

	# A modifier applied to every de jure county in the duchy if county faith has specified parameter
	# Can only be used (and only works) for duchy capital buildings
	#
	duchy_capital_county_faith_modifier = {
		parameter = faith_param
		modifier_name = modifier_value
	}

	# A special modifier applied to every holding of specified type in the county
	county_holding_modifier = {
		holding = castle_holding
		income_mult = 1
	}

	# A modifier applied to the county if the dynasty of the county holder has a specific perk
	#
	county_dynasty_modifier = {
		county_holder_dynasty_perk = fp2_urbanism_legacy_1 # The name of the perk
		modifier_name = modifier_value
	}

	# A modifier applied to the county holder
	#
	county_holder_character_modifier = {
		modifier_name = modifier_value
	}

	# A modifier applied to the province if the county holder's government has the specified parameter
	#
	province_government_modifier = {
		parameter = government_param
		modifier_name = modifier_value
	}

	# A modifier applied to the county holder if their government has the specified parameter
	#
	character_government_modifier = {
		parameter = government_param
		modifier_name = modifier_value
	}

	## fallback: modifier collection
	# Use this field to define an alternative set of modifiers that will be applied if the building is disabled.
	# supported modifiers:
	#	- character_modifier
	#	- character_culture_modifier
	#	- character_faith_modifier
	#	- characer_dynasty_modifier
	#	- province_modifier
	#	- province_culture_modifier
	#	- province_faith_modifier
	#	- province_terrain_modifier
	#	- province_dynasty_modifier
	#	- county_modifier
	#	- county_culture_modifier
	#	- county_faith_modifier
	#	- duchy_capital_county_modifier
    #	- county_situation_modifier
    #	- province_situation_modifier
    #	- character_situation_modifier
    #	- duchy_capital_county_situation_modifier
	#	- duchy_capital_county_culture_modifier
	#	- duchy_capital_county_faith_modifier
	#	- county_holding_modifier
	#	- county_dynasty_modifier
	#	- county_holder_character_modifier
	#	- province_government_modifier
	#	- character_government_modifier
	#
	fallback = {
		character_modifier = {}

		character_dynasty_modifier = {}
		...
	}

	# Filename of building type icon in 'BUILDING_TYPE_ICON_PATH' folder ( string )
	#
	type_icon = "icon_building_hospice.dds"

	# Building flags that can be checked in triggers. Can have multiple flags
	#
	flag = castle

	# How desirable is the building for the AI ( MTTH )
	# Shared priorities with domicile buildings if available
	# See AI selection logic at the bottom of this doc to explain how the AI uses these!
	# Scopes:
	#		root ( Province )	The province the construction took place in
	#
	#		scope:character		The character that paid for the construction, if available
	#
	#		scope:holding		holding type if this building is primary building for holding type scope.
	#							Like castle is primary building for a castle holding
	#
	ai_value = {
		base = 100
	}

	# Shall the building be used for figuring out which background map asset (walls/no walls etc) should be shown
	# AI skips all is_graphical_background = yes buildings
	#
	is_graphical_background = no

	### on_start/on_cancelled/on_complete effects
	# Effects that happen when construction of the building starts/cancels/finishes
	# Scopes:
	#		root ( Province )	The province the construction took place in
	#
	#		scope:character		The character that paid for the construction, if available
	#
	#		scope:holding		holding type if this building is primary building for holding type scope.
	#							Like castle is primary building for a castle holding
	#
	on_start = { ... }
	on_cancelled = { ... }
	on_complete = { ... }

	# which great_project_type is going to upgrade this great building
	# when you're upgrading this great building via great project there will be no construction progress on the building slot itself,
	# and it's the great project that progresses instead.
	# use this field to allow the user to start planning the great project that will upgrade the building
	# and to jump to the UI that shows the current upgrade status.
	great_project_type = grand_building_project_this_tier
}

AI behavior:

1. The AI puts all potential buildings (including domicile buildings, but excluding holdings, Great Projects, etc) in a list
2. It then computes all potential buildings' ai_value and sorts by it
3. Any building that does not score within 20% of the top building in this list are discarded
4. It selects a building randomly from the remaining ones
5. If it can afford this building it builds it; if not, it starts saving up gold for it

Warning: a very expensive building with a high ai_value could lock an AI character into saving gold forever! Since it builds no buildings that could improve its ability to earn gold (investments), it might never build any buildings and never improve its economy.
