struggle_thani_hazad_dissolution = {
	
	title = struggle_thani_hazad_dissolution
	picture = {
		reference = "gfx/interface/illustrations/decisions/struggle_thani_hazad_dissolution.dds"
	}
	extra_picture = "gfx/interface/illustrations/struggle_decision_buttons/struggle_thani_hazad_dissolution_button.dds"
	confirm_click_sound = "event:/DLC/FP2/SFX/UI/fp2_struggle_ending_decision_confirm"
	desc = struggle_thani_hazad_dissolution_description
	selection_tooltip = struggle_thani_hazad_dissolution_select_tooltip
	is_invisible = yes
	sort_order = 80

	is_valid = {
		custom_tooltip = {
			text = struggle_thani_hazad_dissolution_valid_tooltip
			struggle:thani_hazad_struggle = { is_struggle_phase = struggle_thani_hazad_phase_disintegration }
		}
		OR = {
			AND = {
				has_title = title:d_balan_lai_leader
				custom_tooltip = {
					text = struggle_thani_hazad_dissolution_valid_tooltip_condition_2
					any_county_in_region = {
						region = custom_mannish_thani_hazad
						OR = {
							holder = { is_vassal_or_below_of = root }
							holder = root
						}
						percent >= 0.5
					}
				}
			}
			custom_tooltip = {
				text = struggle_thani_hazad_dissolution_valid_tooltip_condition_1
				any_county_in_region = {
					region = middleearth_thani_hazad_struggle_region
					OR = {
						holder = { is_vassal_or_below_of = root }
						holder = root
					}
					percent >= 0.6
				}
			}
		}
	}

	cost = {
		prestige = 2000
	}

	is_valid_showing_failures_only = {
		is_available_adult = yes
	}

	effect = {
		custom_tooltip = {
			text = struggle_thani_hazad_dissolution_duchy_effect
			thani_hazad_struggle_disunity_transfer_duchies_effect = yes
		}
		custom_tooltip = {
			text = struggle_thani_hazad_dissolution_claim_effect
			thani_hazad_struggle_involved_ruler_claims = yes
		}
		custom_tooltip = {
			text = struggle_thani_hazad_dissolution_dynasty_modifier_effect	
			struggle:thani_hazad_struggle = {
				every_involved_ruler = {
					limit = { has_trait = balan_lai_member }
					dynasty = {
						add_dynasty_modifier = {
							modifier = cant_form_thani_hazad_modifier
							years = 50
						}
					}
				}
			}
		}
		destroy_title = title:d_balan_lai_leader
		if = {
			limit = {
				any_character_struggle = {
					involvement = involved
					is_struggle_type = thani_hazad_struggle
				}
			}
			custom_tooltip = {
				text = struggle_thani_hazad_dissolution_effect_involved
			}
			custom_tooltip = {
				text = struggle_thani_hazad_struggle_ends
				struggle:thani_hazad_struggle = { end_struggle = yes }
			}
			
		} else_if = {
			limit = {
				any_character_struggle = {
					involvement = interloper
					is_struggle_type = thani_hazad_struggle
				}
			}
			get_title = title:e_thani_hazad
			custom_tooltip = {
				text = struggle_thani_hazad_struggle_ends
				struggle:thani_hazad_struggle = { end_struggle = yes }
			}
		}
	}
	
	ai_check_interval = 36
	ai_potential = { always = no }
	ai_will_do = { base = 100 }
}

struggle_thani_hazad_confederation = {
	
	title = struggle_thani_hazad_confederation
	picture = {
		reference = "gfx/interface/illustrations/decisions/struggle_thani_hazad_confederation.dds"
	}
	extra_picture = "gfx/interface/illustrations/struggle_decision_buttons/struggle_thani_hazad_confederation_button.dds"
	confirm_click_sound = "event:/DLC/FP2/SFX/UI/fp2_struggle_ending_decision_confirm"
	desc = struggle_thani_hazad_confederation_description
	selection_tooltip = struggle_thani_hazad_confederation_select_tooltip
	is_invisible = yes
	sort_order = 80

	is_valid = {
		custom_tooltip = {
			text = struggle_thani_hazad_confederation_valid_tooltip
			struggle:thani_hazad_struggle = { is_struggle_phase = struggle_thani_hazad_phase_confederation }
		}
		trigger_if = { #Involved
			limit = {
				any_character_struggle = {
					involvement = involved
					is_struggle_type = thani_hazad_struggle
				}
			}
			custom_tooltip = {
				text = struggle_thani_hazad_confederation_valid_previous_phase_tooltip
				global_var:th_confederation_val >= 1
			}
			custom_tooltip = { # Control less than 20% of the struggle region
				text = struggle_thani_hazad_confederation_valid_total_land_held
				any_county_in_region = {
					region = middleearth_thani_hazad_struggle_region
					OR = {
						holder = { is_vassal_or_below_of = root }
						holder = root
					}
					percent <= 0.2
				}
			}
			culture:kharadunaim = { save_temporary_scope_as = kharadunaimculture } # Used for tooltipping
			custom_tooltip = { # Be of a valid culture
				text = struggle_thani_hazad_confederation_valid_culture_tooltip
				OR = {
					culture = culture:kharadunaim
					culture = { any_parent_culture_or_above = { this = culture:kharadunaim } }
				}
			}
			custom_tooltip = { # You should not have already taken this decision
				text = struggle_thani_hazad_confederation_valid_modifier_tooltip
				NOT = { dynasty = { has_dynasty_modifier = old_order_triumphant_th_struggle_modifier } }
			}
			dynasty = { dynasty_prestige_level >= 5 } # You should be from a prestigous dynasty
		}
		trigger_if = { #Interloper or non-involved
			limit = { 
				NOT = {
					any_character_struggle = {
						involvement = involved
						is_struggle_type = thani_hazad_struggle
					}
				}
			}
			custom_tooltip = {
				text = struggle_thani_hazad_confederation_valid_tooltip_interloper
				any_county_in_region = {
					region = middleearth_thani_hazad_struggle_region
					OR = {
						holder = { is_vassal_or_below_of = root }
						holder = root
					}
					percent >= 0.7
				}
			}
		}
	}

	cost = {
		prestige = 2500
	}

	is_valid_showing_failures_only = {
		is_available_adult = yes
		is_independent_ruler = yes
	}

	effect = {
		if = {
			limit = {
				any_character_struggle = {
					involvement = involved
					is_struggle_type = thani_hazad_struggle
				}
			}
			dynasty = { add_dynasty_modifier = old_order_triumphant_th_struggle_modifier }
			dynasty = { add_dynasty_prestige = 3000 }
			dynasty = { add_dynasty_prestige_level = 1 }
			struggle:thani_hazad_struggle = { change_struggle_phase = struggle_thani_hazad_phase_confederation }
		} else_if = {
			limit = {
				any_character_struggle = {
					involvement = interloper
					is_struggle_type = thani_hazad_struggle
				}
			}
			get_title = title:e_thani_hazad
			custom_tooltip = {
				text = struggle_thani_hazad_struggle_ends
				struggle:thani_hazad_struggle = { end_struggle = yes }
			}
		}
	}
	
	ai_check_interval = 36
	ai_potential = { always = no }
	ai_will_do = { base = 100 }
}

struggle_thani_hazad_unification = {
	
	title = struggle_thani_hazad_unification
	picture = {
		reference = "gfx/interface/illustrations/decisions/struggle_thani_hazad_unification.dds"
	}
	extra_picture = "gfx/interface/illustrations/struggle_decision_buttons/struggle_thani_hazad_unification_button.dds"
	confirm_click_sound = "event:/DLC/FP2/SFX/UI/fp2_struggle_ending_decision_confirm"
	desc = struggle_thani_hazad_unification_description
	selection_tooltip = struggle_thani_hazad_unification_select_tooltip
	is_invisible = yes
	sort_order = 80

	is_valid = {
		custom_tooltip = {
			text = struggle_thani_hazad_unification_valid_tooltip
			struggle:thani_hazad_struggle = { is_struggle_phase = struggle_thani_hazad_phase_unification }
		}
		###
		#
		#	Add 2 scripted effects/triggers. 
		#
		#	One set should represent the Balan-Lai uniting
		#	another set should represent Balan-Lai being united conventional way (i.e., one big strong ruler)
		#
		###
		trigger_if = { #Interloper
			limit = {
				NOT = {
					any_character_struggle = {
						involvement = involved
						is_struggle_type = thani_hazad_struggle
					}
				}
			}
			custom_tooltip = {
				text = struggle_thani_hazad_unification_valid_tooltip_interloper
				any_county_in_region = {
					region = middleearth_thani_hazad_struggle_region
					OR = {
						holder = { is_vassal_or_below_of = root }
						holder = root
					}
					percent >= 0.8
				}
			}
		}
		trigger_if = { #Involved
			limit = {
			}
			prestige_level >= 5
			completely_controls_region = custom_mannish_thani_hazad # TEMP | Rework/Finesse more
		}
	}

	cost = {
		prestige = 2000
	}

	is_valid_showing_failures_only = {
		is_available_adult = yes
	}

	effect = {
		if = { # Involved
			limit = {
				any_character_struggle = {
					involvement = involved
					is_struggle_type = thani_hazad_struggle
				}
			}
			get_title = title:e_thani_hazad
			title:e_thani_hazad = { add_title_law = balan_lai_elective_succession_law }
			custom_tooltip = {
				text = struggle_thani_hazad_struggle_ends
				struggle:thani_hazad_struggle = { end_struggle = yes }
			}
		} else_if = {  # Interloper
			limit = {
				any_character_struggle = {
					involvement = interloper
					is_struggle_type = thani_hazad_struggle
				}
			}
			get_title = title:e_thani_hazad
			custom_tooltip = {
				text = struggle_thani_hazad_struggle_ends
				struggle:thani_hazad_struggle = { end_struggle = yes }
			}
		}
	}
	
	ai_check_interval = 36
	ai_potential = { always = no }
	ai_will_do = { base = 100 }
}