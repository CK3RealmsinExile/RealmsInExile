#######################
### DWARF DECISIONS ###
#######################

#      _                     __
#     | |                   / _|
#   __| |_      ____ _ _ __| |_
#  / _` \ \ /\ / / _` | '__|  _|
# | (_| |\ V  V / (_| | |  | |
#  \__,_| \_/\_/ \__,_|_|  |_|
#
#

decision_plunder_thorins_tomb = {
    title = decision_plunder_thorins_tomb
    picture = {
		reference = "gfx/interface/illustrations/decisions/decision_thorins_tomb.dds"
	}

	ai_check_interval = 120
    ai_goal = no
	ai_will_do = {
		base = 0

		modifier = {
			add = 100
			is_orc = yes
		}

		modifier = {
			add = 50
			faith_is_evil = yes
		}

		modifier = {
			add = -100
			is_dwarf = yes
		}

		modifier = {
			add = -50
			faith_is_good = yes
		}

		modifier = {
			add = {
				value = ai_greed
				multiply = 0.5
			}
		}

		modifier = {
			add = {
				value = ai_compassion
				multiply = -0.5
			}
		}
	}

    selection_tooltip = decision_plunder_thorins_tomb_tooltip
    desc = decision_plunder_thorins_tomb_desc

    decision_group_type = realms_in_exile_major

	is_shown = {
		NAND = {
			has_global_variable = orcrist_plundered
			has_global_variable = arkenstone_plundered
		}
		OR = {
			has_title = title:c_throne_of_erebor
			AND = {
				is_orc = yes
				in_diplomatic_range = title:c_throne_of_erebor.holder
			}
		}
		NOT = { has_character_flag = tomb_raider }
		game_start_date >= 6974 # Thorin gotta be dead!
	}

	is_valid = {
		completely_controls = title:c_throne_of_erebor
	}

	is_valid_showing_failures_only = {
		is_imprisoned = no
		is_available_adult = yes
	}

	should_create_alert = { #This means that if the player is tracking the decision, it won't make an alert unless these additional conditions are fulfilled
		always = yes
	}

	effect = {
		trigger_event = lotr_artifact.0030
		add_character_flag = {
			flag = tomb_raider
			days = 1
		}
	}
}

decision_return_thorins_artifacts = {
    title = decision_return_thorins_artifacts
    picture = {
		reference = "gfx/interface/illustrations/decisions/decision_thorins_tomb.dds"
	}

	ai_check_interval = 120


    ai_goal = no
	ai_will_do = {
		base = 0

		modifier = {
			add = 100
			is_dwarf = yes
		}

		modifier = {
			add = 50
			faith_is_good = yes
		}

		modifier = {
			add = -100
			is_orc = yes
		}

		modifier = {
			add = -50
			faith_is_evil = yes
		}

		modifier = {
			add = {
				value = ai_greed
				multiply = -0.5
			}
		}

		modifier = {
			add = {
				value = ai_compassion
				multiply = 0.5
			}
		}
	}

    selection_tooltip = decision_return_thorins_artifacts_tooltip
    desc = decision_return_thorins_artifacts_desc

    decision_group_type = realms_in_exile_major

	is_shown = {
		any_character_artifact = {
			has_variable = thorins_tomb
		}
        NOT = { has_title = title:c_throne_of_erebor }
		any_ruler = {
			in_diplomatic_range = title:c_throne_of_erebor.holder
			is_dwarf = yes
		}
		game_start_date >= 6974 # Thorin gotta be dead!
	}

	is_valid = {
		OR = {
			title:c_throne_of_erebor.holder.top_liege = {
				is_dwarf = yes
			}
			AND = {
				title:c_throne_of_erebor.holder.top_liege = {
					NOT = { is_dwarf = yes }
				}
				NOT = { is_dwarf = yes }
			}
		}
	}

	is_valid_showing_failures_only = {
		is_imprisoned = no
		is_available_adult = yes
		is_at_war = no
	}

	should_create_alert = { #This means that if the player is tracking the decision, it won't make an alert unless these additional conditions are fulfilled
		always = no
	}

	effect = {
		trigger_event = lotr_artifact.0031
	}
}

decision_restore_thorins_tomb = {
    title = decision_restore_thorins_tomb
    picture = {
		reference = "gfx/interface/illustrations/decisions/decision_thorins_tomb.dds"
	}

	ai_check_interval = 120


    ai_goal = no
	ai_will_do = {
		base = 0

		modifier = {
			add = 100
			is_dwarf = yes
		}

		modifier = {
			add = 50
			faith_is_good = yes
		}

		modifier = {
			add = -100
			is_orc = yes
		}

		modifier = {
			add = -50
			faith_is_evil = yes
		}

		modifier = {
			add = {
				value = ai_greed
				multiply = -0.5
			}
		}

		modifier = {
			add = {
				value = ai_compassion
				multiply = 0.5
			}
		}
	}

    selection_tooltip = decision_restore_thorins_tomb_tooltip
    desc = decision_restore_thorins_tomb_desc

    decision_group_type = realms_in_exile_major

	is_shown = {
		any_character_artifact = {
			has_variable = thorins_tomb
		}
        has_title = title:c_throne_of_erebor
		game_start_date >= 6974 # Thorin gotta be dead!
		NOT = { is_orc = yes }
	}

	is_valid = {
		custom_description = {
			text = "decision_has_thorins_artifact"
			any_character_artifact = {
				has_variable = thorins_tomb
			}
		}
	}

	is_valid_showing_failures_only = {
		is_imprisoned = no
		is_available_adult = yes
		is_at_war = no
	}

	should_create_alert = { #This means that if the player is tracking the decision, it won't make an alert unless these additional conditions are fulfilled
		always = yes
	}

	effect = {
		trigger_event = lotr_artifact.0031
	}
}

decision_send_for_thorins_artifacts = {
    title = decision_send_for_thorins_artifacts
    picture = {
		reference = "gfx/interface/illustrations/decisions/decision_thorins_tomb.dds"
	}

	#ai_check_interval = 120
    ai_goal = yes
	ai_will_do = {
		base = 0

		modifier = {
			add = 100
			is_dwarf = yes
		}

		modifier = {
			add = -100
			has_global_variable = orcrist_plundered
			any_artifact = {
				has_variable = orcrist
				can_be_claimed_by = root
				NOT = { owner = root }
			}
		}

		modifier = {
			add = -100
			has_global_variable = arkenstone_plundered
			any_artifact = {
				has_variable = orcrist
				can_be_claimed_by = root
				NOT = { owner = root }
			}
		}
	}

    selection_tooltip = decision_send_for_thorins_artifacts_tooltip
    desc = decision_send_for_thorins_artifacts_desc

    decision_group_type = realms_in_exile_minor

	is_shown = {
		has_title = title:c_throne_of_erebor
		NOT = { has_character_flag = tomb_raider }
		is_dwarf = yes
		game_start_date >= 6974 # Thorin gotta be dead!
		OR = {
			AND = {
				has_global_variable = orcrist_plundered
				NOT = { any_character_artifact = { has_variable = orcrist } }
			}
			AND = {
				has_global_variable = arkenstone_plundered
				NOT = { any_character_artifact = { has_variable = arkenstone } }
			}
		}
	}

	cooldown = { years = 5 }

	is_valid_showing_failures_only = {
		is_imprisoned = no
		is_available_adult = yes
		gold > medium_gold_value
	}

	effect = {
		trigger_event = lotr_artifact.0032
	}
}

decision_unify_durins_folk = {
	sort_order = 98
	# TEXT
	title = decision_unify_durins_folk
	picture = {
		reference = "gfx/interface/illustrations/decisions/decision_dwarves_02.dds"
	}
	selection_tooltip = decision_unify_durins_folk_tooltip
	desc = decision_unify_durins_folk_desc
	confirm_text = decision_unify_durins_folk_confirm

	decision_group_type = realms_in_exile_major

	is_shown = {
		culture = { has_cultural_pillar = heritage_longbeard }

		OR = {
			has_title = title:k_durins_folk
			has_title = title:e_durins_folk
		}

		highest_held_title_tier >= tier_kingdom

		dynasty = dynasty:dynasty_durin

		NOT = {
			is_target_in_global_variable_list = {
				name = unavailable_unique_decisions
				target = flag:decision_unify_durins_folk
			}
		}
	}

	# IS_VALID
	is_valid = {
		prestige_level >= 5
		custom_tooltip = {
			text = control_percentage_of_misty_desc
			title:e_misty_mountains = {
				any_de_jure_county = {
					percent > 0.9
					holder.top_liege = root
				}
			}
		}
		custom_tooltip = {
			text = control_percentage_of_iron_desc
			title:e_iron_mountains = {
				any_de_jure_county = {
					percent > 0.9
					holder.top_liege = root
				}
			}
		}
		# Add Realm Size requirement
	}
	is_valid_showing_failures_only = {
		is_imprisoned = no
		is_available_adult = yes
		is_at_war = no
		NOR = {
			has_trait = beardless_plague
			has_trait = beardless
		}
	}

	# EFFECT
	effect = {
		#Create the title and make it primary
		create_title_and_vassal_change = {
			type = created
			save_scope_as = title_change
			add_claim_on_loss = yes
		}

		if = {
			limit = {
				NOT = { title:e_durins_folk.holder = root }
			}
			title:e_durins_folk = {
				change_title_holder = {
					holder = root
					change = scope:title_change
				}
			}
			resolve_title_and_vassal_change = scope:title_change

			title:e_durins_folk = {
				copy_title_history = title:k_durins_folk
			}
		}

		set_primary_title_to = title:e_durins_folk

		give_nickname = nick_the_unifier
		add_trait = durin_unify
		add_prestige = 1500
		dynasty = { add_dynasty_prestige = 3000 }

		hidden_effect = {
			every_realm_de_jure_kingdom = {
				if = {
					limit = {
						OR = {
							empire = title:e_misty_mountains
							empire = title:e_iron_mountains
						}
					}
					set_de_jure_liege_title = title:e_durins_folk
				}
			}
			set_primary_title_to = title:e_durins_folk
			destroy_title = title:e_iron_mountains
			destroy_title = title:e_misty_mountains
		}

		add_to_global_variable_list = {
			name = unavailable_unique_decisions
			target = flag:decision_unify_durins_folk
		}
	}

	# AI
	ai_goal = yes
	ai_potential = { always = yes }
	ai_will_do = { base = 100 }
}

decision_restore_durin_throne = {
	title = decision_restore_durin_throne
	desc = decision_restore_durin_throne_desc
	confirm_text = decision_restore_durin_throne_confirm
	selection_tooltip = decision_restore_durin_throne_tooltip
	picture = {
		reference = "gfx/interface/illustrations/decisions/decision_dwarves_01.dds"
	}


	# AI
	ai_goal = yes
	ai_potential = {
		always = yes
	}
	ai_will_do = {
		base = 100
	}

	# IS SHOWN
	decision_group_type = realms_in_exile_major

	is_shown = {
		OR = {
			has_title = title:c_durins_hall
			any_vassal = {
				has_title = title:c_durins_hall
				is_dwarf = yes
			}
		}
		is_dwarf = yes
		game_start_date >= 6013.1.1
		NOT = {
			is_target_in_global_variable_list = {
				name = unavailable_unique_decisions
				target = flag:decision_restore_durin_throne
			}
		}
	}

	# IS VALID
	is_valid = {
		prestige_level >= high_prestige_level
		OR = {
			has_title = title:e_misty_mountains
			has_title = title:e_durins_folk
			trigger_if = {
				limit = {
					exists = character:lineofdurin95
					this = character:lineofdurin95
				}
				custom_tooltip = {
					text = balin_event_chain.1000.tt_1
					has_character_flag = balin_survives
				}
			}
			trigger_if = {
				limit = { dynasty = dynasty:dynasty_durin any_owned_story = { story_type = story_dorfdad_reincarnation } }
				has_trait = dwarf_father
			}
		}
		OR = {
			has_title = title:c_durins_hall
			any_vassal = {
				has_title = title:c_durins_hall
				custom_tooltip = {
					text = is_dwarf_trigger
					is_dwarf = yes
				}
			}
		}
		title:c_durins_hall = {
			title_province = {
				NOR = {
					has_holding_type = settlement_holding
					has_holding_type = wastelands_holding
				}
			}
		}
	}

	is_valid_showing_failures_only = {
		is_imprisoned = no
		is_available_adult = yes
		is_at_war = no
		NOR = {
			has_trait = beardless_plague
			has_trait = beardless
		}
	}

	cost = {
		gold = 500
	}

	# EFFECT
	effect = {
		province:4909 = { add_special_building_slot = wonder_durin_throne }
		title:c_durins_hall = {
			change_development_level = 5
		}

		if = {
			limit = { has_character_flag = balin_survives }
			custom_tooltip = {
				text = balin_event_chain.1000.tt_3
				#Create the title and make it primary
				create_title_and_vassal_change = {
					type = created
					save_scope_as = title_change
					add_claim_on_loss = yes
				}
				title:k_khazad_dum = {
					change_title_holder = {
						holder = root
						change = scope:title_change
					}
				}
				resolve_title_and_vassal_change = scope:title_change

				if = {
					limit = {
						NOT = { has_title = title:k_durins_folk }
						highest_held_title_tier <= tier_kingdom
					}
					set_primary_title_to = title:k_khazad_dum
				}
			}
		}

		custom_tooltip = {
			text = durin_hall_upgrade_holding_tooltip
			title:c_durins_hall = {
				title_province = {
					if = {
						limit = { has_building = dwarven_depths_01 }
						add_building = dwarven_depths_03
					}
					else_if = {
						limit = { has_building = dwarven_depths_02 }
						add_building = dwarven_depths_04
					}
					else_if = {
						limit = { has_building = dwarven_depths_03 }
						add_building = dwarven_depths_05
					}
					else_if = {
						limit = { has_building = dwarven_depths_04 }
						add_building = dwarven_depths_06
					}
					else_if = {
						limit = { has_building = dwarven_depths_05 }
						add_building = dwarven_depths_07
					}
					else_if = {
						limit = { has_building = dwarven_depths_06 }
						add_building = dwarven_depths_08
					}
					else_if = {
						limit = { has_building = dwarven_depths_07 }
						add_building = dwarven_depths_08
						county = { change_development_level = 5 }
					}
					else_if = {
						limit = { has_building = dwarven_depths_08 }
						county = { change_development_level = 10 }
					}
					else_if = {
						limit = { has_building = dwarven_depths_09 }
						county = { change_development_level = 15 }
					}
					else_if = {
						limit = { has_building = dwarven_depths_10 }
						county = { change_development_level = 20 }
					}
				}
			}
		}

		add_to_global_variable_list = {
			name = unavailable_unique_decisions
			target = flag:decision_restore_durin_throne
		}
	}
}

decision_reunite_yellow_mountains = {
	title = decision_reunite_yellow_mountains
	desc = decision_reunite_yellow_mountains_desc
	confirm_text = decision_reunite_yellow_mountains_confirm
	selection_tooltip = decision_reunite_yellow_mountains_tooltip
	picture = {
		reference ="gfx/interface/illustrations/decisions/decision_dwarves_02.dds"
	}

	decision_group_type = realms_in_exile_major

	# AI
	ai_goal = yes
	ai_potential = {
		always = yes
	}
	ai_will_do = {
		base = 100
	}

	# IS SHOWN
	is_shown = {
		is_dwarf = yes
		title:e_yellow_mountains = {
			any_de_jure_county = {
				holder = root
			}
		}
		NOT = {
			is_target_in_global_variable_list = {
				name = unavailable_unique_decisions
				target = flag:decision_reunite_yellow_mountains
			}
		}
	}

	# IS VALID
	is_valid = {
		prestige_level >= high_prestige_level
		calc_true_if = {
			amount >= 2
			OR = {
				has_title = title:k_blackflame
				any_vassal = { has_title = title:k_blackflame }
			}
			OR = {
				has_title = title:k_shulkabbad
				any_vassal = { has_title = title:k_shulkabbad }
			}
			OR = {
				has_title = title:k_gunduzanda
				any_vassal = { has_title = title:k_gunduzanda }
			}
		}
	}

	is_valid_showing_failures_only = {
		is_imprisoned = no
		is_available_adult = yes
		is_at_war = no
		NOR = {
			has_trait = beardless_plague
			has_trait = beardless
		}
	}

	cost = {
		prestige = 1000
	}

	# EFFECT
	effect = {
		title:e_western_yellow_mountains = {
			every_de_jure_county = {
				limit = {
					NOR = {
						holder = title:k_wastelands.holder
						any_in_list = {
							list = dwarven_vassals_in_western_YM
							this = prev.holder
						}
					}
				}
				holder = { add_to_list = dwarven_vassals_in_western_YM }
			}
		}
		every_in_list = {
			list = dwarven_vassals_in_western_YM
			add_opinion = {
				target = root
				modifier = lotr_rightful_dwarven_liege
			}
		}
		title:e_western_yellow_mountains = {
			every_in_de_jure_hierarchy = {
			 	limit = { tier = tier_kingdom }
				set_de_jure_liege_title = title:e_yellow_mountains
			}
		}
		add_to_global_variable_list = {
			name = unavailable_unique_decisions
			target = flag:decision_reunite_yellow_mountains
		}
	}
}

decision_colonise_erebor = { ## Contributed by Immortal_Hybrid ~ Thank you! <3 //Aerien
	title = decision_colonise_erebor
	picture = {
		reference = "gfx/interface/illustrations/decisions/decision_dwarves_03.dds"
	}

	decision_group_type = realms_in_exile_major

	# AI
	ai_goal = yes
	ai_potential = { always = yes }
	ai_will_do = { base = 100 }

	selection_tooltip = decision_colonise_erebor_tooltip
	desc = {
		desc = decision_colonise_erebor_desc

		first_valid = {
			triggered_desc = {
				trigger = {
					game_start_date < 6803.9.23
				}
				desc = decision_colonise_erebor_pre_smaug
			}
			triggered_desc = {
				trigger = {
					game_start_date >= 6803.9.23
					game_start_date < 6974.11.30
				}
				desc = decision_colonise_erebor_post_smaug
			}
			triggered_desc = {
				trigger = {
					game_start_date > 6974.11.30
				}
				desc = decision_colonise_erebor_post_thorin
			}
		}
		desc = decision_colonise_erebor_outro
	}
	confirm_text = decision_colonise_erebor_confirm

	cooldown = { years = 50 }

	is_shown = {
		culture = { has_cultural_pillar = heritage_longbeard }
		highest_held_title_tier >= tier_kingdom
		dynasty = dynasty:dynasty_durin
		dynasty:dynasty_durin.dynast = root

		tom_holds_erebor = yes

		NOT = { title:c_throne_of_erebor.title_province = { has_building = smaug } }

		trigger_if = {
			limit = {
				title:k_khazad_dum.holder = { is_dwarf = yes }
			}
			NOT = {
				title:c_durins_hall.title_province = {
					has_building = wonder_durin_throne
				}
			}
		}
		trigger_if = {
			limit = {
				title:k_gundabad.holder = { is_dwarf = yes }
			}
			NOT = {
				title:c_gundabad.title_province = {
					has_building = wonder_gundabad_02
				}
			}
		}

		character:lineofdurin83 ?= {
			is_alive = no
		}

		game_start_date >= 6032.8.24

		trigger_if = {
			limit = {
				game_start_date >= 6803.9.23
				exists = character:lineofdurin83
			}
			character:lineofdurin83 = { is_alive = no }
		}
	}

	is_valid = {
		custom_tooltip = {
			text = tom_throne
			title:c_throne_of_erebor = {
				holder = character:k_wastelands_holder
				title_held_years >= 10
			}
		}
		custom_tooltip = {
			text = tom_raven
			title:c_ravenhill = {
				holder = character:k_wastelands_holder
				title_held_years >= 10
			}
		}
		custom_tooltip = {
			text = tom_deeps
			title:c_golddeeps = {
				holder = character:k_wastelands_holder
				title_held_years >= 10
			}
		}
		custom_tooltip = {
			text = tom_hall
			title:c_golden_hall = {
				holder = character:k_wastelands_holder
				title_held_years >= 10
			}
		}
		custom_tooltip = {
			text = tom_steel
			title:c_halls_of_steel = {
				holder = character:k_wastelands_holder
				title_held_years >= 10
			}
		}
		custom_tooltip = {
			text = tom_foudnries
			title:c_great_foundries = {
				holder = character:k_wastelands_holder
				title_held_years >= 10
			}
		}
		custom_tooltip = {
			text = tom_arken
			title:c_arkenhalls = {
				holder = character:k_wastelands_holder
				title_held_years >= 10
			}
		}
		prestige_level >= 4
	}

	is_valid_showing_failures_only = {
		is_imprisoned = no
		is_available_adult = yes
		is_at_war = no
		NOR = {
			has_trait = beardless_plague
			has_trait = beardless
		}
	}

	effect = {
		custom_tooltip = {
			text = colonises_erebor
			ai_colonisation_effect = { WASTELANDS = title:b_throne_of_erebor ROOT_SCOPE = root }
		}
		#Create the title and make it primary
		create_title_and_vassal_change = {
			type = created
			save_scope_as = title_change
			add_claim_on_loss = yes
		}
		title:k_erebor = {
			change_title_holder = {
				holder = root
				change = scope:title_change
			}
		}
		resolve_title_and_vassal_change = scope:title_change

		if = {
			limit = {
				NOT = { has_title = title:k_durins_folk }
				highest_held_title_tier <= tier_kingdom
			}
			set_primary_title_to = title:k_erebor
		}

		dynasty = { add_dynasty_prestige = 500 }
		add_piety = 250
	}

	cost = {
		gold = 2000
		prestige = 750
	}
}

decision_invite_dwarves = {
	title = decision_invite_dwarves
	picture = {
		reference = "gfx/interface/illustrations/activity_header_backgrounds/activity_expedition.dds"
	}

	ai_check_interval = 5
	ai_potential = {
		always = yes
	}
	ai_will_do = {
		base = 100
	}
	selection_tooltip = decision_invite_dwarves_tooltip
	desc = decision_invite_dwarves_desc
	confirm_text = decision_invite_dwarves_confirm

	decision_group_type = realms_in_exile_minor

	is_shown = {
		is_ruler = yes
		is_landed = yes
		NOT = { is_dwarf = yes } #Settle them yourself, you lazy git
		OR = {
			faith_is_good = yes
			faith_is_neutral = yes
		}

		# Not shown while already inviting someone
		NOT = { has_character_flag = invited_dwarves_into_nearby_mountains }

		# must control a province that has an entrace to the mountains:
		OR = { #
			show_gundabad_trigger = yes
			show_carn_dum_trigger = yes
			show_mount_gram_trigger = yes
			show_greydelve_trigger = yes
			show_grey_mountains_trigger = yes
			show_erebor_trigger = yes
			show_iron_hills_trigger = yes
			show_uldona_spine_trigger = yes
			show_moria_trigger = yes
			show_goblin_town_trigger = yes
			show_belegost_trigger = yes
			show_nogrod_trigger = yes
			show_glittering_caves_trigger = yes
			show_white_mountains_trigger = yes
			show_central_yellows_trigger = yes
			show_eastern_yellows_trigger = yes
			show_southern_yellows_trigger = yes
			show_blackflame_trigger = yes
		}
	}

	is_valid = {
		highest_held_title_tier >= tier_duchy
		prestige_level >= 3
		trigger_if = {
			limit = {
				NOT = { completely_controls = title:c_helmsdeep }
				NOT = { completely_controls = title:c_emyn_glaur }
			}
			custom_tooltip = {
				text = LOTR_FRIENDS_WITH_DWARF
				any_relation = {
					type = friend
					is_dwarf = yes
				}
			}
		}

		OR = {
			completely_controls = title:c_gundalok # Gundabad
			completely_controls = title:c_carn_dum # Angmar Mts.
			completely_controls = title:c_malenhad # Mt. Gram
			completely_controls = title:c_twainmantle # Grey Mts. West
			completely_controls = title:c_berafeld # Grey Mts. East
			completely_controls = title:c_dale # Erebor
			completely_controls = title:c_abkan_nurtad # Iron Hills
			completely_controls = title:c_marzgur # Uldona Spine
			completely_controls = title:c_dimrill_dale # Moria
			completely_controls = title:c_astberg # Goblin Town
			completely_controls = title:c_iznigumuni # Blue Mts. North
			completely_controls = title:c_bar_ereb # Blue Mts. South
			completely_controls = title:c_helmsdeep # White Mts. North
			completely_controls = title:c_emyn_glaur # White Mts. South
			completely_controls = title:c_dubanar_ag # Yellow Mts. Central
			completely_controls = title:c_mbara # Yellow Mts. East
			completely_controls = title:c_rusek_habor # Yellow Mts. West
			completely_controls = title:c_hailin # Yellow Mts. South
		}
	}

	is_valid_showing_failures_only = {
		is_imprisoned = no
		is_lotr_adult = yes
		is_at_war = no
	}

	widget = {
		gui = "decision_view_widget_option_list_generic"
		controller = decision_option_list_controller
		decision_to_second_step_button = "SELECT_ACTION"

		item = {	# Gundabad
			value = invite_dwarves_target_gundabad
			current_description = invite_dwarves_target_gundabad_desc
			localization = invite_dwarves_target_gundabad
			icon = "gfx/interface/icons/regimenttypes/war_troll.dds"
			is_shown = {
				OR = {
					has_title = title:k_langwell
					has_title = title:d_dweorad
					has_title = title:d_gundalok
					has_title = title:k_eotheod
					has_title = title:e_anduin_vale
					completely_controls = title:c_gundalok
					completely_controls = title:d_gundalok
				}
			}
			is_valid = { show_gundabad_trigger = yes }
			ai_chance = { value = 100 }
		}
		item = {	# Carn Dûm
			value = invite_dwarves_target_carn_dum
			current_description = invite_dwarves_target_carn_dum_desc
			localization = invite_dwarves_target_carn_dum
			icon = "gfx/interface/icons/regimenttypes/unburied_wights.dds"
			is_shown = {
				OR = {
					has_title = title:k_angmar
					has_title = title:d_kanelemas
					has_title = title:k_forochel
					has_title = title:e_arnor
					completely_controls = title:c_carn_dum
					completely_controls = title:d_kanelemas
				}
			}
			is_valid = { show_carn_dum_trigger = yes }
			ai_chance = { value = 100 }
		}
		item = {	# Mount Gram
			value = invite_dwarves_target_mount_gram
			current_description = invite_dwarves_target_mount_gram_desc
			localization = invite_dwarves_target_mount_gram
			icon = "gfx/interface/icons/regimenttypes/orc_warriors.dds"
			is_shown = {
				OR = {
					has_title = title:k_angmar
					has_title = title:d_nan_angmar
					has_title = title:k_rhudaur
					has_title = title:e_arnor
					completely_controls = title:c_malenhad
					completely_controls = title:d_nan_angmar
				}
			}
			is_valid = { show_mount_gram_trigger = yes }
			ai_chance = { value = 100 }
		}
		item = {	# Grey Mts. West
			value = invite_dwarves_target_greydelve
			current_description = invite_dwarves_target_greydelve_desc
			localization = invite_dwarves_target_greydelve
			icon = "gfx/interface/icons/regimenttypes/longbeard_skirmishers.dds"
			is_shown = {
				OR = {
					has_title = title:k_langwell
					has_title = title:d_ronen_in_anduin
					has_title = title:k_eotheod
					has_title = title:e_anduin_vale
					has_title = title:e_greenwood
					completely_controls = title:c_twainmantle
					completely_controls = title:d_ronen_in_anduin
				}
			}
			is_valid = { show_greydelve_trigger = yes }
			ai_chance = { value = 100 }
		}
		item = {	# Grey Mts. East
			value = invite_dwarves_target_grey_mountains
			current_description = invite_dwarves_target_grey_mountains_desc
			localization = invite_dwarves_target_grey_mountains
			icon = "gfx/interface/icons/regimenttypes/mountainorc_warriors.dds"
			is_shown = {
				OR = {
					has_title = title:k_langwell
					has_title = title:d_grey_mountain_narrows
					has_title = title:d_drakkenvast
					has_title = title:k_lasgalen
					has_title = title:k_dale
					completely_controls = title:c_berafeld
					completely_controls = title:d_grey_mountain_narrows
					completely_controls = title:d_drakkenvast
				}
			}
			is_valid = { show_grey_mountains_trigger = yes }
			ai_chance = { value = 100 }
		}
		item = {	# Erebor
			value = invite_dwarves_target_erebor
			current_description = invite_dwarves_target_erebor_desc
			localization = invite_dwarves_target_erebor
			icon = "gfx/interface/icons/regimenttypes/longbeard_pikemen.dds"
			is_shown = {
				OR = {
					has_title = title:k_lasgalen
					has_title = title:d_dalelands
					has_title = title:k_dale
					has_title = title:d_drakkenvast
					has_title = title:k_dorwinion
					has_title = title:k_rhovanion
					completely_controls = title:c_dale
					completely_controls = title:d_drakkenvast
					completely_controls = title:d_dalelands
				}
			}
			is_valid = { show_erebor_trigger = yes }
			ai_chance = { value = 100 }
		}
		item = {	# Iron Hills
			value = invite_dwarves_target_iron_hills
			current_description = invite_dwarves_target_iron_hills_desc
			localization = invite_dwarves_target_iron_hills
			icon = "gfx/interface/icons/regimenttypes/longbeard_crossbowmen.dds"
			is_shown = {
				OR = {
					has_title = title:k_dale
					has_title = title:d_azanulinbar_dum
					has_title = title:k_logathavuld
					has_title = title:d_iron_gap
					has_title = title:k_dorwinion
					has_title = title:k_nelornieth
					completely_controls = title:d_iron_gap
					completely_controls = title:d_azanulinbar_dum
					completely_controls = title:c_abkan_nurtad
				}
			}
			is_valid = { show_iron_hills_trigger = yes }
			ai_chance = { value = 100 }
		}
		item = {	# Uldona Spine
			value = invite_dwarves_target_uldona_spine
			current_description = invite_dwarves_target_uldona_spine_desc
			localization = invite_dwarves_target_uldona_spine
			icon = "gfx/interface/icons/regimenttypes/easterling_pikemen.dds"
			is_shown = {
				OR = {
					has_title = title:k_dorwinion
					has_title = title:d_dacranamel
					has_title = title:k_rhovanion
					has_title = title:e_rhovanion
					has_title = title:d_sekelavuld
					completely_controls = title:d_sekelavuld
					completely_controls = title:c_marzgur
				}
			}
			is_valid = { show_uldona_spine_trigger = yes }
			ai_chance = { value = 100 }
		}
		item = {	# Moria
			value = invite_dwarves_target_moria
			current_description = invite_dwarves_target_moria_desc
			localization = invite_dwarves_target_moria
			icon = "gfx/interface/icons/regimenttypes/undying_of_khazad_dum.dds"
			is_shown = {
				OR = {
					has_title = title:e_laurelindorenan
					has_title = title:k_lothlorien
					has_title = title:e_rhovanion
					has_title = title:d_iathglan
					completely_controls = title:d_iathglan
					completely_controls = title:c_dimrill_dale
				}
			}
			is_valid = { show_moria_trigger = yes }
			ai_chance = { value = 100 }
		}
		item = {	# Goblin Town
			value = invite_dwarves_target_goblin_town
			current_description = invite_dwarves_target_goblin_town_desc
			localization = invite_dwarves_target_goblin_town
			icon = "gfx/interface/icons/regimenttypes/cave_troll.dds"
			is_shown = {
				OR = {
					has_title = title:k_anduin_vale
					has_title = title:k_eotheod
					has_title = title:e_rhovanion
					has_title = title:d_carrock_vale
					has_title = title:d_high_pass
					completely_controls = title:d_carrock_vale
					completely_controls = title:c_astberg
					completely_controls = title:d_high_pass
				}
			}
			is_valid = { show_goblin_town_trigger = yes }
			ai_chance = { value = 100 }
		}
		item = {	# Blue Mountains North
			value = invite_dwarves_target_belegost
			current_description = invite_dwarves_target_belegost_desc
			localization = invite_dwarves_target_belegost
			icon = "gfx/interface/icons/regimenttypes/broadbeam_heavy_infantry.dds"
			is_shown = {
				OR = {
					has_title = title:e_arnor
					has_title = title:e_lindon
					has_title = title:d_hadhodor
					completely_controls = title:c_iznigumuni
					completely_controls = title:d_hadhodor
				}
			}
			is_valid = { show_belegost_trigger = yes }
			ai_chance = { value = 100 }
		}
		item = {	# Blue Mountains South
			value = invite_dwarves_target_nogrod
			current_description = invite_dwarves_target_nogrod_desc
			localization = invite_dwarves_target_nogrod
			icon = "gfx/interface/icons/regimenttypes/firebeard_pikemen.dds"
			is_shown = {
				OR = {
					has_title = title:e_arnor
					has_title = title:k_arthedain
					has_title = title:k_cardolan
					has_title = title:k_saralain
					has_title = title:d_hyarromenya
					completely_controls = title:c_bar_ereb
					completely_controls = title:d_hyarromenya
				}
			}
			is_valid = { show_nogrod_trigger = yes }
			ai_chance = { value = 100 }
		}
		item = {	# White Mountains North
			value = invite_dwarves_target_glittering_caves
			current_description = invite_dwarves_target_glittering_caves_desc
			localization = invite_dwarves_target_glittering_caves
			icon = "gfx/interface/icons/regimenttypes/eorlingas_warriors.dds"
			is_shown = {
				OR = {
					has_title = title:k_rohan
					has_title = title:d_westfold
					completely_controls = title:k_rohan
					completely_controls = title:c_helmsdeep
					completely_controls = title:d_westfold
				}
			}
			is_valid = { show_glittering_caves_trigger = yes }
			ai_chance = { value = 100 }
		}
		item = {	# White Mountains South
			value = invite_dwarves_target_white_mountains
			current_description = invite_dwarves_target_white_mountains_desc
			localization = invite_dwarves_target_white_mountains
			icon = "gfx/interface/icons/regimenttypes/gondor_infantry.dds"
			is_shown = {
				OR = {
					has_title = title:e_gondor
					has_title = title:e_gondor_steward
					has_title = title:e_castamir
					has_title = title:k_pinnath_gelin
					has_title = title:d_rhandir
					completely_controls = title:k_pinnath_gelin
					completely_controls = title:c_emyn_glaur
					completely_controls = title:d_rhandir
				}
			}
			is_valid = { show_white_mountains_trigger = yes }
			ai_chance = { value = 100 }
		}
		item = {	# Yellow Mountains Central
			value = invite_dwarves_target_barazimabul
			current_description = invite_dwarves_target_barazimabul_desc
			localization = invite_dwarves_target_barazimabul
			icon = "gfx/interface/icons/regimenttypes/blacklock_pikemen.dds"
			is_shown = {
				OR = {
					has_title = title:e_bozisha_miraz
					has_title = title:k_zajantak
					has_title = title:d_duban_urd
					completely_controls = title:c_dubanar_ag
					completely_controls = title:d_duban_urd
				}
			}
			is_valid = { show_central_yellows_trigger = yes }
			ai_chance = { value = 100 }
		}
		item = {	# Yellow Mountains East
			value = invite_dwarves_target_eastern_yellows
			current_description = invite_dwarves_target_eastern_yellows_desc
			localization = invite_dwarves_target_eastern_yellows
			icon = "gfx/interface/icons/regimenttypes/ivory_sentinels.dds"
			is_shown = {
				OR = {
					has_title = title:e_usakan
					has_title = title:k_usakan
					has_title = title:k_tanturak
					has_title = title:d_wariga
					has_title = title:d_gard_kinn
					completely_controls = title:c_mbara
					completely_controls = title:d_wariga
				}
			}
			is_valid = { show_eastern_yellows_trigger = yes }
			ai_chance = { value = 100 }
		}
		item = {	# Yellow Mountains South
			value = invite_dwarves_target_southern_yellows
			current_description = invite_dwarves_target_southern_yellows_desc
			localization = invite_dwarves_target_southern_yellows
			icon = "gfx/interface/icons/regimenttypes/goblin_warg_riders.dds"
			is_shown = {
				OR = {
					has_title = title:e_mag_tumag
					has_title = title:k_tumag
					has_title = title:d_kurusek
					completely_controls = title:c_rusek_habor
					completely_controls = title:d_kurusek
				}
			}
			is_valid = { show_southern_yellows_trigger = yes }
			ai_chance = { value = 100 }
		}
		item = {	# Blackflame
			value = invite_dwarves_target_blackflame
			current_description = invite_dwarves_target_blackflame_desc
			localization = invite_dwarves_target_blackflame
			icon = "gfx/interface/icons/regimenttypes/blacksteel_phalanx.dds"
			is_shown = {
				OR = {
					has_title = title:e_thani_hazad
					has_title = title:k_zimrathani
					has_title = title:k_pel
					has_title = title:d_kurdurasi
					completely_controls = title:c_hailin
					completely_controls = title:d_kurdurasi
				}
			}
			is_valid = { show_blackflame_trigger = yes }
			ai_chance = { value = 100 }
		}
	}

	cost = {
		prestige = minor_prestige_value
		gold = 100
	}

	cooldown = { years = 15 }

	effect = {
		custom_tooltip = decision_invite_dwarves_tt

		if = { # Gundabad
			limit = {
				scope:invite_dwarves_target_gundabad = yes
			}
			custom_tooltip = invite_dwarves_target_gundabad_tt
			root = {
				add_character_flag = {
					flag = invite_dwarves_target_gundabad_flag
					years = 1
				}
			}
		}
		else_if = { # Carn Dûm
			limit = {
				scope:invite_dwarves_target_carn_dum = yes
			}
			custom_tooltip = invite_dwarves_target_carn_dum_tt
			root = {
				add_character_flag = {
					flag = invite_dwarves_target_carn_dum_flag
					years = 1
				}
			}
		}
		else_if = { # Mount Gram
			limit = {
				scope:invite_dwarves_target_mount_gram = yes
			}
			custom_tooltip = invite_dwarves_target_mount_gram_tt
			root = {
				add_character_flag = {
					flag = invite_dwarves_target_mount_gram_flag
					years = 1
				}
			}
		}
		else_if = { # Greydelve
			limit = {
				scope:invite_dwarves_target_greydelve = yes
			}
			custom_tooltip = invite_dwarves_target_greydelve_tt
			root = {
				add_character_flag = {
					flag = invite_dwarves_target_greydelve_flag
					years = 1
				}
			}
		}
		else_if = { # Grey Mountains
			limit = {
				scope:invite_dwarves_target_grey_mountains = yes
			}
			custom_tooltip = invite_dwarves_target_grey_mountains_tt
			root = {
				add_character_flag = {
					flag = invite_dwarves_target_grey_mountains_flag
					years = 1
				}
			}
		}
		else_if = { # Erebor
			limit = {
				scope:invite_dwarves_target_erebor = yes
			}
			custom_tooltip = invite_dwarves_target_erebor_tt
			root = {
				add_character_flag = {
					flag = invite_dwarves_target_erebor_flag
					years = 1
				}
			}
		}
		else_if = { # Iron Hills
			limit = {
				scope:invite_dwarves_target_iron_hills = yes
			}
			custom_tooltip = invite_dwarves_target_iron_hills_tt
			root = {
				add_character_flag = {
					flag = invite_dwarves_target_iron_hills_flag
					years = 1
				}
			}
		}
		else_if = { # Uldona Spine
			limit = {
				scope:invite_dwarves_target_uldona_spine = yes
			}
			custom_tooltip = invite_dwarves_target_uldona_spine_tt
			root = {
				add_character_flag = {
					flag = invite_dwarves_target_uldona_spine_flag
					years = 1
				}
			}
		}
		else_if = { # Moria
			limit = {
				scope:invite_dwarves_target_moria = yes
			}
			custom_tooltip = invite_dwarves_target_moria_tt
			root = {
				add_character_flag = {
					flag = invite_dwarves_target_moria_flag
					years = 1
				}
			}
		}
		else_if = { # Goblin Town
			limit = {
				scope:invite_dwarves_target_goblin_town = yes
			}
			custom_tooltip = invite_dwarves_target_goblin_town_tt
			root = {
				add_character_flag = {
					flag = invite_dwarves_target_goblin_town_flag
					years = 1
				}
			}
		}
		else_if = { # Blue Mountains North
			limit = {
				scope:invite_dwarves_target_belegost = yes
			}
			custom_tooltip = invite_dwarves_target_belegost_tt
			root = {
				add_character_flag = {
					flag = invite_dwarves_target_belegost_flag
					years = 1
				}
			}
		}
		else_if = { # Blue Mountains South
			limit = {
				scope:invite_dwarves_target_nogrod = yes
			}
			custom_tooltip = invite_dwarves_target_nogrod_tt
			root = {
				add_character_flag = {
					flag = invite_dwarves_target_nogrod_flag
					years = 1
				}
			}
		}
		else_if = { # White Mountains North
			limit = {
				scope:invite_dwarves_target_glittering_caves = yes
			}
			custom_tooltip = invite_dwarves_target_glittering_caves_tt
			root = {
				add_character_flag = {
					flag = invite_dwarves_target_glittering_caves_flag
					years = 1
				}
			}
		}
		else_if = { # White Mountains South
			limit = {
				scope:invite_dwarves_target_white_mountains = yes
			}
			custom_tooltip = invite_dwarves_target_white_mountains_tt
			root = {
				add_character_flag = {
					flag = invite_dwarves_target_white_mountains_flag
					years = 1
				}
			}
		}
		else_if = { # Yellow Mountains Central
			limit = {
				scope:invite_dwarves_target_barazimabul = yes
			}
			custom_tooltip = invite_dwarves_target_barazimabul_tt
			root = {
				add_character_flag = {
					flag = invite_dwarves_target_barazimabul_flag
					years = 1
				}
			}
		}
		else_if = { # Yellow Mountains East
			limit = {
				scope:invite_dwarves_target_eastern_yellows = yes
			}
			custom_tooltip = invite_dwarves_target_eastern_yellows_tt
			root = {
				add_character_flag = {
					flag = invite_dwarves_target_eastern_yellows_flag
					years = 1
				}
			}
		}
		else_if = { # Yellow Mountains South
			limit = {
				scope:invite_dwarves_target_southern_yellows = yes
			}
			custom_tooltip = invite_dwarves_target_southern_yellows_tt
			root = {
				add_character_flag = {
					flag = invite_dwarves_target_southern_yellows_flag
					years = 1
				}
			}
		}
		else_if = { # Blackflame
			limit = {
				scope:invite_dwarves_target_blackflame = yes
			}
			custom_tooltip = invite_dwarves_target_blackflame_tt
			root = {
				add_character_flag = {
					flag = invite_dwarves_target_blackflame_flag
					years = 1
				}
			}
		}

		dynasty = { add_dynasty_prestige = 100 }
		add_legitimacy = minor_legitimacy_gain

		trigger_event = rohan.2500
	}
}

decision_unite_the_western_houses = {
	title = decision_unite_the_western_houses
	desc = decision_unite_the_western_houses_desc
	confirm_text = decision_unite_the_western_houses_confirm
	selection_tooltip = decision_unite_the_western_houses_tooltip
	picture = {
		reference ="gfx/interface/illustrations/decisions/decision_blue_mountains_01.dds"
	}

	decision_group_type = realms_in_exile_major

	# AI
	ai_goal = yes
	ai_potential = {
		always = yes
	}
	ai_will_do = {
		base = 100
	}

	# IS SHOWN
	is_shown = {
		is_dwarf = yes
		title:e_blue_mountains = {
			any_de_jure_county = {
				holder = root
			}
		}
		NOT = {
			is_target_in_global_variable_list = {
				name = unavailable_unique_decisions
				target = flag:decision_unite_the_western_houses
			}
		}
		NAND = {
			has_title = title:k_belegost
			has_title = title:k_buzra_dum
		}
	}

	# IS VALID
	is_valid = {
		prestige_level >= high_prestige_level
		OR = {
			completely_controls = title:k_belegost
			completely_controls = title:k_buzra_dum
			completely_controls = title:k_nogrod
		}
		trigger_if = {
			limit = {
				has_title = title:k_belegost
			}
			has_relation_friend = title:k_buzra_dum.holder
		}
		trigger_if = {
			limit = {
				has_title = title:k_buzra_dum
			}
			has_relation_friend = title:k_belegost.holder
		}
		trigger_if = {
			limit = {
				has_title = title:k_nogrod 
			}
			has_relation_friend = title:k_belegost.holder 
			has_relation_friend = title:k_buzra_dum.holder 
		}
		trigger_if = {
			limit = {
				has_title = title:k_belegost
			}
			is_allied_to = title:k_buzra_dum.holder
		}
		trigger_if = {
			limit = {
				has_title = title:k_buzra_dum
			}
			is_allied_to = title:k_belegost.holder
		}
		trigger_if = {
			limit = {
				has_title = title:k_nogrod 
			}
			is_allied_to = title:k_belegost.holder 
			is_allied_to = title:k_buzra_dum.holder 
		}
		custom_tooltip = {
			text = has_rebuilt_nogrod_or_belegost_desc
			has_rebuilt_nogrod_or_belegost_trigger = yes
		}
	}

	is_valid_showing_failures_only = {
		is_imprisoned = no
		is_available_adult = yes
		is_at_war = no
		NOR = {
			has_trait = beardless_plague
			has_trait = beardless
		}
	}

	cost = {
		prestige = 1000
	}

	# EFFECT
	effect = {
		get_title = title:e_blue_mountains
		dynasty = { add_dynasty_prestige = 750 }
		custom_tooltip = decision_unite_the_western_houses_tt
		trigger_event = dwarven.6200
		add_to_global_variable_list = {
			name = unavailable_unique_decisions
			target = flag:decision_unite_the_western_houses
		}
	}
}

restore_king_title = {
	title = restore_king_title
	picture = {
		reference = "gfx/interface/illustrations/decisions/decision_dwarves_02.dds"
	}

	decision_group_type = realms_in_exile_major

	# AI
	ai_goal = yes
	ai_potential = { always = yes }
	ai_will_do = { base = 100 }

	selection_tooltip = restore_king_title_tooltip
	desc = {
		first_valid = {
			triggered_desc = {
				trigger = {
					dynasty = dynasty:dynasty_durin
				}
				desc = restore_king_title_durin
			}
			triggered_desc = {
				trigger = {
					dynasty = dynasty:dynasty_dwalin
				}
				desc = restore_king_title_dwalin
			}
			triggered_desc = {
				trigger = {
					dynasty = dynasty:dynasty_uri
				}
				desc = restore_king_title_uri
			}
			triggered_desc = {
				trigger = {
					dynasty = dynasty:dynasty_thrar
				}
				desc = restore_king_title_thrar
			}
		}
	}

	is_shown = {
		is_dwarven_dynast = yes
		is_landed = yes
		lotr_not_crowned_dwarven_dynast = yes
	}

	is_valid = {
		highest_held_title_tier >= tier_duchy
		prestige_level >= 2
		is_landed = yes
		trigger_if = {
			limit = {
				NOT = { liege = root }
				liege.highest_held_title_tier <= tier_kingdom
			}
			is_independent_ruler = yes
		}
	}

	is_valid_showing_failures_only = {
		is_imprisoned = no
		is_available_adult = yes
		is_at_war = no
		NOR = {
			has_trait = beardless_plague
			has_trait = beardless
		}
	}

	effect = {
		lotr_crown_dwarven_dynast = yes
		if = {
			limit = {
				NOT = { has_character_flag = been_named_king }
				has_trait = dwarf_father
				OR = {
					any_owned_story = { story_type = story_dorfdad_reincarnation }
					is_canon_dorfdad = yes
				}
			}
			save_scope_as = my_dorfdad
			every_player = {
				trigger_event = {
					id = news_event.0026
					days = 1
				}
			}
		}
	}

	cost = {
		prestige = 750
	}
}

##########################
# Uldona Spine Decisions #
##########################

decision_uldona_spine_dwarf = { # Forge the one-duchy kingdom
	title = decision_uldona_spine_dwarf
	picture = {
		reference = "gfx/interface/illustrations/men_at_arms_big/longbeard_heavy_infantry.dds"
	}
	sort_order = 1000

	ai_goal = yes
	ai_potential = {
		always = yes
	}

	ai_will_do = {
		base = 100
	}

	selection_tooltip = decision_uldona_spine_dwarf_tooltip
	desc = decision_uldona_spine_dwarf_desc
	confirm_text = decision_uldona_spine_dwarf_confirm

	decision_group_type = realms_in_exile_major

	is_shown = {
		is_dwarf = yes
		OR = {
			has_title = title:c_falek_dim
			has_title = title:c_gabil_dum
			has_title = title:c_hathur_na_bunderok
			has_title = title:c_danakh_nala
			has_title = title:c_marzgur
		}

		NOR = {
			is_target_in_global_variable_list = {
				name = unavailable_unique_decisions
				target = flag:decision_uldona_spine_orc
			}
			is_target_in_global_variable_list = {
				name = unavailable_unique_decisions
				target = flag:decision_uldona_spine_dwarf
			}
		}
	}

	is_valid = {
		is_independent_ruler = yes
		is_dwarf = yes
		prestige_level >= 3
		province:5239 = {
			OR = {
				has_building_or_higher = military_specialization_01
				has_building_or_higher = economic_specialization_01
				has_building_or_higher = glory_specialization_01
			}
		}
		has_title = title:d_nurunkizdin
	}

	is_valid_showing_failures_only = {
		is_imprisoned = no
		is_available_adult = yes
		is_at_war = no
		NOR = {
			has_trait = beardless_plague
			has_trait = beardless
		}
	}

	cost = {
		prestige = 500
	}

	effect = {
		dynasty = { add_dynasty_prestige = 100 }
		get_title = title:k_nurunkizdin
		add_to_global_variable_list = {
			name = unavailable_unique_decisions
			target = flag:decision_uldona_spine_dwarf
		}
		add_piety_level = -1
	}
}

decision_nurunkizdin_remove_deepest_darkness = { # Remove the Deepest Darkness Modifier
	title = decision_nurunkizdin_remove_deepest_darkness
	picture = {
		reference = "gfx/interface/illustrations/decisions/decision_dwarves_02.dds"
	}
	sort_order = 1000

	ai_goal = yes
	ai_potential = {
		always = yes
	}

	ai_will_do = {
		base = 100
	}

	selection_tooltip = decision_nurunkizdin_remove_deepest_darkness_tooltip
	desc = decision_nurunkizdin_remove_deepest_darkness_desc
	confirm_text = decision_nurunkizdin_remove_deepest_darkness_confirm

	decision_group_type = realms_in_exile_major

	is_shown = {
		is_dwarf = yes
		has_title = title:k_nurunkizdin
		NOT = {
			is_target_in_global_variable_list = {
				name = unavailable_unique_decisions
				target = flag:decision_nurunkizdin_remove_deepest_darkness
			}
		}
	}

	is_valid = {
		is_independent_ruler = yes
		prestige_level >= 3
		province:5239 = {
			AND = {
				has_building_or_higher = dwarven_depths_07
				has_building_or_higher = dwarven_quarry_07
				has_building_or_higher = dwarven_roads_07
				has_building_or_higher = dwarven_toolmaker_guild_06
				has_building_or_higher = dwarven_terrace_farm_06
			}
		}
	}

	is_valid_showing_failures_only = {
		is_imprisoned = no
		is_available_adult = yes
		is_at_war = no
		NOR = {
			has_trait = beardless_plague
			has_trait = beardless
		}
	}

	cost = {
		gold = 750
	}

	effect = {
		add_piety = 250
		add_to_global_variable_list = {
			name = unavailable_unique_decisions
			target = flag:decision_nurunkizdin_remove_deepest_darkness
		}
		title:c_narikhar = {
			title:c_falek_dim = {
				remove_county_modifier = foundations_of_stone_county_modifier
			}
		}
		province:5239 = { add_special_building = wonder_uzfelak }
		trigger_event = {
			id = dwarven.6300
		}
	}
}

##########################
# Long Winter Decisions #
##########################

decision_kill_smaug = {
	picture = {
		reference = "gfx/interface/illustrations/decisions/decision_dwarves_02.dds"
	}
	decision_group_type = realms_in_exile_major

	# AI
	ai_potential = { always = yes }
	ai_will_do = { base = 100 }
	ai_check_interval = 6

	title = {
		first_valid = {
			triggered_desc = {
				trigger = { is_dwarf = yes }
				desc = decision_kill_smaug
			}
			triggered_desc = {
				trigger = { is_human = yes }
				desc = decision_kill_smaug_alt
			}
		}
	}
	desc = {
		first_valid = {
			triggered_desc = {
				trigger = { is_dwarf = yes }
				desc = decision_kill_smaug_desc
			}
			triggered_desc = {
				trigger = { is_human = yes }
				desc = decision_kill_smaug_desc_alt
			}
		}
	}
	confirm_text = {
		first_valid = {
			triggered_desc = {
				trigger = { is_dwarf = yes }
				desc = decision_kill_smaug_confirm
			}
			triggered_desc = {
				trigger = { is_human = yes }
				desc = decision_kill_smaug_confirm_alt
			}
		}
	}
	selection_tooltip = decision_kill_smaug_tooltip

	cooldown = { years = 20 }

	is_shown = {
		trigger_if = {
			limit = { is_dwarf = yes }
			culture = { has_cultural_pillar = heritage_longbeard }
		}
		trigger_else = {
			is_human = yes
		}

		tom_holds_erebor = yes

		title:c_throne_of_erebor.title_province = { has_building = smaug } # Smaug lives
	}

	is_valid = {
		custom_tooltip = {
			text = erebor_reclaim_timer
			current_date >= 6823.1.1
		}
		trigger_if = {
			limit = { is_dwarf = yes }
			OR = {
				trigger_if = {
					limit = {
						OR = {
							character:lineofdurin81 = { is_alive = yes }
							character:lineofdurin82 = { is_alive = yes }
							character:lineofdurin83 = { is_alive = yes }
						}
					}
					custom_tooltip = {
						text = decision_kill_smaug_character.tt
						OR = {
							character:lineofdurin81 = { this = root }
							character:lineofdurin82 = { this = root }
							character:lineofdurin83 = { this = root }
						}
					}
				}
				trigger_if = {
					limit = { dynasty = dynasty:dynasty_durin any_owned_story = { story_type = story_dorfdad_reincarnation } }
					has_trait = dwarf_father
				}
				has_trait = brave
				has_trait = zealous
				has_trait = impatient
				has_trait = stubborn
			}
			prestige_level >= 3
			OR = {
				is_landed = yes
				dynasty = dynasty:dynasty_durin
			}
		}
		trigger_else = {
			has_title = title:k_dale
			completely_controls = title:c_esgaroth
			prestige_level >= 5
			OR = {
				character:lineofdurin81 = {
					is_alive = yes
					is_ruler = yes
				}
				character:lineofdurin82 = {
					is_alive = yes
					is_ruler = yes
				}
				character:lineofdurin83 = {
					is_alive = yes
					is_ruler = yes
				}
				dynasty:dynasty_durin = {
					any_dynasty_member = {
						is_alive = yes
						is_ruler = yes
					}
				}
				culture:longbeards = { exists = culture_head }
				culture:iron_hills = { exists = culture_head }
			}
		}
	}

	is_valid_showing_failures_only = {
		is_ai = no
		is_imprisoned = no
		is_available_adult = yes
		is_at_war = no
		NOR = {
			has_trait = beardless_plague
			has_trait = beardless
		}
	}

	effect = {
		if = {
			limit = { is_dwarf = yes }
			save_temporary_scope_as = chosen_dwarf
			trigger_event = {
				id = smaug_event_chain.0300
			}
		}
		else = {
			if = {
				limit = {
					character:lineofdurin81 = { is_alive = yes }
					is_ruler = yes
				}
				character:lineofdurin81 = { save_temporary_scope_as = chosen_dwarf }
			}
			else_if = {
				limit = {
					character:lineofdurin82 = { is_alive = yes }
					is_ruler = yes
				}
				character:lineofdurin82 = { save_temporary_scope_as = chosen_dwarf }
			}
			else_if = {
				limit = {
					character:lineofdurin83 = { is_alive = yes }
					is_ruler = yes
				}
				character:lineofdurin83 = { save_temporary_scope_as = chosen_dwarf }
			}
			else_if = {
				limit = {
					dynasty:dynasty_durin = {
						any_dynasty_member = {
							is_alive = yes
							is_ruler = yes
						}
					}
				}
				dynasty:dynasty_durin.dynast = { save_temporary_scope_as = chosen_dwarf }
			}
			else_if = {
				limit = { culture:longbeards = { exists = culture_head } }
				culture:longbeards.culture_head = { save_temporary_scope_as = chosen_dwarf }
			}
			else_if = {
				limit = { culture:iron_hills = { exists = culture_head } }
				culture:iron_hills.culture_head = { save_temporary_scope_as = chosen_dwarf }
			}
			save_scope_as = dale_king
			scope:chosen_dwarf ?= {
				trigger_event = {
					id = smaug_event_chain.0398
					days = 1
				}
			}
		}
		custom_tooltip = decision_enter_erebor_chances
		if = {
			limit = { is_dwarf = yes }
			if = {
				limit = {
					dynasty:dynasty_aivadiuria = {
						any_dynasty_member = { is_alive = yes }
					}
				}
				custom_tooltip = decision_kill_smaug_decision_effect_1
			}
			else = { custom_tooltip = decision_kill_smaug_decision_effect_1_a }
		}
		else = { custom_tooltip = decision_kill_smaug_decision_effect_1_b }
		custom_tooltip = decision_kill_smaug_decision_effect_2
		custom_tooltip = decision_kill_smaug_decision_effect_3
	}

	cost = {
		gold = 200
		prestige = 750
	}
}

decision_usurp_dynast = {
	title = decision_usurp_dynast
	picture = {
		reference = "gfx/interface/illustrations/decisions/decision_dwarves_02.dds"
	}

	decision_group_type = realms_in_exile_major

	# AI
	ai_goal = yes
	ai_potential = { always = yes }
	ai_will_do = { base = 100 }

	selection_tooltip = decision_usurp_dynast_tooltip
	desc = decision_usurp_dynast_desc
	confirm_text = decision_usurp_dynast_confirm

	cooldown = { years = 20 }

	is_shown = {
		OR = {
			dynasty = dynasty:dynasty_durin
			dynasty = dynasty:dynasty_dwalin
			dynasty = dynasty:dynasty_uri
			dynasty = dynasty:dynasty_thrar
			dynasty = dynasty:dynasty_sindri
			dynasty = dynasty:dynasty_bavor
			dynasty = dynasty:dynasty_thulin
		}
		NOT = { is_dwarven_dynast = yes }
		trigger_if = {
			limit = { dynasty = dynasty:dynasty_durin }
			character:lineofdurin81 ?= {  NOT = { is_dwarven_dynast = yes } }
		}
		trigger_if = {
			limit = { dynasty = dynasty:dynasty_durin }
			character:lineofdurin82 ?= {  NOT = { is_dwarven_dynast = yes } }
		}
		trigger_if = {
			limit = { dynasty = dynasty:dynasty_durin }
			character:lineofdurin83 ?= {  NOT = { is_dwarven_dynast = yes } }
		}
	}

	is_valid_showing_failures_only = {
		is_ai = no
		is_imprisoned = no
		is_available_adult = yes
		is_at_war = no
		NOR = {
			has_trait = beardless_plague
			has_trait = beardless
		}
	}

	is_valid = {
		trigger_if = {
			limit = {
				dynasty.dynast = {
					NOR = {
						any_owned_story = { story_type = story_dorfdad_reincarnation }
						is_canon_dorfdad = yes
						has_trait = dwarf_father
					}
				}
			}
			dynasty.dynast.house = root.house
			OR = {
				AND = {
					custom_tooltip = {
						text = army_bigger
						total_strength > dynasty.dynast.total_strength
					}
					OR = {
						has_trait = ambitious
						has_trait = arrogant
						has_trait = disloyal
						has_trait = eccentric
					}
				}
				AND = {
					dynasty.dynast = {
						OR = {
							dread >= 75
							tyranny >= 75
						}
					}
					OR = {
						has_trait = compassionate
						has_trait = just
					}
				}
			}
			AND = {
				trigger_if = {
					limit = { dynasty.dynast = { has_trait = family_first } }
					has_trait = family_first
				}
				trigger_if = {
					limit = { dynasty.dynast = { has_trait = august } }
					has_trait = august
				}
			}
			highest_held_title_tier >= dynasty.dynast.primary_title.tier
		}
		trigger_else = {
			custom_tooltip = {
				text = cannot_usurp_dorfdad
				dynasty.dynast = {
					NOR = {
						any_owned_story = { story_type = story_dorfdad_reincarnation }
						is_canon_dorfdad = yes
						has_trait = dwarf_father
					}
				}
			}
		}
	}

	effect = {
		trigger_event = dwarven.9805
	}
}

decision_rally_dwarves = {
	title = decision_rally_dwarves
	picture = {
		reference = "gfx/interface/illustrations/decisions/decision_dwarves_04.dds"
	}

	decision_group_type = realms_in_exile_major

	selection_tooltip = decision_rally_dwarves_tooltip
	desc = decision_rally_dwarves_desc
	confirm_text = decision_rally_dwarves_confirm
	
	is_shown = {
		has_character_flag = thror_primary_heir
		has_variable = unlock_rally_dwarves_decision

		NOT = {
			is_target_in_global_variable_list = {
				name = unavailable_unique_decisions
				target = flag:decision_rally_dwarves
			}
		}
	}

	# IS_VALID
	is_valid = { 
		custom_tooltip = {
			text = decision_rally_dwarves_tt
			character:lineofdurin81 = { is_alive = no }
		}
		custom_tooltip = {
			text = moria_has_orcs
			title:c_durins_hall.holder = { is_orc = yes }
		}	
	 }
	is_valid_showing_failures_only = {
		is_imprisoned = no
		is_available_adult = yes
		is_at_war = no
	}

	# EFFECT 
	effect = {
		custom_tooltip = decision_rally_dwarves_effect_tt
		trigger_event = {
			id = smaug_event_chain.0123
			days = 10
		}
		
		remove_variable = unlock_rally_dwarves_decision

		add_to_global_variable_list = {
			name = unavailable_unique_decisions
			target = flag:decision_rally_dwarves
		}
	}

	cost = {
		prestige = 500
		piety = 250
	}

	# AI
	ai_goal = yes
	ai_potential = { always = yes }
	ai_will_do = { base = 100 }
}

decision_moria_war_thror_heir = {
	sort_order = 100
	title = decision_moria_war_thror_heir
	picture = {
		reference ="gfx/interface/illustrations/decisions/decision_dwarves_05.dds"
	}
	selection_tooltip = decision_moria_war_thror_heir_tooltip
	desc = decision_moria_war_thror_heir_desc
	confirm_text = decision_moria_war_thror_heir_confirm

	decision_group_type = realms_in_exile_major

	is_shown = {
		has_character_flag = war_of_dwarves_and_orcs
		NOT = {
			is_target_in_global_variable_list = {
				name = unavailable_unique_decisions
				target = flag:decision_moria_war_thror_heir
			}
		}
	}
		
	is_valid = {
		is_independent_ruler = yes
		custom_tooltip = {
			text = moria_has_orcs
			title:c_durins_hall.holder = { is_orc = yes }
		}		
		prestige_level >= 3
	}
	
	is_valid_showing_failures_only = {
		is_imprisoned = no
		is_available_adult = yes
		is_at_war = no
	}
	
	effect = {
		custom_tooltip = decision_moria_war_thror_heir_tt
		trigger_event = smaug_event_chain.0127
		add_to_global_variable_list = {
			name = unavailable_unique_decisions
			target = flag:decision_moria_war_thror_heir
		}

		spawn_army = {
			levies = 500
			men_at_arms = {
				type = onager
				stacks = 5
			}
			location = root.location
			name = thrors_vengeance_troops
		}
	}
	cost = {
		prestige = 500
		piety = 500
	}

	# AI value
	ai_goal = yes
	ai_potential = { always = yes }
	ai_will_do = { base = 100 }
}

##########################
# Dwarf racial decisions #
##########################

dwarven_beard_care_decision = { # Groom that beard! ~ by Xenephulon
	picture = {
		reference ="gfx/interface/illustrations/decisions/decision_dwarves_01.dds"
	}

	ai_check_interval = 120

	cooldown = { days = 1825 }

	decision_group_type = realms_in_exile_minor

	sort_order = 10

	is_shown = {
		is_ruler = yes # Let's not do this for the proletariat
		OR = {
			is_dwarf = yes
			has_game_rule = beards_for_all # If the other peoples have beards, why not?
		}
		age >= 18 #Up from 12
		NOT = { has_trait = beardless }
	}

	is_valid_showing_failures_only = { # Gotta be able to get to the barber
		is_imprisoned = no
		NOT = { has_trait = incapable }
		NAND = {
			is_female = yes
			has_game_rule = no_female_beards # Added here because I need the people to know what they're missing out on by not giving the lasses beards
		}
	}

	effect = {
		custom_tooltip = dwarven_beard_care_decision_effect_tooltip

		show_as_tooltip = {
			add_character_modifier = {
				modifier = beard_care_standard_modifier
				years = 2
			}
		}

		trigger_event = {
			on_action = stress_loss_dwarven_beard_care
		}
	}

	ai_potential = {
		always = yes
	}

	ai_will_do = {
		base = 10 # It's nice to do even if you don't have stress

		modifier = {
			add = 100
			stress > 10
		}
	}
}

# Dwarven Crafting Decisions
decision_dragon_slaying_weapon = {
	picture = {
		reference ="gfx/interface/illustrations/decisions/decision_dwarves_01.dds"
	}

	ai_check_interval = 120

	decision_group_type = realms_in_exile_minor

	sort_order = 20

	selection_tooltip = decision_dragon_slaying_weapon_tooltip
	desc = decision_dragon_slaying_weapon_desc
	confirm_text = decision_dragon_slaying_weapon_confirm

	is_shown = {
		is_dwarf = yes
	}

	is_valid = {
		any_held_title = {
			title_province ?= { has_building_or_higher = dwarven_forge_04 }
		}
		trigger_if = {
			limit = { has_variable = forged_slayer_artifact }
			custom_tooltip = {
				text = slayer_artifact_cooldown
				NOT = { has_variable = forged_slayer_artifact }
			}
		}
		OR = {
			custom_tooltip = {
				text = no_black_arrow
				NOT = { any_character_artifact = { has_variable = black_arrow } }
			}
			custom_tooltip = {
				text = no_windlance
				NOT = { any_character_artifact = { has_variable = windlance_bolt } }
			}
		}
	}

	is_valid_showing_failures_only = {
		is_imprisoned = no
		NOT = { has_trait = incapable }
	}

	widget = {
		gui = "decision_view_widget_option_list_generic"
		controller = decision_option_list_controller
		decision_to_second_step_button = "SELECT_ACTION"

		item = {	# Black Arrow
			value = dragon_slaying_weapon_black_arrow
			current_description = dragon_slaying_weapon_black_arrow_desc
			localization = dragon_slaying_weapon_black_arrow
			icon = "gfx/interface/icons/artifact/artifact_icons_unique_black_arrow.dds"
			is_shown = {  NOT = { any_character_artifact = { has_variable = black_arrow } } }
			is_valid = {  NOT = { any_character_artifact = { has_variable = black_arrow } } }
			ai_chance = { value = 100 }
		}
		item = {	# Windlance Bolt
			value = dragon_slaying_weapon_windlance_bolt
			current_description = dragon_slaying_weapon_windlance_bolt_desc
			localization = dragon_slaying_weapon_windlance_bolt
			icon = "gfx/interface/icons/artifact/artifact_icons_unique_black_arrow.dds"
			is_shown = {  NOT = { any_character_artifact = { has_variable = windlance_bolt } } }
			is_valid = {  NOT = { any_character_artifact = { has_variable = windlance_bolt } } }
			ai_chance = { value = 100 }
		}
	}

	effect = {
		custom_tooltip = dragon_slaying_weapon_tt
		trigger_event = artifact_crafting.0001
	}

	ai_potential = {
		always = yes
	}

	ai_will_do = {
		base = 50
		modifier = {
			add = 50
			NOT = {
				any_character_artifact = { has_variable = black_arrow }
				any_character_artifact = { has_variable = windlance_bolt }
			}
		}
		modifier = {
			add = 25
			AND = {
				OR = {
					any_character_artifact = { has_variable = black_arrow }
					any_character_artifact = { has_variable = windlance_bolt }
				}
				NOR = {
					any_character_artifact = { has_variable = black_arrow }
					any_character_artifact = { has_variable = windlance_bolt }
				}
			}
		}
		modifier = {
			add = -50
			AND = {
				any_character_artifact = { has_variable = black_arrow }
				any_character_artifact = { has_variable = windlance_bolt }
			}
		}
	}
}

decision_king_under_the_mountains = {
	picture = {
		trigger = { is_dwarf = yes }
		reference ="gfx/interface/illustrations/decisions/decision_dwarves_01.dds"
	}
	picture = {
		trigger = { is_orc = yes }
		reference = "gfx/interface/illustrations/decisions/decision_orcs_01.dds"
	}

	decision_group_type = realms_in_exile_major

	sort_order = 20
	

	title = {
		triggered_desc = {
			trigger = { is_orc = yes }
			desc = decision_king_under_the_mountains_orc
		}
		triggered_desc = {
			trigger = { is_dwarf = yes }
			desc = decision_king_under_the_mountains
		}
	}
	selection_tooltip = {
		triggered_desc = {
			trigger = { is_orc = yes }
			desc = decision_king_under_the_mountains_tooltip_orc
		}
		triggered_desc = {
			trigger = { is_dwarf = yes }
			desc = decision_king_under_the_mountains_tooltip
		}
	}
	desc = {
		triggered_desc = {
			trigger = { is_orc = yes }
			desc = decision_king_under_the_mountains_desc_orc
		}
		triggered_desc = {
			trigger = { is_dwarf = yes }
			desc = decision_king_under_the_mountains_desc
		}
	}
	confirm_text = {
		triggered_desc = {
			trigger = { is_orc = yes }
			desc = decision_king_under_the_mountains_confirm_orc
		}
		triggered_desc = {
			trigger = { is_dwarf = yes }
			desc = decision_king_under_the_mountains_confirm
		}
	}

	is_shown = {
		OR = {
			is_orc = yes
			is_dwarf = yes
		}
		is_playable_character = yes
		trigger_if = {
			limit = { is_dwarf = yes }
			trigger_if = {
				limit = {
					dynasty = dynasty:dynasty_durin
					dynasty = dynasty:dynasty_uri
					dynasty = dynasty:dynasty_dwalin
					dynasty = dynasty:dynasty_thrar
					dynasty = dynasty:dynasty_sindri
					dynasty = dynasty:dynasty_thulin
					dynasty = dynasty:dynasty_bavor
				}
				is_dwarven_dynast = yes
			}
			trigger_else = {
				highest_held_title_tier >= tier_kingdom
			}
		}
		trigger_else = {
			highest_held_title_tier >= tier_empire
		}
		NOT = {
			is_target_in_global_variable_list = {
				name = unavailable_unique_decisions
				target = flag:decision_king_under_the_mountains
			}
		}
	}

	is_valid = {
		is_independent_ruler = yes
		prestige_level >= max_prestige_level
		piety_level >= max_piety_level
		legitimacy_level >= max_legitimacy_level_value
		trigger_if = {
			limit = { is_dwarf = yes }
			trigger_if = {
				limit = {
					is_target_in_global_variable_list = {
						name = unavailable_unique_decisions
						target = flag:decision_unify_durins_folk
					}
				}
				has_title = title:e_durins_folk
			}
			trigger_else = {
				has_title = title:e_misty_mountains
				has_title = title:e_iron_mountains
			}
			has_title = title:e_blue_mountains
			has_title = title:e_white_mountains
			has_title = title:e_yellow_mountains
			trigger_if = {
				limit = {
					NOT = {
						is_target_in_global_variable_list = {
							name = unavailable_unique_decisions
							target = flag:decision_unite_the_western_houses
						}
					}
				}
				has_title = title:e_western_yellow_mountains
			}
		}
		trigger_else = {
			completely_controls_region = middleearth_mountains_blue
			completely_controls_region = middleearth_mountains_misty
			completely_controls_region = middleearth_mountains_iron
			completely_controls_region = middleearth_mountains_white
			completely_controls_region = middleearth_mountains_yellow
		}
	#	completely_controls_region = middleearth_mountains_red # To do when we expand
	
		trigger_if = {
			limit = { is_dwarf = yes }
			custom_tooltip = {
				text = vassal_opinion_requirements
				any_vassal = {
					count = all
					is_dwarven_dynast = yes
					OR = {
						highest_held_title_tier < tier_county
						OR = {
							# your friend
							has_relation_friend = root
							AND = {
								has_diarchy_type = regency
								diarch = {
									has_relation_friend = root
								}
							}
							# your lover
							has_relation_lover = root
							AND = {
								has_diarchy_type = regency
								diarch = {
									has_relation_lover = root
								}
							}
							# Your ally
							any_ally = {
								this = root
							}
							AND = {
								has_diarchy_type = regency
								diarch = {
									any_ally = {
										this = root
									}
								}
							}
							# Your hooked
							root = {
								has_hook = prev
							}
							AND = {
								has_diarchy_type = regency
								diarch = {
									root = {
										has_hook = prev
									}
								}
							}
						}
					}
				}
			}
			trigger_if = {
				limit = { dynasty = dynasty:dynasty_durin }
				custom_tooltip = {
					text = unify_durins_folk_requirement
					is_target_in_global_variable_list = {
						name = unavailable_unique_decisions
						target = flag:decision_unify_durins_folk
					}
				}
			}
			trigger_if = {
				limit = {
					OR = {
						dynasty = dynasty:dynasty_uri
						dynasty = dynasty:dynasty_dwalin
					}
					custom_tooltip = {
						text = united_western_houses_requirement
						is_target_in_global_variable_list = {
							name = unavailable_unique_decisions
							target = flag:decision_unite_the_western_houses
						}
					}
				}
			}
			trigger_if = {
				limit = { dynasty = dynasty:dynasty_thrar }
				custom_tooltip = {
					text = reunite_yellow_mountains_requirement
					is_target_in_global_variable_list = {
						name = unavailable_unique_decisions
						target = flag:decision_reunite_yellow_mountains
					}
				}
			}
			# To do when we expand
		#	trigger_if = {
		#		limit = { dynasty = dynasty:dynasty_sindri }
		#	}
		#	trigger_if = {
		#		limit = { dynasty = dynasty:dynasty_thulin }
		#	}
		#	trigger_if = {
		#		limit = { dynasty = dynasty:dynasty_bavor }
		#	}
			custom_tooltip = {
				text = balrog_dead_requirement
				NOT = { exists = struggle:balrog_struggle }
			}
			province:4909 = { has_building = wonder_durin_throne }
			province:4841 = { has_building = wonder_belegost_reborn }
			province:4869 = { has_building = wonder_nogrod_reborn }
			province:7884 = { has_building = wonder_mabladdum_reborn }
			province:5249 = { has_building = wonder_nar_agathol_3 }
			province:3210 = { has_building = wonder_gundabad_02 }
		}
		trigger_else = {
			has_title = title:e_servants_of_the_dark_flame
			custom_tooltip = {
				text = unify_durins_folk_orc_requirement
				NOT = {
					is_target_in_global_variable_list = {
						name = unavailable_unique_decisions
						target = flag:decision_unify_durins_folk
					}
				}
			}
			province:4841 = { has_building = wonder_belegost_broken }
			province:4869 = { has_building = wonder_nogrod_broken }
			province:7884 = { has_building = wonder_mabladdum_orcish }
			province:5249 = { has_building = wonder_nar_agathol }
			province:3210 = { has_building = wonder_gundabad_01 }
		}
	}

	effect = {
		show_as_tooltip = { mountains_hegeomy_formation_effect = yes }
		get_title = title:h_mountains
		if = {
			limit = { is_dwarf = yes }
			show_as_tooltip = { title:h_mountains = { add_title_law = dwarven_hegemonic_elective_succession_law } }
			trigger_event = dwarven.9999
		}
		add_to_global_variable_list = {
			name = unavailable_unique_decisions
			target = flag:decision_king_under_the_mountains
		}
	}

	# AI
	ai_goal = yes
	ai_potential = { always = yes }
	ai_will_do = { base = 100 }
}