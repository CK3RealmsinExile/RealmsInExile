######################
# Druedain Decisions #
######################

### Major Decisions ###

decision_reclaim_ray = { # Reclaim the Ray for the Honnin, pushing out the Haradrim invaders!
	title = decision_reclaim_ray
	picture = {
		reference = "gfx/interface/illustrations/decisions/decision_druadan_02.dds"
	}
	
	ai_goal = yes
	ai_potential = {
		always = yes
	}
	ai_will_do = {
		base = 100
	}
	selection_tooltip = decision_reclaim_ray_tooltip
	desc = decision_reclaim_ray_desc
	confirm_text = decision_reclaim_ray_confirm
	
	decision_group_type = realms_in_exile_major
	
	is_shown = {
		is_landed = yes
		OR = {
			culture = culture:honnin
			culture = { any_parent_culture_or_above = { this = culture:honnin } } #account for divergent cultures
		}
		NOT = {
			is_target_in_global_variable_list = {
				name = unavailable_unique_decisions
				target = flag:reclaim_ray_decision
				}
			}
		}
	is_valid = {
		completely_controls_region = custom_greater_ray
		prestige_level >= high_prestige_level
		is_independent_ruler = yes
	}
	
	is_valid_showing_failures_only = {
		is_imprisoned = no
		is_available_adult = yes
		is_at_war = no
	}
	
	effect = {
		if = { # The First Men | Achievement
			limit = {
				NOT = { exists = global_var:lotr_achievement_16 }
				realms_achievements_enabled = yes
				is_ai = no
			}
			set_global_variable = lotr_achievement_16
		}
		if = {
			limit = { government_has_flag = government_is_tribal }
			convert_whole_realm_to_feudalism_effect = yes
			add_realm_law_skip_effects = crown_authority_1
			root.culture = {
				get_all_innovations_from = culture:bozishnarud
			}
			add_prestige_level = 2
			root.dynasty = {
				add_dynasty_prestige = 500
			}
			give_nickname = nick_honnin_restorer
			hidden_effect = {
				every_realm_province = {
					limit = {
						culture = { has_cultural_pillar = heritage_southern_apysaic }
					}
					add_province_modifier = { modifier = honnin_resettlements years = 100 }
				}
			}
		}
		else_if = {
			limit = { 
				OR = {
					government_has_flag = government_is_clan
					government_has_flag = government_is_feudal
				}
			}
			root.culture = {
				get_all_innovations_from = culture:bozishnarud
			}
			add_prestige_level = 2
			root.dynasty = {
				add_dynasty_prestige = 500
			}
			give_nickname = nick_honnin_restorer
			add_realm_law_skip_effects = crown_authority_3
			add_piety = 1000
			add_prestige = 1000
			capital_county = {
				change_development_progress_with_overflow = 750
			}
			hidden_effect = {
				every_realm_province = {
					limit = {
						culture = { has_cultural_pillar = heritage_southern_apysaic }
					}
					add_province_modifier = { modifier = honnin_resettlements years = 100 }
				}
			}
		}
		
		add_to_global_variable_list = {
			name = unavailable_unique_decisions
			target = flag:reclaim_ray_decision
		}
		save_scope_as = honnin_restorer
		if = {
			limit = { # Major News
				NOT = { has_game_rule = no_news }
			}
			every_player = { #Global News Announcement
				trigger_event = news_event.0009
			}
		}
	}
}

decision_rediscover_yatalin_gan = { # Rediscover the lost lands of the Yatali-Gan
	title = decision_rediscover_yatalin_gan
	picture = {
		reference = "gfx/interface/illustrations/decisions/decision_barrow_03.dds"
	}
	
	ai_goal = no
	ai_potential = {
		always = no
	}
	ai_check_interval = 0

	selection_tooltip = decision_rediscover_yatalin_gan_tooltip
	desc = decision_rediscover_yatalin_gan_desc
	confirm_text = decision_rediscover_yatalin_gan_confirm
	
	decision_group_type = realms_in_exile_major
	
	is_shown = {
		is_landed = yes
		OR = {
			culture = culture:honnin
			culture = { any_parent_culture_or_above = { this = culture:honnin } } #account for divergent cultures
		}
		NOT = {
			is_target_in_global_variable_list = {
				name = unavailable_unique_decisions
				target = flag:decision_rediscover_yatalin_gan
			}
		}
		title:c_bru_kha.title_province = { has_holding_type = wastelands_holding } # Bru-Kha must be wilderness
	}
	is_valid = {
		is_independent_ruler = yes
		prestige_level >= 2
		title:c_bru_kha.title_province = { has_holding_type = wastelands_holding } # Bru-Kha must be wilderness
	}
	
	is_valid_showing_failures_only = {
		is_imprisoned = no
		is_available_adult = yes
		is_at_war = no
	}
	
	cost = {
		gold = 250 
	}
	
	effect = {
		trigger_event = druedain.0200
		custom_tooltip = decision_rediscover_yatalin_gan_tt
		add_to_global_variable_list = {
			name = unavailable_unique_decisions
			target = flag:decision_rediscover_yatalin_gan
		}

	}
}

### Minor Decisions ###

decision_create_watch_stone = { # Create a watch-stone
	picture = {
		reference = "gfx/interface/illustrations/decisions/decision_druadan_01.dds"
	}
	desc = decision_create_watch_stone_desc
	selection_tooltip = decision_create_watch_stone_tooltip
	confirm_text = decision_create_watch_stone_confirm
	
	decision_group_type = realms_in_exile_minor
	cooldown = { years = 30 }

	is_shown = {
		is_druedain = yes 
	}

	is_valid = {
	}

	is_valid_showing_failures_only = {
		is_landed = yes
		is_at_war = no 
		is_lotr_adult = yes
	}
	
	cost = {
		gold = medium_gold_value
	}

	effect = {
		root.capital_county.title_province = {
			add_province_modifier = {
				modifier = druadan_watch_stone_modifier
				years = 30 
			}
		}
		add_character_modifier = {
			modifier = druadan_watch_stone_creator_modifier
			years = 30 
		}
		add_piety = medium_piety_value
		add_prestige = medium_prestige_gain
		add_legitimacy = medium_legitimacy_gain
		every_subject = {
			add_opinion = {
				modifier = pleased_opinion
				target = root
				opinion = 20
			}
		}
		trigger_event = druedain.0300 # Flavor event
	}

	ai_check_interval_by_tier = {
		barony = 0
		county = 36
		duchy = 36
		kingdom = 36
		empire = 36
		hegemony = 36
	}

	ai_potential = {
		always = yes
	}

	ai_will_do = {
		base = 100
	}
}