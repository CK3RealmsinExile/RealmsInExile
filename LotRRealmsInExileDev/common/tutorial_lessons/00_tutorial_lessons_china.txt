
lesson_chain_china_paused = {
	chain = lesson_chain_china
	shown_in_encyclopedia = no


	lesson_china_introduction = {
		text = "lesson_china_introduction_desc"
		animation = center
		force_pause_game = yes
		shown_in_encyclopedia = no

		effect = {
			send_china_tutorial_started_telemetry = yes
			close_all_views = yes
			pan_camera_to_title = title:h_china

			hidden_effect = {
				set_global_variable = {
					name = is_in_tutorial
					value = yes
					years = 5
				}
				set_variable = {
					name = hide_ui_timeline
					value = 1
				}
				set_variable = {
					name = hide_ui_character
					value = 1
				}
				set_variable = {
					name = hide_ui_top_bar
					value = 1
				}
				set_variable = {
					name = hide_ui_character_model
					value = 1
				}
				set_variable = {
					name = hide_ui_bottom_left_bar
					value = 1
				}
				set_variable = {
					name = hide_ui_coa_bottom_left
					value = 1
				}
				set_variable = {
					name = hide_ui_realm
					value = 1
				}
				set_variable = {
					name = hide_ui_character_sheet_bottom
					value = 1
				}
				set_variable = {
					name = hide_ui_character_info
					value = 1
				}
				set_variable = {
					name = hide_ui_main_tabs
					value = 1
				}
				set_variable = {
					name = hide_ui_map_zoom
					value = 1
				}
				set_variable = {
					name = hide_ui_spouse
					value = 1
				}
				set_variable = {
					name = hide_ui_outliner
					value = 1
				}
				set_variable = {
					name = hide_ui_current_situation
					value = 1
				}

				set_variable = {
					name = hide_ui_bottom_right_temporary_statuses
					value = 1
				}

				set_variable = {
					name = hide_ui_pulsating_lifestyle
					value = 1
				}

				set_variable = {
					name = disable_clicking_portraits
					value = 1
				}
			}
		}

		gui_transition = {
			button_id = "next"
			button_text = "tutorial_lesson_button_next"
			target = lesson_china_camera
		}

	}

	# Moving the map
	lesson_china_camera = {
		text = "lesson_china_camera_desc"
		animation = right
		force_pause_game = yes
		shown_in_encyclopedia = no

		gui_transition = {
			button_id = "back"
			button_text = "tutorial_lesson_button_back"
			target = lesson_china_introduction
		}

		gui_transition = {
			button_id = "next"
			button_text = "tutorial_lesson_button_next"
			target = lesson_china_zoom
		}
	}
	# Zooming
	lesson_china_zoom = {
		text = "lesson_china_zoom_desc"
		force_pause_game = yes
		shown_in_encyclopedia = no
		highlight_widget = "details_map"
		highlight_widget = "political_map"
		highlight_widget = "paper_map"

		effect = {
			remove_variable = hide_ui_map_zoom
		}

		gui_transition = {
			button_id = "back"
			button_text = "tutorial_lesson_button_back"
			target = lesson_china_camera
		}

		gui_transition = {
			button_id = "next"
			button_text = "tutorial_lesson_button_next"
			target = lesson_china_nested_tooltips
		}
	}

	# Check out tooltips in tooltips...
	lesson_china_nested_tooltips = {
		text = "lesson_china_nested_tooltips_desc"
		force_pause_game = yes

		gui_transition = {
			button_id = "back"
			button_text = "tutorial_lesson_button_back"
			target = lesson_china_zoom
		}
		trigger_transition = {
			button_id = "next"
			button_text = "tutorial_lesson_button_next"
			target = lesson_china_nested_tooltips_complete
			trigger = {
				custom_description = {
					text = "lesson_china_nested_tooltips_hover_word"
					is_tooltip_with_name_open = GameConceptTooltipDefault
				}
				custom_description = {
					text = "lesson_china_nested_tooltips_hover_word_deeper"
					current_tooltip_depth >= 2
				}
			}
		}
	}

	lesson_china_nested_tooltips_complete = {
		text = "lesson_china_nested_tooltips_complete_desc"
		force_pause_game = yes

		shown_in_encyclopedia = no

		effect = {
			add_character_flag = {
				flag = tutorial_open_tooltip_complete
				days = 200
			}
		}

		gui_transition = {
			button_id = "back"
			button_text = "tutorial_lesson_button_back"
			target = lesson_china_zoom
		}
		gui_transition = {
			button_id = "repeat"
			button_text = "tutorial_lesson_button_repeat_step"
			target = lesson_china_nested_tooltips
		}
		gui_transition = {
			button_id = "next"
			button_text = "tutorial_lesson_button_next"
			target = lesson_china_characters
			enabled = {
				custom_description = {
					text = "lesson_china_nested_tooltips_hover_word"
					has_character_flag = tutorial_open_tooltip_complete
				}
				custom_description = {
					text = "lesson_china_nested_tooltips_hover_word_deeper"
					has_character_flag = tutorial_open_tooltip_complete
				}
			}
			
		}
	}

	lesson_china_characters = {
		text = "lesson_china_characters_desc"
		force_pause_game = yes
		animation = center
		shown_in_encyclopedia = no

		highlight_widget = "character_window"
		highlight_widget = "tutorial_highlight_bottom_left_portrait_button"

		effect = {
			remove_variable = hide_ui_character_model
			close_all_views = yes
		}

		gui_transition = {
			button_id = "back"
			button_text = "tutorial_lesson_button_back"
			target = lesson_china_nested_tooltips
		}
		
		trigger_transition = {
			button_id = "next"
			button_text = "tutorial_lesson_button_next"
			target = lesson_china_this_is_you_1
			trigger = {
				custom_description = {
					text = "lesson_basics_characters_click_on_character"
					is_widgetid_open = character_window
				}
			}
		}
	}
	lesson_china_this_is_you_1 = {
		text = "lesson_china_this_is_you_1_desc"
		force_pause_game = yes
		shown_in_encyclopedia = no
		animation = center

		highlight_widget = "tutorial_highlight_bottom_left_portrait_button"
		highlight_widget = "main_characters"

		effect = {
			open_view_data = character
		}

		gui_transition = {
			button_id = "back"
			button_text = "tutorial_lesson_button_back"
			target = lesson_china_characters
		}
		gui_transition = {
			button_id = "next"
			button_text = "tutorial_lesson_button_next"
			target = lesson_china_this_is_you_3
		}
	}
	

	lesson_china_this_is_you_3 = {
		text = "lesson_china_this_is_you_3_desc"
		force_pause_game = yes
		shown_in_encyclopedia = no
		animation = center

		highlight_widget = "tutorial_highlight_bottom_left_portrait_button"
		highlight_widget = "3_personality_traits"

		effect = {
			remove_variable = hide_ui_character_info
			if = {
				limit = {
					NOT = { is_widgetid_open = character_window }
				}
				open_view_data = character
			}
		}

		gui_transition = {
			button_id = "back"
			button_text = "tutorial_lesson_button_back"
			target = lesson_china_this_is_you_1
		}
		gui_transition = {
			button_id = "next"
			button_text = "tutorial_lesson_button_next"
			target = lesson_china_skills
		}

	}
	# Skills...
	lesson_china_skills = {
		text = "lesson_china_skills_desc"
		force_pause_game = yes
		shown_in_encyclopedia = no
		animation = center
		
		highlight_widget = "tutorial_highlight_bottom_left_portrait_button"
		highlight_widget = "tutorial_highlight_skills"

		effect = {
			if = {
				limit = {
					NOT = { is_widgetid_open = character_window }
				}
				open_view_data = character
			}
		}

		gui_transition = {
			button_id = "back"
			button_text = "tutorial_lesson_button_back"
			target = lesson_china_this_is_you_3
		}
		gui_transition = {
			button_id = "next"
			button_text = "tutorial_lesson_button_next"
			target = lesson_china_house
		}
	}

	# House

	lesson_china_house = {
		text = "lesson_china_house_desc"
		force_pause_game = yes
		shown_in_encyclopedia = no
		animation = center
		
		highlight_widget = "char_view_house_area"

		effect = {
			if = {
				limit = {
					NOT = { is_widgetid_open = character_window }
				}
				open_view_data = character
			}
		}

		gui_transition = {
			button_id = "back"
			button_text = "tutorial_lesson_button_back"
			target = lesson_china_skills
		}
		gui_transition = {
			button_id = "next"
			button_text = "tutorial_lesson_button_next"
			target = lesson_china_realm
		}
	}

	lesson_china_realm = {
		text = "lesson_china_realm_desc"
		force_pause_game = yes
		shown_in_encyclopedia = no
		highlight_widget = "realm_info"

		effect = {
			remove_variable = hide_ui_realm
			if = {
				limit = {
					NOT = { is_widgetid_open = character_window }
				}
				open_view_data = character
			}
			
		}

		gui_transition = {
			button_id = "back"
			button_text = "tutorial_lesson_button_back"
			target = lesson_china_house
		}
		gui_transition = {
			button_id = "next"
			button_text = "tutorial_lesson_button_next"
			target = lesson_china_titles
		}

	}

	lesson_china_titles = {
		text = "lesson_china_titles_desc"
		force_pause_game = yes
		shown_in_encyclopedia = no

		highlight_widget = "char_view_titles"

		effect = {
			if = {
				limit = {
					NOT = { is_widgetid_open = character_window }
				}
				open_view_data = character
			}
		}

		gui_transition = {
			button_id = "back"
			button_text = "tutorial_lesson_button_back"
			target = lesson_china_realm
		}
		gui_transition = {
			button_id = "next"
			button_text = "tutorial_lesson_button_next"
			target = lesson_china_relationships
		}
	}
	lesson_china_relationships = {
		text = "lesson_china_relationships_desc"
		force_pause_game = yes
		shown_in_encyclopedia = no

		highlight_widget = "tutorial_highlight_bottom_left_portrait_button"
		#highlight_widget = "tabs"
		highlight_widget = "family"

		effect = {
			remove_variable = hide_ui_character_sheet_bottom
			remove_variable = disable_clicking_portraits
			if = {
				limit = {
					NOT = { is_widgetid_open = character_window }
				}
				open_view_data = character
			}
		}

		gui_transition = {
			button_id = "back"
			button_text = "tutorial_lesson_button_back"
			target = lesson_china_titles
		}
		gui_transition = {
			button_id = "next"
			button_text = "tutorial_lesson_button_next"
			target = lesson_china_this_is_you_2
		}
	}

	lesson_china_this_is_you_2 = {
		text = "lesson_china_this_is_you_2_desc"
		force_pause_game = yes
		shown_in_encyclopedia = no
		animation = center

		highlight_widget = "tutorial_highlight_bottom_left_portrait_button"
		highlight_widget = "tutorial_spouse"

		effect = {
			remove_variable = hide_ui_spouse
			if = {
				limit = {
					NOT = { is_widgetid_open = character_window }
				}
				open_view_data = character
			}
		}

		gui_transition = {
			button_id = "back"
			button_text = "tutorial_lesson_button_back"
			target = lesson_china_relationships
		}

		gui_transition = {
			button_id = "next"
			button_text = "tutorial_lesson_button_next"
			target = lesson_china_marriage_window
			enabled = {
				custom_description = {
					text = lesson_china_find_spouse_tt
					OR = {
						is_married = yes
						is_betrothed = yes
						is_widgetid_open = lesson_china_marriage_window
					}
				}
			}
		}
		trigger_transition = {
			target = lesson_china_married_great_job
			trigger = {
				NOT = { has_character_flag = tutorial_is_married }
				OR = {
					is_married = yes
					is_betrothed = yes
				}
			}
		}

		trigger_transition = {
			target = lesson_china_marriage_window
			trigger = {
				is_widgetid_open = "marriage_interaction_window"
			}
		}
	}

	lesson_china_marriage_window = {
		text = "lesson_china_marriage_window_desc"

		highlight_widget = "marriage_window_character_list"
		animation = far_right
		
		gui_transition = {
			button_id = "back"
			button_text = "tutorial_lesson_button_back"
			target = lesson_china_this_is_you_2
		}

		gui_transition = {
			button_id = "next"
			button_text = "tutorial_lesson_button_next"
			target = lesson_china_married_great_job
			enabled = {
				custom_description = {
					text = lesson_china_find_spouse_tt
					OR = {
						is_married = yes
						is_betrothed = yes
					}
				}
			}
		}

		# Player closed Marriage Window, they have to reopen
		trigger_transition = {
			target = lesson_china_married_great_job
			trigger = {
				NOT = {
					is_widgetid_open = "marriage_interaction_window"
				}
			}
		}
	}
	lesson_china_married_great_job = {
		text = "lesson_china_married_great_job_desc"
		force_pause_game = yes
		shown_in_encyclopedia = no
		animation = far_right

		effect = {
			remove_variable = hide_ui_spouse
			add_character_flag = {
				flag = tutorial_is_married
				days = 200
			}
			if = {
				limit = {
					NOT = { is_widgetid_open = character_window }
				}
				open_view_data = character
			}
		}

		gui_transition = {
			button_id = "back"
			button_text = "tutorial_lesson_button_back"
			target = lesson_china_this_is_you_2
		}
		gui_transition = {
			button_id = "next"
			button_text = "tutorial_lesson_button_next"
			target = lesson_china_liege_introduction
		}
	}

	lesson_china_liege_introduction = {
		text = "lesson_china_liege_introduction_desc"
		highlight_widget = "liege_portrait"
		force_pause_game = yes
		shown_in_encyclopedia = no
		animation = center

		gui_transition = {
			button_id = "back"
			button_text = "tutorial_lesson_button_back"
			target = lesson_china_relationships
		}
		trigger_transition = {
			button_id = "next"
			button_text = "tutorial_lesson_button_next"
			target = lesson_china_liege_introduction_good_job
			trigger = {
				custom_description = {
					text = lesson_china_find_elder_tt
					is_widgetid_open = "character_interaction_menu_window"
				}
			}
		}
	}

	lesson_china_liege_introduction_good_job = {
		text = "lesson_china_liege_introduction_good_job_desc"
		force_pause_game = yes
		shown_in_encyclopedia = no
		animation = right

		gui_transition = {
			button_id = "back"
			button_text = "tutorial_lesson_button_back"
			target = lesson_china_liege_introduction
		}
		gui_transition = {
			button_id = "next"
			button_text = "tutorial_lesson_button_next"
			target = lesson_china_resources_1
		}
	}

	lesson_china_resources_1 = {
		text = "lesson_china_resources_1_desc"
		force_pause_game = yes		
		highlight_widget = "resources"
		animation = top_right

		effect = {
			remove_variable = hide_ui_top_bar
			close_all_views = yes
		}

		gui_transition = {
			button_id = "back"
			button_text = "tutorial_lesson_button_back"
			target = lesson_china_liege_introduction
		}
		gui_transition = {
			button_id = "next"
			button_text = "tutorial_lesson_button_next"
			target = lesson_china_resources_gold
		}
	}
	lesson_china_resources_gold = {
		text = "lesson_china_resources_gold_desc"
		force_pause_game = yes		
		highlight_widget = "gold"
		animation = top_right

		gui_transition = {
			button_id = "back"
			button_text = "tutorial_lesson_button_back"
			target = lesson_china_resources_1
		}
		gui_transition = {
			button_id = "next"
			button_text = "tutorial_lesson_button_next"
			target = lesson_china_resources_prestige
		}
	}

	lesson_china_resources_prestige = {
		text = "lesson_china_resources_prestige_desc"
		force_pause_game = yes		
		highlight_widget = "prestige"
		animation = top_right

		gui_transition = {
			button_id = "back"
			button_text = "tutorial_lesson_button_back"
			target = lesson_china_resources_gold
		}
		gui_transition = {
			button_id = "next"
			button_text = "tutorial_lesson_button_next"
			target = lesson_china_resources_piety
		}
	}
	lesson_china_resources_piety = {
		text = "lesson_china_resources_piety_desc"
		force_pause_game = yes		
		highlight_widget = "piety"
		animation = top_right

		gui_transition = {
			button_id = "back"
			button_text = "tutorial_lesson_button_back"
			target = lesson_china_resources_prestige
		}
		gui_transition = {
			button_id = "next"
			button_text = "tutorial_lesson_button_next"
			target = lesson_china_resources_influence
		}
	}

	lesson_china_resources_influence = {
		text = "lesson_china_resources_influence_desc"
		force_pause_game = yes		
		highlight_widget = "influence"
		animation = top_right

		gui_transition = {
			button_id = "back"
			button_text = "tutorial_lesson_button_back"
			target = lesson_china_resources_piety
		}
		gui_transition = {
			button_id = "next"
			button_text = "tutorial_lesson_button_next"
			target = lesson_china_resources_renown
		}
	}

	lesson_china_resources_renown = {
		text = "lesson_china_resources_renown_desc"
		force_pause_game = yes		
		highlight_widget = "renown"
		animation = top_right

		gui_transition = {
			button_id = "back"
			button_text = "tutorial_lesson_button_back"
			target = lesson_china_resources_influence
		}
		gui_transition = {
			button_id = "next"
			button_text = "tutorial_lesson_button_next"
			target = lesson_china_open_estate
		}
	}

	lesson_china_open_estate = {
		text = "lesson_china_open_estate_desc"
		force_pause_game = yes
		animation = bottom_left
		shown_in_encyclopedia = no

		highlight_widget = domicile_map_icon


		interface_effect = {
			close_all_views = yes
		}

		# effect = { # LOTR
		# 	pan_camera_to_title = title:b_jiangdu
		# }

		gui_transition = {
			button_id = "back"
			button_text = "tutorial_lesson_button_back"
			target = lesson_china_resources_renown
		}

		trigger_transition = {
			button_id = "next"
			button_text = "tutorial_lesson_button_next"
			target = lesson_china_estate_intro
			trigger = {
				custom_tooltip = {
					text = "lesson_china_open_estate_prompt"
					is_widgetid_open = "domicile_window"
				}
			}
		}
	}

	lesson_china_estate_intro = {
		text = "lesson_china_estate_intro_desc"
		force_pause_game = yes
		animation = far_bottom_left
		shown_in_encyclopedia = no

		highlight_widget = "building_slot_empty"

		gui_transition = {
			button_id = "back"
			button_text = "tutorial_lesson_button_back"
			target = lesson_china_open_estate
		}

		trigger_transition = {
			button_id = "next"
			button_text = "tutorial_lesson_button_next"
			target = lesson_china_estate_build_list
			trigger = {
				custom_tooltip = {
					text = "lesson_china_estate_intro_prompt"
					is_widgetid_open = "construct_building_list"
				}
			}
		}

		# Player closed Domicile, they have to reopen
		trigger_transition = {
			target = lesson_china_open_estate
			trigger = {
				NOT = {
					is_widgetid_open = "domicile_window"
				}
			}
		}

		# Skip ahead if you already are building (avoids getting stuck)
		trigger_transition = {
			target = lesson_china_estate_manor
			trigger = {
				domicile = {
					has_ongoing_domicile_construction = yes
				}
			}
		}


		
	}

	lesson_china_estate_build_list = {
		text = "lesson_china_estate_build_list_desc"
		force_pause_game = yes
		animation = far_bottom_left
		shown_in_encyclopedia = no

		highlight_widget = construct_building_list


		gui_transition = {
			button_id = "back"
			button_text = "tutorial_lesson_button_back"
			target = lesson_china_estate_intro
		}


		trigger_transition = {
			button_id = "next"
			button_text = "tutorial_lesson_button_next"
			target = lesson_china_estate_manor
			trigger = {
				custom_tooltip = {
					text = "lesson_china_estate_build_list_prompt"
					domicile = {
						has_ongoing_domicile_construction = yes
					}
				}
			}
		}


		# Player closed Building List, they have to reopen
		trigger_transition = {
			target = lesson_china_estate_intro
			trigger = {
				NOT = {
					is_widgetid_open = "construct_building_list"
				}
			}
		}

		# Player closed Domicile, they have to reopen
		trigger_transition = {
			target = lesson_china_open_estate
			trigger = {
				NOT = {
					is_widgetid_open = "domicile_window"
				}
			}
		}
	}

	lesson_china_estate_manor = {
		text = "lesson_china_estate_manor_desc"
		force_pause_game = yes
		animation = far_bottom_left
		shown_in_encyclopedia = no

		highlight_widget_with_index = {
			domicile_buildings = 2
		}

		gui_transition = {
			button_id = "back"
			button_text = "tutorial_lesson_button_back"
			target = lesson_china_estate_build_list
		}

		trigger_transition = {
			button_id = "next"
			button_text = "tutorial_lesson_button_next"
			target = lesson_china_estate_manor_selected
			trigger = {
				custom_tooltip = {
					text = "lesson_china_estate_manor_prompt"
					is_widgetid_open = "domicile_upgrade_panel"
				}
			}
		}

		# Player closed Domicile, they have to reopen
		trigger_transition = {
			target = lesson_china_open_estate
			trigger = {
				NOT = {
					is_widgetid_open = "domicile_window"
				}
			}
		}
	}

	lesson_china_estate_manor_selected = {
		text = "lesson_china_estate_manor_selected_desc"
		force_pause_game = yes
		animation = left
		shown_in_encyclopedia = no

		highlight_widget = "domicile_building_upgrade_track"

		gui_transition = {
			button_id = "back"
			button_text = "tutorial_lesson_button_back"
			target = lesson_china_estate_manor
		}
		gui_transition = {
			button_id = "next"
			button_text = "tutorial_lesson_button_next"
			target = lesson_china_estate_close
		}

		# Player closed Manor Panel, they have to reopen
		trigger_transition = {
			target = lesson_china_estate_manor
			trigger = {
				NOT = {
					is_widgetid_open = "domicile_upgrade_panel"
				}
			}
		}

		# Player closed Domicile, they have to reopen
		trigger_transition = {
			target = lesson_china_open_estate
			trigger = {
				NOT = {
					is_widgetid_open = "domicile_window"
				}
			}
		}
	}

	lesson_china_estate_close = {
		text = "lesson_china_estate_close_desc"
		force_pause_game = yes
		animation = far_bottom_left
		shown_in_encyclopedia = no

		gui_transition = {
			button_id = "back"
			button_text = "tutorial_lesson_button_back"
			target = lesson_china_estate_manor_selected
		}

		trigger_transition = {
			button_id = "next"
			button_text = "tutorial_lesson_button_next"
			target = lesson_china_estate_summary
			trigger = {
				custom_tooltip = {
					text = "lesson_china_estate_close_prompt"
					NOT = {
						is_widgetid_open = "domicile_window"
					}
				}
			}
		}

	}

	lesson_china_estate_summary = {
		text = "lesson_china_estate_summary_desc"
		force_pause_game = yes
		animation = center
		shown_in_encyclopedia = no

		gui_transition = {
			button_id = "back"
			button_text = "tutorial_lesson_button_back"
			target = lesson_china_estate_close
		}
		gui_transition = {
			button_id = "next"
			button_text = "tutorial_lesson_button_next"
			target = lesson_china_admin_intro
		}
	}


	lesson_china_admin_intro = {
		text = "lesson_china_admin_intro_desc"
		force_pause_game = yes
		shown_in_encyclopedia = no
		animation = center

		gui_transition = {
			button_id = "back"
			button_text = "tutorial_lesson_button_back"
			target = lesson_china_estate_summary
		}
		gui_transition = {
			button_id = "next"
			button_text = "tutorial_lesson_button_next"
			target = lesson_china_admin_merit
		}

		effect = {
			close_all_views = yes
		}
	}

	lesson_china_admin_merit = {
		text = "lesson_china_admin_merit_desc"
		force_pause_game = yes
		shown_in_encyclopedia = no
		animation = bottom_left

		effect = {
			remove_variable = hide_ui_bottom_left_bar
		}

		highlight_widget = "merit_button_tutorial_uses_this"
		

		gui_transition = {
			button_id = "back"
			button_text = "tutorial_lesson_button_back"
			target = lesson_china_admin_intro
		}
		gui_transition = {
			button_id = "next"
			button_text = "tutorial_lesson_button_next"
			target = lesson_china_admin_open
		}
	}

	lesson_china_admin_open = {
		text = "lesson_china_admin_open_desc"
		force_pause_game = yes
		shown_in_encyclopedia = no
		animation = top_right

		highlight_widget = "tab_government_administration"

		effect = {
			remove_variable = hide_ui_main_tabs
		}

		gui_transition = {
			button_id = "back"
			button_text = "tutorial_lesson_button_back"
			target = lesson_china_admin_merit
		}
		trigger_transition = {
			button_id = "next"
			button_text = "tutorial_lesson_button_next"
			target = lesson_china_exam
			trigger = {
				custom_tooltip = {
					text = "lesson_china_admin_open_prompt"
					is_widgetid_open = "government_panel_exam_area"
					
				}
			}
		}
	}	

	lesson_china_exam = {
		text = "lesson_china_exam_desc"
		force_pause_game = yes
		shown_in_encyclopedia = no
		highlight_widget = "government_panel_exam_area"
		animation = center

		gui_transition = {
			button_id = "back"
			button_text = "tutorial_lesson_button_back"
			target = lesson_china_admin_open
		}
		gui_transition = {
			button_id = "next"
			button_text = "tutorial_lesson_button_next"
			target = lesson_china_decisions_open
		}
	}

	lesson_china_decisions_open = {
		text = "lesson_china_decisions_open_desc"
		force_pause_game = yes
		shown_in_encyclopedia = no
		animation = right

		highlight_widget = "tab_decisions"

		effect = {
			close_all_views = yes

			#sanity removal, it probably already has been removed
			remove_variable = hide_ui_main_tabs 
		}

		gui_transition = {
			button_id = "back"
			button_text = "tutorial_lesson_button_back"
			target = lesson_china_exam
		}
		trigger_transition = {
			button_id = "next"
			button_text = "tutorial_lesson_button_next"
			target = lesson_china_decisions
			trigger = {
				custom_tooltip = {
					text = "lesson_china_decisions_open_prompt"
					is_widgetid_open = "decisions_panel_decisions_scrollarea"
				}
			}
			
		}
	}

	lesson_china_decisions = {
		text = "lesson_china_decisions_desc"
		force_pause_game = yes
		shown_in_encyclopedia = no
		animation = far_left

		highlight_widget = "cram_study_tutorial_highlight"
		highlight_widget = "cram_study_start_tutorial_highlight"
		
		gui_transition = {
			button_id = "back"
			button_text = "tutorial_lesson_button_back"
			target = lesson_china_decisions_open
		}
		trigger_transition = {
			button_id = "next"
			button_text = "tutorial_lesson_button_next"
			target = lesson_china_stress
			trigger = {
				custom_tooltip = {
					text = "lesson_china_decisions_prompt"
					any_scheme = {
						type = study_confucian_classics
					}
					has_character_flag = study_scheme_intensity_chosen
				}
			}
			
		}
	}

	lesson_china_stress = {
		text = "lesson_china_stress_desc"
		force_pause_game = yes
		shown_in_encyclopedia = no
		animation = bottom_left

		highlight_widget = stress_widget

		effect = {
			close_all_views = yes
			remove_variable = hide_ui_bottom_left_bar
		}
		
		gui_transition = {
			button_id = "back"
			button_text = "tutorial_lesson_button_back"
			target = lesson_china_decisions
		}
		gui_transition = {
			button_id = "next"
			button_text = "tutorial_lesson_button_next"
			target = lesson_china_schemes_open
		}

	}

	lesson_china_schemes_open = {
		text = "lesson_china_schemes_open_desc"
		force_pause_game = yes
		shown_in_encyclopedia = no
		animation = right
		highlight_widget = "tab_intrigue"
		highlight_widget = "open_scheme_tab"

		effect = {
			close_all_views = yes
		}		

		gui_transition = {
			button_id = "back"
			button_text = "tutorial_lesson_button_back"
			target = lesson_china_stress
		}

		trigger_transition = {
			button_id = "next"
			button_text = "tutorial_lesson_button_next"
			target = lesson_china_schemes_list

			trigger = {
				custom_tooltip = {
					text = "lesson_china_schemes_open_prompt"
					is_widgetid_open = "my_own_personal_schemes"
				}
			}			
		}
	}

	lesson_china_schemes_list = {
		text = "lesson_china_schemes_list_desc"
		force_pause_game = yes
		shown_in_encyclopedia = no
		animation = center

		highlight_widget = "my_own_personal_schemes"

		gui_transition = {
			button_id = "back"
			button_text = "tutorial_lesson_button_back"
			target = lesson_china_schemes_open
		}
		gui_transition = {
			button_id = "next"
			button_text = "tutorial_lesson_button_next"
			target = lesson_china_unpause
		}

		# rewind if view is closed
		trigger_transition = {
			target = lesson_china_schemes_open
			trigger = {
				NOT = { is_widgetid_open = my_own_personal_schemes }
			}
		}
	}

	
	lesson_china_unpause = {
		text = "lesson_china_unpause_desc"
		highlight_widget = "timeline_widget"
		animation = center
		pause_game = yes

		effect = {
			close_all_views = yes

			remove_global_variable = is_in_tutorial
			remove_variable = hide_ui_timeline
			remove_variable = hide_ui_bottom_left_bar
			remove_variable = hide_ui_character
			remove_variable = hide_ui_character_info
			remove_variable = hide_ui_character_model
			remove_variable = hide_ui_character_sheet_bottom
			remove_variable = hide_ui_coa_bottom_left
			remove_variable = hide_ui_main_tabs
			remove_variable = hide_ui_realm
			remove_variable = hide_ui_timeline
			remove_variable = hide_ui_top_bar
			remove_variable = hide_ui_outliner
			remove_variable = hide_ui_current_situation
			remove_variable = disable_clicking_portraits
			remove_variable = hide_ui_spouse
			remove_variable = hide_ui_map_zoom
		}

		gui_transition = {
			button_id = "back"
			button_text = "tutorial_lesson_button_back"
			target = lesson_china_schemes_list
		}
		gui_transition = {
			button_id = "next"
			button_text = "tutorial_lesson_button_next"
			target = lesson_china_done
			enabled = {
				custom_description = {
					text = lesson_china_unpause_tt
					current_day > 15 
				}
			}
		}
		trigger_transition = {
			target = lesson_china_done
			trigger = {
				current_day > 15 
			}
		}
	}
	lesson_china_done = {
		text = "lesson_china_done_desc"
		animation = center
		delay = 1

		effect = {
			send_china_tutorial_finished_telemetry = yes
			set_global_variable = {
				name = tutorial_completed
				value = 1
				days = 2000
			}
			set_global_variable = {
				name = started_with_china_tutorial
				value = yes
			}
			set_global_variable = {
				name = tutorial_current_situation_gradual_reveal_3
				value = 1
				days = 900
			}
			set_global_variable = {
				name = tutorial_current_situation_gradual_reveal_2
				value = 1
				days = 550
			}
			set_global_variable = {
				name = tutorial_current_situation_gradual_reveal_1
				value = 1
				days = 70
			}
			add_character_flag = {
				flag = ignore_marriage_event
				days = 10
			}
			# trigger_event = {
			# 	id = tutorial.2001
			# 	months = { 1 2 }
			# }
			remove_variable = hide_ui_outliner
			remove_variable = hide_ui_current_situation
			remove_variable = hide_ui_bottom_right_temporary_statuses
			remove_variable = hide_ui_pulsating_lifestyle
		}

		gui_transition = {
			button_id = "next"
			button_text = "tutorial_lesson_button_finish_tutorial"
			target = lesson_finish
		}
	}

	finish_gamestate_tutorial = yes
}




# special reactive advice for china tutorial, triggers when you become a Governor
# mostly a copy of lesson_basics_quick_council
reactive_advice_china_council = {
	chain = reactive_advice
	start_automatically = no
	shown_in_encyclopedia = no

	ra_china_council_1 = {
		text = "ra_china_council_1_desc"
		animation = center
		shown_in_encyclopedia = no

		highlight_widget = "tab_council"

		effect = {
			close_all_views = yes
		}

		gui_transition = {
			button_id = "skip"
			button_text = "tutorial_lesson_button_skip"
			target = lesson_finish
		}

		trigger_transition = {
			button_id = "next"
			button_text = "tutorial_lesson_button_next"
			target = ra_china_council_2
			trigger = {
				custom_description = {
					text = ra_china_council_1_prompt
					is_widgetid_open = council_window
				}
			}
		}
	}

	# Council tasks...
	ra_china_council_2 = {
		text = "ra_china_council_2_desc"
		shown_in_encyclopedia = no
		animation = center

		gui_transition = {
			button_id = "back"
			button_text = "tutorial_lesson_button_back"
			target = ra_china_council_1
		}
		gui_transition = {
			button_id = "next"
			button_text = "tutorial_lesson_button_complete"
			target = lesson_finish
		}
	}
}
