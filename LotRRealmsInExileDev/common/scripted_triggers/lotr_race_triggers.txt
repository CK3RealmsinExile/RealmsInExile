#Triggers for races of LOTR
#these should work for character, culture and province scopes

is_human = { #all other races and species should be added here
	is_orc = no
	is_elf = no
	is_maiar = no
	is_valar = no
	is_undead = no
	is_dwarf = no
	is_druedain = no
	is_hobbit = no
}

is_human_culture = { #all other races and species should be added here
	is_orc_culture = no
	is_elf_culture = no
	is_maiar_culture = no
	is_valar_culture = no
	is_undead_culture = no
	is_dwarf_culture = no
	is_druedain_culture = no
	is_hobbit_culture = no
}

is_nazgul = {
    culture = culture:ringwraith
}

is_nazgul_culture = {
    this = culture:ringwraith
}
is_valar = {
	culture = culture:valar
}

is_valar_culture = {
	this = culture:valar
}

is_maiar = {
	OR = {
		culture = culture:maiar
		culture = culture:maiar_fallen
		is_istari = yes
	}
}

is_maiar_culture = {
	OR = {
		this = culture:maiar
		this = culture:maiar_fallen
		is_istari_culture = yes
	}
}

is_maiar_fallen = {
	culture = culture:maiar_fallen
}

is_maiar_fallen_culture = {
	this = culture:maiar_fallen
}

is_undead = {
	culture = { has_cultural_pillar = heritage_undead }
}

is_undead_culture = {
	has_cultural_pillar = heritage_undead
}

cannot_be_killed = {
	OR = {
		is_valar = yes
		is_maiar = yes
		is_undead = yes
	}
}
is_orc = {
	culture = { has_cultural_pillar = heritage_orc }
}

is_orc_culture = {
	has_cultural_pillar = heritage_orc
}

has_orc_accolades = { # juke note: used for accolade names - orcs will use some unique ones, but also not use others (such as horse-related names)
	OR = {
		is_orc = yes
		is_sauron = yes
		is_nazgul = yes
		has_character_flag = saruman_orc_accolades
	}
}

is_druedain = {
	culture = { has_cultural_pillar = heritage_druedain }
}

is_druedain_culture = {
	has_cultural_pillar = heritage_druedain
}

is_elf = {
	OR = {
		culture = { has_cultural_pillar = heritage_quendi }
		culture = { has_cultural_pillar = heritage_calaquendi }
		culture = { has_cultural_pillar = heritage_lomiquendi }
		culture = { has_cultural_pillar = heritage_moriquendi }
	}
}

is_eldar = {
	OR = {
		culture = { has_cultural_pillar = heritage_calaquendi }
		culture = { has_cultural_pillar = heritage_lomiquendi }
	}
}

is_eldar_culture = {
	OR = {
		has_cultural_pillar = heritage_calaquendi
		has_cultural_pillar = heritage_lomiquendi
	}
}

is_elf_culture = {
	OR = {
		has_cultural_pillar = heritage_quendi
		has_cultural_pillar = heritage_calaquendi
		has_cultural_pillar = heritage_lomiquendi
		has_cultural_pillar = heritage_moriquendi
	}
}

is_dunedain = {
	OR = {
		has_trait = blood_of_numenor
		has_trait = blood_of_numenor
		has_trait = blood_of_numenor
		has_trait = blood_of_numenor
	}
}

is_nazgul = {
		has_trait = nazgul
}

is_dwarf = {
	OR = {
		culture = { has_cultural_pillar = heritage_khazad }
	}
}

is_dwarf_culture = {
	has_cultural_pillar = heritage_khazad
}

is_hobbit = {
	always = no #temp
}

is_hobbit_culture = {
	always = no #temp
}

same_race = { #compares two scopes, example same_race = { TARGET = scope:target_ruler }
	OR = {
		AND = {
			is_human = yes
			$TARGET$ = { is_human = yes }
		}
		AND = {
			is_orc = yes
			$TARGET$ = { is_orc = yes }
		}
		AND = {
			is_elf = yes
			$TARGET$ = { is_elf = yes }
		}
		AND = {
			is_dwarf = yes
			$TARGET$ = { is_dwarf = yes }
		}
		AND = {
			is_druedain = yes
			$TARGET$ = { is_druedain = yes }
		}
		AND = {
			is_undead = yes
			$TARGET$ = { is_undead = yes }
		}
		AND = {
			is_maiar = yes
			$TARGET$ = { is_maiar = yes }
		}
		AND = {
			is_hobbit = yes
			$TARGET$ = { is_hobbit = yes }
		}
	}
}

same_race_culture = { #compares two scopes, example same_race_culture = { TARGET = scope:target_culture }
	OR = {
		AND = {
			is_human_culture = yes
			$TARGET$ = { is_human_culture = yes }
		}
		AND = {
			is_orc_culture = yes
			$TARGET$ = { is_orc_culture = yes }
		}
		AND = {
			is_elf_culture = yes
			$TARGET$ = { is_elf_culture = yes }
		}
		AND = {
			is_dwarf_culture = yes
			$TARGET$ = { is_dwarf_culture = yes }
		}
		AND = {
			is_druedain_culture = yes
			$TARGET$ = { is_druedain_culture = yes }
		}
		AND = {
			is_hobbit_culture = yes
			$TARGET$ = { is_hobbit_culture = yes }
		}
	}
}

is_istari = {
	OR = {
		culture = culture:istari
		culture = culture:istari_evil
	}
}

is_istari_culture = {
	OR = {
		this = culture:istari
		this = culture:istari_evil
	}
}

is_good_istari = {
	culture = culture:istari
}

is_good_istari_culture = {
	this = culture:istari
}

is_evil_istari = {
	culture = culture:istari_evil
}

is_evil_istari_culture = {
	this = culture:istari_evil
}

is_legit_istari = {
	OR = {
		has_trait = istari
		has_character_flag = is_saruman
	}
}

restricted_culture = { #these cultures should not be present in-game outside of certain story characters
	OR = {
		is_maiar = yes
		is_undead = yes
		is_nazgul = yes
	}
}

restricted_culture_culture = { #these cultures should not be present in-game outside of certain story characters
	OR = {
		is_maiar_culture = yes
		is_undead_culture = yes
		is_nazgul_culture = yes
	}
}

can_culture_convert = { #only checks if the culture can convert at all, for comparing two cultures use the next one
	restricted_culture = no
}

can_culture_convert_culture = { #only checks if the culture can convert at all, for comparing two cultures use the next one
	restricted_culture_culture = no
}

culture_conversion_to_allowed = { #example culture_conversion_to_allowed = { TARGET = scope:recipient }
	can_culture_convert = yes
	$TARGET$ = { can_culture_convert = yes }
	same_race = { TARGET = $TARGET$ }
}

culture_conversion_to_allowed_culture = { #example culture_conversion_to_allowed_culture = { TARGET = scope:recipientculture }
	can_culture_convert_culture = yes
	$TARGET$ = { can_culture_convert_culture = yes }
	same_race_culture = { TARGET = $TARGET$ }
}

lotr_children_allowed = {
	is_maiar = no
	is_valar = no
	is_nazgul = no
	is_undead = no
}

lotr_children_with_allowed = { #example lotr_children_with_allowed = { TARGET = scope:lover }
	lotr_marriage_allowed = yes
	$TARGET$ = { lotr_marriage_allowed = yes }
	same_race = { TARGET = $TARGET$ }
}

lotr_marriage_allowed = { #this and the next one are inserted into vanilla marriage_triggers, best use those when you deal with marriage in events, etc.
	lotr_children_allowed = yes
	NOR = { # AI Numenoreans will not seek marriages before coming of full age.
		age < nubile_age
		is_nazgul = yes
		is_maiar = yes
		has_trait = widowed
		has_trait = cannot_marry
	}
}

lotr_marriage_to_allowed = { #example lotr_marriage_to_allowed = { TARGET = scope:lover }
	lotr_children_with_allowed = { TARGET = $TARGET$ }
	OR = { #druedain can only marry druedain
		NOR = {
			culture = { has_cultural_pillar = heritage_druedain }
			$TARGET$ = { culture = { has_cultural_pillar = heritage_druedain } }
		}
		culture = { has_same_culture_heritage = $TARGET$.culture } #Jamie - Hope this works!
	}
	$TARGET$ = { age >= nubile_age }
}

lotr_extramarital_allowed = {
	lotr_children_allowed = yes
}

lotr_extramarital_to_allowed = { #example lotr_extramarital_to_allowed = { TARGET = scope:lover }
	lotr_children_with_allowed = { TARGET = $TARGET$ }
}

## Building Validity Triggers ##

lotr_orc_buildings = { #Orc buildings are enabled under these conditions
	OR = {
		culture = { has_cultural_pillar = heritage_orc }
		has_character_flag = is_sauron
		has_trait = nazgul
		faith = faith:lidless_eye
		faith = faith:cult_of_zigur
		AND = {
			has_character_flag = is_saruman
			OR = {
				has_faith = faith:lidless_eye
				has_faith = faith:cult_of_zigur
				has_faith = faith:white_hand_cult
			}
			#has_culture = culture:istari_evil
		}
	}
}
lotr_orc_or_nurniag_buildings = { #Orc buildings are enabled under these conditions
	OR = {
		culture = { has_cultural_pillar = heritage_orc }
		culture = culture:nurniag
		culture = { any_parent_culture_or_above = { this = culture:nurniag } }
		has_character_flag = is_sauron
		has_trait = nazgul
		faith = faith:lidless_eye
		faith = faith:cult_of_zigur
		AND = {
			has_character_flag = is_saruman
			#OR = {
			#	has_faith = faith:lidless_eye
			#	has_faith = faith:cult_of_zigur
			#	has_faith = faith:white_hand_cult
			#}
			#has_culture = culture:istari_evil
			is_evil_istari = yes
		}
	}
}
