
#####################################
### CULTURAL AND RELIGIOUS GROUPS ###
#####################################

faith_is_good = {
	custom_description = {
		text = faith_is_good
		OR = {
			religion = { is_in_family = rf_eruhini }
			faith = { has_doctrine = doctrine_echoes_of_the_ainur }
			faith = { has_doctrine = special_doctrine_is_freepeople_faith }
		}
	}
}

faith_is_evil = {
	custom_description = {
		text = faith_is_evil
		OR = {
			religion = { is_in_family = rf_forcesofevil }
			faith = { has_doctrine = doctrine_dominion_of_the_dark }
		}
	}
}

faith_is_neutral = {
	custom_description = {
		text = faith_is_neutral
		faith_is_good = no
		faith_is_evil = no
	}
}

opposite_alignment = { #compares two scopes, example opposite_alignment = { TARGET = scope:target_ruler }
	OR = {
		AND = {
			faith_is_good = yes
			$TARGET$ = { faith_is_evil = yes }
		}
		AND = {
			faith_is_evil = yes
			$TARGET$ = { faith_is_good = yes }
		}
	}
}

same_alignment = { #compares two scopes, example same_alignment = { TARGET = scope:target_ruler }
	OR = {
		AND = {
			faith_is_good = yes
			$TARGET$ = { faith_is_good = yes }
		}
		AND = {
			faith_is_evil = yes
			$TARGET$ = { faith_is_evil = yes }
		}
		AND = {
			faith_is_neutral = yes
			$TARGET$ = { faith_is_neutral = yes }
		}
	}
}

lotr_is_immortal_culture_trigger = {
	OR = {
		is_valar = yes
		is_maiar = yes
		is_undead = yes
		is_elf = yes
		culture ?= culture:wastelands
	}
}

lotr_is_spirit_culture_trigger = {
	OR = {
		is_valar = yes
		is_maiar = yes
		is_istari = yes
		is_undead = yes
		culture ?= culture:wastelands
	}
}

is_lotr_adult = {
	custom_description = {
		text = is_lotr_adult
		age > majority_age
	}
}

lotr_normal_building_trigger = {
	NOT = {
		is_orc = yes
		is_elf = yes
		is_dwarf = yes
	}
}

lotr_normal_fortification_trigger = {
	NOT = {
		is_elf = yes
		is_dwarf = yes
	}
}

lotr_gets_nicknames_trigger = {	#checks whether char is eligible to get a nickname
	NOR = {
		culture ?= culture:wastelands
		has_character_flag = had_nickname_event
		is_in_valinor = yes
	}
	NOT = {
		cannot_be_killed = yes
		is_ai = yes
	}
}

can_have_tamska_succession_law_trigger = { # Tamska succession laws
	faith = {
		#religious_head = prev
		has_doctrine = doctrine_temporal_head
		has_doctrine_parameter = lotr_tamska_hof
	}
	has_title = title:d_tamska_main
}

lotr_can_become_admin_gov = { # Trigger that checks wether the char should be able to become administrative
	NOR = {
		is_orc = yes
		is_elf = yes
		is_sauron = yes
		is_nazgul = yes
		is_in_valinor = yes
		is_wastelands = yes
		can_have_tamska_succession_law_trigger = yes
	}
}

lotr_numenor_trigger = {
	OR = {
		has_cultural_pillar = heritage_dunedain
		has_cultural_pillar = heritage_bellakari
		has_cultural_pillar = heritage_northern_adunaic
		has_cultural_pillar = heritage_southern_adunaic
	}
}

lotr_numenor_culture_trigger = {
	OR = {
		culture = { has_cultural_pillar = heritage_dunedain }
		culture = { has_cultural_pillar = heritage_bellakari }
		culture = { has_cultural_pillar = heritage_northern_adunaic }
		culture = { has_cultural_pillar = heritage_southern_adunaic }
	}
}
lotr_gwathuirim_heritage_trigger = {
	OR = {
		culture = { has_cultural_pillar = heritage_daen_coentis }
		culture = { has_cultural_pillar = heritage_daen_lintis }
		culture = { has_cultural_pillar = heritage_danan_lin }
	}
}
lotr_northron_group_culture_trigger = {
	OR = {
		culture = { has_cultural_pillar = heritage_hadorim }
		culture = { has_cultural_pillar = heritage_northron }
	}
}
lotr_horse_lords_trigger = {
	OR = {
		culture = { has_cultural_pillar = heritage_hadorim }
		culture = { has_cultural_pillar = heritage_tedjin }
		culture = { has_cultural_pillar = heritage_ioriag }
	}
}
lotr_haradrim_group_culture_trigger = {
	OR = {
		culture = culture:umbarean
		culture = culture:mardrukan
		culture = culture:bellanarud
		culture = { any_parent_culture_or_above = { this = culture:umbarean } }
		culture = { any_parent_culture_or_above = { this = culture:mardrukan } }
		culture = { any_parent_culture_or_above = { this = culture:bellanarud } }
		culture = { has_cultural_pillar = heritage_northern_apysaic }
		culture = { has_cultural_pillar = heritage_middle_apysaic }
		culture = { has_cultural_pillar = heritage_southern_apysaic }
		culture = { has_cultural_pillar = heritage_tulwangi }
		culture = { has_cultural_pillar = heritage_thani_native }
		culture = { has_cultural_pillar = heritage_nafarati }
		# Matt note: should include Bellanarud and Tantûraki cultures.
		# Check the code after Royal Court.
	}
}
lotr_last_alliance_cultures_trigger = {
	# Cultures that were part of the Last Alliance.
	# A Free Peoples holy war/liberation war fought by the
	# combined strength of these groups.
	OR = {
		culture = { has_cultural_pillar = heritage_dunedain }
		culture = { has_cultural_pillar = heritage_hadorim }
		culture = { has_cultural_pillar = heritage_calaquendi }
		culture = { has_cultural_pillar = heritage_lomiquendi }
		culture = { has_cultural_pillar = heritage_bellakari }
		# Dwarven houses who joined the Last Alliance.
		culture = { has_cultural_pillar = heritage_longbeard }
	}
}

lotr_elven_cultures_trigger = {
	OR = {
		culture = { has_cultural_pillar = heritage_quendi }
		culture = { has_cultural_pillar = heritage_moriquendi }
		culture = { has_cultural_pillar = heritage_calaquendi }
		culture = { has_cultural_pillar = heritage_lomiquendi }
	}
}

lotr_dwarven_cultures_trigger = {
	OR = {
		culture = { has_cultural_pillar = heritage_longbeard }
		culture = { has_cultural_pillar = heritage_firebeard }
		culture = { has_cultural_pillar = heritage_broadbeam }
		culture = { has_cultural_pillar = heritage_ironfist }
		culture = { has_cultural_pillar = heritage_stiffbeard }
		culture = { has_cultural_pillar = heritage_blacklock }
		culture = { has_cultural_pillar = heritage_stonefoot }
	}
}

lotr_beorning_trigger = {
	has_trait = skinchanger
	OR = {
		culture = culture:valemen
		culture = culture:woodmen
		culture = { any_parent_culture_or_above = { this = culture:valemen } }
		culture = { any_parent_culture_or_above = { this = culture:woodmen } }
		culture = { has_cultural_pillar = heritage_northron }
		culture = { has_cultural_pillar = heritage_hadorim }
	}
}

lotr_urbanised_northron_cultures_trigger = {
	AND = {
		culture = { has_cultural_pillar = heritage_northron }
		OR = {
			culture = culture:dalemen
			culture = culture:dorwinionrim
			culture = { any_parent_culture_or_above = { this = culture:dalemen } }
			culture = { any_parent_culture_or_above = { this = culture:dorwinionrim } }
		}
	}
}

lotr_steppe_cultures_trigger = {
	OR = {
		culture = { has_cultural_pillar = heritage_igath }
		culture = { has_cultural_pillar = heritage_ioriag }
		culture = { has_cultural_pillar = heritage_tedjin }
	}
}

lotr_has_sauron_faith = { # For destroy mordor religious effects
	OR = {
		faith = faith:lidless_eye
		faith = faith:red_eye_cult
		faith = faith:cult_of_zigur
		faith = faith:faith_angmar_evil
	}
}
############################
### MEN-AT-ARMS TRIGGERS ###
############################

### Elven MaA Triggers ###
noldor_trigger = { # Handles access to Noldor units
	OR = {
		AND = {
			culture = { has_cultural_pillar = heritage_calaquendi }
			OR = {
				culture = culture:noldor
				culture = { any_parent_culture_or_above = { this = culture:noldor } }
			}
		}
		AND = { # For Cirdan-led Lindon to have access to Noldor events and units
			has_title = title:e_lindon
			is_elf = yes
			NOT = { culture = { has_cultural_pillar = heritage_calaquendi } }
			any_vassal = { has_culture = culture:noldor }
		}
	}
}
sindar_trigger = { # Handles access to Sindar units
	AND = {
		culture = { has_cultural_pillar = heritage_lomiquendi }
		OR = {
			culture = culture:sindar
			culture = { any_parent_culture_or_above = { this = culture:sindar } }
		}
		NOR = { # The Sindar-descended cultures of Rhovanion shouldn't get these units, they have their own!
			culture = culture:nandor
			culture = culture:galadhrim
			culture = culture:silvan
			culture = culture:lasgalendrim
			culture = culture:laiquendi
			culture = { any_parent_culture_or_above = { this = culture:silvan } }
			culture = { any_parent_culture_or_above = { this = culture:lasgalendrim } }
			culture = { any_parent_culture_or_above = { this = culture:nandor } }
			culture = { any_parent_culture_or_above = { this = culture:galadhrim } }
		}
	}
}
galadhrim_trigger = { # Handles access to Galadhrim units
	AND = {
		culture = { has_cultural_pillar = heritage_lomiquendi }
		OR = {
			culture = culture:nandor
			culture = culture:galadhrim
			culture = { any_parent_culture_or_above = { this = culture:nandor } }
			culture = { any_parent_culture_or_above = { this = culture:galadhrim } }
		}
		NOR = {
			culture = culture:silvan
			culture = culture:sirrandrai
			culture = culture:laiquendi
			culture = { any_parent_culture_or_above = { this = culture:silvan } }
			culture = { any_parent_culture_or_above = { this = culture:sirrandrai } }
		}
	}
}
greenwood_trigger = { # Handles access to Greenwood units
	AND = {
		culture = { has_cultural_pillar = heritage_lomiquendi }
		OR = {
			culture = culture:silvan
			culture = culture:lasgalendrim
			culture = { any_parent_culture_or_above = { this = culture:silvan } }
		}

	}
}
laiquendi_trigger = { # Handles access to Laiquendi units
	AND = {
		culture = { has_cultural_pillar = heritage_lomiquendi }
		OR = {
			culture = culture:laiquendi
			culture = { any_parent_culture_or_above = { this = culture:laiquendi } }
		}
	}
}

# Vanyar Triggers - low priority, only Vanyar are in Valinor

# Teleri Triggers - low priority, Valinorean Teleri

# Avari Triggers
neldoreth_trigger = { # Handles access to Neldoreth units
	AND = {
		culture = { has_cultural_pillar = heritage_moriquendi }
		OR = {
			culture = culture:penni
			culture = { any_parent_culture_or_above = { this = culture:penni } }
		}
		has_title = title:k_nelornieth
	}
}

### Human MaA Triggers ###

ithilien_rangers_trigger = { # handles who and under what circumstances ithilien rangers can be recruited
	AND = { # Available to those of Dúnedain heritage of Gondorian heritage
		culture = { has_cultural_pillar = heritage_dunedain }
		OR = {
			culture = culture:gondorian
			culture = { any_parent_culture_or_above = { this = culture:gondorian } }
		}
	}
	OR = {
		OR = { # Available to the titular ruler of Ithilien or of Gondor, even if they don't control Ithilien
			has_primary_title = title:k_ithilien
			is_gondor = yes
		}
		any_sub_realm_county = { # Otherwise, if the ruler controls a province in Ithilien of Dúnedain culture
			culture = { has_cultural_pillar = heritage_dunedain }
			kingdom = title:k_ithilien
		}
	}
	is_target_in_global_variable_list = { # Has the decision to form the rangers been taken...
		name = unavailable_unique_decisions
		target = flag:establish_the_ithilien_rangers
	}
}

can_recruit_mumakil_trigger = {
	any_directly_owned_province = {
		OR = { 
			has_building_or_higher = mumakil_pen_01
			has_building_or_higher = wonder_palace_of_haruzan_03 
		}
	}
}

palace_of_haruzan_cheaper_purchase_mumakil_trigger = {
	is_landed = yes
	any_directly_owned_province = {
		has_building_or_higher = wonder_palace_of_haruzan_01
	}
}
########################
### WARBAND TRIGGERS ###
########################
lotr_allows_warbands_trigger = {
	AND = {
		OR = {
			this.culture = { has_cultural_pillar = heritage_hadorim }
			this.culture = { has_cultural_pillar = heritage_daen_lintis }
			this.culture = { has_cultural_pillar = heritage_daen_coentis }
		}
		NOT = {
			this.culture = culture:rohirrim
			this.culture = { has_cultural_pillar = heritage_ainur }
			has_character_flag = is_saruman
		}
		NOT = { culture ?= culture:wastelands }
	}
}
lotr_warbands_mirkwood_leofring_trigger = {
	AND = {
		this.culture = culture:leofring
		completely_controls = title:c_dorfirnen
		NOT = { culture ?= culture:wastelands }
	}
}
lotr_warbands_parth_celebrant_leofring_trigger = {
	AND = {
		this.culture = culture:leofring
		NOT = { culture ?= culture:wastelands }
		OR = {
			completely_controls = title:d_parth_celebrant
			completely_controls = title:c_thorlorien
		}
	}
}
lotr_warbands_bandit_leofring_trigger = {
	AND = {
		this.culture = culture:leofring
		NOT = { culture ?= culture:wastelands }
		OR = {
			completely_controls = title:c_varad
			completely_controls = title:c_nanlothanduin
			completely_controls = title:c_southundeep
			completely_controls = title:c_berennyn
			completely_controls = title:c_mernael
			completely_controls = title:c_audaghaim
			completely_controls = title:c_gladden_fields
			completely_controls = title:c_norwold
			completely_controls = title:c_northundeep
			completely_controls = title:c_sutwold
			completely_controls = title:c_fortalf
			completely_controls = title:c_theeasternwall
			completely_controls = title:c_hartalf
		}
	}
}
lotr_warbands_dwarrowhall_leofring_trigger = {
	AND = {
		this.culture = culture:leofring
		NOT = { culture ?= culture:wastelands }
		OR = {
			completely_controls = title:c_byre_tor
			completely_controls = title:c_eorcan
		}
	}
}
#lotr_warbands_leofring_trigger = {
#	AND = {
#		this.culture = culture:leofring
#	}
#}
lotr_warbands_eotheod_trigger = {
	AND = {
		this.culture = culture:eotheod
		NOT = { culture ?= culture:wastelands }
	}
}
lotr_warbands_adornaen_trigger = {
	AND = {
		NOT = { culture ?= culture:wastelands }
		OR = {
			this.culture = culture:adornaen
			this.culture = culture:isengard_dunlending
		}
		OR = {
			completely_controls = title:c_frecalund
			completely_controls = title:c_larcnoc
			completely_controls = title:c_earcnoc
			completely_controls = title:c_glasgleann
			completely_controls = title:c_chailcaerdh
			completely_controls = title:c_dunfearnshaws
			completely_controls = title:c_tormcaladach
		}
	}
}
lotr_warbands_fisherfolk_trigger = {
	AND = {
		NOT = { culture ?= culture:wastelands }
		this.culture = {
			OR = {
				has_cultural_pillar = heritage_daen_coentis
				has_cultural_pillar = heritage_daen_lintis
			}
		}
		OR = {
			completely_controls = title:c_iren
			completely_controls = title:c_carreglyn
			completely_controls = title:c_iarnburn
			completely_controls = title:c_cadlus
		}
		NOT = {
			this.culture = culture:isengard_dunlending
		}
	}
}
lotr_warbands_dunlending_trigger = {
	AND = {
		NOT = { culture ?= culture:wastelands }
		this.culture = {
			OR = {
				has_cultural_pillar = heritage_daen_coentis
				has_cultural_pillar = heritage_daen_lintis
			}
		}
		OR = {
			completely_controls = title:c_westmarches
			completely_controls = title:c_valesoftheadorn
			completely_controls = title:c_emyndunendor
			completely_controls = title:c_gaetir
			completely_controls = title:c_galtrev
			completely_controls = title:c_starkmoors
			completely_controls = title:c_cailintur
			completely_controls = title:c_glasgleann
		}
		NOT = {
			this.culture = culture:isengard_dunlending
		}
	}
}
lotr_warbands_gwathlo_estuary_trigger = {
	AND = {
		NOT = { culture ?= culture:wastelands }
		this.culture = culture:saralain
	}
}
lotr_warbands_gwathlo_trigger = {
	AND = {
		NOT = { culture ?= culture:wastelands }
		OR = {
			# this.culture = culture:gwathlo_gwathuirim
			this.culture = culture:enedhwaithrim
		}
	}
}
lotr_warbands_gondor_gwathuirim_trigger = {
	AND = {
		NOT = { culture ?= culture:wastelands }
		this.culture = { has_cultural_pillar = heritage_daen_coentis }
	}
}
lotr_warbands_haradrim_suladan_trigger = {
	AND = {
		NOT = { culture ?= culture:wastelands }
		this.culture = { has_cultural_pillar = heritage_northern_apysaic }
		OR = {
			completely_controls = title:k_haruzan
		}
	}
}
lotr_warbands_haradrim_corsair_trigger = {
	AND = {
		NOT = { culture ?= culture:wastelands }
		this.culture = { has_cultural_pillar = heritage_northern_apysaic }
		OR = {
			completely_controls = title:c_shafra
			completely_controls = title:c_suk_oda
			completely_controls = title:c_korb_ugarta
		}
	}
}
lotr_warbands_haradrim_desert_trigger = {
	AND = {
		NOT = { culture ?= culture:wastelands }
		this.culture = { has_cultural_pillar = heritage_northern_apysaic }
		OR = {
			completely_controls = title:c_khabazh
			completely_controls = title:c_tajama
			completely_controls = title:c_zakakha
			completely_controls = title:c_ardrista
			completely_controls = title:c_rakha
			completely_controls = title:c_kharga
			completely_controls = title:c_arakh
			completely_controls = title:c_kajbah
			completely_controls = title:c_pazaran
		}
	}
}
lotr_warbands_haradrim_trigger = {
	AND = {
		NOT = { culture ?= culture:wastelands }
		this.culture = { has_cultural_pillar = heritage_northern_apysaic }
	}
}


not_in_use_trigger = {
	OR = {
		culture = { has_cultural_pillar = heritage_daen_lintis }
		culture = { has_cultural_pillar = heritage_hadorim }
	}
	NOT = {
		culture = culture:rohirrim
		culture = { has_cultural_pillar = heritage_ainur }
		has_character_flag = is_saruman
	}
}

lotr_isengard_urukhai_culture_trigger = {
	culture = culture:isengard_urukhai
}

lotr_isengard_urukai_maa_trigger = {
	OR = {
		culture = culture:isengard_urukhai
		culture = { any_parent_culture_or_above = { this = culture:isengard_urukhai } }
	}
}

lotr_armies_are_outnumbered = {
	total_enemy_strength > total_ally_strength
}

lotr_chelkar_submission_trigger = {
	title:k_haruzan.holder.max_military_strength > chelkar_military_strength_times_two
}

lotr_at_peace_with_gondor = {
	NOR = {
		any_war_enemy = {
			has_title = title:e_gondor
		}
		any_war_enemy = {
			has_title = title:e_gondor_steward
		}
	}
}

lotr_at_peace_with_rohan = {
	NOT = {
		any_war_enemy = {
			has_title = title:k_rohan
		}
	}
}


########################
### ABRAKHÂN TRIGGERS ##
########################

# Abrakhân
character_is_valid_for_abrakhan_subjugation_mission_trigger = {		# this trigger checks if you are considered Sauron's Abrakhan
	#juke note: should be improved to eventually include "saurons permission" for cases where a not nessecarily sauron aligned power conquers abkrahan (for example, the mission stuff wouldnt make sense. i.e. player-led Ar-Adunai conquerors etc)
	custom_tooltip = {
		text = character_is_valid_for_abrakhan_subjugation_mission_trigger
		faith_is_evil = yes
		NOR = {
			faith = faith:melkorite
			faith = faith:way_of_strength
		}
		sauron_is_alive = yes

		highest_held_title_tier >= tier_kingdom
		OR = { 	#juke note: added to avoid situations where sandbox stuff occurs (player-lead independent darsalan kingdom etc)
			has_title = title:k_abrakhan_religious
			has_title = title:k_abrakhan
			has_title = title:e_nafarat
		}
		capital_province = { geographical_region = middleearth_haradwaith_far_abrakhan }
	}
}


character_is_valid_for_nafarati_subjugation_trigger = {	# this trigger checks if you are valid to submit to Abrakhan at  the beginning
	is_available_adult = yes
	culture = culture:nafarati
	martial >= high_skill_rating
	#	AND = {
	#		OR = {
	#			culture = { has_cultural_pillar = heritage_nafarati }
	#			#faith = faith:faith_nafar	#juke note: we can let them be a different faith, if they are in abrakhans court we can assume they are a servant of the golden king
	#		}
	#	}
}
character_is_valid_for_ray_subjugation_trigger = {
	is_available_adult = yes
	# ToDo: is relevant to Ray and has relevant traits.
	stewardship >= high_skill_rating
	AND = {
		OR = {
			culture = { has_cultural_pillar = heritage_southern_apysaic }
			faith = faith:faith_ray
		}
		OR = {
			has_trait = education_stewardship_3
			has_trait = education_stewardship_4
			has_trait = administrator
			has_trait = avaricious
			short_term_gold >= major_gold_value # Matt note: this should check if they have a large amount of income.
		}
	}
}
character_is_valid_for_umbar_subjugation_trigger = {
	is_available_adult = yes
	stewardship >= high_skill_rating
	# ToDo: is relevant to Umbar and has relevant traits.
	#	AND = {
	#		OR = {
	#			lotr_numenor_culture_trigger = yes
	#			faith = faith:faith_kings_men_castamir
	#			faith = faith:faith_corsair
	#			faith = faith:melkorite
	#		}
	#		OR = {
	#			dynasty = { has_dynasty_perk = lotr_black_numenorean_legacy_1 }
	#			has_trait = adventurer
	#			has_trait = varangian
	#		}
	#	}
}

##############################################
### Numenoreans and their successor states ###
##############################################

is_gondor = {
	culture = { has_cultural_pillar = heritage_dunedain }
	OR = {
		has_primary_title = title:e_gondor_steward
		has_primary_title = title:e_gondor
		has_primary_title = title:e_castamir
		has_primary_title = title:e_numenor_in_exile
		has_primary_title = title:e_reunitedkingdom
	}
}

is_steward_of_gondor = {
	culture = { has_cultural_pillar = heritage_dunedain }
	OR = {
		has_primary_title = title:e_gondor_steward
		has_primary_title = title:k_gondor_steward
		AND = {
			highest_held_title_tier = tier_kingdom
			has_title = title:k_gondor_steward
		}
	}
}

is_arnor = {
	culture = { has_cultural_pillar = heritage_dunedain }
	OR = {
		has_primary_title = title:e_arnor
		has_primary_title = title:d_northern_dunedain
		has_primary_title = title:e_numenor_in_exile
		has_primary_title = title:e_reunitedkingdom
	}
}

lotr_has_numenorean_culture_trigger = {
	culture = {
		#OR = {
		#	has_cultural_pillar = heritage_dunedain
		#	has_cultural_pillar = heritage_bellakari
		#	has_cultural_pillar = heritage_northern_adunaic
		#	has_cultural_pillar = heritage_southern_adunaic
		#}
		has_cultural_parameter = heritage_group_numenorean
	}
}

lotr_has_southern_numenorean_culture_trigger = {
	culture = {
		OR = {
			has_cultural_pillar = heritage_bellakari
			has_cultural_pillar = heritage_northern_adunaic
			has_cultural_pillar = heritage_southern_adunaic
		}
	}
}

### New Dejure Capital Triggers ###

# Show Triggers
show_osgiliath_capital_trigger = {
	NOT = { primary_title.title_capital_county = title:c_osgiliath }
	#completely_controls = title:c_osgiliath
	OR = {
		has_primary_title = title:e_gondor
		has_primary_title = title:e_gondor_steward
		has_primary_title = title:e_castamir
		has_primary_title = title:e_reunitedkingdom
		has_primary_title = title:e_numenor_in_exile
		has_primary_title = title:k_anorien
	}
}
show_minas_tirith_capital_trigger = {
	NOT = { primary_title.title_capital_county = title:c_minas_tirith }
	#completely_controls = title:c_minas_tirith
	OR = {
		has_primary_title = title:e_gondor
		has_primary_title = title:e_gondor_steward
		has_primary_title = title:e_castamir
		has_primary_title = title:e_reunitedkingdom
		has_primary_title = title:e_numenor_in_exile
		has_primary_title = title:k_anorien
	}
}
show_minas_ithil_capital_trigger = {
	NOT = { primary_title.title_capital_county = title:c_minas_ithil }
	#completely_controls = title:c_minas_ithil
	OR = {
		has_primary_title = title:e_gondor
		has_primary_title = title:e_gondor_steward
		has_primary_title = title:e_castamir
		has_primary_title = title:e_reunitedkingdom
		has_primary_title = title:e_numenor_in_exile
		has_primary_title = title:k_ithilien
	}
}
show_emyn_arnen_capital_trigger = {
	NOT = { primary_title.title_capital_county = title:c_emyn_arnen }
	#completely_controls = title:c_emyn_arnen
	current_year >= 6035
	OR = {
		has_primary_title = title:k_ithilien
	}
	is_target_in_global_variable_list = {
		name = unavailable_unique_decisions
		target = flag:decision_emyn_arnen_capital
	}
}
show_pelargir_capital_trigger = {
	NOT = { primary_title.title_capital_county = title:c_pelargir }
	#completely_controls = title:c_pelargir
	OR = {
		has_primary_title = title:e_gondor
		has_primary_title = title:e_gondor_steward
		has_primary_title = title:e_castamir
		has_primary_title = title:e_reunitedkingdom
		has_primary_title = title:e_numenor_in_exile
	}
}
show_dol_amroth_capital_trigger = {
	NOT = { primary_title.title_capital_county = title:c_dol_amroth }
	#completely_controls = title:c_dol_amroth
	OR = {
		has_primary_title = title:e_gondor
		has_primary_title = title:e_gondor_steward
		has_primary_title = title:e_castamir
		has_primary_title = title:e_reunitedkingdom
		has_primary_title = title:e_numenor_in_exile
	}
	dynasty = dynasty:dynasty_dol_amroth
}
show_methir_capital_trigger = {
	NOT = { primary_title.title_capital_county = title:c_methir }
	#completely_controls = title:c_methir
	OR = {
		has_primary_title = title:k_harondor
	}
}
show_mirlond_capital_trigger = {
	NOT = { primary_title.title_capital_county = title:c_mirlond }
	#completely_controls = title:c_mirlond
	OR = {
		has_primary_title = title:k_mirlond
		has_primary_title = title:k_harondor
	}
}
show_ramlond_capital_trigger = {
	NOT = { primary_title.title_capital_county = title:c_ramlond }
	#completely_controls = title:c_ramlond
	OR = {
		has_primary_title = title:k_mirlond
	}
}
show_umbar_capital_trigger = {
	NOT = { primary_title.title_capital_county = title:c_umbar }
	#completely_controls = title:c_umbar
	OR = {
		AND = {
			OR = {
				has_primary_title = title:e_gondor
				has_primary_title = title:e_reunitedkingdom
			}
			title:k_umbar.empire = root.primary_title
		}
		has_primary_title = title:e_castamir
		has_primary_title = title:e_umbar
		has_primary_title = title:e_numenor_in_exile
		has_primary_title = title:e_adunaim
	}
}
show_annuminas_capital_trigger = {
	NOT = { primary_title.title_capital_county = title:c_annuminas }
	#completely_controls = title:c_annuminas
	OR = {
		has_primary_title = title:e_arnor
		has_primary_title = title:e_reunitedkingdom
		has_primary_title = title:e_numenor_in_exile
		has_primary_title = title:k_arthedain
	}
}
show_fornost_capital_trigger = {
	NOT = { primary_title.title_capital_county = title:c_fornost }
	#completely_controls = title:c_fornost
	OR = {
		has_primary_title = title:e_arnor
		has_primary_title = title:e_reunitedkingdom
		#has_primary_title = title:e_numenor_in_exile
		has_primary_title = title:k_arthedain
	}
}
show_tharbad_capital_trigger = {
	NOT = { primary_title.title_capital_county = title:c_tharbad }
	#completely_controls = title:c_tharbad
	OR = {
		has_primary_title = title:e_arnor
		has_primary_title = title:e_reunitedkingdom
		has_primary_title = title:e_numenor_in_exile
		has_primary_title = title:k_cardolan
	}
}
show_thalion_capital_trigger = {
	NOT = { primary_title.title_capital_county = title:c_thalion }
	#completely_controls = title:c_thalion
	OR = {
		#has_primary_title = title:e_arnor
		#has_primary_title = title:e_reunitedkingdom
		#has_primary_title = title:e_numenor_in_exile
		has_primary_title = title:k_cardolan
	}
}
show_cameth_brin_capital_trigger = {
	NOT = { primary_title.title_capital_county = title:c_cameth_brin }
	#completely_controls = title:c_cameth_brin
	OR = {
		#has_primary_title = title:e_arnor
		#has_primary_title = title:e_reunitedkingdom
		#has_primary_title = title:e_numenor_in_exile
		has_primary_title = title:k_rhudaur
	}
}
show_nilulonde_capital_trigger = {
	NOT = { primary_title.title_capital_county = title:c_nilulonde }
	#completely_controls = title:c_nilulonde
	OR = {
		has_primary_title = title:e_bellakar
		has_primary_title = title:e_pharazain
		has_primary_title = title:e_numenor_in_exile
		#has_primary_title = title:e_thon_an_kharlokh
	}
}
show_korlea_capital_trigger = {
	NOT = { primary_title.title_capital_county = title:c_korlea }
	#completely_controls = title:c_korlea
	OR = {
		AND = {
			has_primary_title = title:e_bellakar
			NOT = { dynasty = dynasty:dynasty_tumakveh }
		}
		has_primary_title = title:e_pharazain
		has_primary_title = title:e_numenor_in_exile
		#has_primary_title = title:e_thon_an_kharlokh
	}
}
show_tariketh_an_kharat_capital_trigger = {
	NOT = { primary_title.title_capital_county = title:c_tariketh_an_kharat }
	#completely_controls = title:c_tariketh_an_kharat
	OR = {
		has_primary_title = title:e_pharazain
		has_primary_title = title:e_numenor_in_exile
		has_primary_title = title:e_thani_hazad
		#has_primary_title = title:e_thon_an_kharlokh
	}
}
show_khorsaj_capital_trigger = {
	NOT = { primary_title.title_capital_county = title:c_khorsaj }
	#completely_controls = title:c_khorsaj
	OR = {
		has_primary_title = title:e_pharazain
		has_primary_title = title:e_numenor_in_exile
		#has_primary_title = title:e_thon_an_kharlokh
	}
}
show_tol_uialgaer_capital_trigger = {
	NOT = { primary_title.title_capital_county = title:c_tol_uialgaer }
	#completely_controls = title:c_tol_uialgaer
	OR = {
		has_primary_title = title:e_umbar
		has_primary_title = title:e_numenor_in_exile
		has_primary_title = title:e_adunaim
	}
	dynasty = dynasty:dynasty_pharazon
}

# Valid Triggers
valid_osgiliath_capital_trigger = {
	has_title = title:c_osgiliath
	completely_controls = title:d_minas_tirith
	completely_controls = title:k_ithilien
	province:202 = { has_building_or_higher = wonder_osgiliath_04 }
	province:203 = { has_building_or_higher = wonder_osgiliath_04 }
}
valid_minas_tirith_capital_trigger = {
	has_title = title:c_minas_tirith
	completely_controls = title:d_minas_tirith
}
valid_minas_ithil_capital_trigger = {
	has_title = title:c_minas_ithil
	completely_controls = title:k_ithilien
	custom_tooltip = {
		text = minas_ithil_free_of_corruption.tt
		title:c_minas_ithil = {
			NOR = {
				has_county_modifier = morgul_corruption_modifier
				has_county_modifier = fading_morgul_corruption_modifier
			}
		}
	}
	province:226 = { has_building_or_higher = wonder_minas_ithil_03 }
}
valid_emyn_arnen_capital_trigger = {
	has_title = title:c_emyn_arnen
	completely_controls = title:d_emyn_arnen
	#has_building_or_higher = wonder_palace_of_ithilien
}
valid_pelargir_capital_trigger = {
	has_title = title:c_pelargir
	completely_controls = title:d_pelargir
	province:264 = { has_building_or_higher = castle_03 }
	province:264 = { has_building_or_higher = wonder_port_of_pelargir_02 }
}
valid_dol_amroth_capital_trigger = {
	has_title = title:c_dol_amroth
	completely_controls = title:k_belfalas
	province:315 = { has_building_or_higher = castle_03 }
	province:315 = { has_building_or_higher = wonder_dol_amroth_03 }
}
valid_methir_capital_trigger = {
	has_title = title:c_methir
	completely_controls = title:d_laergaladrin
}
valid_mirlond_capital_trigger = {
	has_title = title:c_mirlond
	completely_controls = title:d_forethir
}
valid_ramlond_capital_trigger = {
	has_title = title:c_ramlond
	completely_controls = title:d_ramlond
}
valid_umbar_capital_trigger = {
	has_title = title:c_umbar
	completely_controls = title:d_umbar
	province:819 = { has_building_or_higher = castle_03 }
}
valid_annuminas_capital_trigger = {
	has_title = title:c_annuminas
	completely_controls = title:k_arthedain
	province:4708 = { has_building_or_higher = castle_03 }
	province:4708 = { has_building_or_higher = wonder_annuminas_03 }
}
valid_fornost_capital_trigger = {
	has_title = title:c_fornost
	completely_controls = title:d_nan_turath
	#province:4545 = { has_building_or_higher = castle_03 }
	#province:4545 = { has_building_or_higher = wonder_fornost_04 }
}
valid_tharbad_capital_trigger = {
	has_title = title:c_tharbad
	has_title = title:d_minhiriath
	completely_controls = title:d_minhiriath
	province:4537 = { has_building_or_higher = castle_03 }
	province:4537 = { has_building_or_higher = wonder_tharbad_04 }
}
valid_thalion_capital_trigger = {
	has_title = title:c_thalion
	has_title = title:d_minhiriath
	completely_controls = title:d_minhiriath
	province:4532 = { has_building_or_higher = castle_03 }
	province:4532 = { has_building_or_higher = wonder_thalion_04 }
}
valid_cameth_brin_capital_trigger = {
	has_title = title:c_cameth_brin
	completely_controls = title:d_cameth_brin
	province:4415 = { has_building_or_higher = castle_03 }
	province:4415 = { has_building_or_higher = wonder_cameth_brin_03 }
}
valid_nilulonde_capital_trigger = {
	has_title = title:c_nilulonde
	completely_controls = title:k_nilulonde
	province:1791 = { has_building_or_higher = castle_03 }
}
valid_korlea_capital_trigger = {
	has_title = title:c_korlea
	completely_controls = title:k_bellazen
	province:1644 = { has_building_or_higher = castle_03 }
}
valid_khorsaj_capital_trigger = {
	has_title = title:c_khorsaj
	completely_controls = title:d_khorsaj
	province:1977 = { has_building_or_higher = castle_03 }
}
valid_tariketh_an_kharat_capital_trigger = {
	has_title = title:c_tariketh_an_kharat
	completely_controls = title:d_aruzayan
	province:2493 = { has_building_or_higher = castle_03 }
	province:2493 = { has_building_or_higher = wonder_marath_kharadune_03 }
}
valid_tol_uialgaer_capital_trigger = {
	has_title = title:c_tol_uialgaer
	completely_controls = title:d_tol_uialgaer
	province:1018 = { has_building_or_higher = castle_04 }
	province:1018 = { has_building_or_higher = wonder_arminalethor_01 }
}

### Dejure Province Restoration Triggers ###

show_harondor_trigger = {
	current_year >= 6852
	NOT = {
		is_target_in_global_variable_list = {
			name = unavailable_unique_decisions
			target = flag:reclaim_harondor_decision
		}
	}
	title:k_harondor.empire = {
		NOR = {
			this = title:e_gondor_steward
			this = title:e_gondor
			this = title:e_castamir
			this = title:e_numenor_in_exile
			this = title:e_reunitedkingdom
		}
	}
}
show_harnendor_trigger = {
	OR = {
		is_target_in_global_variable_list = {
			name = unavailable_unique_decisions
			target = flag:harnen_kingdom_decision
		}
		current_year <= 4000
	}
	OR = {
		title:d_doriant.kingdom = title:k_mirlond
		title:d_ramlond.kingdom = title:k_mirlond
	}
	NOT = {
		is_target_in_global_variable_list = {
			name = unavailable_unique_decisions
			target = flag:reclaim_harnendor_decision
		}
	}
	title:k_mirlond.empire = {
		NOR = {
			this = title:e_gondor_steward
			this = title:e_gondor
			this = title:e_castamir
			this = title:e_numenor_in_exile
			this = title:e_reunitedkingdom
		}
	}
}
show_andrast_trigger = {
	NOT = {
		is_target_in_global_variable_list = {
			name = unavailable_unique_decisions
			target = flag:integrate_andrast_decision
		}
	}
	title:k_andrast.empire = {
		NOR = {
			this = title:e_gondor_steward
			this = title:e_gondor
			this = title:e_castamir
			this = title:e_numenor_in_exile
			this = title:e_reunitedkingdom
		}
	}
}
show_umbar_trigger = {
	current_year >= 5843
	NOT = {
		is_target_in_global_variable_list = {
			name = unavailable_unique_decisions
			target = flag:reclaim_umbar_decision
		}
	}
	title:k_umbar.empire = {
		NOR = {
			this = title:e_gondor_steward
			this = title:e_gondor
			this = title:e_castamir
			this = title:e_numenor_in_exile
			this = title:e_reunitedkingdom
		}
	}
}
show_calenardhon_trigger = {
	current_year >= 6543
	NOT = {
		is_target_in_global_variable_list = {
			name = unavailable_unique_decisions
			target = flag:integrate_calenardhon_decision
		}
	}
	title:k_rohan.empire = {
		NOR = {
			this = title:e_gondor_steward
			this = title:e_gondor
			this = title:e_castamir
			this = title:e_numenor_in_exile
			this = title:e_reunitedkingdom
		}
	}
}
show_dor_rhunen_trigger = {
	current_year >= 5889 # Gondor looses Dor Rhúnen
	NOT = {
		is_target_in_global_variable_list = {
			name = unavailable_unique_decisions
			target = flag:reclaim_dor_rhunen_decision
		}
	}
	title:k_south_rhovanion.empire = {
		NOR = {
			this = title:e_gondor_steward
			this = title:e_gondor
			this = title:e_castamir
			this = title:e_numenor_in_exile
			this = title:e_reunitedkingdom
		}
	}
}
show_enedhwaith_trigger = {
	OR = {
		AND = {
			has_primary_title = title:e_reunitedkingdom
			is_target_in_global_variable_list = {
				name = unavailable_unique_decisions
				target = flag:decision_solidify_reunited_kingdom
			}
		}
		has_primary_title = title:e_numenor_in_exile
	}
	is_target_in_global_variable_list = {
		name = unavailable_unique_decisions
		target = flag:integrate_andrast_decision
	}
	NOT = {
		is_target_in_global_variable_list = {
			name = unavailable_unique_decisions
			target = flag:decision_claim_enedhwaith
		}
	}
	NOT = {
		title:k_druwaith.empire = {
			OR = {
				this = title:e_numenor_in_exile
				this = title:e_reunitedkingdom
			}
		}
		title:k_enedhwaith.empire = {
			OR = {
				this = title:e_numenor_in_exile
				this = title:e_reunitedkingdom
			}
		}
		title:k_dunland.empire = {
			OR = {
				this = title:e_numenor_in_exile
				this = title:e_reunitedkingdom
			}
		}
	}
}
show_eregion_trigger = {
	OR = {
		AND = {
			has_primary_title = title:e_reunitedkingdom
			is_target_in_global_variable_list = {
				name = unavailable_unique_decisions
				target = flag:decision_solidify_reunited_kingdom
			}
		}
		has_primary_title = title:e_numenor_in_exile
	}
	NOT = {
		is_target_in_global_variable_list = {
			name = unavailable_unique_decisions
			target = flag:decision_integrate_eregion
		}
	}
	title:k_eregion.empire = {
		NOR = {
			this = title:e_numenor_in_exile
			this = title:e_reunitedkingdom
		}
	}
}

### Thâni-Hazâd Struggle Triggers ###
balan_lai_united_cunning_trigger = {
	has_title = title:d_balan_lai_leader
	any_balan_lai_member = {
		percent > 0.8
		NOT = { this = ROOT }
		save_temporary_scope_as = char_temp
		calc_true_if = {
			amount >= 2
			opinion = {
				target = root
				value > 80
			}
			custom_tooltip = {
				text = lotr_i_have_hook
				root = { has_hook = scope:char_temp }
			}
			custom_tooltip = {
				text = lotr_i_have_strong_hook
				root = { has_strong_hook = scope:char_temp }
			}
			is_allied_to = root
			custom_tooltip = {
				text = lotr_is_tributary_of_me
				is_tributary_of = { SUZERAIN = ROOT TRIBUTARY = scope:char_temp }
			}
			is_vassal_or_below_of = ROOT
			is_spouse_of = ROOT
			# is_adult = No
            #is_imprisoned_by = root
			custom_tooltip = {
				text = lotr_is_in_regency
				has_active_diarchy = yes
				has_diarchy_type = regency
			}
		}
	}
}

balan_lai_united_might_trigger = {
	prestige_level >= 4
	custom_tooltip = {
		text = balan_lai_united_might_region_realm_size_desc
		NOT = {
			any_balan_lai_member = {
				NOT = { this = ROOT }
				is_independent_ruler = yes
				realm_size > ROOT.realm_size
			}
		}
	}
	#custom_tooltip = {
	#	text = balan_lai_united_might_region_control_desc
	#	any_county_in_region = {
	#		region = custom_mannish_thani_hazad
	#		OR = {
	#			holder = { is_vassal_or_below_of = root }
	#			holder = root
	#		}
	#		percent >= 0.30
	#	}
	#}
	dread >= 50
	custom_tooltip = {
		text = balan_lai_united_might_military_strength_min
		current_military_strength >= 5000
	}
	custom_tooltip = {
		text = balan_lai_united_might_greater_military_strength
		current_military_strength > {
			value = 0
			struggle:thani_hazad_struggle ?= {
				every_involved_ruler = {
				    limit = {
						has_trait = balan_lai_member
    			        is_independent_ruler = yes
				    	NOT = { this = root }
    			        NOT = { is_allied_to = root }
				    	NOT = { is_tributary_of = { SUZERAIN = root TRIBUTARY = this } }
    			        NOT = { is_imprisoned_by = root }
						NOT = { is_vassal_or_below_of = root }
				    }
					limit = { exists = current_military_strength }
					add = current_military_strength
				}
			}
			multiply = 0.8
		}
	}
}

### Set Sail Activity Triggers ###

coastal_province_in_realm = {
	any_realm_county = {
		title_province = { is_coastal = yes }
	}
}

owns_a_damaged_boat = {
	OR = {
		has_character_modifier = small_damaged_boat_modifier
		has_character_modifier = medium_damaged_boat_modifier
		has_character_modifier = large_damaged_boat_modifier
	}
}

owns_an_undamaged_boat = {
	OR = {
		has_character_modifier = small_boat_modifier
		has_character_modifier = medium_boat_modifier
		has_character_modifier = large_boat_modifier
	}
}

owns_a_boat = {
	OR = {
		owns_an_undamaged_boat = yes
		owns_a_damaged_boat = yes
	}
}

is_boat_purchased = {
	NOT = {
		has_character_flag =  hired_a_boat
	}
}

can_afford_a_boat = {
	owns_a_boat = no
	gold >= small_boat_hire_cost
}

### War CB ###
can_conduct_slave_expedition = {
	NOT = {
		has_character_flag = successful_slaver_expedition
	}
}

county_is_elven = {
	county = {
		OR = {
			culture = { has_cultural_pillar = heritage_quendi }
			culture = { has_cultural_pillar = heritage_calaquendi }
			culture = { has_cultural_pillar = heritage_lomiquendi }
			culture = { has_cultural_pillar = heritage_moriquendi }
		}
	}
}

no_existing_elven_stronghold_in_duchy = {
	any_province = {
		count = 0
		NOT = { this = root }
		trigger_if = {
			limit = { exists = duchy }
			duchy = root.duchy
		}
		OR = {
			has_building = elven_settlement_03
			has_building = elven_settlement_04
			has_building = elven_settlement_05
		}
	}
}

has_capacity_for_elven_stronghold = {
	any_realm_province = {
		count < elven_stronghold_limit
		OR = {
			has_building = elven_settlement_03
			has_building = elven_settlement_04
			has_building = elven_settlement_05
		}
	}
}

no_existing_elven_city_in_kingdom = {
	any_province = {
		count = 0
		NOT = { this = root }
		trigger_if = {
			limit = { exists = kingdom }
			kingdom = root.kingdom
		}
		OR = {
			has_building = elven_settlement_06
			has_building = elven_settlement_07
		}
	}
}

has_capacity_for_elven_city = {
	any_realm_province = {
		count < elven_city_limit
		OR = {
			has_building = elven_settlement_06
			has_building = elven_settlement_07
		}
	}
}

lotr_friends_with_elven_king_trigger = {
	any_independent_ruler = {
		has_relation_friend = root
		is_elf = yes
		is_in_valinor = no
		highest_held_title_tier >= tier_kingdom
	}
}

lotr_friends_with_dwarf_trigger = {
	any_independent_ruler = { 
		has_relation_friend = root
		is_dwarf = yes
	}
}

is_in_valinor = {
	trigger_if = {
		limit = {
			exists = capital_province
		}
		capital_province = {
			geographical_region = middleearth_valinor
		}
	}
	trigger_else = {
		trigger_if = {
			limit = { exists = host.capital_province }
			host.capital_province = {
				geographical_region = middleearth_valinor
			}
		}
		trigger_else_if = {
			limit = {
				exists = liege.capital_province
			}
			liege.capital_province = {
				geographical_region = middleearth_valinor
			}
		}
		trigger_else_if = {
			limit = {
				exists = location.province_owner.capital_province
			}
			location.province_owner.capital_province = {
				geographical_region = middleearth_valinor
			}
		}
		trigger_else = {
			trigger_if = {
				limit = { is_alive = yes }
				OR = {
					has_trait = sailed_west
					has_trait = doom_sundered
				}
			}
		}
	}
}

##########################
## NEW SORCERY TRIGGERS ##
##########################

is_sorcerer = {
	OR = {
		has_trait = sorcerer_1
		has_trait = sorcerer_2
		has_trait = sorcerer_3
	}
}

can_learn_sorcery = {
	AND = {
		piety_level >= 2
		NOT = {
			has_character_flag = learning_sorcery
			has_character_modifier = studying_dark_arts_modifier
			is_sorcerer = yes
			has_trait = nazgul
			is_evil_istari = yes
			has_trait = maiar
		}
		AND = {
			OR = {
				has_trait = intellect_good_3
				has_trait = zealous
				has_trait = lifestyle_mystic
				has_trait = witch
				has_trait = education_intrigue_4
				has_trait = education_learning_4
			}
			religion = { is_in_family = rf_forcesofevil }
		}

		learning >= 16
	}

}

can_learn_sorcery_ai = {
	is_ai = yes
	religion = { is_in_family = rf_forcesofevil }
	NOT = {
		has_character_flag = learning_sorcery
		has_character_modifier = studying_dark_arts_modifier
		is_sorcerer = yes
		has_trait = nazgul
		is_evil_istari = yes
		has_trait = maiar
	}
	AND = {
		calc_true_if = {
			amount >= 2
			piety_level >= 3
			has_trait = intellect_good_3
			has_trait = zealous
			has_trait = schemer
			has_trait = theologian
			has_trait = lifestyle_mystic
			has_trait = witch
			has_trait = education_intrigue_4
			has_trait = education_learning_4
			learning >= 16
		}
	}
}

##########################
##### STORY TRIGGERS #####
##########################

sauron_is_alive = {
	character:lineofsauron = {
		is_alive = yes
	}
}

is_sauron = {
	this = character:lineofsauron
}

is_radagast = {
	this = character:lineofradagast
}

sauron_has_palantir = {
	character:lineofsauron = {
		any_character_artifact = {
			has_variable = palantir
		}
	}
}

aragorn_is_alive = {
	character:lineisildur42 = {
		is_alive = yes
	}
}

elrond_is_alive = {
	character:linefinwe27 = {
		is_alive = yes
	}
}

arwen_is_alive = {
	character:linefinwe30 = {
		is_alive = yes
	}
}

denethor_is_alive = {
	character:linesteward38 = {
		is_alive = yes
	}
}

saruman_is_alive = {
	character:lineofsaruman = {
		is_alive = yes
	}
}

saruman_is_evil = {
	character:lineofsaruman = {
		OR = {
			has_character_flag = saruman_accepted_sauron
			religion = {
				is_in_family = rf_forcesofevil
			}
		}
	}
}

saruman_is_defeated = {
	character:lineofsaruman = {
		OR = {
			NOT = { completely_controls = title:d_isengard }
			is_alive = no
		}
		faith_is_evil = yes
	}
}

golden_king_is_alive = {
	character:nazgul3 = {
		is_alive = yes
	}
}

witch_king_is_alive = {
	character:nazgul1 = {
		is_alive = yes
	}
}


################
#####KHAND######
################

has_vassals = {
	any_vassal = {
		count > 0
	}
}

###############
### TRAITS ####
###############

is_berserker = {	#to unify all three traits for event code
	or = {
		has_trait = berserker
		has_trait = urukhai_berserker
		has_trait = nafarati_berserker
	}
}

###################
### ACTIVITIES ####
###################

RICE_activity_participant_trigger = {
	is_ai = yes
	NOT = { this = root }
	is_alive = yes
	is_imprisoned = no
	is_incapable = no
}

lotr_can_be_activity_guest = {
	NOT = { has_trait = sauron_ringless }
	is_nazgul = no
	is_in_valinor = no

	# Orcs only attend Orcish events
	trigger_if = {
		limit = { scope:host ?= { is_orc = yes } }
		is_orc = yes
	}
	trigger_else = { is_orc = no }

	#Humans and Dwarves may tolerate other alignments but Elves and Istari do not
	trigger_if = {
		limit = {
			scope:host ?= {
				faith_is_good = yes
				is_human = no
				is_dwarf = no
			}
		}
		faith_is_good = yes
	}

	#Same goes for Sauron and the Nazgûl (if allowed to host activities)
	trigger_else_if = {
		limit = {
			scope:host ?= {
				is_human = no
				is_dwarf = no
				faith_is_evil = yes
			}
		}
		faith_is_evil = yes
	}

	trigger_else = {
		always = yes
	}
}

unique_human_archives_trigger = {
	OR = {
		province:199 = this #Minas Tirith
		province:315 = this #Dol Amroth
		province:264 = this #Pelargir
		province:20 = this #Isengard
		has_building = wonder_osgiliath_05
		AND = {
			title:c_minas_ithil = {
				NOR = {
					has_county_modifier = morgul_corruption_modifier
					has_county_modifier = fading_morgul_corruption_modifier
				}
			}
			province:226 = this #Minas Ithil
		}
		has_building = wonder_annuminas_01
		has_building = wonder_annuminas_03
		has_building = wonder_fornost_01
		has_building = wonder_fornost_02
		has_building = wonder_fornost_04
		has_building = wonder_cameth_brin_01
		has_building = wonder_cameth_brin_03
		has_building = wonder_palace_of_ithilien
		has_building = wonder_argond_01
		has_building = wonder_argond_03
		has_building = wonder_tharbad_01
		has_building = wonder_tharbad_02
		has_building = wonder_tharbad_04
		has_building = wonder_lond_daer_01
		has_building = wonder_lond_daer_03
		has_building = wonder_house_of_elrond
		province:2493 = this #Zadan an-Adûn
		province:2513 = this #Kadar an-Kharadûn
		province:819 = this #Umbar
		has_building = wonder_arminalethor_01
		province:1791 = this #Nilulonde
		province:1644 = this #Korlea
		province:1542 = this #Hazaj Tollin
		province:1731 = this #Urezayan
		has_building = wonder_haven_of_inzilloni
		has_building = wonder_mispir
		has_building = wonder_uruloni
	}
}

unique_elven_archives_trigger = {
	OR = {
		province:3108 = this #Caras Galadhon
		province:3216 = this #Aradhrynd
		has_building = wonder_amon_lanc_01
		has_building = wonder_amon_lanc_03
		has_building = wonder_edhellond_01
		has_building = wonder_edhellond_03
		has_building = wonder_amarthrynd_01
		has_building = wonder_amarthrynd_03
		has_building = wonder_house_of_elrond
		has_building = wonder_mithlond_south_01
		has_building_or_higher = wonder_forlond_01
		has_building = wonder_harlond_01
		has_building = wonder_mirdairond
		has_building = wonder_hall_of_tiralaen
	}
}

lotr_canon_safe_from_harm_trigger = {
	has_game_rule = default_ai_behavior
	OR = {
		this = character:lineisildur42 #Aragorn
		this = character:linegilraen12 #Halbarad
		this = character:linesteward38 #Denethor II
		this = character:linesteward39 #Boromir
		this = character:linesteward40 #Faramir
		this = character:dolamroth27 #Imrahil
		this = character:dolamroth31 #Lothiriel
		has_character_flag = is_eldarion #Eldarion
		this = character:linegilraen12 #Halbarad
		this = character:linelamedon30 #Angbor
		this = character:lossarnach28 #Forlong
		this = character:1518 #Hirluin
		this = character:6000017 #Théoden
		this = character:6000018 #Eomer
		this = character:6000034 #Théodred
		this = character:6000035 #Eowyn
		this = character:6000044 #Grima
		this = character:lineofbeorn2 # Grimbeorn
		this = character:lineoftumakveh82 #Niluhin
		this = character:lineofhuz190 #Huz-Margoz
		this = character:lineblackqueen9 #Beruthiel
		this = character:lineofcassimir23 #Cassimir
		this = character:lineofcassimir24 #Burodapan
		this = character:mouthofsauron #Mouth of Sauron
		this = character:syarrhul1 #Black Vizier
		this = character:lineofhador10 #Tuor
		this = character:lineofbaggins12 #Bilbo
		this = character:lineofbaggins29 #Frodo
		this = character:lineofdurin90 #Dain
		this = character:lineofdurin91 #Thorin Stonehelm
		this = character:lineofdurin95 #Balin
		this = character:lineofdurin98 #Oin
		this = character:lineofdale48 #Bain
		this = character:lineofdale50 #Brand
		this = character:lineofdale54 #Bard II
		this = character:lineofkoldana98 #Hawin
		has_trait = dwarf_father
		this = character:linefinwe36 #Galadriel
		this = character:lineofelmo5 #Celeborn
		this = character:linefinwe27 #Elrond
		this = character:lineofglorfindel #Glorfindel
		this = character:lineofcirdan #Cirdan
		this = character:lineoforopher3 #Thranduil
		this = character:lineoflanthir1 #Lanthir
		this = character:lineterilaen3 #Terilaen
		this = character:lineofafalku11a # Hussumadin of Harwan
		this = character:lineofazog1 # Azog
		this = character:lineofdurin81 # Thrór
		this = character:lineofdurin82 # Thráin
		this = character:lineofdurin83 # Thorin
		this = character:lineoffreca2 # Wulf
		this = character:lineisildur37 # Arassuil
	}
}

#######################
# WASTELANDS TRIGGERS #
#######################

not_has_county_on_island_region = {
	OR = {
		NOR = {
			any_held_title = {
				target_is_de_jure_liege_or_above = title:d_andunaloni
			}
			any_vassal_or_below = {
				any_held_title = {
					target_is_de_jure_liege_or_above = title:d_andunaloni
				}
			}
		}
		AND = {
			any_held_title = {
				target_is_de_jure_liege_or_above = title:d_andunaloni
				any_county_province = {
					has_holding_type = settlement_holding
				}
			}
			NOT = {
				any_held_title = {
					target_is_de_jure_liege_or_above = title:d_andunaloni
					any_county_province = {
						OR = {
							has_holding_type = castle_holding
							has_holding_type = elven_holding
							has_holding_type = church_holding
							has_holding_type = city_holding
						}
					}
				}
			}
		}
	}
}

maglor_aggresive_gondorian_knight_trigger = {
	is_ruler = no
	NOT = { is_primary_heir_of = scope:$SAVED_SCOPE$ }
	dynasty = scope:$SAVED_SCOPE$.dynasty
}

is_underground_county = {
	any_county_province = {
		terrain = halls
	}
}

has_movie_sountracks = {
	OR = {
		is_elf = yes
		is_dwarf = yes
		is_hobbit = yes
		culture = { has_cultural_pillar = heritage_dunedain } # Gondor music
		culture = { has_cultural_pillar = heritage_hadorim } # Rohan music
		culture = { has_cultural_pillar = heritage_northron } # Dale & Laketown music
		religion = { is_in_family = rf_forcesofevil } # Isengard and Mordor music
		is_orc = yes
	}
}

tom_holds_erebor = {
	title:k_wastelands.holder = {
		has_title = title:c_throne_of_erebor
		has_title = title:c_ravenhill
		has_title = title:c_golddeeps
		has_title = title:c_golden_hall
		has_title = title:c_halls_of_steel
		has_title = title:c_great_foundries
		has_title = title:c_arkenhalls
	}
}

is_dwarven_dynast = {
	OR = {
		dynasty:dynasty_durin.dynast = root
		dynasty:dynasty_dwalin.dynast = root
		dynasty:dynasty_uri.dynast = root
		dynasty:dynasty_thrar.dynast = root
	}
}

is_dwarven_dynasty_title = {
	OR = {
		this = title:e_durins_folk
		this = title:k_longbeards
		this = title:e_firebeards
		this = title:k_firebeards
		this = title:e_broadbeams
		this = title:k_broadbeams
		this = title:e_blacklocks
		this = title:k_blacklocks

		this = title:e_ironfists
		this = title:k_ironfists
		this = title:e_stiffbeards
		this = title:k_stiffbeards
		this = title:e_stonefoots
		this = title:k_stonefoots
	}
}

has_dwarven_dynasty_title = {
	OR = {
		has_title = title:e_durins_folk
		has_title = title:k_longbeards
		has_title = title:e_firebeards
		has_title = title:k_firebeards
		has_title = title:e_broadbeams
		has_title = title:k_broadbeams
		has_title = title:e_blacklocks
		has_title = title:k_blacklocks

		has_title = title:e_ironfists
		has_title = title:k_ironfists
		has_title = title:e_stiffbeards
		has_title = title:k_stiffbeards
		has_title = title:e_stonefoots
		has_title = title:k_stonefoots
	}
}

can_give_dwarven_title = {
	trigger_if = {
		limit = { scope:target = { is_dwarven_dynasty_title = yes } }
		always = no
	}
	trigger_if = {
		limit = {
			scope:target.tier = scope:actor.primary_title.tier
			scope:target = { is_dwarven_dynasty_title = no }
			scope:actor = { has_dwarven_dynasty_title = yes }
			scope:actor = {
				any_held_title = {
					count = 1
					NOT = { this = scope:target }
					tier = scope:target.tier
				}
			}
		}
		always = no
	}

	trigger_if = {
		limit = { 
			scope:actor = { has_dwarven_dynasty_title = yes }
			OR = {
				scope:target = scope:actor.capital_county.kingdom
				scope:target = scope:actor.capital_county.empire
			}
		}
		always = no
	}
}

##########################
### Diplomacy Triggers ###
##########################

# Checks whether the ROOT character has a defensive alliance with the RECIPIENT
# Assumes || Character || scope
is_defensive_allied_to = {
	trigger_if = {
		limit = { has_variable_list = defensive_allies }
		is_target_in_variable_list = {
			name = defensive_allies
			target = $RECIPIENT$
		}
	}
	trigger_else = { always = no }
}

has_defensive_alliance = {
	has_variable_list = defensive_allies
}

has_numenorean_trait = {
	OR = {
		has_trait = blood_of_numenor_1
		has_trait = blood_of_numenor_2
		has_trait = blood_of_numenor_3
		has_trait = blood_of_numenor_4
		has_trait = blood_of_numenor_5
		has_trait = blood_of_numenor_6
		has_trait = blood_of_numenor_7
		has_trait = blood_of_numenor_8
		has_trait = blood_of_numenor_9
		has_trait = blood_of_numenor_10
	}
}

realms_achievements_enabled = {
	debug_only = no
	any_player = { count < 2 }
}

# Wulf Content Trigger
is_reconsidering_negotion = {
	OR = {
		AND = {
			var:wulf_negotiation_choice = 1
			NOT = { has_character_flag = wulf_rohan_promise_pat_marriage }
		}
		AND = {
			var:wulf_negotiation_choice = 2
			NOT = { has_character_flag = wulf_rohan_promise_mat_marriage }
		}
		AND = {
			var:wulf_negotiation_choice = 3
			NOT = { has_character_flag = wulf_rohan_promise_land }
		}
		AND = {
			var:wulf_negotiation_choice = 4
			NOT = { has_character_flag = wulf_rohan_promise_vassal_contract }
		}
		AND = {
			var:wulf_negotiation_choice = 5
			NOT = { has_character_flag = wulf_rohan_promise_hook }
		}
		AND = {
			var:wulf_negotiation_choice = 6
			NOT = { has_character_flag = wulf_rohan_promise_co_monarch }
		}
		AND = {
			var:wulf_negotiation_choice = 7
			NOT = { has_character_flag = wulf_rohan_promise_independence }
		}
	}
}
