dwarf_and_goblin_underground_county_cb_trigger = {
	trigger_if = {
		limit = { scope:target ?= { title_province ?= { terrain = halls } } }
		scope:attacker ?= {
			OR = {
				is_dwarf = yes
				is_orc = yes
				is_istari = yes
				is_nazgul = yes
				is_sauron = yes
			}
		}
		scope:defender ?= {
			OR = {
				is_dwarf = yes
				is_orc = yes
				is_istari = yes
				is_nazgul = yes
				is_sauron = yes
			}
		}
	}
}

dwarf_and_goblin_underground_duchy_cb_trigger = {
	trigger_if = {
		limit = { NOT = { exists = scope:target } }
		always = no
	}
	trigger_if = {
		limit = {
			OR = {
				scope:target = { any_de_jure_county = { holder.top_liege = scope:defender } }
				scope:target.holder = scope:defender
			}
			trigger_if = {
				limit = { 
					scope:target ?= { 
						any_de_jure_county ?= { 
							NOT = { title_province ?= { terrain = halls } } 
							OR = {
								holder = scope:defender
								holder.top_liege = scope:defender
							}
						}
					}
				}
				always = no
			} trigger_else  = {
				scope:target ?= { any_de_jure_county ?= { title_province ?= { terrain = halls } } }
			}
		}
		scope:attacker ?= {
			OR = {
				is_dwarf = yes
				is_orc = yes
				is_istari = yes
				is_nazgul = yes
				is_sauron = yes
			}
		}
		scope:defender ?= {
			OR = {
				is_dwarf = yes
				is_orc = yes
				is_istari = yes
				is_nazgul = yes
				is_sauron = yes
			}
		}
	}
}

underground_cb_trigger = {
	scope:attacker ?= {
		any_sub_realm_county ?= {
			any_neighboring_county ?= {
				OR = {
					holder = scope:defender
					holder = { is_vassal_or_below_of = scope:defender }
				}
			}
		}
	}
}

lotr_TH_struggle_balan_lai_defend_other_balan_lai = {
	trigger_if = {
		limit = {
			scope:defender = { has_trait = balan_lai_member }
		}
		always = yes
	}
	trigger_else = { always = no }
}

lotr_TH_struggle_not_at_war_with_scoped_balan_lai_member = {
	NOT = {
		this = scope:attacker
		is_vassal_or_below_of = scope:attacker
		is_at_war_with = scope:attacker
	}
}

lotr_hostile_holy_wars_allowed_trigger = {
	OR = {
		has_game_rule = hostile_holy_wars_unrestricted
		scope:defender.faith = {
			faith_hostility_level = {
				target = scope:attacker.faith
				value = faith_evil_level
			}
		}
		scope:attacker.faith = { has_doctrine = doctrine_pluralism_fundamentalist }
	}
}

is_berserker = {	#to unify all three traits for event code
	OR = {
		has_trait = berserker
		has_trait = urukhai_berserker
	}
}

lotr_can_be_berserker_trigger = { #These are the ways you can get Berserker
	OR = {
		faith = {
			has_doctrine_parameter = allows_berserkers
		}
		culture = culture:isengard_urukhai
	}
	NOR = {
		has_trait = craven
		has_trait = calm	
	}
	is_berserker = no
	is_elf = no
	cannot_be_killed = no
}

################################
### Sunset Invasion Triggers ###
################################

lotr_holds_land_in_middle_earth_trigger = {
	OR = {
		holder = scope:largest_realm_ruler
		holder = title:k_wastelands.holder # Tom Bombadil
		holder = { is_vassal_or_below_of = scope:largest_realm_ruler }
		holder = { is_vassal_or_below_of = title:k_wastelands.holder } # Tom Bombadil
		trigger_if = { # Tributary
			limit = { holder = { is_tributary = yes } }
			holder.suzerain = scope:largest_realm_ruler
		} 
		trigger_if = { # My suzerain's suzerain is Sauron
			limit = {
				holder = { is_tributary = yes  }
				holder.suzerain = { is_tributary = yes }
			}
			holder.suzerain.suzerain = scope:largest_realm_ruler
		}
		trigger_if = { # Tributary
			limit = { holder.top_liege = { is_tributary = yes } }
			holder.top_liege.suzerain = scope:largest_realm_ruler
		} 
	}
}

sunset_invasion_subject_has_opposite_alignment_and_land_in_region = {
	is_wastelands = no
	# Check Alignment
	opposite_alignment = { TARGET = scope:attacker }

	# Check for any held counties inside the region
	any_sub_realm_county = {
		any_in_list = {
			list = initial_invasion_titles
			this = prev
		}
		NOT = {
			any_in_list = {
				list = targeted_titles
				this = prev
			}
		}
	}
}

sunset_invasion_subject_has_same_alignment_and_land_in_region = {
	is_wastelands = no
	# Check Alignment
	same_alignment = { TARGET = scope:attacker }
	
	# Check for any held counties inside the region
	any_sub_realm_county = {
		any_in_list = {
			list = initial_invasion_titles
			this = prev
		}
		NOT = {
			any_in_list = {
				list = targeted_titles
				this = prev
			}
		}
	}
}

######################################
### Pharazon Invasion Sub-triggers ###
######################################
