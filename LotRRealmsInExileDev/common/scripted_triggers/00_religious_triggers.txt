# LotR: removed references to real world. Added Middle-earth religions.

###TRIGGER LIST

# has_strong_religious_conviction_trigger
# is_christian_trigger

###DOCTRINE BASED###
# is_weak_claimant_due_to_gender_trigger
# can_be_combatant_based_on_gender_trigger
# can_be_clergy_due_to_gender_trigger
# faith_is_aniconic_trigger
# relation_with_character_is_incestuous_in_faith_trigger 	- Relation would be shunned in faith
# relation_with_character_is_incestuous_in_my_faith_trigger 			- Relation would be shunned in the faith of character you use trigger in
# relation_with_character_is_incestuous_in_my_or_lieges_faith_trigger - Relation would be shunned in the faith of the character you use trigger in or their liege's faith
# faith_allows_marriage_consanguinity_trigger
# relation_with_character_is_sodomy_in_faith_trigger
# relation_with_character_is_sodomy_trigger
# relation_with_character_is_sodomy_in_my_or_lieges_faith_trigger
# trait_is_shunned_in_faith_trigger
# trait_is_criminal_in_faith_trigger
# trait_is_shunned_or_criminal_in_my_or_lieges_faith_trigger
# has_negative_attitude_towards_trait_trigger
# secret_is_shunned_in_faith_trigger
# secret_is_criminal_in_faith_trigger
# secret_is_shunned_or_criminal_in_my_or_lieges_faith_trigger
# religion_has_angels_trigger
# highgod_is_passive_trigger
# highgod_is_active_trigger
# is_reincarnation_trigger
# holy_order_1000_request_target_trigger 		- Is this ruler a valid target for a holy order to request land from?

###HERESY TRIGGERS###
# is_valid_heresiarch

###RELIGIOUS INTERACTIONS###
# can_take_religious_vows_trigger


# CHECK A NUMBER OF RELIGION-RELATED CONDITIONS TO DETERMINE HOW STRONG OF A BELIEVER THEY SEEM TO BE
has_strong_religious_conviction_trigger = {
	NOR = {
		has_trait = cynical
		has_trait = excommunicated
	}
	OR = {
		has_trait = zealous
		has_trait = pilgrim
		has_trait = devoted
		has_trait = sayyid
		has_trait = saoshyant
		has_trait = savior
		has_trait = divine_blood
		has_trait = blood_of_prophet
		has_trait = faith_warrior
		has_trait = saint
	}
}

is_christian_trigger = {
	always = no
	#OR = {
	#	faith = { religion_tag = christianity_religion }
	#}
}

# Not-non-XYZ triggers allow us to check for specific historical faiths whilst still defaulting to something positive for variant faiths.
## E.g., looking to see if something would only be of interest to Catholics, but if we're dealing with a player-made heresy, still return true. This way mechanics will default to on rather than off (still likely to result in weird GHWs, but at least less random ones).
not_non_catholic_standard_christian_faith_trigger = {
	always = no
	#NOR = {
	#	this = faith:orthodox
	#	this = faith:iconoclast
	#	this = faith:coptic
	#	this = faith:armenian_apostolic
	#}
}

not_non_orthodox_standard_christian_faith_trigger = {
	always = no
	#NOR = {
	#	this = faith:catholic
	#	this = faith:coptic
	#	this = faith:armenian_apostolic
	#}
}

not_non_coptic_standard_christian_faith_trigger = {
	always = no
	#NOR = {
	#	this = faith:catholic
	#	this = faith:orthodox
	#	this = faith:iconoclast
	#	this = faith:armenian_apostolic
	#}
}

not_non_armenian_standard_christian_faith_trigger = {
	always = no
	#NOR = {
	#	this = faith:catholic
	#	this = faith:orthodox
	#	this = faith:iconoclast
	#	this = faith:coptic
	#}
}

is_weak_claimant_due_to_gender_trigger = {
	OR = {
		AND = {
			$FAITH$ = { has_doctrine_parameter = female_claims_are_weak }
			$CHARACTER$ = { is_female = yes }
		}
		AND = {
			$FAITH$ = { has_doctrine_parameter = male_claims_are_weak }
			$CHARACTER$ = { is_male = yes }
		}
	}
}

can_be_combatant_based_on_gender_trigger = {
	custom_description = {
		text = "can_be_combatant_based_on_gender"
		object = this
		subject = $ARMY_OWNER$
		# Priests only fight if faith has war priests
		trigger_if = {
			limit = {
				is_clergy = yes
			}
			OR = {
				faith = { has_doctrine_parameter = clergy_can_fight }
				culture = { has_cultural_parameter = culture_clergy_can_fight }
				AND = {
					$ARMY_OWNER$.culture = {
						has_cultural_parameter = high_prowess_ignores_knight_restrictions
					}
					prowess >= 10
				}
			}
		}
		OR = {
			trigger_if = { # Has the Royal Court and thus can modify pillars
				limit = {
					has_dlc_feature = diverge_culture # Can modify pillars
				}
				trigger_if = {
					limit = {
						$ARMY_OWNER$.culture = { has_cultural_parameter = martial_custom_male_only_combatant }
					}
					is_male = yes
				}
				trigger_else_if = {
					limit = {
						$ARMY_OWNER$.culture = { has_cultural_parameter = martial_custom_female_only_combatant }
					}
					is_female = yes
				}
				trigger_else = {}
			}
			trigger_else = { # Does not have the Royal Court and thus combatant is governed by faith
				OR = {
					$ARMY_OWNER$.faith = { has_doctrine_parameter = combatant_can_be_either_gender_if_no_roco }
					AND = {
						$ARMY_OWNER$.faith = { has_doctrine_parameter = combatant_must_be_male_if_no_roco }
						is_male = yes
					}
					AND = {
						$ARMY_OWNER$.faith = { has_doctrine_parameter = combatant_must_be_female_if_no_roco }
						is_female = yes
					}
				}
			}
			AND = {
				# No need to gender diversify this: if they're a right-gender shieldperson of the culture, then they've already got permission to fight from the previous AND conditions.
				has_trait = shieldmaiden
				$ARMY_OWNER$ = {
					culture = { has_cultural_parameter = has_access_to_shieldmaidens }
				}
			}
			# Event-based special exceptions
			OR = {
				has_character_modifier = ignores_gender_army_rules
				has_character_modifier = mpo_destined_leader_modifier
			}
			AND = {
				prowess >= 10
				$ARMY_OWNER$.culture = { has_cultural_parameter = high_prowess_ignores_knight_restrictions }
				NOT = { $ARMY_OWNER$.culture = { has_cultural_parameter = minimum_prowess_for_knights } }
			}
			AND = {
				prowess >= 12
				$ARMY_OWNER$.culture = {
					has_cultural_parameter = high_prowess_ignores_knight_restrictions
					has_cultural_parameter = minimum_prowess_for_knights
				}
			}
		}
	}
}

can_be_clergy_due_to_gender_trigger = {
	OR = {
		AND = {
			faith = { has_doctrine_parameter = clergy_must_be_female }
			is_female = yes
		}
		AND = {
			faith = { has_doctrine_parameter = clergy_must_be_male }
			is_male = yes
		}
		faith = { has_doctrine_parameter = clergy_can_be_either_gender }
	}
}

is_wrong_gender_in_faith_trigger = {
	OR = {
		AND = {
			is_female = yes
			$FAITH$ = { has_doctrine_parameter = male_dominated_law }
		}
		AND = {
			is_male = yes
			$FAITH$ = { has_doctrine_parameter = female_dominated_law }
		}
	}
}

faith_is_aniconic_trigger = {
	faith = {
		OR = {
			#religion = religion:islam_religion #LotR
			has_doctrine = tenet_aniconism
		}
	}
}

#Needs CHARACTER and FAITH
relation_with_character_is_incestuous_in_faith_trigger = {
	OR = {
		# doctrine_consanguinity_dynastic; not within the same descent group
		AND = {
			$FAITH$ = { has_doctrine = doctrine_consanguinity_dynastic }
			OR = {
				is_close_or_extended_family_of = $CHARACTER$
				dynasty = $CHARACTER$.dynasty
			}
		}	
		#doctrine_consanguinity_restricted; absolutely no family business
		AND = {
			$FAITH$ = { has_doctrine = doctrine_consanguinity_restricted }
			is_close_or_extended_family_of = $CHARACTER$ #[parents, children, siblings, grandparents, grandchildren, cousins, uncles, aunts, nephews, nieces]
		}
		#doctrine_consanguinity_cousins; the only acceptable incest is with your cousin
		AND = {
			$FAITH$ = { has_doctrine = doctrine_consanguinity_cousins }
			OR = {
	            is_close_family_of = $CHARACTER$ #[parents, children, siblings, grandparents, grandchildren]
	            is_uncle_or_aunt_of = $CHARACTER$
	            is_nibling_of = $CHARACTER$
	        }
		}
		#doctrine_consanguinity_aunt_nephew_and_uncle_niece; extended family is ok
		AND = {
			$FAITH$ = { has_doctrine = doctrine_consanguinity_aunt_nephew_and_uncle_niece }
			is_close_family_of = $CHARACTER$
		}
		#doctrine_consanguinity_unrestricted; all forms of incest is acceptable
	}
}

#Note: only checks from the viewpoint of current scope. Needs CHARACTER
relation_with_character_is_incestuous_in_my_faith_trigger = {
	faith = { save_temporary_scope_as = my_faith }
	relation_with_character_is_incestuous_in_faith_trigger = { CHARACTER = $CHARACTER$ FAITH = scope:my_faith }
}

relation_with_character_is_incestuous_in_my_or_lieges_faith_trigger = {
	OR = {
		AND = {
			faith = { #My faith doesn't approve
				save_temporary_scope_as = check_faith
			}
			relation_with_character_is_incestuous_in_faith_trigger = { CHARACTER = $CHARACTER$ FAITH = scope:check_faith }
		}
		AND = { #Liege's faith doesn't approve
			liege ?= {
				faith = {
					save_temporary_scope_as = check_faith
				}
			}
			relation_with_character_is_incestuous_in_faith_trigger = { CHARACTER = $CHARACTER$ FAITH = scope:check_faith }
		}
	}
}

#Needs CHARACTER_1 and CHARACTER_2
faith_allows_marriage_consanguinity_trigger = {
	save_temporary_scope_as = consanguinity_faith

	NOT = {
		$CHARACTER_1$ = {
			relation_with_character_is_incestuous_in_faith_trigger = {
				CHARACTER = $CHARACTER_2$
				FAITH = scope:consanguinity_faith
			}
		}
	}
}
relation_between_characters_is_sodomy_in_my_faith_trigger = {
	$CHARACTER_1$ = { is_male = yes }
	$CHARACTER_2$ = { is_male = yes }
	faith = {
		OR = {
			has_doctrine_parameter = homosexuality_shunned
			has_doctrine_parameter = homosexuality_illegal
		}
	}
}

relation_with_character_is_sodomy_in_faith_trigger = {
	is_male = yes
	$CHARACTER$ = { is_male = yes }
	$FAITH$ = {
		OR = {
			has_doctrine_parameter = homosexuality_shunned
			has_doctrine_parameter = homosexuality_illegal
		}
	}
}

#Note: only checks from the viewpoint of current scope. Needs CHARACTER
relation_with_character_is_sodomy_trigger = {
	faith = { save_temporary_scope_as = my_faith }
	relation_with_character_is_sodomy_in_faith_trigger = {
		CHARACTER = $CHARACTER$
		FAITH = scope:my_faith
	}
}

relation_with_character_is_sodomy_in_my_or_lieges_faith_trigger = {
	OR = {
		AND = {
			faith = { #My faith doesn't approve
				save_temporary_scope_as = check_faith
			}
			relation_with_character_is_sodomy_in_faith_trigger = { CHARACTER = $CHARACTER$ FAITH = scope:check_faith }
		}
		AND = { #Liege's faith doesn't approve
			liege ?= {
				faith = {
					save_temporary_scope_as = check_faith
				}
			}
			relation_with_character_is_sodomy_in_faith_trigger = { CHARACTER = $CHARACTER$ FAITH = scope:check_faith }
		}
	}
}

murdering_character_is_kinslaying_in_faith_trigger = {
	OR = {
		is_close_or_extended_family_of = $CHARACTER$
		dynasty = $CHARACTER$.dynasty
	}
	$FAITH$ = { NOT = { has_doctrine = doctrine_kinslaying_accepted } }
}

murdering_character_is_kinslaying_in_my_or_same_dynasty_lieges_faith_trigger = {
	save_temporary_scope_as = kinslayer_me
	faith = {
		save_temporary_scope_as = check_faith
	}
	trigger_if = {
		limit = {
			liege ?= { dynasty = scope:kinslayer_me.dynasty }
		}
		liege = {
			faith = {
				save_temporary_scope_as = check_faith_liege
			}
		}
	}
	OR = {
		murdering_character_is_kinslaying_in_faith_trigger = { CHARACTER = $CHARACTER$ FAITH = scope:check_faith } #My faith doesn't approve
		AND = { #Liege's faith doesn't approve
			liege ?= { dynasty = scope:kinslayer_me.dynasty }
			murdering_character_is_kinslaying_in_faith_trigger = { CHARACTER = $CHARACTER$ FAITH = scope:check_faith_liege }
		}
	}
}



trait_is_shunned_in_faith_trigger = {
	save_temporary_scope_value_as = {
		name = shunned_trait_check
		value = flag:$TRAIT$
	}
	OR = {
		#INCEST
		AND = {
			scope:shunned_trait_check = flag:incestuous
			$FAITH$ = { NOT = { has_doctrine_parameter = allows_unrestricted_marriage } }
		}
		#WITCH
		AND = {
			scope:shunned_trait_check = flag:witch
			$FAITH$ = { has_doctrine_parameter = witchcraft_shunned }
		}
		#SODOMITE
		AND = {
			scope:shunned_trait_check = flag:sodomite
			$FAITH$ = { has_doctrine_parameter = homosexuality_shunned }
		}
		#DEVIANT
		AND = {
			scope:shunned_trait_check = flag:deviant
			$FAITH$ = { has_doctrine_parameter = deviancy_shunned }
		}
		#ADULTERER/FORNICATOR
		AND = {
			OR = {
				scope:shunned_trait_check = flag:adulterer
				scope:shunned_trait_check = flag:fornicator
			}
			$GENDER_CHARACTER$ = {
				trigger_if = {
					limit = { exists = faith }
					accepts_adultery_without_penalty_trigger = no
				}
			}
			OR = {
				AND = {
					$FAITH$ = { has_doctrine_parameter = adultery_female_shunned }
					$GENDER_CHARACTER$ = { is_female = yes }
				}
				AND = {
					$FAITH$ = { has_doctrine_parameter = adultery_male_shunned }
					$GENDER_CHARACTER$ = { is_male = yes }
				}
			}
		}
		#KINSLAYER
		AND = {
			OR = {
				scope:shunned_trait_check = flag:kinslayer_1
				scope:shunned_trait_check = flag:kinslayer_2
				scope:shunned_trait_check = flag:kinslayer_3
			}
			$FAITH$ = { has_doctrine_parameter = kinslaying_shunned }
		}
	}
}

trait_is_criminal_in_faith_trigger = {
	save_temporary_scope_value_as = {
		name = criminal_trait_check
		value = flag:$TRAIT$
	}
	OR = {
		#KINSLAYER
		AND = {
			OR = {
				scope:criminal_trait_check = flag:kinslayer_3
				scope:criminal_trait_check = flag:kinslayer_2
				scope:criminal_trait_check = flag:kinslayer_1
			}
			$FAITH$ = { has_doctrine_parameter = kinslaying_any_dynasty_member_crime }
		}
		AND = {
			OR = {
				scope:criminal_trait_check = flag:kinslayer_3
				scope:criminal_trait_check = flag:kinslayer_2
			}
			$FAITH$ = { has_doctrine_parameter = kinslaying_extended_family_crime }
		}
		AND = {
			scope:criminal_trait_check = flag:kinslayer_3
			$FAITH$ = { has_doctrine_parameter = kinslaying_close_kin_crime }
		}
		#WITCH
		AND = {
			scope:criminal_trait_check = flag:witch
			$FAITH$ = { has_doctrine_parameter = witchcraft_illegal }
		}
		#CANNIBAL
		AND = {
			scope:criminal_trait_check = flag:cannibal
			NOT = {
				$FAITH$ = { has_doctrine_parameter = cannibalism_legal }
			}
		}
		#SODOMITE
		AND = {
			scope:criminal_trait_check = flag:sodomite
			$FAITH$ = { has_doctrine_parameter = homosexuality_illegal }
		}
		#DEVIANT
		AND = {
			scope:criminal_trait_check = flag:deviant
			$FAITH$ = { has_doctrine_parameter = deviancy_illegal }
		}
		#INCEST
		AND = {
			scope:criminal_trait_check = flag:incestuous
			$FAITH$ = { NOT = { has_doctrine_parameter = consanguinity_unrestricted_incest } }
		}
		#ADULTERER/FORNICATOR
		AND = {
			OR = {
				scope:criminal_trait_check = flag:adulterer
				scope:criminal_trait_check = flag:fornicator
			}
			OR = {
				AND = {
					$FAITH$ = { has_doctrine_parameter = adultery_female_crime }
					$GENDER_CHARACTER$ = { is_female = yes }
				}
				AND = {
					$FAITH$ = { has_doctrine_parameter = adultery_male_crime }
					$GENDER_CHARACTER$ = { is_male = yes }
				}
			}
		}
	}
}

scoped_trait_is_criminal_in_faith_trigger = {
	OR = {
		#KINSLAYER
		AND = {
			OR = {
				$TRAIT$ = trait:kinslayer_3
				$TRAIT$ = trait:kinslayer_2
				$TRAIT$ = trait:kinslayer_1
			}
			$FAITH$ = { has_doctrine_parameter = kinslaying_any_dynasty_member_crime }
		}
		AND = {
			OR = {
				$TRAIT$ = trait:kinslayer_3
				$TRAIT$ = trait:kinslayer_2
			}
			$FAITH$ = { has_doctrine_parameter = kinslaying_extended_family_crime }
		}
		AND = {
			$TRAIT$ = trait:kinslayer_3
			$FAITH$ = { has_doctrine_parameter = kinslaying_close_kin_crime }
		}
		#WITCH
		AND = {
			$TRAIT$ = trait:witch
			$FAITH$ = { has_doctrine_parameter = witchcraft_illegal }
		}
		#CANNIBAL
		AND = {
			$TRAIT$ = trait:cannibal
			NOT = {
				$FAITH$ = { has_doctrine_parameter = cannibalism_legal }
			}
		}
		#SODOMITE
		AND = {
			$TRAIT$ = trait:sodomite
			$FAITH$ = { has_doctrine_parameter = homosexuality_illegal }
		}
		#DEVIANT
		AND = {
			$TRAIT$ = trait:deviant
			$FAITH$ = { has_doctrine_parameter = deviancy_illegal }
		}
		#INCEST
		AND = {
			$TRAIT$ = trait:incestuous
			$FAITH$ = { NOT = { has_doctrine_parameter = consanguinity_unrestricted_incest } }
		}
		#ADULTERER/FORNICATOR
		AND = {
			OR = {
				$TRAIT$ = trait:adulterer
				$TRAIT$ = trait:fornicator
			}
			OR = {
				AND = {
					$FAITH$ = { has_doctrine_parameter = adultery_female_crime }
					$GENDER_CHARACTER$ = { is_female = yes }
				}
				AND = {
					$FAITH$ = { has_doctrine_parameter = adultery_male_crime }
					$GENDER_CHARACTER$ = { is_male = yes }
				}
			}
		}
	}
}

trait_is_shunned_or_criminal_in_faith_trigger = {
	OR = {
		trait_is_shunned_in_faith_trigger = { TRAIT = $TRAIT$ FAITH = $FAITH$ GENDER_CHARACTER = $GENDER_CHARACTER$ }
		trait_is_criminal_in_faith_trigger = { TRAIT = $TRAIT$ FAITH = $FAITH$ GENDER_CHARACTER = $GENDER_CHARACTER$ }
	}
}

trait_is_shunned_or_criminal_in_my_or_lieges_faith_trigger = {
	OR = {
		AND = {
			faith = { #My faith doesn't approve
				save_temporary_scope_as = check_faith
			}
			trait_is_shunned_or_criminal_in_faith_trigger = { TRAIT = $TRAIT$ FAITH = scope:check_faith GENDER_CHARACTER = $GENDER_CHARACTER$ }
		}
		AND = { #Liege's faith doesn't approve
			liege ?= {
				faith = {
					save_temporary_scope_as = check_faith
				}
			}
			trait_is_shunned_or_criminal_in_faith_trigger = { TRAIT = $TRAIT$ FAITH = scope:check_faith GENDER_CHARACTER = $GENDER_CHARACTER$ }
		}
	}
}

has_any_shunned_or_criminal_trait_in_faith_trigger = {
	$CHARACTER$ = {
		OR = {
			#KINSLAYER
			AND = {
				has_trait = kinslayer_3
				trait_is_shunned_or_criminal_in_faith_trigger = { TRAIT = kinslayer_3 FAITH = $FAITH$ GENDER_CHARACTER = $CHARACTER$ }
			}
			AND = {
				has_trait = kinslayer_2
				trait_is_shunned_or_criminal_in_faith_trigger = { TRAIT = kinslayer_2 FAITH = $FAITH$ GENDER_CHARACTER = $CHARACTER$ }
			}
			AND = {
				has_trait = kinslayer_1
				trait_is_shunned_or_criminal_in_faith_trigger = { TRAIT = kinslayer_1 FAITH = $FAITH$ GENDER_CHARACTER = $CHARACTER$ }
			}
			#WITCH
			AND = {
				has_trait = witch
				trait_is_shunned_or_criminal_in_faith_trigger = { TRAIT = witch FAITH = $FAITH$ GENDER_CHARACTER = $CHARACTER$ }
			}
			#CANNIBAL
			AND = {
				has_trait = cannibal
				trait_is_shunned_or_criminal_in_faith_trigger = { TRAIT = cannibal FAITH = $FAITH$ GENDER_CHARACTER = $CHARACTER$ }
			}
			#SODOMITE
			AND = {
				has_trait = sodomite
				trait_is_shunned_or_criminal_in_faith_trigger = { TRAIT = sodomite FAITH = $FAITH$ GENDER_CHARACTER = $CHARACTER$ }
			}
			#DEVIANT
			AND = {
				has_trait = deviant
				trait_is_shunned_or_criminal_in_faith_trigger = { TRAIT = deviant FAITH = $FAITH$ GENDER_CHARACTER = $CHARACTER$ }
			}
			AND = {
				has_trait = incestuous
				trait_is_shunned_or_criminal_in_faith_trigger = { TRAIT = incestuous FAITH = $FAITH$ GENDER_CHARACTER = $CHARACTER$ }
			}
			#ADULTERER/FORNICATOR
			AND = {
				has_trait = adulterer
				trait_is_shunned_or_criminal_in_faith_trigger = { TRAIT = adulterer FAITH = $FAITH$ GENDER_CHARACTER = $CHARACTER$ }
			}
			AND = {
				has_trait = fornicator
				trait_is_shunned_or_criminal_in_faith_trigger = { TRAIT = fornicator FAITH = $FAITH$ GENDER_CHARACTER = $CHARACTER$ }
			}
		}
	}
}

has_any_criminal_trait_in_faith_trigger = {
	$CHARACTER$ = {
		OR = {
			#KINSLAYER
			AND = {
				has_trait = kinslayer_3
				trait_is_criminal_in_faith_trigger = { TRAIT = kinslayer_3 FAITH = $FAITH$ GENDER_CHARACTER = $CHARACTER$ }
			}
			AND = {
				has_trait = kinslayer_2
				trait_is_criminal_in_faith_trigger = { TRAIT = kinslayer_2 FAITH = $FAITH$ GENDER_CHARACTER = $CHARACTER$ }
			}
			AND = {
				has_trait = kinslayer_1
				trait_is_criminal_in_faith_trigger = { TRAIT = kinslayer_1 FAITH = $FAITH$ GENDER_CHARACTER = $CHARACTER$ }
			}
			#WITCH
			AND = {
				has_trait = witch
				trait_is_criminal_in_faith_trigger = { TRAIT = witch FAITH = $FAITH$ GENDER_CHARACTER = $CHARACTER$ }
			}
			#CANNIBAL
			AND = {
				has_trait = cannibal
				trait_is_criminal_in_faith_trigger = { TRAIT = cannibal FAITH = $FAITH$ GENDER_CHARACTER = $CHARACTER$ }
			}
			#SODOMITE
			AND = {
				has_trait = sodomite
				trait_is_criminal_in_faith_trigger = { TRAIT = sodomite FAITH = $FAITH$ GENDER_CHARACTER = $CHARACTER$ }
			}
			#DEVIANT
			AND = {
				has_trait = deviant
				trait_is_criminal_in_faith_trigger = { TRAIT = deviant FAITH = $FAITH$ GENDER_CHARACTER = $CHARACTER$ }
			}
			AND = {
				has_trait = incestuous
				trait_is_criminal_in_faith_trigger = { TRAIT = incestuous FAITH = $FAITH$ GENDER_CHARACTER = $CHARACTER$ }
			}
			#ADULTERER/FORNICATOR
			AND = {
				has_trait = adulterer
				trait_is_criminal_in_faith_trigger = { TRAIT = adulterer FAITH = $FAITH$ GENDER_CHARACTER = $CHARACTER$ }
			}
			AND = {
				has_trait = fornicator
				trait_is_criminal_in_faith_trigger = { TRAIT = fornicator FAITH = $FAITH$ GENDER_CHARACTER = $CHARACTER$ }
			}
		}
	}
}

has_any_shunned_trait_in_faith_trigger = {
	$CHARACTER$ = {
		OR = {
			#KINSLAYER
			AND = {
				has_trait = kinslayer_3
				trait_isshunnedl_in_faith_trigger = { TRAIT = kinslayer_3 FAITH = $FAITH$ GENDER_CHARACTER = $CHARACTER$ }
			}
			AND = {
				has_trait = kinslayer_2
				trait_is_shunned_in_faith_trigger = { TRAIT = kinslayer_2 FAITH = $FAITH$ GENDER_CHARACTER = $CHARACTER$ }
			}
			AND = {
				has_trait = kinslayer_1
				trait_is_shunned_in_faith_trigger = { TRAIT = kinslayer_1 FAITH = $FAITH$ GENDER_CHARACTER = $CHARACTER$ }
			}
			#WITCH
			AND = {
				has_trait = witch
				trait_is_shunned_in_faith_trigger = { TRAIT = witch FAITH = $FAITH$ GENDER_CHARACTER = $CHARACTER$ }
			}
			#CANNIBAL
			AND = {
				has_trait = cannibal
				trait_is_shunned_in_faith_trigger = { TRAIT = cannibal FAITH = $FAITH$ GENDER_CHARACTER = $CHARACTER$ }
			}
			#SODOMITE
			AND = {
				has_trait = sodomite
				trait_is_shunned_in_faith_trigger = { TRAIT = sodomite FAITH = $FAITH$ GENDER_CHARACTER = $CHARACTER$ }
			}
			#DEVIANT
			AND = {
				has_trait = deviant
				trait_is_shunned_in_faith_trigger = { TRAIT = deviant FAITH = $FAITH$ GENDER_CHARACTER = $CHARACTER$ }
			}
			AND = {
				has_trait = incestuous
				trait_is_shunned_in_faith_trigger = { TRAIT = incestuous FAITH = $FAITH$ GENDER_CHARACTER = $CHARACTER$ }
			}
			#ADULTERER/FORNICATOR
			AND = {
				has_trait = adulterer
				trait_is_shunned_in_faith_trigger = { TRAIT = adulterer FAITH = $FAITH$ GENDER_CHARACTER = $CHARACTER$ }
			}
			AND = {
				has_trait = fornicator
				trait_is_shunned_in_faith_trigger = { TRAIT = fornicator FAITH = $FAITH$ GENDER_CHARACTER = $CHARACTER$ }
			}
		}
	}
}


has_negative_attitude_towards_trait_trigger = {
	save_temporary_scope_value_as = {
		name = negative_status_check
		value = flag:$TRAIT$
	}

	NOR = {
		has_trait = $TRAIT$
		#INCESTUOUS
		AND = {
			scope:negative_status_check = flag:incestuous
			any_secret = { type = secret_incest }
		}
		#WITCH
		AND = {
			scope:negative_status_check = flag:witch
			any_secret = { type = secret_witch }
		}
		#CANNIBAL
		AND = {
			scope:negative_status_check = flag:cannibal
			any_secret = { type = secret_cannibal }
		}
		#SODOMITE
		AND = {
			scope:negative_status_check = flag:sodomite
			OR = {
				has_sexuality = homosexual
				has_sexuality = bisexual
			}
			any_secret = {
				type = secret_homosexual
			}
		}
		#ADULTERER
		AND = {
			scope:negative_status_check = flag:adulterer
			OR = {
				has_trait = lustful
				AND = {
					is_married = yes
					any_relation = { type = lover NOT = { is_spouse_of = prev } }
				}
				any_relation = {
					type = lover
					is_married = yes
					NOT = { is_spouse_of = prev }
				}
			}
		}
		#FORNICATOR
		AND = {
			scope:negative_status_check = flag:fornicator
			OR = {
				has_trait = lustful
				any_relation = { type = lover always = yes }
			}
		}
	}

	faith = { save_temporary_scope_as = my_faith }
	OR = {
		trait_is_shunned_in_faith_trigger = { TRAIT = $TRAIT$ FAITH = scope:my_faith GENDER_CHARACTER = $GENDER_CHARACTER$ }
		trait_is_criminal_in_faith_trigger = { TRAIT = $TRAIT$ FAITH = scope:my_faith GENDER_CHARACTER = $GENDER_CHARACTER$ }
	}
}

has_followers_trigger = {
	OR = {
		num_character_followers >= 1
		num_county_followers >= 1
	}
}

secret_is_blackmailable_trigger = {
	OR = {
		secret_is_blackmailable_strong_hook_trigger = { TARGET = $TARGET$ }
		secret_is_blackmailable_weak_hook_trigger = { TARGET = $TARGET$ }
	}
}


###################
# Heresy Triggers #
###################

is_preferred_heresy = {
	is_valid_heresy = {
		ORIGIN_FAITH = $ORIGIN_FAITH$
		HERETICAL_FAITH = $HERETICAL_FAITH$
	}

	OR = {
		#If we're Chistian, pick a heretical faiths which is in the same regional group as our origin faith (i.e., Lollards for Catholics, Iconoclasts for Orthodox, etc.)
		#AND = {
		#	religion_tag = christianity_religion
		#	OR = {
		#		faiths_are_in_western_christianity_group = {FAITH_1 = $ORIGIN_FAITH$ FAITH_2 = $HERETICAL_FAITH$ }
		#		faiths_are_in_orthodox_christianity_group = {FAITH_1 = $ORIGIN_FAITH$ FAITH_2 = $HERETICAL_FAITH$ }
		#		faiths_are_in_eastern_christianity_group = {FAITH_1 = $ORIGIN_FAITH$ FAITH_2 = $HERETICAL_FAITH$ }
		#	}
		#}

		#If we're Muslim, we want to stay within our 'branch' of Islam:
		#AND = {
		#	religion_tag = islam_religion
		#	OR = {
		#		faiths_are_in_sunni_islam_group = {FAITH_1 = $ORIGIN_FAITH$ FAITH_2 = $HERETICAL_FAITH$}
		#		faiths_are_in_shia_islam_group = {FAITH_1 = $ORIGIN_FAITH$ FAITH_2 = $HERETICAL_FAITH$}
		#		faiths_are_in_muhakkima_islam_group = {FAITH_1 = $ORIGIN_FAITH$ FAITH_2 = $HERETICAL_FAITH$}
		#	}
		#}
		AND = {
			religion = religion:dunedain_religion
			OR = {
				faiths_are_in_dunedain_group_and_appropriate = {FAITH_1 = $ORIGIN_FAITH$ FAITH_2 = $HERETICAL_FAITH$ }
			}
		}
		AND = {
			this = faith:faith_corsair
			scope:heretic_capital ?= {
				title_province = { geographical_region = custom_close_corsair_coast }
			}
		}

		#Otherwise, we don't have any special preferences.
		AND = {
			NOT = {
				#religion_tag = islam_religion #LOTR
				#religion_tag = christianity_religion #LOTR
				religion = religion:dunedain_religion
				#religion_tag = northmen_religion
				this = faith:faith_corsair
			}
		}
	}
}

is_valid_heresy = {
	#The origin faith can never be its own heresy.
	NOT = { $ORIGIN_FAITH$ = $HERETICAL_FAITH$ }
	#Must not be considered invalid
	invalid_for_heresy_events = no
	# A heretical faith can't be currently locked off via variable.
	$HERETICAL_FAITH$ = {
		NOR = {
			has_variable = block_conversion_till_decision_taken
			has_variable = block_conversion_till_nebulous_circumstances
		}
	}
	#Depending on the origin faith's religion/religion group, there may have additional requirements for a heresy to be considered valid.
	OR = {
		#For Christian Faiths, the origin and heretical faiths must not both be Ecumenical (excepting the faiths which aren't technically ecumenical).
		#AND = {
		#	religion_tag = christianity_religion
		#	NAND = {
		#		$ORIGIN_FAITH$ = {
		#			has_doctrine = special_doctrine_ecumenical_christian
		#			OR = {
		#				this = faith:insular_celtic
		#				this = faith:bosnian_church
		#			}
		#		}
		#		$HERETICAL_FAITH$ = {
		#			has_doctrine = special_doctrine_ecumenical_christian
		#			OR = {
		#				this = faith:insular_celtic
		#				this = faith:bosnian_church
		#			}
		#		}
		#	}
		#}
		#No special requirements for Muslims, Jews, Yazidis, or Zoroastrians.
		#religion_tag = islam_religion
		#religion_tag = judaism_religion
		#religion_tag = zoroastrianism_religion
		#Eastern Faiths can shift and spread amongst each other.
		#AND = {
		#	OR = {
		#		religion_tag = buddhism_religion
		#		religion_tag = hinduism_religion
		#		religion_tag = jainism_religion
		#		religion_tag = dualism_religion
		#	}
		#}
		#No special requirements for Pagan religions.
		#has_doctrine = pagan_hostility_doctrine
	}
}

is_valid_heresiarch = {
	is_landed = yes
	faith = root
	OR = {
		highest_held_title_tier = tier_duchy
		highest_held_title_tier = tier_county
	}
	is_imprisoned = no
	is_capable_adult_ai = yes
	is_playable_character = yes
	is_landless_adventurer = no
	primary_title ?= {
		is_landless_type_title = no
		is_noble_family_title = no
	}
	exists = capital_county
	NOT = { has_trait = heresiarch }
	no_heretical_hof_faith_trigger = yes
	recently_converted_faith_trigger = no # As amusing as it may be, rulers shouldn't 'flip-flop' between Faiths, so we need to enforce a cooldown on heresy conversions.
}

no_heretical_hof_faith_trigger = { #Head of Faith shouldn't convert.
	OR = {
		NOT = { exists = root.religious_head }
		AND = {
			exists = root.religious_head
			this != root.religious_head
		}
	}
}

#LotR Heresy Groups
faiths_are_in_dunedain_group_and_appropriate = {
	OR = {
		$FAITH_1$ = faith:faith_numenorean
		$FAITH_1$ = faith:faith_edain
		$FAITH_1$ = faith:faith_edain_manwe
		$FAITH_1$ = faith:faith_edain_varda
		$FAITH_1$ = faith:faith_edain_ulmo
	}
	OR = {
		$FAITH_2$ = faith:faith_edain
		$FAITH_2$ = faith:faith_edain_manwe
		$FAITH_2$ = faith:faith_edain_varda
		AND = {	# Ulmo cult should be coastal
			$FAITH_2$ = faith:faith_edain_ulmo
			scope:heretic_capital = {
				OR = {
					is_coastal_county = yes
					title_province = { geographical_region = middleearth_west_gondor_centralfiefdoms }
					title_province = { geographical_region = middleearth_west_gondor_easternfiefdoms }
					title_province = { geographical_region = middleearth_west_gondor_andrast }
					title_province = { geographical_region = middleearth_west_arnor_cardolan }
				}
			}
		}
		AND = {	# Daen may resurge in Andrast
			$FAITH_2$ = faith:faith_daen_gaoth
			scope:heretic_capital = {
				culture = {
					OR = {
						has_cultural_pillar = heritage_daen_coentis
						any_parent_culture_or_above = {
							has_cultural_pillar = heritage_daen_coentis
						}
						has_cultural_pillar = heritage_danan_lin
						any_parent_culture_or_above = {
							has_cultural_pillar = heritage_danan_lin
						}
					}
				}
				title_province = { geographical_region = middleearth_west_gondor_andrast }
			}
		}
		AND = {	# Daen may resurge in White Mountains
			$FAITH_2$ = faith:faith_daen_coentis
			scope:heretic_capital = {
				culture = {
					OR = {
						has_cultural_pillar = heritage_daen_coentis
						any_parent_culture_or_above = {
							has_cultural_pillar = heritage_daen_coentis
						}
						has_cultural_pillar = heritage_danan_lin
						any_parent_culture_or_above = {
							has_cultural_pillar = heritage_danan_lin
						}
					}
				}
			}
		}
	}
}

#Christian Heresy Groups
faiths_are_in_western_christianity_group = {
	always = no
}

faiths_are_in_orthodox_christianity_group = {
	always = no
}

faiths_are_in_eastern_christianity_group = {
	always = no
}

faiths_are_in_sunni_islam_group = {
	always = no
}

faiths_are_in_shia_islam_group = {
	always = no
}

faiths_are_in_muhakkima_islam_group = {
	always = no
}

refusing_conversion_is_crime_trigger = {
	faith = {
		trigger_if = { # Only apply imprisonment reason if actor's faith is not the state faith
			limit = {
				$CHARACTER$ = {
					top_liege = { government_allows = state_faith }
					faith = $CHARACTER$.top_liege.primary_title.state_faith
				}
			}
			always = no
		}
		#OR = { #LotR
		#	religion_tag = christianity_religion
		#	religion_tag = islam_religion
		#	religion_tag = judaism_religion
		#	religion_tag = zoroastrianism_religion
		#}
		OR = { #LotR
			has_doctrine = doctrine_pluralism_fundamentalist
			faith_hostility_level = {
				target = $CHARACTER$.faith
				value >= faith_evil_level
			}
		}
		NOT = {
			faith_hostility_level = {
				target = $CHARACTER$.faith
				value <= faith_astray_level
			}
		}
	}
}

is_hostile_enough_for_holy_war_trigger = {
	faith_hostility_level = {
		target = $FAITH$
		value >= religious_cb_enabled_hostility_level
	}
	NOT = { $FAITH$ = faith:faith_wastelands_pagan } #LotR
}

barony_is_valid_for_holy_order_lease_trigger = {
	title_province = {
		OR = {
			has_holding_type = castle_holding
			has_holding_type = city_holding
			has_holding_type = elven_holding #LotR
		}
	}
	trigger_if = {
		limit = {
			holder.primary_title.tier != tier_barony
		}
		can_be_leased_out = yes
	}
	trigger_if = {
		limit = {
			NOT = { holder = $CHARACTER$ }
		}
		holder.primary_title.tier = tier_barony
	}
	NOT = {
		is_leased_out = yes
	}
}

barony_is_valid_for_holy_order_lease_cancellation_trigger = {
	is_under_holy_order_lease = yes
	has_revokable_lease = yes
	lessee = {
		NOT = {
			has_strong_hook = prev.holder
		}
	}
}

religion_has_angels_trigger = {
	#OR = {
	#	religion = religion:christianity_religion
	#	religion = religion:islam_religion
	#	religion = religion:zoroastrianism_religion
	#	religion = religion:dualism_religion
	#	religion = religion:judaism_religion
	#	religion = religion:yazidi_religion
	#}
	always = no
}

religion_has_circumcision_trigger = {
	#OR = {
	#	religion = religion:islam_religion
	#	religion = religion:judaism_religion
	#}
	always = no
}

is_heretic_trigger = {
	$WHO$.faith.religion = $TARGET$.faith.religion
	$WHO$.faith = {
		faith_hostility_level = {
			target = $TARGET$.faith
			value >= religious_cb_enabled_hostility_level
		}
	}
}

is_heathen_trigger = {
	NOT = { $WHO$.faith.religion = $TARGET$.faith.religion }
	#$TARGET$.faith = { #LOTR
	#	has_doctrine = pagan_hostility_doctrine
	#}
	$WHO$.faith = {
		faith_hostility_level = {
			target = $TARGET$.faith
			value >= religious_cb_enabled_hostility_level
		}
	}
}

is_infidel_trigger = {
	NOT = { $WHO$.faith.religion = $TARGET$.faith.religion }
	# $TARGET$.faith = {
		# NOT = { has_doctrine = pagan_hostility_doctrine }
	# }
	$WHO$.faith = {
		faith_hostility_level = {
			target = $TARGET$.faith
			value >= religious_cb_enabled_hostility_level
		}
	}
}

valid_demand_conversion_conditions_trigger = {
	scope:recipient = {
		NOR = {
			has_strong_hook = scope:actor
			has_trait = devoted
			has_trait = order_member
			is_imprisoned_by = scope:actor
			is_at_war_with = scope:actor
		}
	}
	scope:actor = {
		trigger_if = {
			limit = {
				government_has_flag = government_is_landless_adventurer
				scope:recipient = { is_courtier_of = scope:actor }
			}
			custom_tooltip = {
				text = valid_demand_conversion_conditions_trigger.tt.domicile_requires_shrine
				domicile = { has_domicile_parameter = camp_enable_conversion }
			}
		}
		NAND = {
			has_trait = nomadic_philosophy
			has_trait = zealous
		}
	}
	scope:recipient = { #LotR
		NOR = { 
			has_trait = maiar
			has_trait = istari
		}
	}

	custom_description = {
		text = "is_head_of_religion"
		subject = scope:recipient
		scope:recipient.faith.religious_head != scope:recipient
	}
	custom_description = {
		text = "is_protected_via_contract"
		subject = scope:recipient
		# Vassal Contract forbids meddling by liege
		NAND = {
			exists = scope:recipient.liege
			scope:recipient.liege = scope:actor
			scope:recipient = {
				is_ruler = yes
				vassal_contract_has_flag = religiously_protected
			}
		}
	}
	trigger_if = {
		limit = {
			scope:recipient = {
				AND = {
					has_variable = cannot_be_converted_by_value
					var:cannot_be_converted_by_value = scope:actor
				}
			}
		}
		custom_tooltip = {
			text = promised_to_not_convert_character
			scope:recipient = {
				NOR = {
					has_variable = cannot_be_converted_by_value
					var:cannot_be_converted_by_value = scope:actor
				}
			}
		}
	}
	custom_tooltip = {
		text = cannot_take_overt_hostile_actions_against_diarch.tt
		NOT = { scope:recipient ?= scope:actor.diarch }
	}
}

valid_ask_for_conversion_conditions_trigger = { # Deliberate variant of the above, so you can ask your diarch nicely to convert if you made a new faith
	scope:recipient = {
		NOR = {
			has_strong_hook = scope:actor
			has_trait = devoted
			has_trait = order_member
			is_imprisoned_by = scope:actor
			is_at_war_with = scope:actor
		}
	}
	scope:actor = {
		trigger_if = {
			limit = {
				government_has_flag = government_is_landless_adventurer
				scope:recipient = { is_courtier_of = scope:actor }
			}
			custom_tooltip = {
				text = valid_demand_conversion_conditions_trigger.tt.domicile_requires_shrine
				domicile = { has_domicile_parameter = camp_enable_conversion }
			}
		}
		NAND = {
			has_trait = nomadic_philosophy
			has_trait = zealous
		}
	}

	custom_description = {
		text = "is_head_of_religion"
		subject = scope:recipient
		scope:recipient.faith.religious_head != scope:recipient
	}
	custom_description = {
		text = "is_protected_via_contract"
		subject = scope:recipient
		# Vassal Contract forbids meddling by liege
		NAND = {
			exists = scope:recipient.liege
			scope:recipient.liege = scope:actor
			scope:recipient = {
				is_ruler = yes
				vassal_contract_has_flag = religiously_protected
			}
		}
	}
	trigger_if = {
		limit = {
			scope:recipient = {
				AND = {
					has_variable = cannot_be_converted_by_value
					var:cannot_be_converted_by_value = scope:actor
				}
			}
		}
		custom_tooltip = {
			text = promised_to_not_convert_character
			scope:recipient = {
				NOR = {
					has_variable = cannot_be_converted_by_value
					var:cannot_be_converted_by_value = scope:actor
				}
			}
		}
	}
}

highgod_is_passive_trigger = {
	religion = { is_in_family = rf_eruhini }
#	religion_tag = free_peoples_religion
#	OR = {
#		religion_tag = buddhism_religion
#		religion_tag = jainism_religion
#		religion_tag = taoism_religion
#		religion_tag = west_african_roog_religion
#		religion_tag = zunism_religion
#	}
}

highgod_is_active_trigger = {
	highgod_is_passive_trigger = no
}


fertilitygod_is_active_trigger = {
	highgod_is_active_trigger = yes
}


###REINCARNATION###
can_become_reincarnation_trigger = {
	save_temporary_scope_as = reincarnated_child
	faith = {
		has_doctrine = tenet_reincarnation
	}
	any_parent = {
		is_playable_character = yes
		faith = scope:reincarnated_child.faith
	}
}

can_reincarnate_trigger = {
	is_alive = no
	OR = {
		has_trait = temperate
		has_trait = greedy
		has_trait = generous
		has_trait = diligent
		has_trait = calm
		has_trait = arrogant
		has_trait = humble
		has_trait = deceitful
		has_trait = honest
		has_trait = brave
		has_trait = gregarious
		has_trait = ambitious
		has_trait = just
		has_trait = zealous
		has_trait = compassionate
		has_trait = stubborn
		has_trait = forgiving
		has_trait = lunatic
		has_trait = dull
		has_trait = intellect_bad
		has_trait = shrewd
		has_trait = intellect_good
		has_trait = strong
		has_trait = physique_good
	}
}

is_reincarnation_trigger = {
	can_become_reincarnation_trigger = yes
	has_variable = reincarnation_of
}

# Used in faith scope, COUNT is number of faiths to at least have and CHARACTER is who must own them
num_realm_holy_sites_faithful_holders = {
	$CHARACTER$ = { save_temporary_scope_as = root_scope }
	trigger_if = {
		limit = {
			exists = $CHARACTER$.confederation
		}
		custom_description = {
			text = direct_realm_holy_sites_held_by_faithful_confederation
			subject = $CHARACTER$
			object = this
			value = 1
			any_holy_site = {
				county = {
					save_temporary_scope_as = current_holy_site
					is_holy_site_controlled_by = $CHARACTER$
					holder.faith = $CHARACTER$.faith
				}
			}
		}
	}
	custom_description = {
		text = number_realm_holy_sites_held_by_faithful
		subject = $CHARACTER$
		object = this
		value = $COUNT$
		any_holy_site = {
			count >= $COUNT$
			county = {
				save_temporary_scope_as = current_holy_site
				OR = {
					is_holy_site_controlled_by = $CHARACTER$
					$CHARACTER$.confederation ?= {
						is_house_based = no # any_confederation_member is not performant for house blocs
						any_confederation_member = {
							scope:current_holy_site = {
								is_holy_site_controlled_by = prev
							}
						}
					}
				}
				holder.faith = $CHARACTER$.faith
			}
		}
	}
}

### Head of Faith
can_create_temporal_head_of_faith_title_trigger = {
	num_realm_holy_sites_faithful_holders = {
		COUNT = holy_sites_to_create_temporal_head_of_faith
		CHARACTER = ROOT
	}
	root = { piety_level >= high_piety_level }
	trigger_if = {
		limit = {
			root = { top_liege != this }
		}
		custom_description = {
			text = cannot_create_hof_title_at_or_above_liege_tier
			root.liege.primary_title.tier > tier_duchy
		}
	}
	trigger_if = { # LotR
	 	limit = { has_doctrine = special_doctrine_not_allowed_to_nhazadh } # LotR
	 	NOT = { has_doctrine = special_doctrine_not_allowed_to_nhazadh } # LotR
	} # LotR
	trigger_if = { # LotR
	 	limit = { has_doctrine = tenet_tamska_main } # LotR
	 	NOT = { has_doctrine = tenet_tamska_main } # LotR
	} # LotR
}

can_create_spiritual_head_of_faith_title_trigger = {
	num_realm_holy_sites_faithful_holders = {
		COUNT = holy_sites_to_create_spiritual_head_of_faith
		CHARACTER = ROOT
	}
	root = { piety_level >= medium_piety_level }
	# trigger_if = { #LotR
	# 	limit = { has_doctrine = special_doctrine_not_allowed_to_hof }
	# 	NOT = { has_doctrine = special_doctrine_not_allowed_to_hof }
	# }
}

# this = Person trying to create the title
can_afford_create_head_of_faith_title_cost_trigger = {
	trigger_if = {
		limit = {
			faith = {
				has_doctrine_parameter = temporal_head_of_faith
				#OR = { #LotR
				#	has_doctrine = muhammad_succession_sunni_doctrine
				#	has_doctrine = muhammad_succession_shia_doctrine
				#}
			}
		}
		trigger_if = {
			limit = { NOT = { has_trait = sayyid } }
			piety >= massive_piety_value
		}
	}
	trigger_else_if = {
		limit = {
			faith = {
				has_doctrine_parameter = temporal_head_of_faith
			}
		}
		piety >= major_piety_value
	}
	trigger_else = {
		limit = {
			faith = {
				has_doctrine_parameter = spiritual_head_of_faith
			}
		}
		gold >= medium_gold_max_value
	}
}

# FAITH = The faith we are trying to make the head of faith title for
# this = Person trying to create the title
can_create_head_of_faith_title_trigger = {
	$FAITH$ = {
		trigger_if = {
			limit = {
				has_doctrine_parameter = spiritual_head_of_faith
			}
			can_create_spiritual_head_of_faith_title_trigger = yes
		}
		trigger_else_if = {
			limit = {
				has_doctrine_parameter = temporal_head_of_faith
			}
			can_create_temporal_head_of_faith_title_trigger = yes
		}
		trigger_else = {
			# We shouldn't hit this point, but if we do use the following as error messages.
			has_doctrine_parameter = spiritual_head_of_faith
			has_doctrine_parameter = temporal_head_of_faith
		}
	}
	can_afford_create_head_of_faith_title_cost_trigger = yes
}

can_perform_the_hajj_trigger = {
	always = no #LotR
	# faith.religion = religion:islam_religion #LotR
	# faith = { has_doctrine_parameter = can_go_on_pilgrimage }
}

shared_faith_or_hof_trigger = {
	OR = {
		$ACTOR$.faith = $RECIPIENT$.faith
		AND = {
			exists = $ACTOR$.faith.religious_head
			exists = $RECIPIENT$.faith.religious_head
			$ACTOR$.faith.religious_head = $RECIPIENT$.faith.religious_head
		}
	}
}


###RELIGIOUS INTERACTIONS###
#Triggers that applies to both Monastery or Holy Order requirements
can_take_religious_vows_trigger = {
	can_take_religious_vows_disregard_marriage_trigger = yes

	#Do they have the "wrong" marriage type?
	NOR = {
		custom_description = {
			text = is_married_matrilineally
			subject = scope:recipient
			any_spouse = {
				is_female = yes
				matrilinear_marriage = yes
			}
		}
		custom_description = {
			text = is_married_patrilineally
			subject = scope:recipient
			any_spouse = {
				is_male = yes
				patrilinear_marriage = yes
			}
		}
		custom_description = {
			text = matrilinear_betrothal
			subject = scope:recipient
			betrothed ?= {
				is_female = yes
				matrilinear_betrothal = yes
			}
		}
		custom_description = {
			text = patrilinear_betrothal
			subject = scope:recipient
			betrothed ?= {
				is_male = yes
				patrilinear_betrothal = yes
			}
		}
	}
	bp2_valid_for_standard_interactions_trigger = yes
}

can_take_religious_vows_disregard_marriage_trigger = {
	is_available_ai = yes
	faith = scope:actor.faith
	is_ruler = no
	NOT = { has_trait = excommunicated }
	NOT = { has_character_flag = holy_order_member_requested_return_home }
}

does_religion_exist_in_world_region_trigger = { # The most efficient way I could think of to esentially do diplomatic range triggers on religions
	#trigger_if = {
	#	limit = { location = { geographical_region = world_europe } } # Even though europe has many sub regions, it's overall size is small so no need to sub-divide!
	#	any_county_in_region = {
	#		region = world_europe
	#		faith.religion = $RELIGION$
	#	}
	#}
	#trigger_else_if = {
	#	limit = { location = { geographical_region = world_asia_minor } } # Maybe this should be grouped with both the one above and the one below...
	#	any_county_in_region = {
	#		region = world_asia_minor
	#		faith.religion = $RELIGION$
	#	}
	#}
	#trigger_else_if = {
	#	limit = { location = { geographical_region = world_middle_east } }
	#	any_county_in_region = {
	#		region = world_middle_east
	#		faith.religion = $RELIGION$
	#	}
	#}
	#trigger_else_if = {
	#	limit = {
	#		location = { geographical_region = world_india } }
	#	any_county_in_region = {
	#		region = world_india
	#		faith.religion = $RELIGION$
	#	}
	#}
	#trigger_else_if = {
	#	limit = { location = { geographical_region = world_africa } }
	#	any_county_in_region = {
	#		region = world_africa
	#		faith.religion = $RELIGION$
	#	}
	#}
	#trigger_else_if = {
	#	limit = { location = { geographical_region = world_steppe } }
	#	any_county_in_region = {
	#		region = world_steppe
	#		faith.religion = $RELIGION$
	#	}
	#}
	#trigger_else_if = { # We group two smaller world regions into one
	#	limit = {
	#		location = {
	#			OR = {
	#				geographical_region = world_tibet
	#				geographical_region = world_burma
	#			}
	#		}
	#	}
	#	OR = {
	#		any_county_in_region = {
	#			region = world_tibet
	#			faith.religion = $RELIGION$
	#		}
	#		any_county_in_region = {
	#			region = world_burma
	#			faith.religion = $RELIGION$
	#		}
	#	}
	#}
	#trigger_else = { always = no } # This should always go at the end of this scripted trigger
	trigger_if = { limit = { exists = $RELIGION$ } } #LotR - so $RELIGION$ does NOT throw errors. We need the argument
	always = no
}

### HOLY ORDERS ###
holy_order_1000_holy_order_trigger = {
	title = {
		NOR = {
			has_variable = received_new_land
			has_variable = discarded_for_being_too_big
		}
	}
}

holy_order_1000_target_barony_trigger = {
	tier = tier_barony
	barony_is_valid_for_holy_order_lease_trigger = { CHARACTER = $CHARACTER$ }
	#Don't grab something that's held by a vassal player of the one receiving the event.
	trigger_if = {
		limit = {
			NOT = { holder = $CHARACTER$ }
		}
		holder = { is_ai = yes }
	}
}

holy_order_1000_request_target_trigger = {
	highest_held_title_tier >= tier_duchy
	is_landed_or_landless_administrative = yes
	faith = root
	is_available = yes
	NOR = {
		has_character_flag = holy_order_recently_requested_land
		has_character_flag = holy_order_recently_received_land
	}
	save_temporary_scope_as = ruler
	any_sub_realm_barony = {
		holy_order_1000_target_barony_trigger = { CHARACTER = scope:ruler }
	}
}

faith_dominant_gender_male_or_equal = {
	faith = {
		OR = {
			has_doctrine_parameter = male_dominated_law
			has_doctrine_parameter = gender_equal_law
		}
	}
}

faith_dominant_gender_female_or_equal = {
	faith = {
		OR = {
			has_doctrine_parameter = female_dominated_law
			has_doctrine_parameter = gender_equal_law
		}
	}
}

is_theological_character_trigger = {
	OR = {
		has_trait = theologian
		has_trait = devoted
		has_trait = order_member
		AND = {
			is_playable_character = yes
			government_has_flag = government_is_theocracy
		}

	}
}

would_be_sinful_adulterer_trigger = {
	is_married = yes
	trigger_if = {
		limit = { is_male = yes }
		NOT = {
			faith = { has_doctrine = doctrine_adultery_men_accepted }
		}
	}
	trigger_else = {
		NOT = {
			faith = { has_doctrine = doctrine_adultery_women_accepted }
		}
	}
}

has_tolerant_faith_or_culture_trigger = {
	OR = {
		faith = { has_doctrine = doctrine_pluralism_pluralistic }
		# culture = { has_cultural_parameter = less_likely_to_force_conversion } #LotR
		has_trait = nomadic_philosophy
	}
}

is_open_to_inviting_other_faiths_trigger = {
	OR = {
		faith = { has_doctrine = tenet_adaptive }
		faith = { has_doctrine = unreformed_faith_doctrine }
		faith = { has_doctrine = doctrine_pluralism_pluralistic }
		culture = { has_cultural_tradition = tradition_religion_blending }
		culture = { has_cultural_tradition = tradition_tgp_religious_hospitality }
	}
}

faith_is_open_minded_trigger = {
	OR = {
		has_doctrine = tenet_adaptive
		has_doctrine = doctrine_pluralism_pluralistic
	}
}

is_mainstream_jewish_faith = {
	always = no
	#religion = religion:judaism_religion
	#NOT = {
	#	this = faith:samaritan
	#	this = faith:haymanot
	#	this = faith:malabarism
	#	this = faith:kabarism
	#}
}

is_unprotected_hostile_faith = { # Checks if the faith is at least hostile but not protected by a contract, used in a county scope
	faith = {
		faith_hostility_level = {
			target = prev.holder.top_liege.faith
			value >= 2
		}
	}
	holder = {
		NOT = { vassal_contract_has_flag = religiously_protected }
	}
	trigger_if = { # Does anyone in the hierarchy have religious protection?
		limit = {
			holder = {
				any_liege_or_above = {
					faith = prev.faith
				}
			}
		}
		holder = {
			any_liege_or_above = {
				NOT = { vassal_contract_has_flag = religiously_protected }
			}
		}
	}
}

#is_mainstream_jewish_faith = {
#	religion = religion:judaism_religion
#	NOT = {
#		this = faith:samaritan
#		this = faith:haymanot
#		this = faith:malabarism
#		this = faith:kabarism
#	}
#	always = no #LotR
#}

### SYNCRETIC TRIGGERS ###

##Used on faiths
is_dharmic_faith_trigger = {
	# OR = {
	# 	religion = religion:hinduism_religion
	# 	religion = religion:buddhism_religion
	# 	religion = religion:jainism_religion
	# }
	always = no
}

#Used on provinces
has_holy_building = {
	always = no #LotR
	#OR = {
	#	has_building_or_higher = holy_site_cathedral_01
	#	has_building_or_higher = holy_site_mosque_01
	#	has_building_or_higher = holy_site_pagan_grand_temple_01
	#	has_building_or_higher = holy_site_indian_grand_temple_01
	#	has_building_or_higher = holy_site_other_grand_temple_01
	#	has_building_or_higher = holy_site_cologne_cathedral_01
	#	has_building_or_higher = holy_site_canterbury_cathedral_01
	#	has_building_or_higher = temple_of_uppsala_01
	#	has_building_or_higher = lund_cathedral_01
	#	has_building_or_higher = notre_dame_01
	#	has_building_or_higher = holy_site_imam_ali_mosque_01
	#	has_building_or_higher = holy_site_great_mosque_of_mecca_01
	#	has_building_or_higher = holy_site_great_mosque_of_cordoba_01
	#	has_building_or_higher = holy_site_great_mosque_of_djenne_01
	#	has_building_or_higher = holy_site_great_mosque_of_samarra_01
	#	has_building_or_higher = holy_site_prophetic_mosque_01
	#	has_building_or_higher = dome_of_the_rock_01
	#	has_building_or_higher = temple_in_jerusalem_01
	#}
}

invalid_for_heresy_events = {
	OR = {
	#	this = faith:conversos
	#	this = faith:insular_celtic
	#	this = faith:bosnian_church
	#	this = faith:mozarabic_church
	#	this = faith:adamites
	#	this = faith:kabarism
		this = faith:faith_numenorean
		this = faith:faith_dwarven_balrog_cult
		this = faith:faith_hakimian
		this = faith:dark_worship
		this = faith:melkorite
		this = faith:commands_of_szrel
		this = faith:faith_dunlending_white_hand
		this = faith:faith_ainur
		this = faith:faith_angmar_evil
		this = faith:white_hand_cult
		this = faith:faith_wastelands_pagan
		AND = {
			this = faith:lidless_eye
			sauron_is_alive = no
		}
	}
}

is_faith_dominant_gender = {
	OR = {
		AND = {
			is_male = yes
			faith = {
				OR = {
					has_doctrine_parameter = male_dominated_law
					has_doctrine_parameter = gender_equal_law
				}
			}
		}
		AND = {
			is_female = yes
			faith = {
				OR = {
					has_doctrine_parameter = female_dominated_law
					has_doctrine_parameter = gender_equal_law
				}
			}
		}
	}
}

religion_is_broadly_asian_trigger = {
	#OR = { #LotR
	#	religion_is_east_asian_trigger = yes
	#	broadly_dharmic_trigger = yes
	#	broadly_chinese_religion_trigger = yes
	#}
}

religion_is_east_asian_trigger = {
	#OR = { #LotR
	#	faith.religion = religion:buddhism_religion
	#	faith.religion = religion:confucianism_religion
	#	faith.religion = religion:taoism_religion
	#	faith.religion = religion:shintoism_religion
	#}
}

broadly_dharmic_trigger = {
	#OR = { #LotR
	#	faith.religion = religion:buddhism_religion
	#	faith.religion = religion:hinduism_religion
	#	faith.religion = religion:jainism_religion
	#	faith.religion = religion:bon_religion
	#	faith.religion = religion:dab_qhuas_religion
	#	faith.religion = religion:aluk_religion
	#	faith.religion = religion:dayawism_religion
	#	faith.religion = religion:hantuism_religion
	#	faith.religion = religion:kaharingan_religion
	#	faith.religion = religion:satsana_phi_religion
	#	faith.religion = religion:tolotang_religion
	#	faith.religion = religion:utaki_religion
	#	faith.religion = religion:bimoism_religion
	#	faith.religion = religion:moism_religion
	#	faith.religion = religion:muism_religion
	#	faith.religion = religion:qiangic_religion
	#}
}

south_east_asian_pagan_trigger = {
	#OR = { #LotR
	#	faith.religion = religion:aluk_religion
	#	faith.religion = religion:dayawism_religion
	#	faith.religion = religion:hantuism_religion
	#	faith.religion = religion:kaharingan_religion
	#	faith.religion = religion:tolotang_religion
	#	faith.religion = religion:biliku_religion
	#}
}

broadly_jungle_dwelling_trigger = {
	culture = {
		#OR = { #LotR
		#	has_cultural_pillar = heritage_austronesian
		#	has_cultural_pillar = heritage_burman
		#	has_cultural_pillar = heritage_tai
		#	has_cultural_pillar = heritage_hmongic
		#	has_cultural_pillar = heritage_dravidian
		#	has_cultural_pillar = heritage_malayic
		#	has_cultural_pillar = heritage_mon_khmer
		#	has_cultural_pillar = heritage_viet
		#	has_cultural_pillar = heritage_indo_aryan
		#}
	}
}

broadly_chinese_religion_trigger = {
	#OR = { #LotR
	#	faith.religion = religion:taoism_religion
	#	faith.religion = religion:confucianism_religion
	#}
}

broadly_mainland_east_asian_heritage_trigger = {
	culture = {
		#OR = { #LotR
		#	has_cultural_pillar = heritage_chinese
		#	has_cultural_pillar = heritage_korean
		#	has_cultural_pillar = heritage_buyeo
		#	has_cultural_pillar = heritage_qiangic
		#	has_cultural_pillar = heritage_viet
		#}
	}
}

broadly_japanese_island_heritage_trigger = {
	culture = {
		#OR = { #LotR
		#	has_cultural_pillar = heritage_japonic
		#	has_cultural_pillar = heritage_ainuic
		#}
	}
}
