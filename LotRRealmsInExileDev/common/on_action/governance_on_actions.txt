###########################################
# ON ACTIONS FOR CREATING GOVERNANCE ISSUES
###########################################

### The following on_actions are specifically for their respective government types
# Administrative government
spawn_admin_governance_contract_on_action = {
	# Select a random eligible contract to create
	random_on_action = {
		100 = ep3_overdue_taxes
		100 = ep3_hoarding_mayor
		100 = ep3_bountiful_harvest
		100 = ep3_rampant_bandits
		100 = ep3_discontent_soldiers
		100 = ep3_inept_mayor
		100 = ep3_prov_investment
		100 = ep3_raiding_peasants
		100 = ep3_wild_predators
		100 = ep3_evil_presence
		100 = ep3_miraculous_healing
		100 = ep3_buried_treasure
		100 = ep3_public_land
		100 = ep3_mad_prophet
		100 = ep3_titles_sale
		100 = ep3_hungry_times
		100 = ep3_wartime_measures
	}
}

# Celestial government
spawn_celestial_governance_contract_on_action = {
	first_valid_on_action = {
		spawn_celestial_civic_governance_contract_on_action
		spawn_celestial_military_governance_contract_on_action
	}
}

spawn_celestial_civic_governance_contract_on_action = {
	trigger = {
		OR = { # Must have a civilian administration
			vassal_contract_has_flag = celestial_province_metropolitan
			vassal_contract_has_flag = celestial_province_standard
			vassal_contract_has_flag = celestial_province_industrial
		}
	}
	
	# Select a random eligible contract to create
	random_on_action = {
		100 = tgp_jail_inspection
		100 = tgp_potent_physick
		100 = tgp_irregular_accounting
		100 = tgp_salt_smugglers
		100 = tgp_hoarding_grain
		100 = tgp_doddering_magistrate
		100 = tgp_burdensome_taxes
		100 = tgp_unsafe_highways
		100 = tgp_dam_in_disrepair
		100 = tgp_unsanctioned_deity
		100 = tgp_escaped_justice
		100 = tgp_lines_in_the_soil
		100 = tgp_fraud_in_broad_daylight
		100 = tgp_crumbling_bridge
		100 = tgp_confusion_of_tongues
		100 = tgp_seditious_storytelling
		100 = tgp_quaking_in_panic
		100 = tgp_monopoly_in_the_marketplace
		100 = tgp_contested_inheritance
		
		# Reused contracts from EP3 that makes thematic sense
		100 = ep3_overdue_taxes
		100 = ep3_hoarding_mayor
		100 = ep3_bountiful_harvest
		100 = ep3_inept_mayor
		100 = ep3_raiding_peasants
		100 = ep3_wild_predators
	}
}

spawn_celestial_military_governance_contract_on_action = {
	trigger = {
		OR = { # Must have a military administration
			vassal_contract_has_flag = celestial_province_military
			vassal_contract_has_flag = celestial_province_protectorate
		}
	}
	
	# Select a random eligible contract to create
	random_on_action = {
		100 = tgp_unsafe_highways
		100 = tgp_escaped_justice
		100 = tgp_forced_conscription
		100 = tgp_combat_train_monks
		100 = tgp_missing_equipment
		
		# Reused contracts from EP3 that makes thematic sense
		100 = ep3_rampant_bandits
		100 = ep3_raiding_peasants
	}
}

# Natural Disasters Contract spawning for all Administrative types
spawn_natural_disaster_contract_on_action = {
	random_on_action = {
		100 = tgp_food_shortage
		100 = tgp_ravaged_buildings
		100 = tgp_medieval_medicine
		100 = tgp_disaster_displacement
	}
}

### EP3 contracts
# Overdue Taxes
ep3_overdue_taxes = {
	trigger = {
		NOT = { has_character_flag = task_contract_cooldown_overdue_taxes }
		any_sub_realm_county = {
			any_county_province = {
				has_holding = yes
				NOT = { this = scope:governor.capital_province }
			}
		}
	}
	
	effect = {
		# Select a suitable location
		random_sub_realm_county = {
			limit = {
				any_county_province = {
					has_holding = yes
					NOT = { this = scope:governor.capital_province }
				}
			}
			random_county_province = {
				limit = {
					has_holding = yes
					NOT = { this = scope:governor.capital_province }
				}
				save_scope_as = target_province
			}
		}
		
		# Create the contract
		create_task_contract = {
			task_contract_type = overdue_taxes
			task_contract_tier = scope:governance_task_contract_tier
			location = scope:target_province
			save_scope_as = new_governance_issue
		}
		
		# Set a cooldown
		add_character_flag = {
			flag = task_contract_cooldown_overdue_taxes
			years = 10
		}
		
		# General post-creation set up
		manage_new_governance_contract_effect = yes
	}
}

# Hoarding Mayor
ep3_hoarding_mayor = {
	trigger = {
		NOT = { has_character_flag = task_contract_cooldown_hoarding_mayor }
		any_sub_realm_county = {
			any_county_province = {
				has_holding_type = city_holding
				province_owner = {
					NOT = { this = scope:governor }
					gold >= 500 # Mayor needs to have a lot of gold
				}
			}
		}
	}
	
	effect = {
		# Select a suitable location
		random_sub_realm_county = {
			limit = {
				any_county_province = {
					has_holding_type = city_holding
					province_owner = {
						NOT = { this = scope:governor }
						gold >= 500 # Mayor needs to have a lot of gold
					}
				}
			}
			random_county_province = {
				limit = {
					has_holding_type = city_holding
					province_owner = {
						NOT = { this = scope:governor }
						gold >= 500 # Mayor needs to have a lot of gold
					}
				}
				save_scope_as = target_province
			}
		}
		
		# Create the contract
		create_task_contract = {
			task_contract_type = hoarding_mayor
			task_contract_tier = scope:governance_task_contract_tier
			location = scope:target_province
			task_contract_employer = scope:target_province.province_owner
			save_scope_as = new_governance_issue
		}
		
		# Set a cooldown
		add_character_flag = {
			flag = task_contract_cooldown_hoarding_mayor
			years = 10
		}
		
		# General post-creation set up
		manage_new_governance_contract_effect = yes
	}
}

# Bountiful Harvest
ep3_bountiful_harvest = {
	trigger = {
		NOT = { has_character_flag = task_contract_cooldown_bountiful_harvest }
	}
	
	weight_multiplier = {
		base = 1
		modifier = { # Increased chance if there is fertile terrain types present
			factor = 1.5
			any_sub_realm_county = {
				any_county_province = {
					OR = {
						terrain = farmlands
						terrain = floodplains
					}
				}
			}
		}
		modifier = { # Reduced chance if there is only rough terrain present
			factor = 0.5
			NOT = {
				any_sub_realm_county = {
					any_county_province = {
						OR = {
							terrain = farmlands
							terrain = floodplains
							terrain = plains
							terrain = drylands
							terrain = oasis
							terrain = forest
						}
					}
				}
			}
		}
	}
	
	effect = {
		# Select a suitable location
		capital_province = {
			save_scope_as = target_province
		}
		
		# Create the contract
		create_task_contract = {
			task_contract_type = bountiful_harvest
			task_contract_tier = scope:governance_task_contract_tier
			location = scope:target_province
			save_scope_as = new_governance_issue
		}
		
		# Set a cooldown
		add_character_flag = {
			flag = task_contract_cooldown_bountiful_harvest
			years = 10
		}
		
		# General post-creation set up
		manage_new_governance_contract_effect = yes
	}
}

# Rampant Bandits
ep3_rampant_bandits = {
	trigger = {
		NOT = { has_character_flag = task_contract_cooldown_rampant_bandits }
		any_sub_realm_county = {
			any_county_province = {
				NOT = { this = county.holder.capital_province }
			}
		}
	}
	
	weight_multiplier = {
		base = 1
		modifier = { # Significantly reduce the chance if there is no county with reduced control
			factor = 0.1
			NOT = {
				any_sub_realm_county = { county_control <= 90 }
			}
		}
		modifier = { # Increased chance if there are multiple counties with low control
			factor = 1.5
			any_sub_realm_county = {
				percent >= 0.25
				county_control <= 75
			}
		}
		modifier = { # Increased it more if control is even lower
			factor = 2
			any_sub_realm_county = {
				percent >= 0.5
				county_control <= 50
			}
		}
	}
	
	effect = {
		# Select a suitable location
		random_sub_realm_county = {
			limit = {
				any_county_province = {
					NOT = { this = county.holder.capital_province }
				}
			}
			weight = {
				base = 1
				modifier = { # Prioritize counties with low control
					add = {
						value = 100
						subtract = county_control
					}
					county_control < 100
				}
			}
			add_county_modifier = {
				modifier = ep3_governance_rampant_bandits
				years = 40
			}
			random_county_province = {
				limit = {
					NOT = { this = county.holder.capital_province }
				}
				weight = {
					base = 1
					modifier = { # Empty baronies make for better hiding spots
						add = 15
						has_holding = no
					}
					modifier = { # You can harass cities easier than castles or temples
						add = 4
						has_holding_type = city_holding
					}
					modifier = { # You can harass temples easier than castles
						add = 2
						has_holding_type = church_holding
					}
				}
				save_scope_as = target_province
			}
		}
		
		# Create the contract
		create_task_contract = {
			task_contract_type = rampant_bandits
			task_contract_tier = scope:governance_task_contract_tier
			location = scope:target_province
			save_scope_as = new_governance_issue
		}
		
		# Set a cooldown
		add_character_flag = {
			flag = task_contract_cooldown_rampant_bandits
			years = 10
		}
		
		# General post-creation set up
		manage_new_governance_contract_effect = yes
	}
}

# Discontent Soldiers
ep3_discontent_soldiers = {
	trigger = {
		NOT = { has_character_flag = task_contract_cooldown_discontent_soldiers }
		any_maa_regiment = {
			is_title_maa_regiment = yes
			is_raised = no
			count >= 2
		}
	}
	
	effect = {
		# Select a suitable location
		capital_province = {
			save_scope_as = target_province
		}
		
		# Create the contract
		create_task_contract = {
			task_contract_type = discontent_soldiers
			task_contract_tier = scope:governance_task_contract_tier
			location = scope:target_province
			save_scope_as = new_governance_issue
		}
		
		# Set a cooldown
		add_character_flag = {
			flag = task_contract_cooldown_discontent_soldiers
			years = 10
		}
		
		# General post-creation set up
		manage_new_governance_contract_effect = yes
	}
}

# Inept Mayor
ep3_inept_mayor = {
	trigger = {
		NOT = { has_character_flag = task_contract_cooldown_inept_mayor }
		any_sub_realm_county = {
			any_county_province = {
				has_holding_type = city_holding
				province_owner = {
					NOT = { this = scope:governor }
					stewardship <= mediocre_skill_rating
				}
			}
		}
	}
	
	effect = {
		# Select a suitable location
		random_sub_realm_county = {
			limit = {
				any_county_province = {
					has_holding_type = city_holding
					province_owner = {
						NOT = { this = scope:governor }
						stewardship <= mediocre_skill_rating
					}
				}
			}
			random_county_province = {
				limit = {
					has_holding_type = city_holding
					province_owner = {
						NOT = { this = scope:governor }
						stewardship <= mediocre_skill_rating
					}
				}
				save_scope_as = target_province
			}
			add_county_modifier = {
				modifier = ep3_mismanaged_administration_modifier
				years = 10
			}
		}
		
		# Create the contract
		create_task_contract = {
			task_contract_type = inept_mayor
			task_contract_tier = scope:governance_task_contract_tier
			location = scope:target_province
			task_contract_employer = scope:target_province.province_owner
			save_scope_as = new_governance_issue
		}
		
		# Set a cooldown
		add_character_flag = {
			flag = task_contract_cooldown_inept_mayor
			years = 10
		}
		
		# General post-creation set up
		manage_new_governance_contract_effect = yes
	}
}

# Provincial Investment
ep3_prov_investment = {
	trigger = {
		NOT = { has_character_flag = task_contract_cooldown_prov_investment }
		scope:governance_task_contract_tier = define:NTaskContract|HIGH_TASK_CONTRACT_TIER
	}
	
	weight_multiplier = {
		base = 1
		modifier = {
			has_trait = education_stewardship
			add = 10
		}
	}
	
	effect = {
		# Select a suitable location
		capital_province = {
			save_scope_as = target_province
		}
		
		# Create the contract
		create_task_contract = {
			task_contract_type = prov_investment
			task_contract_tier = scope:governance_task_contract_tier
			location = scope:target_province
			save_scope_as = new_governance_issue
		}
		
		# Set a cooldown
		add_character_flag = {
			flag = task_contract_cooldown_prov_investment
			years = 10
		}
		
		# General post-creation set up
		manage_new_governance_contract_effect = yes
	}
}

# Raiding Peasants
ep3_raiding_peasants = {
	trigger = {
		NOT = { has_character_flag = task_contract_cooldown_raiding_peasants }
		any_sub_realm_county = {
			any_neighboring_county = {
				holder = {
					top_liege = {
						NOT = { this = scope:governor.top_liege }
					}
				}
			}
			any_county_province = {
				has_holding = yes
			}
		}
	}
	
	effect = {
		# Select a suitable location
		random_sub_realm_county = {
			limit = {
				any_neighboring_county = {
					holder = {
						top_liege = {
							NOT = { this = scope:governor.top_liege }
						}
					}
				}
				any_county_province = {
					has_holding = yes
				}
			}
			random_county_province = {
				limit = {
					has_holding = yes
				}
				save_scope_as = target_province
			}
		}
		
		# Create the contract
		create_task_contract = {
			task_contract_type = raiding_peasants
			task_contract_tier = scope:governance_task_contract_tier
			location = scope:target_province
			save_scope_as = new_governance_issue
		}
		
		# Set a cooldown
		add_character_flag = {
			flag = task_contract_cooldown_raiding_peasants
			years = 10
		}
		
		# General post-creation set up
		manage_new_governance_contract_effect = yes
	}
}

# Wild Predators
ep3_wild_predators = {
	trigger = {
		NOT = { has_character_flag = task_contract_cooldown_wild_predators }
		any_sub_realm_county = {
			any_county_province = {
				OR = {
					has_building_or_higher = hunting_grounds_01
					has_building_or_higher = royal_forest_01
					terrain = forest
					terrain = jungle
				}
			}
		}
	}
	
	effect = {
		# Select a suitable location
		random_sub_realm_county = {
			limit = {
				any_county_province = {
					OR = {
						has_building_or_higher = hunting_grounds_01
						has_building_or_higher = royal_forest_01
						terrain = forest
						terrain = jungle
					}
				}
			}
			add_county_modifier = {
				modifier = ep3_wild_predators_modifier
				years = 10
			}
			random_county_province = {
				limit = {
					OR = {
						has_building_or_higher = hunting_grounds_01
						has_building_or_higher = royal_forest_01
					}
				}
				alternative_limit = {
					OR = {
						terrain = forest
						terrain = jungle
					}
				}
				save_scope_as = target_province
			}
		}
		
		# Create the contract
		create_task_contract = {
			task_contract_type = wild_predators
			task_contract_tier = scope:governance_task_contract_tier
			location = scope:target_province
			save_scope_as = new_governance_issue
		}
		
		# Set a cooldown
		add_character_flag = {
			flag = task_contract_cooldown_wild_predators
			years = 10
		}
		
		# General post-creation set up
		manage_new_governance_contract_effect = yes
	}
}

# Evil Presence
ep3_evil_presence = {
	trigger = {
		NOT = { has_character_flag = task_contract_cooldown_evil_presence }
		scope:governance_task_contract_tier = define:NTaskContract|LOW_TASK_CONTRACT_TIER
		any_sub_realm_county = {
			faith.religion = religion:dunedain_religion # LotR
			any_county_province = {
				has_holding = yes
				province_owner != scope:governor
			}
		}
	}
	
	effect = {
		# Select a suitable location
		random_sub_realm_county = {
			limit = {
				faith.religion = religion:dunedain_religion # LotR
				any_county_province = {
					has_holding = yes
					province_owner != scope:governor
				}
			}
			random_county_province = {
				limit = {
					has_holding = yes
					province_owner != scope:governor
				}
				save_scope_as = target_province
			}
		}
		
		# Create the contract
		create_task_contract = {
			task_contract_type = evil_presence
			task_contract_tier = scope:governance_task_contract_tier
			location = scope:target_province
			save_scope_as = new_governance_issue
		}
		
		# Set a cooldown
		add_character_flag = {
			flag = task_contract_cooldown_evil_presence
			years = 10
		}
		
		# General post-creation set up
		manage_new_governance_contract_effect = yes
	}
}

# Miraculous Healing
ep3_miraculous_healing = {
	trigger = {
		NOT = { has_character_flag = task_contract_cooldown_miraculous_healing }
	}
	
	effect = {
		# Select a suitable location
		capital_province = {
			save_scope_as = target_province
		}
		
		# Create the contract
		create_task_contract = {
			task_contract_type = miraculous_healing
			task_contract_tier = scope:governance_task_contract_tier
			location = scope:target_province
			save_scope_as = new_governance_issue
		}
		
		# Set a cooldown
		add_character_flag = {
			flag = task_contract_cooldown_miraculous_healing
			years = 10
		}
		
		# General post-creation set up
		manage_new_governance_contract_effect = yes
	}
}

# Buried Treasure
ep3_buried_treasure = {
	trigger = {
		NOT = { has_character_flag = task_contract_cooldown_buried_treasure }
		any_sub_realm_county = {
			any_county_province = {
				has_holding = yes
				province_owner != scope:governor
			}
		}
	}
	
	effect = {
		# Select a suitable location
		random_sub_realm_county = {
			limit = {
				any_county_province = {
					has_holding = yes
					province_owner != scope:governor
				}
			}
			random_county_province = {
				limit = {
					has_holding = yes
					province_owner != scope:governor
				}
				save_scope_as = target_province
			}
		}
		
		# Create the contract
		create_task_contract = {
			task_contract_type = buried_treasure
			task_contract_tier = scope:governance_task_contract_tier
			location = scope:target_province
			save_scope_as = new_governance_issue
		}
		
		# Set a cooldown
		add_character_flag = {
			flag = task_contract_cooldown_buried_treasure
			years = 10
		}
		
		# General post-creation set up
		manage_new_governance_contract_effect = yes
	}
}

# Public Land
ep3_public_land = {
	trigger = {
		NOT = { has_character_flag = task_contract_cooldown_public_land }
		any_sub_realm_county = {
			any_county_province = {
				any_province_domicile = {
					owner = scope:governor
					is_domicile_type = estate
				}
			}
		}
		OR = {
			any_sub_realm_county = {
				any_county_province = {
					has_holding = yes
					province_owner != scope:governor
					has_holding_type = castle_holding
				}
			}
			any_sub_realm_county = {
				any_county_province = {
					any_province_domicile = {
						is_domicile_type = estate
						owner = {
							NOT = { this = scope:governor }
							is_ai = yes
							is_alive = yes
						}
					}
				}
			}
		}
	}
	
	effect = {
		# Select a suitable location
		random_sub_realm_county = {
			limit = {
				any_county_province = {
					any_province_domicile = {
						is_domicile_type = estate
						owner = {
							NOT = { this = scope:governor }
							is_ai = yes
							is_alive = yes
						}
					}
				}
			}
			random_county_province = {
				limit = {
					any_province_domicile = {
						is_domicile_type = estate
						owner = {
							NOT = { this = scope:governor }
							is_ai = yes
							is_alive = yes
						}
					}

				}
				save_scope_as = target_province
			}
			scope:target_province ?= {
				random_province_domicile = {
					limit = {
						is_domicile_type = estate
						owner = {
							NOT = { this = scope:governor }
							is_ai = yes
							is_alive = yes
						}
					}
					owner = { save_scope_as = employer }
				}
			}
		}
		if = {
			limit = {
				NOT = { exists = scope:target_province }
			}
			random_sub_realm_county = {
				limit = {
					any_county_province = {
						has_holding = yes
						province_owner != scope:governor
						has_holding_type = castle_holding
					}
				}
				random_county_province = {
					limit = {
						has_holding = yes
						province_owner != scope:governor
						has_holding_type = castle_holding
					}
					save_scope_as = target_province
					province_owner = { save_scope_as = employer }
				}
			}
		}
		
		# Create the contract
		create_task_contract = {
			task_contract_type = public_land
			task_contract_tier = scope:governance_task_contract_tier
			location = scope:target_province
			task_contract_employer = scope:employer
			save_scope_as = new_governance_issue
		}
		
		# Set a cooldown
		add_character_flag = {
			flag = task_contract_cooldown_public_land
			years = 10
		}
		
		# General post-creation set up
		manage_new_governance_contract_effect = yes
	}
}

# Mad Prophet
ep3_mad_prophet = {
	trigger = {
		NOT = { has_character_flag = task_contract_cooldown_mad_prophet }
		any_sub_realm_county = {
			any_county_province = {
				has_holding = yes
				province_owner != scope:governor
			}
		}
	}
	
	effect = {
		# Select a suitable location
		random_sub_realm_county = {
			limit = {
				any_county_province = {
					has_holding = yes
					province_owner != scope:governor
				}
			}
			random_county_province = {
				limit = {
					has_holding = yes
					province_owner != scope:governor
				}
				save_scope_as = target_province
			}
		}
		
		# Create the contract
		create_task_contract = {
			task_contract_type = mad_prophet
			task_contract_tier = scope:governance_task_contract_tier
			location = scope:target_province
			save_scope_as = new_governance_issue
		}
		
		# Set a cooldown
		add_character_flag = {
			flag = task_contract_cooldown_mad_prophet
			years = 10
		}
		
		# General post-creation set up
		manage_new_governance_contract_effect = yes
	}
}

# Titles for Sale
ep3_titles_sale = {
	trigger = {
		NOT = { has_character_flag = task_contract_cooldown_titles_sale }
		faith = {
			NOR = {
				has_doctrine = doctrine_theocracy_lay_clergy
				has_doctrine = doctrine_temporal_head
			}
		}
	}
	
	effect = {
		# Select a suitable location
		capital_province = {
			save_scope_as = target_province
		}
		
		# Create the contract
		create_task_contract = {
			task_contract_type = titles_sale
			task_contract_tier = scope:governance_task_contract_tier
			location = scope:target_province
			save_scope_as = new_governance_issue
		}
		
		# Set a cooldown
		add_character_flag = {
			flag = task_contract_cooldown_titles_sale
			years = 10
		}
		
		# General post-creation set up
		manage_new_governance_contract_effect = yes
	}
}

# Hungry Times
ep3_hungry_times = {
	trigger = {
		NOT = { has_character_flag = task_contract_cooldown_hungry_times }
		any_sub_realm_county = {
			any_county_province = {
				has_holding = yes
				province_owner != scope:governor
				has_variable = epidemic_cooldown_general
			}
		}
	}
	
	effect = {
		# Select a suitable location
		random_sub_realm_county = {
			limit = {
				any_county_province = {
					has_holding = yes
					province_owner != scope:governor
					has_variable = epidemic_cooldown_general
				}
			}
			random_county_province = {
				limit = {
					has_holding = yes
					province_owner != scope:governor
					has_variable = epidemic_cooldown_general
				}
				save_scope_as = target_province
			}
		}
		
		# Create the contract
		create_task_contract = {
			task_contract_type = hungry_times
			task_contract_tier = scope:governance_task_contract_tier
			location = scope:target_province
			save_scope_as = new_governance_issue
		}
		
		# Set a cooldown
		add_character_flag = {
			flag = task_contract_cooldown_hungry_times
			years = 15 #epidemic_cooldown_general lasts 15 years, and we don't want this to trigger twice in a row for the same place
		}
		
		# General post-creation set up
		manage_new_governance_contract_effect = yes
	}
}

# Wartime Measures
ep3_wartime_measures = {
	trigger = {
		NOT = { has_character_flag = task_contract_cooldown_wartime_measures }
		liege = { is_at_war = yes }
		is_at_war = no
		OR = {
			vassal_contract_has_flag = admin_theme_frontier
			vassal_contract_has_flag = admin_theme_military
		}
	}
	
	effect = {
		# Select a suitable location
		capital_province = {
			save_scope_as = target_province
		}
		
		# Create the contract
		create_task_contract = {
			task_contract_type = wartime_measures
			task_contract_tier = scope:governance_task_contract_tier
			location = scope:target_province
			save_scope_as = new_governance_issue
		}
		
		# Set a cooldown
		add_character_flag = {
			flag = task_contract_cooldown_wartime_measures
			years = 10
		}
		
		# General post-creation set up
		manage_new_governance_contract_effect = yes
	}
}

### TGP contracts
# Jail Inspection
tgp_jail_inspection = {
	trigger = {
		NOT = { has_character_flag = task_contract_cooldown_jail_inspection }
		any_sub_realm_county = {
			any_county_province = {
				has_holding = yes
				NOT = { this = scope:governor.capital_province }
			}
		}
	}
	
	weight_multiplier = {
		base = 1
		modifier = {
			has_trait = education_stewardship
			add = 10
		}
	}
	
	effect = {
		# Select a suitable location
		random_sub_realm_county = {
			limit = {
				any_county_province = {
					has_holding = yes
					NOT = { this = scope:governor.capital_province }
				}
			}
			random_county_province = {
				limit = {
					has_holding = yes
					NOT = { this = scope:governor.capital_province }
				}
				save_scope_as = target_province
			}
		}
		
		# Create the contract
		create_task_contract = {
			task_contract_type = jail_inspection
			task_contract_tier = scope:governance_task_contract_tier
			location = scope:target_province
			save_scope_as = new_governance_issue
		}
		
		# Set a cooldown
		add_character_flag = {
			flag = task_contract_cooldown_jail_inspection
			years = 10
		}
		
		# General post-creation set up
		manage_new_governance_contract_effect = yes
	}
}

# Potent Physick
tgp_potent_physick = {
	trigger = {
		NOT = { has_character_flag = task_contract_cooldown_potent_physick }
		any_sub_realm_county = {
			any_county_province = {
				has_holding = yes
				NOT = { this = scope:governor.capital_province }
			}
		}
	}
	
	effect = {
		# Select a suitable location
		random_sub_realm_county = {
			limit = {
				any_county_province = {
					has_holding = yes
					NOT = { this = scope:governor.capital_province }
				}
			}
			random_county_province = {
				limit = {
					has_holding = yes
					NOT = { this = scope:governor.capital_province }
				}
				save_scope_as = target_province
			}
		}
		
		# Create the contract
		create_task_contract = {
			task_contract_type = potent_physick
			task_contract_tier = scope:governance_task_contract_tier
			location = scope:target_province
			save_scope_as = new_governance_issue
		}
		
		# Set a cooldown
		add_character_flag = {
			flag = task_contract_cooldown_potent_physick
			years = 10
		}
		
		# General post-creation set up
		manage_new_governance_contract_effect = yes
	}
}

# Irregular Accounting
tgp_irregular_accounting = {
	trigger = {
		NOT = { has_character_flag = task_contract_cooldown_irregular_accounting }
		any_sub_realm_county = {
			any_county_province = {
				has_holding = yes
				NOT = { this = scope:governor.capital_province }
			}
		}
	}
	
	effect = {
		# Select a suitable location
		random_sub_realm_county = {
			limit = {
				any_county_province = {
					has_holding = yes
					NOT = { this = scope:governor.capital_province }
				}
			}
			random_county_province = {
				limit = {
					has_holding = yes
					NOT = { this = scope:governor.capital_province }
				}
				save_scope_as = target_province
			}
		}
		
		# Create the contract
		create_task_contract = {
			task_contract_type = irregular_accounting
			task_contract_tier = scope:governance_task_contract_tier
			location = scope:target_province
			save_scope_as = new_governance_issue
		}
		
		# Set a cooldown
		add_character_flag = {
			flag = task_contract_cooldown_irregular_accounting
			years = 10
		}
		
		# General post-creation set up
		manage_new_governance_contract_effect = yes
	}
}

# Salt Smugglers
tgp_salt_smugglers = {
	trigger = {
		NOT = { has_character_flag = task_contract_cooldown_salt_smugglers }
		any_sub_realm_county = {
			any_county_province = {
				has_holding = yes
				is_coastal = yes
				NOT = { this = scope:governor.capital_province }
			}
		}
	}
	
	effect = {
		# Select a suitable location
		random_sub_realm_county = {
			limit = {
				any_county_province = {
					has_holding = yes
					is_coastal = yes
					NOT = { this = scope:governor.capital_province }
				}
			}
			random_county_province = {
				limit = {
					has_holding = yes
					is_coastal = yes
					NOT = { this = scope:governor.capital_province }
				}
				save_scope_as = target_province
			}
		}
		
		# Create the contract
		create_task_contract = {
			task_contract_type = salt_smugglers
			task_contract_tier = scope:governance_task_contract_tier
			location = scope:target_province
			save_scope_as = new_governance_issue
		}
		
		# Set a cooldown
		add_character_flag = {
			flag = task_contract_cooldown_salt_smugglers
			years = 10
		}
		
		# General post-creation set up
		manage_new_governance_contract_effect = yes
	}
}

# Hoarding Grain
tgp_hoarding_grain = {
	trigger = {
		NOT = { has_character_flag = task_contract_cooldown_hoarding_grain }
		any_sub_realm_county = {
			any_county_province = {
				has_holding = yes
				OR = {
					terrain = farmlands
					terrain = forest
					terrain = hills
				}
				NOT = { this = scope:governor.capital_province }
			}
		}
	}
	
	effect = {
		# Select a suitable location
		random_sub_realm_county = {
			limit = {
				any_county_province = {
					has_holding = yes
					OR = {
						terrain = farmlands
						terrain = forest
						terrain = hills
					}
					NOT = { this = scope:governor.capital_province }
				}
			}
			random_county_province = {
				limit = {
					has_holding = yes
					OR = {
						terrain = farmlands
						terrain = forest
						terrain = hills
					}
					NOT = { this = scope:governor.capital_province }
				}
				save_scope_as = target_province
			}
		}
		
		# Create the contract
		create_task_contract = {
			task_contract_type = hoarding_grain
			task_contract_tier = scope:governance_task_contract_tier
			location = scope:target_province
			save_scope_as = new_governance_issue
		}
		
		# Set a cooldown
		add_character_flag = {
			flag = task_contract_cooldown_hoarding_grain
			years = 10
		}
		
		# General post-creation set up
		manage_new_governance_contract_effect = yes
	}
}

# Doddering Magistrate
tgp_doddering_magistrate = {
	trigger = {
		NOT = { has_character_flag = task_contract_cooldown_doddering_magistrate }
		any_sub_realm_county = {
			any_county_province = {
				has_holding = yes
				NOT = { this = scope:governor.capital_province }
			}
		}
	}
	
	effect = {
		# Select a suitable location
		random_sub_realm_county = {
			limit = {
				any_county_province = {
					has_holding = yes
					NOT = { this = scope:governor.capital_province }
				}
			}
			random_county_province = {
				limit = {
					has_holding = yes
					NOT = { this = scope:governor.capital_province }
				}
				save_scope_as = target_province
			}
		}
		
		# Create the contract
		create_task_contract = {
			task_contract_type = doddering_magistrate
			task_contract_tier = scope:governance_task_contract_tier
			location = scope:target_province
			save_scope_as = new_governance_issue
		}
		
		# Set a cooldown
		add_character_flag = {
			flag = task_contract_cooldown_doddering_magistrate
			years = 10
		}
		
		# General post-creation set up
		manage_new_governance_contract_effect = yes
	}
}

# Burdensome Taxes
tgp_burdensome_taxes = {
	trigger = {
		NOT = { has_character_flag = task_contract_cooldown_burdensome_taxes }
		any_sub_realm_county = {
			any_county_province = {
				has_holding = yes
				NOT = { this = scope:governor.capital_province }
			}
		}
	}
	
	effect = {
		# Select a suitable location
		random_sub_realm_county = {
			limit = {
				any_county_province = {
					has_holding = yes
					NOT = { this = scope:governor.capital_province }
				}
			}
			random_county_province = {
				limit = {
					has_holding = yes
					NOT = { this = scope:governor.capital_province }
				}
				save_scope_as = target_province
			}
		}
		
		# Create the contract
		create_task_contract = {
			task_contract_type = burdensome_taxes
			task_contract_tier = scope:governance_task_contract_tier
			location = scope:target_province
			save_scope_as = new_governance_issue
		}
		
		# Set a cooldown
		add_character_flag = {
			flag = task_contract_cooldown_burdensome_taxes
			years = 10
		}
		
		# General post-creation set up
		manage_new_governance_contract_effect = yes
	}
}

# Unsafe Highways
tgp_unsafe_highways = {
	trigger = {
		NOT = { has_character_flag = task_contract_cooldown_unsafe_highways }
		any_sub_realm_county = {
			county_control < 100
			any_county_province = {
				has_holding = yes
				NOT = { this = scope:governor.capital_province }
			}
		}
	}
	
	effect = {
		# Select a suitable location
		random_sub_realm_county = {
			limit = {
				county_control < 100
				any_county_province = {
					has_holding = yes
					NOT = { this = scope:governor.capital_province }
				}
			}
			random_county_province = {
				limit = {
					has_holding = yes
					NOT = { this = scope:governor.capital_province }
				}
				save_scope_as = target_province
			}
		}
		
		# Create the contract
		create_task_contract = {
			task_contract_type = unsafe_highways
			task_contract_tier = scope:governance_task_contract_tier
			location = scope:target_province
			save_scope_as = new_governance_issue
		}
		
		# Set a cooldown
		add_character_flag = {
			flag = task_contract_cooldown_unsafe_highways
			years = 10
		}
		
		# General post-creation set up
		manage_new_governance_contract_effect = yes
	}
}

# Dam in Disrepair
tgp_dam_in_disrepair = {
	trigger = {
		NOT = { has_character_flag = task_contract_cooldown_dam_in_disrepair }
		any_sub_realm_county = {
			any_county_province = {
				OR = {
					terrain = farmlands
					terrain = forest
					terrain = hills
					terrain = floodplains
				}
				NOT = { this = scope:governor.capital_province }
			}
		}
	}
	
	effect = {
		# Select a suitable location
		random_sub_realm_county = {
			limit = {
				any_county_province = {
					has_holding = yes
					NOT = { this = scope:governor.capital_province }
					OR = {
						terrain = farmlands
						terrain = forest
						terrain = hills
						terrain = floodplains
					}
				}
			}
			random_county_province = {
				limit = {
					has_holding = yes
					NOT = { this = scope:governor.capital_province }
					OR = {
						terrain = farmlands
						terrain = forest
						terrain = hills
						terrain = floodplains
					}
				}
				save_scope_as = target_province
			}
		}
		
		# Create the contract
		create_task_contract = {
			task_contract_type = dam_in_disrepair
			task_contract_tier = scope:governance_task_contract_tier
			location = scope:target_province
			save_scope_as = new_governance_issue
		}
		
		# Set a cooldown
		add_character_flag = {
			flag = task_contract_cooldown_dam_in_disrepair
			years = 10
		}
		
		# General post-creation set up
		manage_new_governance_contract_effect = yes
	}
}

# Unsanctioned Deity
tgp_unsanctioned_deity = {
	trigger = {
		NOT = { has_character_flag = task_contract_cooldown_unsanctioned_deity }
		any_sub_realm_county = {
			any_county_province = {
				has_holding = yes
				NOT = { this = scope:governor.capital_province }
			}
		}
	}
	
	effect = {
		# Select a suitable location
		random_sub_realm_county = {
			limit = {
				any_county_province = {
					has_holding = yes
					NOT = { this = scope:governor.capital_province }
				}
			}
			random_county_province = {
				limit = {
					has_holding = yes
					NOT = { this = scope:governor.capital_province }
				}
				save_scope_as = target_province
			}
		}
		
		# Create the contract
		create_task_contract = {
			task_contract_type = unsanctioned_deity
			task_contract_tier = scope:governance_task_contract_tier
			location = scope:target_province
			save_scope_as = new_governance_issue
		}
		
		# Set a cooldown
		add_character_flag = {
			flag = task_contract_cooldown_unsanctioned_deity
			years = 10
		}
		
		# General post-creation set up
		manage_new_governance_contract_effect = yes
	}
}

# Escaped Justice
tgp_escaped_justice = {
	trigger = {
		NOT = { has_character_flag = task_contract_cooldown_escaped_justice }
		any_sub_realm_county = {
			any_county_province = {
				has_holding = no
				NOT = { this = scope:governor.capital_province }
				OR = {
					terrain = farmlands
					terrain = forest
					terrain = hills
				}
			}
		}
		scope:governor = {
			any_vassal = {
				highest_held_title_tier = tier_barony
				is_travelling = no
				is_imprisoned = no
				is_commanding_army = no
			}
		}
	}
	
	effect = {
		# Save the escapee
		scope:governor = {
			ordered_vassal = {
				limit = {
					highest_held_title_tier = tier_barony
					is_travelling = no
					is_imprisoned = no
					is_commanding_army = no
				}
				order_by = {
					value = {
						add = ai_greed
						add = {
							value = ai_honor
							multiply = -0.5
						}
					}
				}
				save_scope_as = escapee
			}
		}
		
		# Select a suitable location
		random_sub_realm_county = {
			limit = {
				any_county_province = {
					NOT = { this = scope:governor.capital_province }
					OR = {
						terrain = farmlands
						terrain = forest
						terrain = hills
					}
				}
			}
			random_county_province = {
				limit = {
					NOT = { this = scope:governor.capital_province }
					OR = {
						terrain = farmlands
						terrain = forest
						terrain = hills
					}
				}
				save_scope_as = target_province
			}
		}
		
		# Create the contract
		create_task_contract = {
			task_contract_type = escaped_justice
			task_contract_tier = scope:governance_task_contract_tier
			location = scope:target_province
			save_scope_as = new_governance_issue
		}
		scope:new_governance_issue = {
			set_task_contract_target = scope:escapee
		}
		
		# Set a cooldown
		add_character_flag = {
			flag = task_contract_cooldown_escaped_justice
			years = 10
		}
		
		# General post-creation set up
		manage_new_governance_contract_effect = yes
	}
}

# Forced Conscription
tgp_forced_conscription = {
	trigger = {
		NOT = { has_character_flag = task_contract_cooldown_forced_conscription }
		any_sub_realm_county = {
			any_county_province = {
				NOT = { this = scope:governor.capital_province }
				OR = {
					terrain = farmlands
					terrain = forest
					terrain = hills
					terrain = terraced_hills
				}
			}
		}
	}
	
	effect = {
		# Select a suitable location
		random_sub_realm_county = {
			limit = {
				any_county_province = {
					NOT = { this = scope:governor.capital_province }
					OR = {
						terrain = farmlands
						terrain = forest
						terrain = hills
						terrain = terraced_hills
					}
				}
			}
			random_county_province = {
				limit = {
					NOT = { this = scope:governor.capital_province }
					OR = {
						terrain = farmlands
						terrain = forest
						terrain = hills
						terrain = terraced_hills
					}
				}
				save_scope_as = target_province
			}
		}
		
		# Create the contract
		create_task_contract = {
			task_contract_type = forced_conscription
			task_contract_tier = scope:governance_task_contract_tier
			location = scope:target_province
			task_contract_employer = scope:governor.liege
			save_scope_as = new_governance_issue
		}
		
		# Set a cooldown
		add_character_flag = {
			flag = task_contract_cooldown_forced_conscription
			years = 10
		}
		
		# General post-creation set up
		manage_new_governance_contract_effect = yes
	}
}

# Teach Monks Martial Arts
tgp_combat_train_monks = {
	trigger = {
		NOT = { has_character_flag = task_contract_cooldown_combat_train_monks }
		any_sub_realm_county = {
			any_county_province = {
				NOT = { this = scope:governor.capital_province }
				has_holding_type = church_holding
			}
		}
	}
	
	effect = {
		# Select a suitable location
		random_sub_realm_county = {
			limit = {
				any_county_province = {
					NOT = { this = scope:governor.capital_province }
					has_holding_type = church_holding
				}
			}
			random_county_province = {
				limit = {
					NOT = { this = scope:governor.capital_province }
					has_holding_type = church_holding
				}
				save_scope_as = target_province
			}
		}
		
		# Create the contract
		create_task_contract = {
			task_contract_type = combat_train_monks
			task_contract_tier = scope:governance_task_contract_tier
			location = scope:target_province
			save_scope_as = new_governance_issue
		}
		
		# Set a cooldown
		add_character_flag = {
			flag = task_contract_cooldown_combat_train_monks
			years = 10
		}
		
		# General post-creation set up
		manage_new_governance_contract_effect = yes
	}
}

# Missing Equipment
tgp_missing_equipment = {
	trigger = {
		NOT = { has_character_flag = task_contract_cooldown_missing_equipment }
		NOR = { # And not have any potential modifiers active
			any_realm_province = { has_province_modifier = tgp_well_equipped_soldiers_modifier }
			any_realm_province = { has_province_modifier = tgp_greatly_equipped_soldiers_modifier }
		}
	}
	
	effect = {
		# Select a suitable location
		# We make this appear in the capital, which is likely where the equipment would be kept - You also have the option to travel later
		capital_province = {
			save_scope_as = target_province
		}
		
		# Create the contract
		create_task_contract = {
			task_contract_type = missing_equipment
			task_contract_tier = scope:governance_task_contract_tier
			location = scope:target_province
			save_scope_as = new_governance_issue
		}
		
		# Set a cooldown
		add_character_flag = {
			flag = task_contract_cooldown_missing_equipment
			years = 10
		}
		
		# General post-creation set up
		manage_new_governance_contract_effect = yes
	}
}

# Lines in the Soil
tgp_lines_in_the_soil = {
	trigger = {
		NOT = { has_character_flag = task_contract_cooldown_lines_in_the_soil }
		any_sub_realm_county = {
			any_county_province = {
				has_holding = yes
				NOT = { this = scope:governor.capital_province }
			}
		}
	}
	
	effect = {
		# Select a suitable location
		random_sub_realm_county = {
			limit = {
				any_county_province = {
					has_holding = yes
					NOT = { this = scope:governor.capital_province }
				}
			}
			random_county_province = {
				limit = {
					has_holding = yes
					NOT = { this = scope:governor.capital_province }
				}
				save_scope_as = target_province
			}
		}
		
		# Create the contract
		create_task_contract = {
			task_contract_type = lines_in_the_soil
			task_contract_tier = scope:governance_task_contract_tier
			location = scope:target_province
			save_scope_as = new_governance_issue
		}
		
		# Set a cooldown
		add_character_flag = {
			flag = task_contract_cooldown_lines_in_the_soil
			years = 10
		}
		
		# General post-creation set up
		manage_new_governance_contract_effect = yes
	}
}

# Fraud in Broad Daylight
tgp_fraud_in_broad_daylight = {
	trigger = {
		NOT = { has_character_flag = task_contract_cooldown_fraud_in_broad_daylight }
		any_sub_realm_county = {
			any_county_province = {
				has_holding = yes
				NOT = { this = scope:governor.capital_province }
			}
		}
	}
	
	effect = {
		# Select a suitable location
		random_sub_realm_county = {
			limit = {
				any_county_province = {
					has_holding = yes
					NOT = { this = scope:governor.capital_province }
				}
			}
			random_county_province = {
				limit = {
					has_holding = yes
					NOT = { this = scope:governor.capital_province }
				}
				save_scope_as = target_province
			}
		}
		
		# Create the contract
		create_task_contract = {
			task_contract_type = fraud_in_broad_daylight
			task_contract_tier = scope:governance_task_contract_tier
			location = scope:target_province
			save_scope_as = new_governance_issue
		}
		
		# Set a cooldown
		add_character_flag = {
			flag = task_contract_cooldown_fraud_in_broad_daylight
			years = 10
		}
		
		# General post-creation set up
		manage_new_governance_contract_effect = yes
	}
}

# Crumbling Bridge
tgp_crumbling_bridge = {
	trigger = {
		NOT = { has_character_flag = task_contract_cooldown_crumbling_bridge }
		any_sub_realm_county = {
			any_county_province = {
				has_holding = yes
				NOT = { terrain = desert }
				NOT = { this = scope:governor.capital_province }
			}
		}
	}
	
	effect = {
		# Select a suitable location
		random_sub_realm_county = {
			limit = {
				any_county_province = {
					has_holding = yes
					NOT = { terrain = desert }
					NOT = { this = scope:governor.capital_province }
				}
			}
			random_county_province = {
				limit = {
					has_holding = yes
					NOT = { terrain = desert }
					NOT = { this = scope:governor.capital_province }
				}
				save_scope_as = target_province
			}
		}
		
		# Create the contract
		create_task_contract = {
			task_contract_type = crumbling_bridge
			task_contract_tier = scope:governance_task_contract_tier
			location = scope:target_province
			save_scope_as = new_governance_issue
		}
		
		# Set a cooldown
		add_character_flag = {
			flag = task_contract_cooldown_crumbling_bridge
			years = 10
		}
		
		# General post-creation set up
		manage_new_governance_contract_effect = yes
	}
}

# A Confusion of Tongues
tgp_confusion_of_tongues = {
	trigger = {
		NOT = { has_character_flag = task_contract_cooldown_confusion_of_tongues }
		any_sub_realm_county = {
			any_county_province = {
				has_holding = yes
				is_coastal = yes
				NOT = { this = scope:governor.capital_province }
			}
		}
		# any_county_in_region = { #LotR
		# 	region = world_asia_and_india
		# 	any_province = { 
		# 		is_coastal = yes
		# 	}
		# 	culture = { NOT = { has_cultural_pillar = heritage_chinese } }
		# }
	}
	
	effect = {
		# Select a suitable location
		random_sub_realm_county = {
			limit = {
				any_county_province = {
					has_holding = yes
					is_coastal = yes
					NOT = { this = scope:governor.capital_province }
				}
			}
			random_county_province = {
				limit = {
					has_holding = yes
					is_coastal = yes
					NOT = { this = scope:governor.capital_province }
				}
				save_scope_as = target_province
			}
		}
		
		# Create the contract
		create_task_contract = {
			task_contract_type = confusion_of_tongues
			task_contract_tier = scope:governance_task_contract_tier
			location = scope:target_province
			save_scope_as = new_governance_issue
		}
		
		# Set a cooldown
		add_character_flag = {
			flag = task_contract_cooldown_confusion_of_tongues
			years = 10
		}
		
		# General post-creation set up
		manage_new_governance_contract_effect = yes
	}
}

# Seditious Storytelling
tgp_seditious_storytelling = {
	trigger = {
		NOT = { has_character_flag = task_contract_cooldown_seditious_storytelling }
		any_sub_realm_county = {
			any_county_province = {
				has_holding = yes
				NOT = { this = scope:governor.capital_province }
			}
		}
	}
	
	effect = {
		# Select a suitable location
		random_sub_realm_county = {
			limit = {
				any_county_province = {
					has_holding = yes
					NOT = { this = scope:governor.capital_province }
				}
			}
			random_county_province = {
				limit = {
					has_holding = yes
					NOT = { this = scope:governor.capital_province }
				}
				save_scope_as = target_province
			}
		}
		
		# Create the contract
		create_task_contract = {
			task_contract_type = seditious_storytelling
			task_contract_tier = scope:governance_task_contract_tier
			location = scope:target_province
			save_scope_as = new_governance_issue
		}
		
		# Set a cooldown
		add_character_flag = {
			flag = task_contract_cooldown_seditious_storytelling
			years = 10
		}
		
		# General post-creation set up
		manage_new_governance_contract_effect = yes
	}
}

# Quaking in Panic
tgp_quaking_in_panic = {
	trigger = {
		NOT = { has_character_flag = task_contract_cooldown_quaking_in_panic }
		any_sub_realm_county = {
			any_county_province = {
				has_holding = yes
				NOT = { this = scope:governor.capital_province }
			}
		}
	}
	
	effect = {
		# Select a suitable location
		random_sub_realm_county = {
			limit = {
				any_county_province = {
					has_holding = yes
					NOT = { this = scope:governor.capital_province }
				}
			}
			random_county_province = {
				limit = {
					has_holding = yes
					NOT = { this = scope:governor.capital_province }
				}
				save_scope_as = target_province
			}
		}
		
		# Create the contract
		create_task_contract = {
			task_contract_type = quaking_in_panic
			task_contract_tier = scope:governance_task_contract_tier
			location = scope:target_province
			save_scope_as = new_governance_issue
		}
		
		# Set a cooldown
		add_character_flag = {
			flag = task_contract_cooldown_quaking_in_panic
			years = 10
		}
		
		# General post-creation set up
		manage_new_governance_contract_effect = yes
	}
}

# Monopoly in the Marketplace
tgp_monopoly_in_the_marketplace = {
	trigger = {
		NOT = { has_character_flag = task_contract_cooldown_monopoly_in_the_marketplace }
		any_sub_realm_county = {
			any_county_province = {
				has_holding = yes
				NOT = { this = scope:governor.capital_province }
			}
		}
	}
	
	effect = {
		# Select a suitable location
		random_sub_realm_county = {
			limit = {
				any_county_province = {
					has_holding = yes
					NOT = { this = scope:governor.capital_province }
				}
			}
			random_county_province = {
				limit = {
					has_holding = yes
					NOT = { this = scope:governor.capital_province }
				}
				save_scope_as = target_province
			}
		}
		
		# Create the contract
		create_task_contract = {
			task_contract_type = monopoly_in_the_marketplace
			task_contract_tier = scope:governance_task_contract_tier
			location = scope:target_province
			save_scope_as = new_governance_issue
		}
		
		# Set a cooldown
		add_character_flag = {
			flag = task_contract_cooldown_monopoly_in_the_marketplace
			years = 10
		}
		
		# General post-creation set up
		manage_new_governance_contract_effect = yes
	}
}

# Contested Inheritance
tgp_contested_inheritance = {
	trigger = {
		NOT = { has_character_flag = task_contract_cooldown_contested_inheritance }
		any_sub_realm_county = {
			any_county_province = {
				has_holding = yes
				NOT = { this = scope:governor.capital_province }
			}
		}
	}
	
	effect = {
		# Select a suitable location
		random_sub_realm_county = {
			limit = {
				any_county_province = {
					has_holding = yes
					NOT = { this = scope:governor.capital_province }
				}
			}
			random_county_province = {
				limit = {
					has_holding = yes
					NOT = { this = scope:governor.capital_province }
				}
				save_scope_as = target_province
			}
		}
		
		# Create the contract
		create_task_contract = {
			task_contract_type = contested_inheritance
			task_contract_tier = scope:governance_task_contract_tier
			location = scope:target_province
			save_scope_as = new_governance_issue
		}
		
		# Set a cooldown
		add_character_flag = {
			flag = task_contract_cooldown_contested_inheritance
			years = 10
		}
		
		# General post-creation set up
		manage_new_governance_contract_effect = yes
	}
}

### Natural Disaster contracts
# Food Shortage
tgp_food_shortage = {
	trigger = {
		NOT = { has_character_flag = task_contract_cooldown_tgp_food_shortage }
		any_sub_realm_county = {
			any_county_province = {
				has_holding = yes
				NOT = { this = scope:governor.capital_province }
			}
		}
	}
	
	weight_multiplier = {
		base = 1
		modifier = {
			has_trait = education_stewardship
			add = 10
		}
	}
	
	effect = {
		# Select a suitable location
		random_sub_realm_county = {
			limit = {
				any_county_province = {
					has_holding = yes
					NOT = { this = scope:governor.capital_province }
				}
			}
			random_county_province = {
				limit = {
					has_holding = yes
					NOT = { this = scope:governor.capital_province }
				}
				save_scope_as = target_province
			}
		}
		
		# Create the contract
		create_task_contract = {
			task_contract_type = tgp_food_shortage
			task_contract_tier = scope:governance_task_contract_tier
			location = scope:target_province
			save_scope_as = new_governance_issue
		}
		
		# Set a cooldown
		add_character_flag = {
			flag = task_contract_cooldown_tgp_food_shortage
			years = 10
		}
		
		# General post-creation set up
		manage_new_governance_contract_effect = yes
	}
}

# Destroyed by Nature
tgp_ravaged_buildings = {
	trigger = {
		NOT = { has_character_flag = task_contract_cooldown_tgp_ravaged_buildings }
		any_sub_realm_county = {
			any_county_province = {
				has_holding = yes
				NOT = { this = scope:governor.capital_province }
			}
		}
	}
	
	weight_multiplier = {
		base = 1
		modifier = {
			has_trait = education_stewardship
			add = 10
		}
	}
	
	effect = {
		# Select a suitable location
		random_sub_realm_county = {
			limit = {
				any_county_province = {
					has_holding = yes
					NOT = { this = scope:governor.capital_province }
				}
			}
			random_county_province = {
				limit = {
					has_holding = yes
					NOT = { this = scope:governor.capital_province }
				}
				save_scope_as = target_province
			}
		}
		
		# Create the contract
		create_task_contract = {
			task_contract_type = tgp_ravaged_buildings
			task_contract_tier = scope:governance_task_contract_tier
			location = scope:target_province
			save_scope_as = new_governance_issue
		}
		
		# Set a cooldown
		add_character_flag = {
			flag = task_contract_cooldown_tgp_ravaged_buildings
			years = 10
		}
		
		# General post-creation set up
		manage_new_governance_contract_effect = yes
	}
}

# Treating the Unfortunate
tgp_medieval_medicine = {
	trigger = {
		NOT = { has_character_flag = task_contract_cooldown_tgp_medieval_medicine }
		any_sub_realm_county = {
			any_county_province = {
				has_holding = yes
				NOT = { this = scope:governor.capital_province }
			}
		}
	}
	
	weight_multiplier = {
		base = 1
		modifier = {
			has_trait = education_stewardship
			add = 10
		}
	}
	
	effect = {
		# Select a suitable location
		random_sub_realm_county = {
			limit = {
				any_county_province = {
					has_holding = yes
					NOT = { this = scope:governor.capital_province }
				}
			}
			random_county_province = {
				limit = {
					has_holding = yes
					NOT = { this = scope:governor.capital_province }
				}
				save_scope_as = target_province
			}
		}
		
		# Create the contract
		create_task_contract = {
			task_contract_type = tgp_medieval_medicine
			task_contract_tier = scope:governance_task_contract_tier
			location = scope:target_province
			save_scope_as = new_governance_issue
		}
		
		# Set a cooldown
		add_character_flag = {
			flag = task_contract_cooldown_tgp_medieval_medicine
			years = 10
		}
		
		# General post-creation set up
		manage_new_governance_contract_effect = yes
	}
}

# Provisional Relocation
tgp_disaster_displacement = {
	trigger = {
		NOT = { has_character_flag = task_contract_cooldown_tgp_disaster_displacement }
		any_sub_realm_county = {
			any_county_province = {
				has_holding = yes
				NOT = { this = scope:governor.capital_province }
			}
		}
	}
	
	weight_multiplier = {
		base = 1
		modifier = {
			has_trait = education_stewardship
			add = 10
		}
	}
	
	effect = {
		# Select a suitable location
		random_sub_realm_county = {
			limit = {
				any_county_province = {
					has_holding = yes
					NOT = { this = scope:governor.capital_province }
				}
			}
			random_county_province = {
				limit = {
					has_holding = yes
					NOT = { this = scope:governor.capital_province }
				}
				save_scope_as = target_province
			}
		}
		
		# Create the contract
		create_task_contract = {
			task_contract_type = tgp_disaster_displacement
			task_contract_tier = scope:governance_task_contract_tier
			location = scope:target_province
			save_scope_as = new_governance_issue
		}
		
		# Set a cooldown
		add_character_flag = {
			flag = task_contract_cooldown_tgp_disaster_displacement
			years = 10
		}
		
		# General post-creation set up
		manage_new_governance_contract_effect = yes
	}
}
