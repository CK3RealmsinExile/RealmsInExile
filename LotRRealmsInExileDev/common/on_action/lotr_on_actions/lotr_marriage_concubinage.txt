# Characters getting married
# root = Major partner of the marriage
# scope:spouse = Minor partner of the marriage
lotr_on_marriage = { # Will not fire from historical marriages
	effect = {	
		#LotR - Ensure elves become soulmates
		if = {
			limit = {
				is_elf = yes
			}
			set_relation_soulmate = scope:spouse
			# Ensure NPCs have babies
			if = {
				limit = {
					is_playable_character = no
					scope:spouse = { is_playable_character = no }
				}
				trigger_event = {
					id = elven_racial.0001
					years = {5 50}
				}
			}
		}
		#LotR - Accidental cross-racial marriage failsafe
		if = {
			limit = {
				AND = {
					NOT = { same_race = { TARGET = scope:spouse } }
					NOR = {
						AND = {
							has_character_flag = is_aragorn
							OR = {
								AND = {
									has_title = title:e_gondor
									has_title = title:e_arnor
								}
								has_title = title:h_reunited_kingdom
							}
							scope:spouse = { has_character_flag = is_arwen }
						}
						AND = {
							has_character_flag = is_arwen
							scope:spouse = {
								has_character_flag = is_aragorn
								OR = {
									AND = {
										has_title = title:e_gondor
										has_title = title:e_arnor
									}
									has_title = title:h_reunited_kingdom
								}
							}
						}
					}
				}
			}
			divorce_effect = {
				DIVORCER = root
				DIVORCEE = scope:spouse
			}
		}
		#LotR - Eldarion inception
		if = {
			limit = {
				has_character_flag = is_aragorn
				OR = {
					AND = {
						has_title = title:e_gondor
						has_title = title:e_arnor
					}
					has_title = title:h_reunited_kingdom
				}
				scope:spouse = { has_character_flag = is_arwen }
			}
			trigger_event = {
				id = gondor.0508 
				days = 100
			}
		}

		#LotR - Thani-Hazad Struggle Catalysts
		if = {
			limit = { scope:spouse = { is_lowborn = no } }
			if = {
				limit = {
					is_alive = yes
					scope:spouse = { 
						is_alive = yes 
						any_character_struggle = { 
							is_struggle_type = thani_hazad_struggle
						phase_has_catalyst = catalyst_marriage_between_characters
						}
					}
					any_character_struggle = { 
						is_struggle_type = thani_hazad_struggle 
						phase_has_catalyst = catalyst_marriage_between_characters
					}
				}
				every_character_struggle = {
					involvement = involved
					activate_struggle_catalyst = {
						catalyst = catalyst_marriage_between_characters
						character = scope:owner
					}
				}
			}
		}

	}
}