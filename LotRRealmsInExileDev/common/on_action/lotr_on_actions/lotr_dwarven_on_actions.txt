# Dwarven on_actions

#Response events to beard care decision that lets you lose stress
stress_loss_dwarven_beard_care = {
	random_events = {
		70 = dwarven_racial.1001 # It's nice
		15 = dwarven_racial.1002 # You now have the best beard ever
		15 = dwarven_racial.1003 # You've gone and ruined your beard
	}
}

# Petition Liege On Action from Activity Rework
appeal_for_dwarven_aid_start = {
	effect = {
		add_character_flag = appeal_for_dwarven_aid_character_flag
		set_variable = {
			name = appeal_for_dwarven_aid_scope
			value = liege
		}
		switch = {
			trigger = has_trait 
			shy = { add_stress = medium_stress_impact_gain }
			arrogant = { add_stress = medium_stress_impact_gain }
		}
	}
}

appeal_for_dwarven_aid_travel_planner_exit = {
	effect = {
		send_interface_toast = {
			type = event_toast_effect_neutral
			title = appeal_for_dwarven_aid_costs_refunded
			left_icon = root
			remove_decision_cooldown = appeal_for_dwarven_aid_decision
			# refund prestige and influence cost
			if = {
				limit = { petition_liege_admin_valid_trigger = yes }
				change_influence_no_experience = standard_activity_cost
			}
			else = {
				add_prestige_no_experience = standard_activity_cost
			}
		}
		if = {
			limit = { has_variable = appeal_for_dwarven_aid_scope }
			remove_variable = appeal_for_dwarven_aid_scope
		}
		if = {
			limit = { has_variable = petition_type }
			remove_variable = petition_type
		}
		if = {
			limit = { has_character_flag = appeal_for_dwarven_aid_character_flag }
			remove_character_flag = appeal_for_dwarven_aid_character_flag
		}
	}
}

appeal_for_dwarven_aid_0101 = {
	effect = {
		if = {
			limit = {
				scope:appeal_for_dwarven_aid = {
					is_alive = yes 
					is_imprisoned = no
				}
				scope:petition_vassal = {
					is_alive = yes
					is_imprisoned = no
				}
			}
			trigger_event = appeal_for_dwarven_aid.0101
		}
		else = {
			trigger_event = appeal_for_dwarven_aid.0601
		}
	}
}

appeal_for_dwarven_aid_0201 = {
	effect = {
		if = {
			limit = {
				petition_liege_valid_trigger = yes
			}
			scope:petition_vassal = {
				trigger_event = {
					id = appeal_for_dwarven_aid.0201
				}
			}
		}
		else = {
			trigger_event = appeal_for_dwarven_aid.0601
		}
	}
}

appeal_for_dwarven_aid_0205 = { # Liege proposes a counter offer
	effect = {
		if = {
			limit = {
				petition_liege_valid_trigger = yes
			}
			trigger_event = {
				id = appeal_for_dwarven_aid.0205
			}
		}
		else = {
			trigger_event = appeal_for_dwarven_aid.0601
		}
	}
}

appeal_for_dwarven_aid_0401 = { # Vassal skill check event
	effect = {
		if = {
			limit = {
				petition_liege_valid_trigger = yes
			}
			trigger_event = appeal_for_dwarven_aid.0401
		}
		else = {
			trigger_event = appeal_for_dwarven_aid.0601
		}
	}
}


appeal_for_dwarven_aid_ghosted = {
	effect = {
		if = {
			limit = {
				has_variable = appeal_for_dwarven_aid_scope 
			}
			trigger_event = appeal_for_dwarven_aid.0009
		}
	}
}
