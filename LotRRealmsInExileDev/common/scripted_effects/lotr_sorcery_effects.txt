### Learn Sorcery ###
#var:sorcery_quest
learn_sorcery_cancel_effect = {
	remove_character_modifier = apprentice_sorcerer_modifier
	stress_impact = {
		zealous = medium_stress_impact_gain
		ambitious = minor_stress_impact_gain
	}
	if = {
		limit = { has_trait = zealous }
		random_list = {
			20 = { remove_trait = zealous }
			80 = { add_piety = minor_piety_loss }
		}
	}
	else = {
		random_list = {
			20 = { add_trait = cynic }
			80 = { add_piety = minor_piety_loss }
		}
	}
}
learn_sorcery_befriend_master_effect = {
	stress_impact = {
		shy = minor_stress_impact_gain
		gregarious = minor_stress_impact_loss
	}
	random_list = {
		0 = { # Yes
			compare_modifier = {
           		value = root.diplomacy
           		multiplier = 2
       		}
			opinion_modifier = {
				opinion_target = root
				who = scope:master
				multiplier = 1
			}
			scope:master = {
				add_opinion = {
					target = root
					modifier = friendly_interaction
				}
			}
			change_variable = {
				name = sorcery_quest
				add = 1
			}
			trigger_event = {
				id = evil.0111
#				days = {5 10}
			}
			add_character_flag = sorcery_quest_riddle_attempt
			trigger_event = {
				id = evil.0190
=#				years = 10
			}
		}
		100 = { # No
			scope:master = {
				add_opinion = {
					target = root
					opinion = -30
					modifier = rival_differing_personalities_opinion
					years = 15
				}
			}
			send_interface_toast = {
				type = event_toast_effect_bad
				title = evil.0110.a.t
				left_icon = scope:master
			}
			trigger_event = {
				id = evil.0112
#				days = 3
			}
		}
	}
}
learn_sorcery_bribe_master_effect = {
	if = {
		limit = { has_hook = scope:master }
		pay_short_term_gold = {
			gold = bribe_value
			target = scope:master
		}
		stress_impact = {
			greedy = minor_stress_impact_gain
		}
		change_variable = {
			name = sorcery_quest
			add = 1
		}
	}
	else = {
		pay_short_term_gold = {
			gold = {
				value = bribe_value
				multiply = 5
			}
			target = scope:master
		}
		stress_impact = {
			greedy = minor_stress_impact_gain
		}
	}
	hidden_effect = {
		random_list = {
			45 = {
				trigger_event = {
					id = evil.0111
#					days = 3
				}
			}
			45 = {
				add_gold = bribe_value
				set_variable = {name = mastermethod value = 1}
				trigger_event = {
					id = evil.0112
#					days = 3
				}
			}
			10 = {
				modifier = {
					scope:master = {
						ai_honor < -25
					}
					add = 100
				}
				set_variable = {name = mastermethod value = 2}
				trigger_event = {
					id = evil.0112
#					days = 3
				}
			}
		}
	}
}
learn_sorcery_abduct_master_effect = {
	add_character_flag = {
		flag = abducting_sorcerer
		years = 2
	}
	start_scheme = {
		type = abduct
		target = scope:master
		save_scope_as = scope:scheme
	}
	scheme = {
		add_scheme_progress = scheme_progress_gain
	}
	stress_impact = {
		compassionate = minor_stress_impact_gain
		sadistic = minor_stress_impact_loss
		callous = minor_stress_impact_loss
	}
	trigger_event = {
		id = evil.0114
		years = 2
	}
	trigger_event = {
		id = intrigue_scheme_ongoing.1001
		years = 1
	}
}
learn_sorcery_abduct_master_failing_effect = {
	random_list = {
		50 = {
			add_piety = minor_prestige_loss
		}
		40 = {
			add_piety = minor_prestige_loss
			add_character_modifier = sorcerer_failing_modifier
		}
		10 = {
			add_piety = medium_prestige_loss
			add_character_modifier = sorcerer_failing_modifier
		}
	}
	random_scheme = {
		limit = {
			scheme_type = abduct
			scheme_target = scope:master
		}
		add_scheme_progress = scheme_progress_gain
	}
	add_character_flag = {
		flag = abducting_sorcerer
		years = 2
	}
	stress_impact = {
		zealous = miniscule_stress_impact_gain
		craven = miniscule_stress_impact_gain
		ambitious = miniscule_stress_impact_gain
		vengeful = miniscule_stress_impact_gain
		compassionate = minor_stress_impact_gain
	}
	trigger_event = {
		id = evil.0114
		years = 2
	}
	trigger_event = {
		id = intrigue_scheme_ongoing.1002
		years = 1
	}
}
abducted_sorcerer_effect = {
	change_variable = {
		name = sorcery_quest
		add = 1
	}
	random_list = {
		70 = {
			if = {
				limit = { has_trait = zealous }
				add_piety = miniscule_piety_loss
			}
			else = {}
		}
		30 = {
			if = {
				limit = { has_trait = zealous }
				add_piety = minor_piety_loss
				add_character_modifier = {
					modifier = captured_a_fly_in_their_web_modifier
					years = 2
				}
			}
			else = {
				add_character_modifier = {
					modifier = captured_a_fly_in_their_web_modifier
					years = 1
				}
			}
		}
	}
	add_character_flag = {
		flag = abducted_sorcerer
		years = 2
	}
}
tortured_sorcerer_effect = {
	change_variable = {
		name = sorcery_quest
		add = 1
	}
	stress_impact = {
		intellect_good_2 = minor_stress_impact_gain
		education_intrigue_3 = minor_stress_impact_gain
		education_learning_3 = minor_stress_impact_gain
		intellect_good_3 = medium_stress_impact_gain
		education_intrigue_4 = medium_stress_impact_gain
		education_learning_4 = medium_stress_impact_gain
	}
#	scope:master = {
#		duel = {
#			skill = learning
#			value = 10
#			20 = {
#				compare_modifier = {
#					value = scope:duel_value
#					multiplier = 0.5
#				}
#				send_interface_toast = {
#					title = tortured_sorcerer_effect.success
#					left_icon = root
#					change_variable = {
#						name = sorcery_quest
#						add = 1
#					}
#				}
#			}
#			10 = {
#				compare_modifier = {
#					value = scope:duel_value
#					multiplier = -0.5
#				}
#				send_interface_toast = {
#					title = tortured_sorcerer_effect.failure
#					left_icon = root
#					add_trait = wounded
#				}
#			}
#		}
#	}
	add_character_flag = sorcery_quest_riddle_attempt
	trigger_event = {
		id = evil.0190
#		years = 10
	}
}
learn_sorcery_tomes_dark_knowledge_success_effect = {
}
learn_sorcery_tomes_dark_knowledge_failure_effect = {
}




riddle_ritual_morgoths_ring_effect = {
	change_variable = {
		name = sorcery_quest
		add = 1
	}
	if = {
		limit = { var:sorcery_quest >= 10 }
		random_list = {
			25 = {
				add_stress = miniscule_stress_impact_gain
			}
			25 = {
				add_stress = minor_stress_impact_gain
				add_trait = craven
			}
			50 = { # ToDo: move to Learn Sorcery Phase 2.
				add_stress = medium_stress_impact_gain
				health = -1
				hidden_effect = {
					add_trait = sorcerer_1
					remove_character_modifier = apprentice_sorcerer_modifier
					remove_character_flag = learning_sorcery
					scope:activity = { complete_activity = yes }
				}
			}
		}
	}
	else = {
		random_list = {
			50 = {
				add_stress = miniscule_stress_impact_gain
			}
			45 = {
				add_stress = minor_stress_impact_gain
				add_trait = craven
			}
			5 = {
				add_stress = medium_stress_impact_gain
				health = -1
				hidden_effect = {
					add_trait = sorcerer_1
					remove_character_modifier = apprentice_sorcerer_modifier
					remove_character_flag = learning_sorcery
					scope:activity = { complete_activity = yes }
				}
			}
		}
	}
}
riddle_ritual_blood_offering_effect = {
	if = {
		limit = { var:sorcery_quest >= 10 }
		random_list = {
			50 = {
				add_stress = miniscule_stress_impact_gain
			}
			45 = {
				add_stress = minor_stress_impact_gain
				add_trait = deceitful
			}
			5 = { # ToDo: move to Learn Sorcery Phase 2.
				add_stress = medium_stress_impact_gain
				health = -1
				add_trait = bleeder
				hidden_effect = {
					add_trait = sorcerer_1
					remove_character_modifier = apprentice_sorcerer_modifier
					remove_character_flag = learning_sorcery
					scope:activity = { complete_activity = yes }
				}
			}
		}
	}
	else = {
		random_list = {
			50 = {
				add_stress = miniscule_stress_impact_gain
			}
			45 = {
				add_stress = minor_stress_impact_gain
				add_trait = deceitful
			}
			5 = {
				add_stress = medium_stress_impact_gain
				health = -1
			}
		}
	}
}
riddle_ritual_ritual_mutilation_effect = {
	if = {
		limit = { var:sorcery_quest >= 5 }
		random_list = {
			50 = {
				add_stress = miniscule_stress_impact_gain
			}
			49 = {
				add_stress = minor_stress_impact_gain
				add_trait = sadistic
			}
			1 = { # ToDo: move to Learn Sorcery Phase 2.
				add_stress = medium_stress_impact_gain
				health = -1
				add_trait = sterile
				hidden_effect = {
					add_trait = sorcerer_1
					remove_character_modifier = apprentice_sorcerer_modifier
					remove_character_flag = learning_sorcery
					scope:activity = { complete_activity = yes }
				}
			}
		}
	}
	else = {
		random_list = {
			50 = {
				add_stress = miniscule_stress_impact_gain
			}
			49 = {
				add_stress = minor_stress_impact_gain
				add_trait = sadistic
			}
			1 = {
				add_stress = medium_stress_impact_gain
				health = -1
			}
		}
	}
}
riddle_ritual_into_darkness_effect = {
	if = {
		limit = { var:sorcery_quest >= 10 }
		random_list = {
			50 = {
				add_stress = miniscule_stress_impact_gain
			}
			45 = {
				add_stress = minor_stress_impact_gain
				add_trait = zealous
			}
			5 = { # ToDo: move to Learn Sorcery Phase 2.
				add_stress = medium_stress_impact_gain
				health = -1
				add_trait = melancholic
				hidden_effect = {
					add_trait = sorcerer_1
					remove_character_modifier = apprentice_sorcerer_modifier
					remove_character_flag = learning_sorcery
					scope:activity = { complete_activity = yes }
				}
			}
		}
	}
	else = {
		random_list = {
			50 = {
				add_stress = miniscule_stress_impact_gain
			}
			45 = {
				add_stress = minor_stress_impact_gain
				add_trait = zealous
			}
			5 = {
				add_stress = medium_stress_impact_gain
				health = -1
			}
		}
	}
}
riddle_ritual_wild_dance_effect = {
	random_list = {
		50 = {
			add_stress = miniscule_stress_impact_gain
		}
		45 = {
			add_stress = minor_stress_impact_gain
			add_trait = possessed
		}
		5 = {
			add_stress = medium_stress_impact_gain
			health = -1
		}
	}
}



# Move to Learn Sorcery Phase 2
#	add_character_modifier = {
#		modifier = studying_dark_arts_modifier
#		years = 5
#	}
#	trigger_event = {
#		id = evil.0130
#		years = 5
#	}

### Learn Sorcery Yearly Events ###
dark_sorcery_create_uruk_effect = {
	create_character = {
		employer = this
		random_list = {
			5 = { culture = culture:morlughai }
			5 = { culture = culture:ungurhai }
			5 = { culture = culture:luftutaumhai }
			5 = { culture = culture:ghashhai }
			5 = { culture = culture:ruhai }
			5 = { culture = culture:burgulhai }
			5 = { culture = culture:gurgurhai }
			5 = { culture = culture:maraudhai }
			5 = { culture = culture:kuhai }
			5 = { culture = culture:gazoghai }
		}
		random_list = {
			5 = { faith = faith:lidless_eye }
			5 = { faith = faith:sons_of_sauron }
			5 = { faith = faith:red_eye_cult }
			5 = { faith = faith:way_of_strength }
		}
		template = dark_sorcery_create_uruk_template
		save_scope_as = dark_sorcery_created_uruk
	}
	scope:dark_sorcery_created_uruk = {
		add_character_flag = {
			flag = immune_to_disease
			years = 10
		}
	}
}
dark_sorcery_create_mordor_uruk_duel_effect = {
	hidden_effect = {
		create_character = {
			random_list = {
				5 = { culture = culture:morlughai }
				5 = { culture = culture:ungurhai }
				5 = { culture = culture:luftutaumhai }
				5 = { culture = culture:ghashhai }
				5 = { culture = culture:ruhai }
				5 = { culture = culture:burgulhai }
				5 = { culture = culture:gurgurhai }
				5 = { culture = culture:maraudhai }
				5 = { culture = culture:kuhai }
				5 = { culture = culture:gazoghai }
			}
			random_list = {
				5 = { faith = faith:lidless_eye }
				5 = { faith = faith:sons_of_sauron }
				5 = { faith = faith:red_eye_cult }
				5 = { faith = faith:way_of_strength }
			}
			dynasty = none
			age = { 120 180 }
			template = dark_sorcery_create_uruk_template
			save_scope_as = dark_sorcery_created_mordor_uruk_duel
		}
	}
}











