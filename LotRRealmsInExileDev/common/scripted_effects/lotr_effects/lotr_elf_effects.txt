### ELVEN EFFECTS ###
define_elven_homelands = {
	##Greenwood
	title:c_aradhrynd = {
		add_county_modifier = elven_homeland_county_modifier
	}
	title:c_cerin_arhendhiril = {
		add_county_modifier = elven_homeland_county_modifier
	}
	title:c_celon_glossgond = {
		add_county_modifier = elven_homeland_county_modifier
	}
	title:c_car_rusc = {
		add_county_modifier = elven_homeland_county_modifier
	}
	title:c_tirduin = {
		add_county_modifier = elven_homeland_county_modifier
	}
	title:c_neldoreth = {
		add_county_modifier = elven_homeland_county_modifier
	}
	title:c_arodsenn = {
		add_county_modifier = elven_homeland_county_modifier
	}
	title:c_haudh_en_aiganaur = {
		add_county_modifier = elven_homeland_county_modifier
	}
	title:c_tham_aeldir = {
		add_county_modifier = elven_homeland_county_modifier
	}
	title:c_tham_taerdol = {
		add_county_modifier = elven_homeland_county_modifier
	}
	title:c_torech_emel = {
		add_county_modifier = elven_homeland_county_modifier
	}
	title:c_caras_tilion = {
		add_county_modifier = elven_homeland_county_modifier
	}
	title:c_esglador = {
		add_county_modifier = elven_homeland_county_modifier
	}
	title:c_orod_men = {
		add_county_modifier = elven_homeland_county_modifier
	}
	title:c_orod_annon = {
		add_county_modifier = elven_homeland_county_modifier
	}
	title:c_nan_gulduin = {
		add_county_modifier = elven_homeland_county_modifier
	}
	title:c_amarthrynd = {
		add_county_modifier = elven_homeland_county_modifier
	}
	title:c_edhelmen = {
		add_county_modifier = elven_homeland_county_modifier
	}
	title:c_eryn_ivann = {
		add_county_modifier = elven_homeland_county_modifier
	}
	title:c_linnathon = {
		add_county_modifier = elven_homeland_county_modifier
	}
	title:c_forbardh = {
		add_county_modifier = elven_homeland_county_modifier
	}
	title:c_elenfen = {
		add_county_modifier = elven_homeland_county_modifier
	}
	title:c_mornrad = {
		add_county_modifier = elven_homeland_county_modifier
	}
	title:c_girchirion = {
		add_county_modifier = elven_homeland_county_modifier
	}
	title:c_beraland = {
		add_county_modifier = elven_homeland_county_modifier
	}
	title:c_gudmarhalle = {
		add_county_modifier = elven_homeland_county_modifier
	}
	title:c_taurongobel = {
		add_county_modifier = elven_homeland_county_modifier
	}
	title:c_dunmen_i_naugrim = {
		add_county_modifier = elven_homeland_county_modifier
	}
	title:c_tauronrad = {
		add_county_modifier = elven_homeland_county_modifier
	}
	title:c_talan_pengron = {
		add_county_modifier = elven_homeland_county_modifier
	}
	title:c_cor_tauraglor = {
		add_county_modifier = elven_homeland_county_modifier
	}
	title:c_eryn_aelin = {
		add_county_modifier = elven_homeland_county_modifier
	}
	title:c_minas_thoron = {
		add_county_modifier = elven_homeland_county_modifier
	}
	title:c_rad_angaladh = {
		add_county_modifier = elven_homeland_county_modifier
	}
	title:c_gond_bangath = {
		add_county_modifier = elven_homeland_county_modifier
	}
	title:c_senn_i_naugrim = {
		add_county_modifier = elven_homeland_county_modifier
	}
	title:c_medelarnis = {
		add_county_modifier = elven_homeland_county_modifier
	}
	title:c_rhumen_i_naugrim = {
		add_county_modifier = elven_homeland_county_modifier
	}
	title:c_enedhmen_i_naugrim = {
		add_county_modifier = elven_homeland_county_modifier
	}
	title:c_taurannon = {
		add_county_modifier = elven_homeland_county_modifier
	}
	title:c_nidurn = {
		add_county_modifier = elven_homeland_county_modifier
	}
	title:c_carag_thoroth = {
		add_county_modifier = elven_homeland_county_modifier
	}
	title:c_amon_lanc = {
		add_county_modifier = elven_homeland_county_modifier
	}
	title:c_gorogrod = {
		add_county_modifier = elven_homeland_county_modifier
	}
	title:c_dimbar = {
		add_county_modifier = elven_homeland_county_modifier
	}
	title:c_barad_angol = {
		add_county_modifier = elven_homeland_county_modifier
	}
	title:c_naerorn = {
		add_county_modifier = elven_homeland_county_modifier
	}
	title:c_gwathrad = {
		add_county_modifier = elven_homeland_county_modifier
	}
	title:c_thon_gwaeren = {
		add_county_modifier = elven_homeland_county_modifier
	}
	title:c_emyn_dulin = {
		add_county_modifier = elven_homeland_county_modifier
	}
	title:c_galbrethin = {
		add_county_modifier = elven_homeland_county_modifier
	}
	title:c_barad_dolni = {
		add_county_modifier = elven_homeland_county_modifier
	}
	title:c_tawaroth = {
		add_county_modifier = elven_homeland_county_modifier
	}
	title:c_tharlag = {
		add_county_modifier = elven_homeland_county_modifier
	}
	title:c_minas_raug = {
		add_county_modifier = elven_homeland_county_modifier
	}
	##Lothlorien
	title:c_caras_galadhon = {
		add_county_modifier = elven_homeland_county_modifier
	}
	title:c_melbrethil = {
		add_county_modifier = elven_homeland_county_modifier
	}
	title:c_cerin_amroth = {
		add_county_modifier = elven_homeland_county_modifier
	}
	title:c_amdirion = {
		add_county_modifier = elven_homeland_county_modifier
	}
	title:c_egladil = {
		add_county_modifier = elven_homeland_county_modifier
	}
	title:c_nimrodel = {
		add_county_modifier = elven_homeland_county_modifier
	}
	title:c_harglan_nimrodel = {
		add_county_modifier = elven_homeland_county_modifier
	}
	title:c_thinglad = {
		add_county_modifier = elven_homeland_county_modifier
	}
	##Nelornieth
	title:c_caras_torn = {
		add_county_modifier = elven_homeland_county_modifier
	}
	title:c_nimbrethil = {
		add_county_modifier = elven_homeland_county_modifier
	}
	title:c_lant_glawar = {
		add_county_modifier = elven_homeland_county_modifier
	}
	title:c_eryn_laeg = {
		add_county_modifier = elven_homeland_county_modifier
	}
	title:c_nen_gweleb = {
		add_county_modifier = elven_homeland_county_modifier
	}
	title:c_caras_edel = {
		add_county_modifier = elven_homeland_county_modifier
	}
	title:c_eryn_tirnen = {
		add_county_modifier = elven_homeland_county_modifier
	}
	title:c_padrand = {
		add_county_modifier = elven_homeland_county_modifier
	}
	title:c_rhond_gwanwen = {
		add_county_modifier = elven_homeland_county_modifier
	}
	title:c_lant_naergurth = {
		add_county_modifier = elven_homeland_county_modifier
	}
	title:c_midilhad = {
		add_county_modifier = elven_homeland_county_modifier
	}
	title:c_lind_gelir = {
		add_county_modifier = elven_homeland_county_modifier
	}
	##Gondor
	title:c_edhellond = {
		add_county_modifier = elven_homeland_county_modifier
	}
	##Suza Sumar
	title:c_pred = {
		add_county_modifier = elven_homeland_county_modifier
	}
	title:c_qhan_vuzo = {
		add_county_modifier = elven_homeland_county_modifier
	}
	title:c_madi_khon = {
		add_county_modifier = elven_homeland_county_modifier
	}
	title:c_rhan_dazu = {
		add_county_modifier = elven_homeland_county_modifier
	}
	title:c_domo_domo = {
		add_county_modifier = elven_homeland_county_modifier
	}
	title:c_whan_nevi = {
		add_county_modifier = elven_homeland_county_modifier
	}
	## Imladris
	title:c_imladris = {
		add_county_modifier = elven_homeland_county_modifier
	}
	title:c_ladforthon = {
		add_county_modifier = elven_homeland_county_modifier
	}
	title:c_mirybinim = {
		add_county_modifier = elven_homeland_county_modifier
	}
	##d_rhawnen
	title:c_faronador = {
		add_county_modifier = elven_homeland_county_modifier
	}
	title:c_ladenris = {
		add_county_modifier = elven_homeland_county_modifier
	}
	title:c_anglennalad = {
		add_county_modifier = elven_homeland_county_modifier
	}
	##d_lhadereg
	title:c_gwingris = {
		add_county_modifier = elven_homeland_county_modifier
	}
	title:c_men_andrath = {
		add_county_modifier = elven_homeland_county_modifier
	}
	title:c_nan_rhawereg = {
		add_county_modifier = elven_homeland_county_modifier
	}
	##d_dor_maenor
	title:c_edraregion = {
		add_county_modifier = elven_homeland_county_modifier
	}
	title:c_emyn_dindal = {
		add_county_modifier = elven_homeland_county_modifier
	}
	title:c_lanthiring = {
		add_county_modifier = elven_homeland_county_modifier
	}
	title:c_talath_formir = {
		add_county_modifier = elven_homeland_county_modifier
	}
	##d_eregion
	title:c_arabrand = {
		add_county_modifier = elven_homeland_county_modifier
	}
	title:c_nin_in_eilph = {
		add_county_modifier = elven_homeland_county_modifier
	}
	title:c_ost_in_edhil = {
		add_county_modifier = elven_homeland_county_modifier
	}
	title:c_sirannon = {
		add_county_modifier = elven_homeland_county_modifier
	}
	##d_dor_tinuviel
	title:c_bar_i_dinuviel = {
		add_county_modifier = elven_homeland_county_modifier
	}
	title:c_baranduin = {
		add_county_modifier = elven_homeland_county_modifier
	}
	title:c_gladhith = {
		add_county_modifier = elven_homeland_county_modifier
	}
	title:c_harnelost = {
		add_county_modifier = elven_homeland_county_modifier
	}
	title:c_hartond = {
		add_county_modifier = elven_homeland_county_modifier
	}
	##d_dor_leithan
	title:c_talanobel = {
		add_county_modifier = elven_homeland_county_modifier
	}
	title:c_lanthir_lamath = {
		add_county_modifier = elven_homeland_county_modifier
	}
	title:c_danwaith = {
		add_county_modifier = elven_homeland_county_modifier
	}
	title:c_denethora = {
		add_county_modifier = elven_homeland_county_modifier
	}
	title:c_ardquetto = {
		add_county_modifier = elven_homeland_county_modifier
	}
	##d_dor_elvaedhorien
	title:c_caleneithel = {
		add_county_modifier = elven_homeland_county_modifier
	}
	title:c_gwaelad = {
		add_county_modifier = elven_homeland_county_modifier
	}
	title:c_halfalas = {
		add_county_modifier = elven_homeland_county_modifier
	}
	##d_ardolyalinya
	title:c_arkemar = {
		add_county_modifier = elven_homeland_county_modifier
	}
	title:c_dor_firn_i_guinar = {
		add_county_modifier = elven_homeland_county_modifier
	}
	title:c_harlond = {
		add_county_modifier = elven_homeland_county_modifier
	}
	title:c_lairiardhon = {
		add_county_modifier = elven_homeland_county_modifier
	}
	title:c_taerlorn = {
		add_county_modifier = elven_homeland_county_modifier
	}
	##d_mithlond
	title:c_dinfalas = {
		add_county_modifier = elven_homeland_county_modifier
	}
	title:c_dor_thalos = {
		add_county_modifier = elven_homeland_county_modifier
	}
	title:c_lond_in_telerrim = {
		add_county_modifier = elven_homeland_county_modifier
	}
	title:c_mithannunlond = {
		add_county_modifier = elven_homeland_county_modifier
	}
	title:c_mithrhulond = {
		add_county_modifier = elven_homeland_county_modifier
	}
	title:c_ronalindon = {
		add_county_modifier = elven_homeland_county_modifier
	}
	title:c_imladorn = {
		add_county_modifier = elven_homeland_county_modifier
	}
	##d_emyn_beraid
	title:c_harostirion = {
		add_county_modifier = elven_homeland_county_modifier
	}
	title:c_forostirion = {
		add_county_modifier = elven_homeland_county_modifier
	}
	title:c_elostirion = {
		add_county_modifier = elven_homeland_county_modifier
	}
	##d_duneriador
	title:c_lhun_i_nibben = {
		add_county_modifier = elven_homeland_county_modifier
	}
	title:c_naug_badamrun = {
		add_county_modifier = elven_homeland_county_modifier
	}
	title:c_emyn_dornhoth = {
		add_county_modifier = elven_homeland_county_modifier
	}
	title:c_nannuduin = {
		add_county_modifier = elven_homeland_county_modifier
	}
	title:c_nen_i_naugrim = {
		add_county_modifier = elven_homeland_county_modifier
	}
	title:c_ramb_luin = {
		add_county_modifier = elven_homeland_county_modifier
	}
	##d_geleidhien
	title:c_forast = {
		add_county_modifier = elven_homeland_county_modifier
	}
	title:c_amon_ereb = {
		add_county_modifier = elven_homeland_county_modifier
	}
	title:c_forlond = {
		add_county_modifier = elven_homeland_county_modifier
	}
	title:c_galfalas = {
		add_county_modifier = elven_homeland_county_modifier
	}
	title:c_nenthanc = {
		add_county_modifier = elven_homeland_county_modifier
	}
	title:c_taur_idur_in_enyd = {
		add_county_modifier = elven_homeland_county_modifier
	}
	title:c_ascaniriand = {
		add_county_modifier = elven_homeland_county_modifier
	}
	##d_estolad
	title:c_nibben = {
		add_county_modifier = elven_homeland_county_modifier
	}
	title:c_ras_toronion = {
		add_county_modifier = elven_homeland_county_modifier
	}
	title:c_manoriand = {
		add_county_modifier = elven_homeland_county_modifier
	}
	title:c_estoriand = {
		add_county_modifier = elven_homeland_county_modifier
	}
	title:c_edenathrad = {
		add_county_modifier = elven_homeland_county_modifier
	}
	title:c_uveduinore = {
		add_county_modifier = elven_homeland_county_modifier
	}
	##d_dor_gweydor
	title:c_eryn_luin = {
		add_county_modifier = elven_homeland_county_modifier
	}
	title:c_halethdyr = {
		add_county_modifier = elven_homeland_county_modifier
	}
	title:c_rhudranor = {
		add_county_modifier = elven_homeland_county_modifier
	}
	title:c_sandariand = {
		add_county_modifier = elven_homeland_county_modifier
	}
	title:c_seldoriand = {
		add_county_modifier = elven_homeland_county_modifier
	}
	title:c_brunmen_hadhod = {
		add_county_modifier = elven_homeland_county_modifier
	}
	##d_thargelion
	title:c_londolas = {
		add_county_modifier = elven_homeland_county_modifier
	}
	title:c_dor_maedhros = {
		add_county_modifier = elven_homeland_county_modifier
	}
	title:c_dor_maglor = {
		add_county_modifier = elven_homeland_county_modifier
	}
	title:c_helevorn = {
		add_county_modifier = elven_homeland_county_modifier
	}
	title:c_rhumbad = {
		add_county_modifier = elven_homeland_county_modifier
	}
	title:c_lothlann = {
		add_county_modifier = elven_homeland_county_modifier
	}
	title:c_tir_bronadui = {
		add_county_modifier = elven_homeland_county_modifier
	}
	##d_andunaloni
	title:c_himring = {
		add_county_modifier = elven_homeland_county_modifier
	}
	title:c_aeluin = {
		add_county_modifier = elven_homeland_county_modifier
	}
	title:c_anach = {
		add_county_modifier = elven_homeland_county_modifier
	}
	title:c_ladros = {
		add_county_modifier = elven_homeland_county_modifier
	}
	title:c_dorthonion = {
		add_county_modifier = elven_homeland_county_modifier
	}
	#k_drel
	#d_chelayana
	title:c_ainglad = {
		add_county_modifier = elven_homeland_county_modifier
	}
	title:c_alabgarda = {
		add_county_modifier = elven_homeland_county_modifier
	}
	title:c_elenka = {
		add_county_modifier = elven_homeland_county_modifier
	}
	title:c_ornekara = {
		add_county_modifier = elven_homeland_county_modifier
	}
	#d_cuindore
	title:c_cuinen = {
		add_county_modifier = elven_homeland_county_modifier
	}
	title:c_galadutor = {
		add_county_modifier = elven_homeland_county_modifier
	}
	title:c_omengoren = {
		add_county_modifier = elven_homeland_county_modifier
	}
	#d_galadartaure
	title:c_cuirissin = {
		add_county_modifier = elven_homeland_county_modifier
	}
	title:c_delanda = {
		add_county_modifier = elven_homeland_county_modifier
	}
	title:c_paladwath = {
		add_county_modifier = elven_homeland_county_modifier
	}
	title:c_taw_morna = {
		add_county_modifier = elven_homeland_county_modifier
	}
	#c_baranagath
	title:c_baranagath = {
		add_county_modifier = elven_homeland_county_modifier
	}
	#Kinn-Lai Usakan
	title:c_kelun = {
		add_county_modifier = elven_homeland_county_modifier
	}
	title:c_taullonn = {
		add_county_modifier = elven_homeland_county_modifier
	}
	title:c_balann_del = {
		add_county_modifier = elven_homeland_county_modifier
	}
	title:c_malna_tinn = {
		add_county_modifier = elven_homeland_county_modifier
	}
	title:c_eln_lai = {
		add_county_modifier = elven_homeland_county_modifier
	}
	title:c_unnalgald = {
		add_county_modifier = elven_homeland_county_modifier
	}
	title:c_unnaltinn = {
		add_county_modifier = elven_homeland_county_modifier
	}
	title:c_unnalolen = {
		add_county_modifier = elven_homeland_county_modifier
	}
	
	
}

initialise_elven_holdings = {
	every_county = {
		limit = {
			holder = {
				is_ai = no
				is_elf = yes
			}
		}
		set_county_culture = holder.culture
		set_county_faith = holder.faith
		every_province = {
			limit = { county = prev }
			if = {
				limit = {
					has_holding = yes
					NOT = { has_holding_type = elven_holding }
				}
				set_holding_type = elven_holding
			}
			if = {
				limit = { barony.holder = { is_elf = no } }
				create_character = {
					gender = male
					age = { 120 7030 }
					culture = root.culture
					faith = root.faith
					save_scope_as = new_holder
					location = barony.holder.location
				}
				barony = {
					create_title_and_vassal_change = {
						type = usurped
						save_scope_as = change
						add_claim_on_loss = no
					}
					change_title_holder = {
						holder = scope:new_holder
						change = scope:change
					}
					resolve_title_and_vassal_change = scope:change
				}
			}
		}
	}
}

convert_elven_holdings_effect = {
	every_sub_realm_county = {
		limit = {
			holder = {
				is_elf = yes
			}
		}
		set_county_culture = holder.culture
		set_county_faith = holder.faith
		every_province = {
			limit = { county = prev }
			if = {
				limit = {
					has_holding = yes
					NOT = { has_holding_type = elven_holding }
				}
				set_holding_type = elven_holding
			}
			if = {
				limit = { barony.holder = { is_elf = no } }
				create_character = {
					gender = male
					age = { 120 7030 }
					culture = root.culture
					faith = root.faith
					save_scope_as = new_holder
					location = barony.holder.location
				}
				barony = {
					create_title_and_vassal_change = {
						type = usurped
						save_scope_as = change
						add_claim_on_loss = no
					}
					change_title_holder = {
						holder = scope:new_holder
						change = scope:change
					}
					resolve_title_and_vassal_change = scope:change
				}
			}
		}
	}
	change_government = elven_government
}


vanquish_darkness_generate_new_holder_culture_and_faith = { #In Title Scope
	if = { # Gondor
		limit = {
			OR = {
				empire = title:e_gondor_steward
				empire = title:e_gondor
				empire = title:e_castamir
			}
		}
		culture:gondorian = { save_scope_as = holder_culture }
		faith:faith_edain = { save_scope_as = holder_faith }
	}
	else_if = { #Arnor or Orrostar
		limit = { 
			OR = {
				empire = title:e_arnor
				empire = title:e_orrostar
			}
		}
		culture:dunedain_ranger = { save_scope_as = holder_culture }
		faith:faith_edain = { save_scope_as = holder_faith }
	}
	else_if = { #Calenardhon
		limit = { empire = title:e_calenardhon }
		culture:rohirrim = { save_scope_as = holder_culture }
		faith:faith_rohirric = { save_scope_as = holder_faith }
	}
	else_if = { # Enedhwaith
		limit = { empire = title:e_enedhwaith }
		culture:enedhwaithrim = { save_scope_as = holder_culture }
		faith:faith_dunlending_turthalis = { save_scope_as = holder_faith }
	}
	else_if = { # Lothlorien/Greenwood
		limit = {
			OR = {
				empire = title:e_laurelindorenan
				empire = title:e_greenwood
			}
		}
		culture:woodmen = { save_scope_as = holder_culture }
		faith:faith_woodmen = { save_scope_as = holder_faith }
	}
	else_if = { # Anduin Vale
		limit = { empire = title:e_anduin_vale }
		culture:valemen = { save_scope_as = holder_culture }
		faith:faith_woodmen = { save_scope_as = holder_faith }
	}
	else_if = { # Rhovanion
		limit = { empire = title:e_rhovanion }
		culture:rhovannic = { save_scope_as = holder_culture }
		faith:faith_northmen = { save_scope_as = holder_faith }
	}
	else_if = { # Rhun
		limit = { empire = title:e_rhun }
		culture:igath = { save_scope_as = holder_culture }
		faith:faith_rhun_araw_triumvirate = { save_scope_as = holder_faith }
	}
	else_if = { # Mordor
		limit = { empire = title:e_mordor }
		culture:nurnoth = { save_scope_as = holder_culture }
		faith:faith_nurn_good = { save_scope_as = holder_faith }
	}
	else_if = { # Khand
		limit = { empire = title:e_khand }
		culture:variag = { save_scope_as = holder_culture }
		faith:faith_rhun_araw_triumvirate = { save_scope_as = holder_faith }
	}
	else_if = { # Haradwaith
		limit = { empire = title:e_haradwaith }
		culture:haruze = { save_scope_as = holder_culture }
		faith:faith_chelkar = { save_scope_as = holder_faith }
	}
	else_if = { # Dune Sea
		limit = { empire = title:e_dune_sea }
		culture:sand_people = { save_scope_as = holder_culture }
		faith:faith_iunast = { save_scope_as = holder_faith }
	}
	else_if = { # Nafarat
		limit = { empire = title:e_nafarat }
		culture:pust = { save_scope_as = holder_culture }
		faith:faith_iunast = { save_scope_as = holder_faith }
	}
	else_if = { # Umbar
		limit = { empire = title:e_umbar }
		culture:umbarean = { save_scope_as = holder_culture }
		faith:faith_edain = { save_scope_as = holder_faith }
	}
	else_if = { # Bellakar
		limit = { empire = title:e_bellakar }
		culture:bellakaze = { save_scope_as = holder_culture }
		faith:faith_infinite_wisdom = { save_scope_as = holder_faith }
	}
	else_if = { # Bozisha-Miraz
		limit = { empire = title:e_bozisha_miraz }
		culture:bozishnarud = { save_scope_as = holder_culture }
		faith:faith_honnin = { save_scope_as = holder_faith }
	}
	else_if = { # Thani-Hazad
		limit = { empire = title:e_thani_hazad }
		culture:kharadunaim = { save_scope_as = holder_culture }
		faith:faith_gimileth = { save_scope_as = holder_faith }
	}
	else_if = { # Mag Tumag
		limit = { empire = title:e_mag_tumag }
		culture:tumag = { save_scope_as = holder_culture }
		faith:faith_tamska_anjiru = { save_scope_as = holder_faith }
	}
	else_if = { # Usakan
		limit = { empire = title:e_usakan }
		culture:usakani = { save_scope_as = holder_culture }
		faith:faith_sederi = { save_scope_as = holder_faith }
	}
	else_if = { # Misty Mountains
		limit = { empire = title:e_misty_mountains }
		culture:longbeards = { save_scope_as = holder_culture }
		faith:faith_khazad = { save_scope_as = holder_faith }
	}
	else_if = { # Blue Mountains
		limit = { empire = title:e_blue_mountains }
		random_list = {
			50 = { culture:broadbeams = { save_scope_as = holder_culture } }
			50 = { culture:firebeards = { save_scope_as = holder_culture } }
		}
		faith:faith_broadbeams = { save_scope_as = holder_faith }
	}
	else_if = { # Iron Mountains
		limit = { empire = title:e_iron_mountains }
		culture:longbeards = { save_scope_as = holder_culture }
		faith:faith_khazad = { save_scope_as = holder_faith }
	}
	else_if = { # Yellow Mountains
		limit = { empire = title:e_yellow_mountains }
		culture:blacklocks = { save_scope_as = holder_culture }
		faith:faith_blacklocks = { save_scope_as = holder_faith }
	}
	else_if = { # Western Yellow Mountains
		limit = { empire = title:e_western_yellow_mountains }
		culture:blacklocks = { save_scope_as = holder_culture }
		faith:faith_blacklocks = { save_scope_as = holder_faith }
	}
	else_if = { # Nurunkizdin
		limit = { kingdom = title:k_nurunkizdin }
		culture:blacklocks = { save_scope_as = holder_culture }
		faith:faith_blacklocks = { save_scope_as = holder_faith }
	}
	else_if = { # Forodwaith
		limit = { empire = title:e_forodwaith }
		culture:lossoth = { save_scope_as = holder_culture }
		faith:faith_lossoth = { save_scope_as = holder_faith }
	}
	else = { #Fallback
		culture:gondorian = { save_scope_as = holder_culture }
		faith:faith_edain = { save_scope_as = holder_faith }
	}
}

dynasty_legacy_of_oropher_effects = {
	dynasty = {
		add_dynasty_modifier = {
			modifier = legacy_of_oropher_modifier
		}
		custom_tooltip = legacy_of_oropher_conversion_bonus
		add_dynasty_prestige = excessive_dynasty_prestige_gain
	}
}

dynasty_light_of_the_forest = {
	dynasty = {
		add_dynasty_modifier = {
			modifier = light_of_the_forest_modifier
			years = 50
		}
		add_dynasty_prestige = excessive_dynasty_prestige_gain
	}
}

add_new_elf_friendly_trait = {
	random_list = {
		1 = {
			trigger = { NOT = { has_trait = brave } }
			add_trait = brave
		}
		1 = {
			trigger = { NOT = { has_trait = craven } }
			add_trait = craven
		}
		1 = {
			trigger = { NOT = { has_trait = calm } }
			add_trait = calm
		}
		1 = {
			trigger = { NOT = { has_trait = chaste } }
			add_trait = chaste
		}
		1 = {
			trigger = { NOT = { has_trait = content } }
			add_trait = content
		}
		1 = {
			trigger = { NOT = { has_trait = ambitious } }
			add_trait = ambitious
		}
		1 = {
			trigger = { NOT = { has_trait = diligent } }
			add_trait = diligent
		}
		1 = {
			trigger = { NOT = { has_trait = lazy } }
			add_trait = lazy
		}
		1 = {
			trigger = { NOT = { has_trait = fickle } }
			add_trait = fickle
		}
		1 = {
			trigger = { NOT = { has_trait = stubborn } }
			add_trait = stubborn
		}
		1 = {
			trigger = { NOT = { has_trait = forgiving } }
			add_trait = forgiving
		}
		1 = {
			trigger = { NOT = { has_trait = vengeful } }
			add_trait = vengeful
		}
		1 = {
			trigger = { NOT = { has_trait = generous } }
			add_trait = generous
		}
		1 = {
			trigger = { NOT = { has_trait = greedy } }
			add_trait = greedy
		}
		1 = {
			trigger = { NOT = { has_trait = gregarious } }
			add_trait = gregarious
		}
		1 = {
			trigger = { NOT = { has_trait = shy } }
			add_trait = shy
		}
		1 = {
			trigger = { NOT = { has_trait = honest } }
			add_trait = honest
		}
		1 = {
			trigger = { NOT = { has_trait = humble } }
			add_trait = humble
		}
		1 = {
			trigger = { NOT = { has_trait = arrogant } }
			add_trait = arrogant
		}
		1 = {
			trigger = { NOT = { has_trait = just } }
			add_trait = just
		}
		1 = {
			trigger = { NOT = { has_trait = arbitrary } }
			add_trait = arbitrary
		}
		1 = {
			trigger = { NOT = { has_trait = patient } }
			add_trait = patient
		}
		1 = {
			trigger = { NOT = { has_trait = impatient } }
			add_trait = impatient
		}
		1 = {
			trigger = { NOT = { has_trait = temperate } }
			add_trait = temperate
		}
		1 = {
			trigger = { NOT = { has_trait = trusting } }
			add_trait = trusting
		}
		1 = {
			trigger = { NOT = { has_trait = paranoid } }
			add_trait = paranoid
		}
		1 = {
			trigger = { NOT = { has_trait = zealous } }
			add_trait = zealous
		}
		1 = {
			trigger = { NOT = { has_trait = compassionate } }
			add_trait = compassionate
		}
		1 = {
			trigger = { NOT = { has_trait = callous } }
			add_trait = callous
		}
	}
}

replace_unelven_traits = {
	if = {
		limit = { has_trait = deceitful }
		remove_trait = deceitful
		add_new_elf_friendly_trait = yes
	}
	if = {
		limit = { has_trait = lustful }
		remove_trait = lustful
		add_new_elf_friendly_trait = yes
	}
	if = {
		limit = { has_trait = gluttonous }
		remove_trait = gluttonous
		add_new_elf_friendly_trait = yes
	}
	if = {
		limit = { has_trait = cynical }
		remove_trait = cynical
		add_new_elf_friendly_trait = yes
	}
	if = {
		limit = { has_trait = sadistic }
		remove_trait = sadistic
		add_new_elf_friendly_trait = yes
	}
}

###############################################
### Scripted Effects for Maglor Event Chain ###
###############################################

maglor_crusade_elven_warriors = {
	if = {
		limit = { scope:elven_ruler.culture = culture:noldor }
		random_list = { # Noldor
			1 = { increase_variable = { NAME = noldor_veterans AMOUNT = $SUPPORT$ } }
			1 = { increase_variable = { NAME = noldor_cavalry AMOUNT = $SUPPORT$ } }
		}
	}
	else_if = {
		limit = { scope:elven_ruler.culture = culture:sindar }
		random_list = { # Sindar
			1 = { increase_variable = { NAME = falathrim_haven_guard AMOUNT = $SUPPORT$ } }
			1 = { increase_variable = { NAME = marchwardens AMOUNT = $SUPPORT$ } }
		}
	}
	else_if = {
		limit = { scope:elven_ruler.culture = culture:falathrim }
		random_list = { # Falathrim
			1 = { increase_variable = { NAME = hir_hathol AMOUNT = $SUPPORT$ } }
			1 = { increase_variable = { NAME = grey_elven_heavy_cavalry AMOUNT = $SUPPORT$ } }
		}
	}
	else_if = {
		limit = { scope:elven_ruler.culture = culture:laiquendi }
		random_list = { # Laiquendi
			1 = { increase_variable = { NAME = ossiriand_rangers AMOUNT = $SUPPORT$ } }
			1 = { increase_variable = { NAME = laiquendi_scouts AMOUNT = $SUPPORT$ } }
		}
	}
	else = {
		random_list = { # Noldor troops ||| Fallback
			1 = { increase_variable = { NAME = high_elven_heavy_cavalry AMOUNT = 1 } }
			1 = { increase_variable = { NAME = high_elven_archers AMOUNT = 1 } }
		}
	}
}

give_maglor_elven_warriors_effect = {
	if = {
		limit = { has_variable = noldor_veterans }
		spawn_army = {
			name = maglor_event_chain.0020.noldor_troops

			men_at_arms = {
				type = noldor_veterans
				stacks = var:noldor_veterans
			}
			location = root.capital_province
		}
		remove_variable = noldor_veterans
	}
	if = {
		limit = { has_variable = noldor_cavalry }
		spawn_army = {
			name = maglor_event_chain.0020.noldor_troops

			men_at_arms = {
				type = noldor_cavalry
				stacks = var:noldor_cavalry
			}
			location = root.capital_province
		}
		remove_variable = noldor_cavalry
	}
	if = {
		limit = { has_variable = falathrim_haven_guard }
		spawn_army = {
			name = maglor_event_chain.0020.falathrim_troops

			men_at_arms = {
				type = falathrim_haven_guard
				stacks = var:falathrim_haven_guard
			}
			location = root.capital_province
		}
	}
	if = {
		limit = { has_variable = marchwardens }
		spawn_army = {
			name = maglor_event_chain.0020.falathrim_troops

			men_at_arms = {
				type = marchwardens
				stacks = var:marchwardens
			}
			location = root.capital_province
		}
		remove_variable = marchwardens
	}
	if = {
		limit = { has_variable = hir_hathol }
		spawn_army = {
			name = maglor_event_chain.0020.sindar_troops

			men_at_arms = {
				type = hir_hathol
				stacks = var:hir_hathol
			}
			location = root.capital_province
		}
		remove_variable = hir_hathol
	}
	if = {
		limit = { has_variable = grey_elven_heavy_cavalry }
		spawn_army = {
			name = maglor_event_chain.0020.sindar_troops

			men_at_arms = {
				type = grey_elven_heavy_cavalry
				stacks = var:grey_elven_heavy_cavalry
			}
			location = root.capital_province
		}
		remove_variable = grey_elven_heavy_cavalry
	}
	if = {
		limit = { has_variable = ossiriand_rangers }
		spawn_army = {
			name = maglor_event_chain.0020.laiquendi_troops

			men_at_arms = {
				type = ossiriand_rangers
				stacks = var:ossiriand_rangers
			}
			location = root.capital_province
		}
		remove_variable = ossiriand_rangers
	}
	if = {
		limit = { has_variable = laiquendi_scouts }
		spawn_army = {
			name = maglor_event_chain.0020.laiquendi_troops

			men_at_arms = {
				type = laiquendi_scouts
				stacks = var:laiquendi_scouts
			}
			location = root.capital_province
		}
		remove_variable = laiquendi_scouts
	}
	if = {
		limit = { has_variable = high_elven_heavy_cavalry }
		spawn_army = {
			name = maglor_event_chain.0020.noldor_troops

			men_at_arms = {
				type = high_elven_heavy_cavalry
				stacks = var:high_elven_heavy_cavalry
			}
			location = root.capital_province
		}
		remove_variable = high_elven_heavy_cavalry
	}
	if = {
		limit = { has_variable = high_elven_archers }
		spawn_army = {
			name = maglor_event_chain.0020.noldor_troops

			men_at_arms = {
				type = high_elven_archers
				stacks = var:high_elven_archers
			}
			location = root.capital_province
		}
		remove_variable = high_elven_archers
	}
}

maglor_reclaim_moria = {
	create_title_and_vassal_change = {
		type = granted
		save_scope_as = change
		add_claim_on_loss = yes
	}
	title:d_zirakzigil = {
		change_title_holder = {
			holder = $NEW_HOLDER$
			change = scope:change
		}
		every_in_de_jure_hierarchy = {
			title_province = { set_holding_type = castle_holding }
			change_title_holder = {
				holder = $NEW_HOLDER$
				change = scope:change
			}
			set_county_faith = $NEW_HOLDER$.faith
			set_county_culture = $NEW_HOLDER$.culture
		}
	}
	title:d_barazinbar = {
		change_title_holder = {
			holder = $NEW_HOLDER$
			change = scope:change
		}
		every_in_de_jure_hierarchy = {
			title_province = { set_holding_type = castle_holding }
			change_title_holder = {
				holder = $NEW_HOLDER$
				change = scope:change
			}
			set_county_faith = $NEW_HOLDER$.faith
			set_county_culture = $NEW_HOLDER$.culture
		}
	}
	title:d_bundushathur = {
		change_title_holder = {
			holder = $NEW_HOLDER$
			change = scope:change
		}
		every_in_de_jure_hierarchy = {
			title_province = { set_holding_type = castle_holding }
			change_title_holder = {
				holder = $NEW_HOLDER$
				change = scope:change
			}
			set_county_faith = $NEW_HOLDER$.faith
			set_county_culture = $NEW_HOLDER$.culture
		}
	}
	resolve_title_and_vassal_change = scope:change

	$NEW_HOLDER$ = {
		every_held_title = { generate_coa = yes }
		get_title = title:k_khazad_dum
	}
}