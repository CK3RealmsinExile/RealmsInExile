###################################
###								  ###
###		Elven Situation Effects	  ###
###								  ###
###################################

# Move situation to the next phase according to current hope threshold
update_lorien_phase_effect = { # Lorien & Imladris
    if = {
        limit = {
            var:lorien_hope_value <= elven_fading_limit
        }
        every_situation_sub_region = {
            limit = {
                situation_sub_region_has_county = title:c_caras_galadhon
            }
            change_phase = { phase = situation_elven_fading }
        }
    }
    else_if = {
        limit = {
            AND = {
                var:lorien_hope_value <= elven_fading_limit
                var:lorien_hope_value > elven_waning_limit
            }
        }
        every_situation_sub_region = {
            limit = {
                situation_sub_region_has_county = title:c_caras_galadhon
            }
            change_phase = { phase = situation_elven_waning }
        }
    }
    else_if = {
        limit = {
            AND = {
                var:lorien_hope_value <= elven_enduring_limit
                var:lorien_hope_value > elven_waning_limit
            }
        }
        every_situation_sub_region = {
            limit = {
                situation_sub_region_has_county = title:c_caras_galadhon
            }
            change_phase = { phase = situation_elven_enduring }
        }
    }
    else_if = {
        limit = {
            AND = {
                var:lorien_hope_value <= elven_renewing_limit
                var:lorien_hope_value > elven_enduring_limit
            }
        }
        every_situation_sub_region = {
            limit = {
                situation_sub_region_has_county = title:c_caras_galadhon
            }
            change_phase = { phase = situation_elven_renewing }
        }
    }
    else_if = {
        limit = {
            AND = {
                var:lorien_hope_value <= elven_thriving_limit
                var:lorien_hope_value > elven_renewing_limit
            }
        }
        every_situation_sub_region = {
            limit = {
                situation_sub_region_has_county = title:c_caras_galadhon
            }
            change_phase = { phase = situation_elven_thriving }
        }
    }
}

update_lindon_phase_effect = { # Lindon
    if = {
        limit = {
            var:lindon_hope_value <= elven_fading_limit
        }
        every_situation_sub_region = {
            limit = {
                situation_sub_region_has_county = title:c_mithrhulond
            }
            change_phase = { phase = situation_elven_fading }
        }
    }
    else_if = {
        limit = {
            AND = {
                var:lindon_hope_value <= elven_waning_limit
                var:lindon_hope_value > elven_fading_limit
            }
        }
        every_situation_sub_region = {
            limit = {
                situation_sub_region_has_county = title:c_mithrhulond
            }
            change_phase = { phase = situation_elven_waning }
        }
    }
    else_if = {
        limit = {
            AND = {
                var:lindon_hope_value <= elven_enduring_limit
                var:lindon_hope_value > elven_waning_limit
            }
        }
        every_situation_sub_region = {
            limit = {
                situation_sub_region_has_county = title:c_mithrhulond
            }
            change_phase = { phase = situation_elven_enduring }
        }
    }
    else_if = {
        limit = {
            AND = {
                var:lindon_hope_value <= elven_renewing_limit
                var:lindon_hope_value > elven_enduring_limit
            }
        }
        every_situation_sub_region = {
            limit = {
                situation_sub_region_has_county = title:c_mithrhulond
            }
            change_phase = { phase = situation_elven_renewing }
        }
    }
    else_if = {
        limit = {
            AND = {
                var:lindon_hope_value <= elven_thriving_limit
                var:lindon_hope_value > elven_renewing_limit
            }
        }
        every_situation_sub_region = {
            limit = {
                situation_sub_region_has_county = title:c_mithrhulond
            }
            change_phase = { phase = situation_elven_thriving }
        }
    }
}

update_greenwood_phase_effect = { # Greenwood
    if = {
        limit = {
            var:greenwood_hope_value <= elven_fading_limit
        }
        every_situation_sub_region = {
            limit = {
                situation_sub_region_has_county = title:c_aradhrynd
            }
            change_phase = { phase = situation_elven_fading }
        }
    }
    else_if = {
        limit = {
            AND = {
                var:greenwood_hope_value <= elven_waning_limit
                var:greenwood_hope_value > elven_fading_limit
            }
        }
        every_situation_sub_region = {
            limit = {
                situation_sub_region_has_county = title:c_aradhrynd
            }
            change_phase = { phase = situation_elven_waning }
        }
    }
    else_if = {
        limit = {
            AND = {
                var:greenwood_hope_value <= elven_enduring_limit
                var:greenwood_hope_value > elven_waning_limit
            }
        }
        every_situation_sub_region = {
            limit = {
                situation_sub_region_has_county = title:c_aradhrynd
            }
            change_phase = { phase = situation_elven_enduring }
        }
    }
    else_if = {
        limit = {
            AND = {
                var:greenwood_hope_value <= elven_renewing_limit
                var:greenwood_hope_value > elven_enduring_limit
            }
        }
        every_situation_sub_region = {
            limit = {
                situation_sub_region_has_county = title:c_aradhrynd
            }
            change_phase = { phase = situation_elven_renewing }
        }
    }
    else_if = {
        limit = {
            AND = {
                var:greenwood_hope_value <= elven_thriving_limit
                var:greenwood_hope_value > elven_renewing_limit
            }
        }
        every_situation_sub_region = {
            limit = {
                situation_sub_region_has_county = title:c_aradhrynd
            }
            change_phase = { phase = situation_elven_thriving }
        }
    }
}

# Remove excess hope
remove_excess_hope_effect = {
    if = {
        limit = {
            var:lorien_hope_value > elven_thriving_limit
        }
        set_variable = {
            name = lorien_hope_value
            value = elven_thriving_limit
        }
    }
    if = {
        limit = {
            var:lindon_hope_value > elven_thriving_limit
        }
        set_variable = {
            name = lindon_hope_value
            value = elven_thriving_limit
        }
    }
    if = {
        limit = {
            var:greenwood_hope_value > elven_thriving_limit
        }
        set_variable = {
            name = greenwood_hope_value
            value = elven_thriving_limit
        }
    }
}

# Add hope through effect
add_elven_hope_effect = {
    every_character_situation = {
        limit = { has_variable = lorien_hope_value }
        save_scope_as = lorien_situation
    }
    every_character_situation = {
        limit = { has_variable = lindon_hope_value }
        save_scope_as = lindon_situation
    }
    every_character_situation = {
        limit = { has_variable = greenwood_hope_value }
        save_scope_as = greenwood_situation
    }

    if = {
        limit = {
            capital_county.title_province = {
                OR = {
                    geographical_region = middleearth_west_rhovanion_lothlorien
                    geographical_region = middleearth_west_eregion
                }
            }
        }
        scope:lorien_situation = {
            change_variable = {
                name = lorien_hope_value
                add = $VALUE$
            }
        }
        create_elven_catalyst_for_history = {
            VALUE = $VALUE$
            HOPE_EFFECT = $HOPE_EFFECT$
            SITUATION_REGION = lorien_situation
            POSITIVE_OR_NEGATIVE = positive_effect
        }
    }
    else_if = {
        limit = {
            capital_county.title_province = {
                geographical_region = middleearth_west_beleriand
            }
        }
        scope:lindon_situation = {
            change_variable = {
                name = lindon_hope_value
                add = $VALUE$
            }
        }
        create_elven_catalyst_for_history = {
            VALUE = $VALUE$
            HOPE_EFFECT = $HOPE_EFFECT$
            SITUATION_REGION = lindon_situation
            POSITIVE_OR_NEGATIVE = positive_effect
        }
    }
    else_if = {
        limit = {
            capital_county.title_province = {
                geographical_region = middleearth_west_rhovanion_mirkwood
            }
        }
        scope:greenwood_situation = {
            change_variable = {
                name = greenwood_hope_value
                add = $VALUE$
            }
        }
        create_elven_catalyst_for_history = {
            VALUE = $VALUE$
            HOPE_EFFECT = $HOPE_EFFECT$
            SITUATION_REGION = greenwood_situation
            POSITIVE_OR_NEGATIVE = positive_effect
        }
    }
    custom_description = { text = add_elven_hope_desc value = $VALUE$ }
}

# Subtract hope through effect
subtract_elven_hope_effect = {
    every_character_situation = {
        limit = { has_variable = lorien_hope_value }
        save_scope_as = lorien_situation
    }
    every_character_situation = {
        limit = { has_variable = lindon_hope_value }
        save_scope_as = lindon_situation
    }
    every_character_situation = {
        limit = { has_variable = greenwood_hope_value }
        save_scope_as = greenwood_situation
    }


    if = {
        limit = {
            capital_county.title_province = {
                OR = {
                    geographical_region = middleearth_west_rhovanion_lothlorien
                    geographical_region = middleearth_west_eregion
                }
            }
        }
        scope:lorien_situation = {
            change_variable = {
                name = lorien_hope_value
                subtract = $VALUE$
            }
        }
        create_elven_catalyst_for_history = {
            VALUE = $VALUE$
            HOPE_EFFECT = $HOPE_EFFECT$
            SITUATION_REGION = lorien_situation
            POSITIVE_OR_NEGATIVE = negative_effect
        }
    }
    else_if = {
        limit = {
            capital_county.title_province = {
                geographical_region = middleearth_west_beleriand
            }
        }
        scope:lindon_situation = {
            change_variable = {
                name = lindon_hope_value
                subtract = $VALUE$
            }
        }
        create_elven_catalyst_for_history = {
            VALUE = $VALUE$
            HOPE_EFFECT = $HOPE_EFFECT$
            SITUATION_REGION = lindon_situation
            POSITIVE_OR_NEGATIVE = negative_effect
        }
    }
    else_if = {
        limit = {
            capital_county.title_province = {
                geographical_region = middleearth_west_rhovanion_mirkwood
            }
        }
        scope:greenwood_situation = {
            change_variable = {
                name = greenwood_hope_value
                subtract = $VALUE$
            }
            add_to_variable_list = {
                name = greenwood_hope_changes
                target = $HOPE_EFFECT$
            }
        }
        create_elven_catalyst_for_history = {
            VALUE = $VALUE$
            HOPE_EFFECT = $HOPE_EFFECT$
            SITUATION_REGION = greenwood_situation
            POSITIVE_OR_NEGATIVE = negative_effect
        }
    }
    custom_description = { text = subtract_elven_hope_desc value = $VALUE$ }
}

# Apply development penalty when hope is low
check_elven_development_penalties_effect = {
    every_situation_sub_region = {
        every_situation_sub_region_participant = {
            limit = { is_independent_ruler = yes }
            trigger_event = {
                id = elven_hope.0020
                months = { 2 10 }
            }
        }
    }
}

create_elven_catalyst_for_history = {
    set_variable = {
        name = elven_hope_catalyst_loc_value
        value = $VALUE$
    }
    set_variable = {
        name = elven_hope_catalyst_loc_key
        value = flag:$HOPE_EFFECT$
    }
    set_variable = {
        name = elven_hope_catalyst_specific_situation
        value = scope:$SITUATION_REGION$
    }
    set_variable = {
        name = elven_hope_catalyst_positive_or_negative
        value = flag:$POSITIVE_OR_NEGATIVE$
    }

    create_story = story_elven_hope_catalyst
    random_owned_story = {
        limit = {
            save_temporary_scope_as = this_story

            NOT = {
                scope:$SITUATION_REGION$ = {
                    is_target_in_variable_list = {
                        name = region_$SITUATION_REGION$_localization
                        target = scope:this_story
                    }
                }
            }
        }
        scope:$SITUATION_REGION$ = {
            add_to_variable_list = {
                name = region_$SITUATION_REGION$_localization
                target = prev
                years = 5
            }
        }
    }
    remove_variable = elven_hope_catalyst_loc_key
    remove_variable = elven_hope_catalyst_loc_value
    remove_variable = elven_hope_catalyst_specific_situation
}

### Debug Effects ###

add_elven_hope_debug = {
    subtract_elven_hope_effect = { VALUE = 100 HOPE_EFFECT = effect_elven_very_high_hope }
}


###################################
###								  ###
###   Mirkwood Situation Effects  ###
###								  ###
###################################

update_mirkwood_monthly_phase_effect = {
    update_aradhrynd_phase_effect = yes
    update_taurduin_phase_effect = yes
    update_taur_nu_fuin_phase_effect = yes
    update_emyn_i_firith_phase_effect = yes
    update_nivrim_phase_effect = yes
    update_dundaedelu_phase_effect = yes
    update_angaladh_rhunen_phase_effect = yes
    update_men_i_naugrim_phase_effect = yes
    update_gwath_anglennol_phase_effect = yes
    update_taur_e_ndaedlos_phase_effect = yes
    update_amon_lanc_phase_effect = yes
}

# Add hope through effect
add_corruption_effect = {
    every_character_situation = {
        limit = { has_variable = aradhrynd_corruption_value }
        save_scope_as = aradhrynd_situation
    }
    every_character_situation = {
        limit = { has_variable = taurduin_corruption_value }
        save_scope_as = taurduin_situation
    }
    every_character_situation = {
        limit = { has_variable = taur_nu_fuin_corruption_value }
        save_scope_as = taur_nu_fuin_situation
    }
    every_character_situation = {
        limit = { has_variable = emyn_i_firith_corruption_value }
        save_scope_as = emyn_i_firith_situation
    }
    every_character_situation = {
        limit = { has_variable = nivrim_corruption_value }
        save_scope_as = nivrim_situation
    }
    every_character_situation = {
        limit = { has_variable = dundaedelu_corruption_value }
        save_scope_as = dundaedelu_situation
    }
    every_character_situation = {
        limit = { has_variable = angaladh_rhunen_corruption_value }
        save_scope_as = angaladh_rhunen_situation
    }
    every_character_situation = {
        limit = { has_variable = men_i_naugrim_corruption_value }
        save_scope_as = men_i_naugrim_situation
    }
    every_character_situation = {
        limit = { has_variable = gwath_anglennol_corruption_value }
        save_scope_as = gwath_anglennol_situation
    }
    every_character_situation = {
        limit = { has_variable = taur_e_ndaedlos_corruption_value }
        save_scope_as = taur_e_ndaedlos_situation
    }
    every_character_situation = {
        limit = { has_variable = amon_lanc_corruption_value }
        save_scope_as = amon_lanc_situation
    }
    if = {
        limit = {
            situation_sub_region:$SITUATION_REGION$ = situation_sub_region:aradhrynd
        }
        scope:aradhrynd_situation = {
            change_variable = {
                name = aradhrynd_corruption_value
                add = $VALUE$
            }
        }
    }
    else_if = {
        limit = {
            situation_sub_region:$SITUATION_REGION$ = situation_sub_region:taurduin
        }
        scope:taurduin_situation = {
            change_variable = {
                name = taurduin_corruption_value
                add = $VALUE$
            }
        }
    }
    else_if = {
        limit = {
            situation_sub_region:$SITUATION_REGION$ = situation_sub_region:taur_nu_fuin
        }
        scope:taur_nu_fuin_situation = {
            change_variable = {
                name = taur_nu_fuin_corruption_value
                add = $VALUE$
            }
        }
    }
    else_if = {
        limit = {
            situation_sub_region:$SITUATION_REGION$ = situation_sub_region:taur_nu_fuin
        }
        scope:taur_nu_fuin_situation = {
            change_variable = {
                name = taur_nu_fuin_corruption_value
                add = $VALUE$
            }
        }
    }
    else_if = {
        limit = {
            situation_sub_region:$SITUATION_REGION$ = situation_sub_region:taur_nu_fuin
        }
        scope:taur_nu_fuin_situation = {
            change_variable = {
                name = taur_nu_fuin_corruption_value
                add = $VALUE$
            }
        }
    }
    else_if = {
        limit = {
            situation_sub_region:$SITUATION_REGION$ = situation_sub_region:emyn_i_firith
        }
        scope:emyn_i_firith_situation = {
            change_variable = {
                name = emyn_i_firith_corruption_value
                add = $VALUE$
            }
        }
    }
    else_if = {
        limit = {
            situation_sub_region:$SITUATION_REGION$ = situation_sub_region:nivrim
        }
        scope:nivrim_situation = {
            change_variable = {
                name = nivrim_corruption_value
                add = $VALUE$
            }
        }
    }
    else_if = {
        limit = {
            situation_sub_region:$SITUATION_REGION$ = situation_sub_region:dundaedelu
        }
        scope:dundaedelu_situation = {
            change_variable = {
                name = dundaedelu_corruption_value
                add = $VALUE$
            }
        }
    }
    else_if = {
        limit = {
            situation_sub_region:$SITUATION_REGION$ = situation_sub_region:angaladh_rhunen
        }
        scope:angaladh_rhunen_situation = {
            change_variable = {
                name = angaladh_rhunen_corruption_value
                add = $VALUE$
            }
        }
    }
    else_if = {
        limit = {
            situation_sub_region:$SITUATION_REGION$ = situation_sub_region:men_i_naugrim
        }
        scope:men_i_naugrim_situation = {
            change_variable = {
                name = men_i_naugrim_corruption_value
                add = $VALUE$
            }
        }
    }
    else_if = {
        limit = {
            situation_sub_region:$SITUATION_REGION$ = situation_sub_region:gwath_anglennol
        }
        scope:gwath_anglennol_situation = {
            change_variable = {
                name = gwath_anglennol_corruption_value
                add = $VALUE$
            }
        }
    }
    else_if = {
        limit = {
            situation_sub_region:$SITUATION_REGION$ = situation_sub_region:taur_e_ndaedlos
        }
        scope:taur_e_ndaedlos_situation = {
            change_variable = {
                name = taur_e_ndaedlos_corruption_value
                add = $VALUE$
            }
        }
    }
    else_if = {
        limit = {
            situation_sub_region:$SITUATION_REGION$ = situation_sub_region:amon_lanc
        }
        scope:amon_lanc_situation = {
            change_variable = {
                name = amon_lanc_corruption_value
                add = $VALUE$
            }
        }
    }
    custom_description = { text = add_corruption_desc value = $VALUE$ }
}

subtract_corruption_effect = {
    every_character_situation = {
        limit = { has_variable = aradhrynd_corruption_value }
        save_scope_as = aradhrynd_situation
    }
    every_character_situation = {
        limit = { has_variable = taurduin_corruption_value }
        save_scope_as = taurduin_situation
    }
    every_character_situation = {
        limit = { has_variable = taur_nu_fuin_corruption_value }
        save_scope_as = taur_nu_fuin_situation
    }
    every_character_situation = {
        limit = { has_variable = emyn_i_firith_corruption_value }
        save_scope_as = emyn_i_firith_situation
    }
    every_character_situation = {
        limit = { has_variable = nivrim_corruption_value }
        save_scope_as = nivrim_situation
    }
    every_character_situation = {
        limit = { has_variable = dundaedelu_corruption_value }
        save_scope_as = dundaedelu_situation
    }
    every_character_situation = {
        limit = { has_variable = angaladh_rhunen_corruption_value }
        save_scope_as = angaladh_rhunen_situation
    }
    every_character_situation = {
        limit = { has_variable = men_i_naugrim_corruption_value }
        save_scope_as = men_i_naugrim_situation
    }
    every_character_situation = {
        limit = { has_variable = gwath_anglennol_corruption_value }
        save_scope_as = gwath_anglennol_situation
    }
    every_character_situation = {
        limit = { has_variable = taur_e_ndaedlos_corruption_value }
        save_scope_as = taur_e_ndaedlos_situation
    }
    every_character_situation = {
        limit = { has_variable = amon_lanc_corruption_value }
        save_scope_as = amon_lanc_situation
    }
    if = {
        limit = {
            $SITUATION_REGION$ = situation_sub_region:aradhrynd
        }
        scope:aradhrynd_situation = {
            change_variable = {
                name = aradhrynd_corruption_value
                subtract = $VALUE$
            }
        }
    }
    else_if = {
        limit = {
            $SITUATION_REGION$ = situation_sub_region:taurduin
        }
        scope:taurduin_situation = {
            change_variable = {
                name = taurduin_corruption_value
                subtract = $VALUE$
            }
        }
    }
    else_if = {
        limit = {
            $SITUATION_REGION$ = situation_sub_region:taur_nu_fuin
        }
        scope:taur_nu_fuin_situation = {
            change_variable = {
                name = taur_nu_fuin_corruption_value
                subtract = $VALUE$
            }
        }
    }
    else_if = {
        limit = {
            $SITUATION_REGION$ = situation_sub_region:taur_nu_fuin
        }
        scope:taur_nu_fuin_situation = {
            change_variable = {
                name = taur_nu_fuin_corruption_value
                subtract = $VALUE$
            }
        }
    }
    else_if = {
        limit = {
            $SITUATION_REGION$ = situation_sub_region:taur_nu_fuin
        }
        scope:taur_nu_fuin_situation = {
            change_variable = {
                name = taur_nu_fuin_corruption_value
                subtract = $VALUE$
            }
        }
    }
    else_if = {
        limit = {
            $SITUATION_REGION$ = situation_sub_region:emyn_i_firith
        }
        scope:emyn_i_firith_situation = {
            change_variable = {
                name = emyn_i_firith_corruption_value
                subtract = $VALUE$
            }
        }
    }
    else_if = {
        limit = {
            $SITUATION_REGION$ = situation_sub_region:nivrim
        }
        scope:nivrim_situation = {
            change_variable = {
                name = nivrim_corruption_value
                subtract = $VALUE$
            }
        }
    }
    else_if = {
        limit = {
            $SITUATION_REGION$ = situation_sub_region:dundaedelu
        }
        scope:dundaedelu_situation = {
            change_variable = {
                name = dundaedelu_corruption_value
                subtract = $VALUE$
            }
        }
    }
    else_if = {
        limit = {
            $SITUATION_REGION$ = situation_sub_region:angaladh_rhunen
        }
        scope:angaladh_rhunen_situation = {
            change_variable = {
                name = angaladh_rhunen_corruption_value
                subtract = $VALUE$
            }
        }
    }
    else_if = {
        limit = {
            $SITUATION_REGION$ = situation_sub_region:men_i_naugrim
        }
        scope:men_i_naugrim_situation = {
            change_variable = {
                name = men_i_naugrim_corruption_value
                subtract = $VALUE$
            }
        }
    }
    else_if = {
        limit = {
            $SITUATION_REGION$ = situation_sub_region:gwath_anglennol
        }
        scope:gwath_anglennol_situation = {
            change_variable = {
                name = gwath_anglennol_corruption_value
                subtract = $VALUE$
            }
        }
    }
    else_if = {
        limit = {
            $SITUATION_REGION$ = situation_sub_region:taur_e_ndaedlos
        }
        scope:taur_e_ndaedlos_situation = {
            change_variable = {
                name = taur_e_ndaedlos_corruption_value
                subtract = $VALUE$
            }
        }
    }
    else_if = {
        limit = {
            $SITUATION_REGION$ = situation_sub_region:amon_lanc
        }
        scope:amon_lanc_situation = {
            change_variable = {
                name = amon_lanc_corruption_value
                subtract = $VALUE$
            }
        }
    }
    custom_description = { text = add_corruption_desc value = $VALUE$ }
}

# Rebuilds the list of "active" sub-regions on the situation scope
mkw_refresh_active_subregions_effect = {
    # root = situation
    remove_variable = aradhrynd_is_active
    remove_variable = taurduin_is_active
    remove_variable = taur_nu_fuin_is_active
    remove_variable = emyn_i_firith_is_active
    remove_variable = nivrim_is_active
    remove_variable = dundaedelu_is_active
    remove_variable = angaladh_rhunen_is_active
    remove_variable = men_i_naugrim_is_active
    remove_variable = gwath_anglennol_is_active
    remove_variable = taur_e_ndaedlos_is_active
    remove_variable = amon_lanc_is_active

    remove_variable = aradhrynd_fully_corrupted
    remove_variable = taurduin_fully_corrupted
    remove_variable = taur_nu_fuin_fully_corrupted
    remove_variable = emyn_i_firith_fully_corrupted
    remove_variable = nivrim_fully_corrupted
    remove_variable = dundaedelu_fully_corrupted
    remove_variable = angaladh_rhunen_fully_corrupted
    remove_variable = men_i_naugrim_fully_corrupted
    remove_variable = gwath_anglennol_fully_corrupted
    remove_variable = taur_e_ndaedlos_fully_corrupted
    remove_variable = amon_lanc_fully_corrupted

    # Aradhrynd
    if = {
        limit = { mkw_aradhrynd_is_active = yes }
        set_variable = { name = aradhrynd_is_active value = yes }
        add_to_list = {
            name = active_mirkwood_regions
            value = situation_sub_region:aradhrynd
        }
    }
    # Taurduin
    if = {
        limit = { mkw_taurduin_is_active = yes }
        set_variable = { name = taurduin_is_active value = yes }
        add_to_list = {
            name = active_mirkwood_regions
            value = situation_sub_region:taurduin
        }
    }
    # Taur-nu-Fuin
    if = {
        limit = { mkw_taur_nu_fuin_is_active = yes }
        set_variable = { name = taur_nu_fuin_is_active value = yes }
        add_to_list = {
            name = active_mirkwood_regions
            value = situation_sub_region:taur_nu_fuin
        }
    }
    # Emyn-i-Firith
    if = {
        limit = { mkw_emyn_i_firith_is_active = yes }
        set_variable = { name = emyn_i_firith_is_active value = yes }
        add_to_list = {
            name = active_mirkwood_regions
            value = situation_sub_region:emyn_i_firith
        }
    }
    # Nivrim
    if = {
        limit = { mkw_nivrim_is_active = yes }
        set_variable = { name = nivrim_is_active value = yes }
        add_to_list = {
            name = active_mirkwood_regions
            value = situation_sub_region:nivrim
        }
    }
    # Dundaedelu
    if = {
        limit = { mkw_dundaedelu_is_active = yes }
        set_variable = { name = dundaedelu_is_active value = yes }
        add_to_list = {
            name = active_mirkwood_regions
            value = situation_sub_region:dundaedelu
        }
    }
    # Angaladh Rhunen
    if = {
        limit = { mkw_angaladh_rhunen_is_active = yes }
        set_variable = { name = angaladh_rhunen_is_active value = yes }
        add_to_list = {
            name = active_mirkwood_regions
            value = situation_sub_region:angaladh_rhunen
        }
    }
    # Men-i-Naugrim
    if = {
        limit = { mkw_men_i_naugrim_is_active = yes }
        set_variable = { name = men_i_naugrim_is_active value = yes }
        add_to_list = {
            name = active_mirkwood_regions
            value = situation_sub_region:men_i_naugrim
        }
    }
    # Gwath Anglennol
    if = {
        limit = { mkw_gwath_anglennol_is_active = yes }
        set_variable = { name = gwath_anglennol_is_active value = yes }
        add_to_list = {
            name = active_mirkwood_regions
            value = situation_sub_region:gwath_anglennol
        }
    }
    # Taur-e-Ndaedlos
    if = {
        limit = { mkw_taur_e_ndaedlos_is_active = yes }
        set_variable = { name = taur_e_ndaedlos_is_active value = yes }
        add_to_list = {
            name = active_mirkwood_regions
            value = situation_sub_region:taur_e_ndaedlos
        }
    }
    # Amon Lanc
    if = {
        limit = { mkw_amon_lanc_is_active = yes }
        set_variable = { name = amon_lanc_is_active value = yes }
        add_to_list = {
            name = active_mirkwood_regions
            value = situation_sub_region:amon_lanc
        }
    }

    # Fully Corrupted
    if = {
        limit = { mkw_aradhrynd_is_fully_corrupted = yes }
        set_variable = { name = aradhrynd_fully_corrupted value = yes }
    }
    if = {
        limit = { mkw_taurduin_is_fully_corrupted = yes }
        set_variable = { name = taurduin_fully_corrupted value = yes }
    }
    if = {
        limit = { mkw_taur_nu_fuin_is_fully_corrupted = yes }
        set_variable = { name = taur_nu_fuin_fully_corrupted value = yes }
    }
    if = {
        limit = { mkw_emyn_i_firith_is_fully_corrupted = yes }
        set_variable = { name = emyn_i_firith_fully_corrupted value = yes }
    }
    if = {
        limit = { mkw_nivrim_is_fully_corrupted = yes }
        set_variable = { name = nivrim_fully_corrupted value = yes }
    }
    if = {
        limit = { mkw_dundaedelu_is_fully_corrupted = yes }
        set_variable = { name = dundaedelu_fully_corrupted value = yes }
    }
    if = {
        limit = { mkw_angaladh_rhunen_is_fully_corrupted = yes }
        set_variable = { name = angaladh_rhunen_fully_corrupted value = yes }
    }
    if = {
        limit = { mkw_men_i_naugrim_is_fully_corrupted = yes }
        set_variable = { name = men_i_naugrim_fully_corrupted value = yes }
    }
    if = {
        limit = { mkw_gwath_anglennol_is_fully_corrupted = yes }
        set_variable = { name = gwath_anglennol_fully_corrupted value = yes }
    }
    if = {
        limit = { mkw_taur_e_ndaedlos_is_fully_corrupted = yes }
        set_variable = { name = taur_e_ndaedlos_fully_corrupted value = yes }
    }
    if = {
        limit = { mkw_amon_lanc_is_fully_corrupted = yes }
        set_variable = { name = amon_lanc_fully_corrupted value = yes }
    }
}
remove_excess_corruption_effect = {
    if = {
        limit = {
            var:aradhrynd_corruption_value > corruption_web_of_night_limit
        }
        set_variable = {
            name = aradhrynd_corruption_value
            value = corruption_web_of_night_limit
        }
    }
    if = {
        limit = {
            var:taurduin_corruption_value > corruption_web_of_night_limit
        }
        set_variable = {
            name = taurduin_corruption_value
            value = corruption_web_of_night_limit
        }
    }
    if = {
        limit = {
            var:taur_nu_fuin_corruption_value > corruption_web_of_night_limit
        }
        set_variable = {
            name = taur_nu_fuin_corruption_value
            value = corruption_web_of_night_limit
        }
    }
    if = {
        limit = {
            var:emyn_i_firith_corruption_value > corruption_web_of_night_limit
        }
        set_variable = {
            name = emyn_i_firith_corruption_value
            value = corruption_web_of_night_limit
        }
    }
    if = {
        limit = {
            var:nivrim_corruption_value > corruption_web_of_night_limit
        }
        set_variable = {
            name = nivrim_corruption_value
            value = corruption_web_of_night_limit
        }
    }
    if = {
        limit = {
            var:dundaedelu_corruption_value > corruption_web_of_night_limit
        }
        set_variable = {
            name = dundaedelu_corruption_value
            value = corruption_web_of_night_limit
        }
    }
    if = {
        limit = {
            var:angaladh_rhunen_corruption_value > corruption_web_of_night_limit
        }
        set_variable = {
            name = angaladh_rhunen_corruption_value
            value = corruption_web_of_night_limit
        }
    }
    if = {
        limit = {
            var:men_i_naugrim_corruption_value > corruption_web_of_night_limit
        }
        set_variable = {
            name = men_i_naugrim_corruption_value
            value = corruption_web_of_night_limit
        }
    }
    if = {
        limit = {
            var:gwath_anglennol_corruption_value > corruption_web_of_night_limit
        }
        set_variable = {
            name = gwath_anglennol_corruption_value
            value = corruption_web_of_night_limit
        }
    }
    if = {
        limit = {
            var:taur_e_ndaedlos_corruption_value > corruption_web_of_night_limit
        }
        set_variable = {
            name = taur_e_ndaedlos_corruption_value
            value = corruption_web_of_night_limit
        }
    }
    if = {
        limit = {
            var:amon_lanc_corruption_value > corruption_web_of_night_limit
        }
        set_variable = {
            name = amon_lanc_corruption_value
            value = corruption_web_of_night_limit
        }
    }
}

update_aradhrynd_phase_effect = {
    if = {
        limit = {
            var:aradhrynd_corruption_value <= corruption_untainted_limit
        }
        every_situation_sub_region = {
            limit = {
                situation_sub_region_has_county = title:c_aradhrynd
            }
            change_phase = { phase = untainted_wood }
        }
    }
    else_if = {
        limit = {
            AND = {
                var:aradhrynd_corruption_value >= corruption_untainted_limit
                var:aradhrynd_corruption_value <= corruption_whispers_in_the_leaves_limit
            }
        }
        every_situation_sub_region = {
            limit = {
                situation_sub_region_has_county = title:c_aradhrynd
            }
            change_phase = { phase = whispers_in_the_leaves }
        }
    }
    else_if = {
        limit = {
            AND = {
                var:aradhrynd_corruption_value >= corruption_whispers_in_the_leaves_limit
                var:aradhrynd_corruption_value <= corruption_withering_shade_limit
            }
        }
        every_situation_sub_region = {
            limit = {
                situation_sub_region_has_county = title:c_aradhrynd
            }
            change_phase = { phase = the_withering_shade }
        }
    }
    else_if = {
        limit = {
            AND = {
                var:aradhrynd_corruption_value >= corruption_withering_shade_limit
                var:aradhrynd_corruption_value <= corruption_shadows_grasp_limit
            }
        }
        every_situation_sub_region = {
            limit = {
                situation_sub_region_has_county = title:c_aradhrynd
            }
            change_phase = { phase = shadows_grasp }
        }
    }
    else_if = {
        limit = {
            AND = {
                var:aradhrynd_corruption_value >= corruption_shadows_grasp_limit
                var:aradhrynd_corruption_value <= corruption_web_of_night_limit
            }
        }
        every_situation_sub_region = {
            limit = {
                situation_sub_region_has_county = title:c_aradhrynd
            }
            change_phase = { phase = the_web_of_night }
        }
    }
}

update_taurduin_phase_effect = {
    if = {
        limit = {
            var:taurduin_corruption_value <= corruption_untainted_limit
        }
        every_situation_sub_region = {
            limit = {
                situation_sub_region_has_county = title:c_haudh_en_aiganaur
            }
            change_phase = { phase = untainted_wood }
        }
    }
    else_if = {
        limit = {
            AND = {
                var:taurduin_corruption_value >= corruption_untainted_limit
                var:taurduin_corruption_value <= corruption_whispers_in_the_leaves_limit
            }
        }
        every_situation_sub_region = {
            limit = {
                situation_sub_region_has_county = title:c_haudh_en_aiganaur
            }
            change_phase = { phase = whispers_in_the_leaves }
        }
    }
    else_if = {
        limit = {
            AND = {
                var:taurduin_corruption_value >= corruption_whispers_in_the_leaves_limit
                var:taurduin_corruption_value <= corruption_withering_shade_limit
            }
        }
        every_situation_sub_region = {
            limit = {
                situation_sub_region_has_county = title:c_haudh_en_aiganaur
            }
            change_phase = { phase = the_withering_shade }
        }
    }
    else_if = {
        limit = {
            AND = {
                var:taurduin_corruption_value >= corruption_withering_shade_limit
                var:taurduin_corruption_value <= corruption_shadows_grasp_limit
            }
        }
        every_situation_sub_region = {
            limit = {
                situation_sub_region_has_county = title:c_haudh_en_aiganaur
            }
            change_phase = { phase = shadows_grasp }
        }
    }
    else_if = {
        limit = {
            AND = {
                var:taurduin_corruption_value >= corruption_shadows_grasp_limit
                var:taurduin_corruption_value <= corruption_web_of_night_limit
            }
        }
        every_situation_sub_region = {
            limit = {
                situation_sub_region_has_county = title:c_haudh_en_aiganaur
            }
            change_phase = { phase = the_web_of_night }
        }
    }
}

update_taur_nu_fuin_phase_effect = {
    if = {
        limit = {
            var:taur_nu_fuin_corruption_value <= corruption_untainted_limit
        }
        every_situation_sub_region = {
            limit = {
                situation_sub_region_has_county = title:c_caras_tilion
            }
            change_phase = { phase = untainted_wood }
        }
    }
    else_if = {
        limit = {
            AND = {
                var:taur_nu_fuin_corruption_value >= corruption_untainted_limit
                var:taur_nu_fuin_corruption_value <= corruption_whispers_in_the_leaves_limit
            }
        }
        every_situation_sub_region = {
            limit = {
                situation_sub_region_has_county = title:c_caras_tilion
            }
            change_phase = { phase = whispers_in_the_leaves }
        }
    }
    else_if = {
        limit = {
            AND = {
                var:taur_nu_fuin_corruption_value >= corruption_whispers_in_the_leaves_limit
                var:taur_nu_fuin_corruption_value <= corruption_withering_shade_limit
            }
        }
        every_situation_sub_region = {
            limit = {
                situation_sub_region_has_county = title:c_caras_tilion
            }
            change_phase = { phase = the_withering_shade }
        }
    }
    else_if = {
        limit = {
            AND = {
                var:taur_nu_fuin_corruption_value >= corruption_withering_shade_limit
                var:taur_nu_fuin_corruption_value <= corruption_shadows_grasp_limit
            }
        }
        every_situation_sub_region = {
            limit = {
                situation_sub_region_has_county = title:c_caras_tilion
            }
            change_phase = { phase = shadows_grasp }
        }
    }
    else_if = {
        limit = {
            AND = {
                var:taur_nu_fuin_corruption_value >= corruption_shadows_grasp_limit
                var:taur_nu_fuin_corruption_value <= corruption_web_of_night_limit
            }
        }
        every_situation_sub_region = {
            limit = {
                situation_sub_region_has_county = title:c_caras_tilion
            }
            change_phase = { phase = the_web_of_night }
        }
    }
}

update_emyn_i_firith_phase_effect = {
    if = {
        limit = {
            var:emyn_i_firith_corruption_value <= corruption_untainted_limit
        }
        every_situation_sub_region = {
            limit = {
                situation_sub_region_has_county = title:c_amarthrynd
            }
            change_phase = { phase = untainted_wood }
        }
    }
    else_if = {
        limit = {
            AND = {
                var:emyn_i_firith_corruption_value >= corruption_untainted_limit
                var:emyn_i_firith_corruption_value <= corruption_whispers_in_the_leaves_limit
            }
        }
        every_situation_sub_region = {
            limit = {
                situation_sub_region_has_county = title:c_amarthrynd
            }
            change_phase = { phase = whispers_in_the_leaves }
        }
    }
    else_if = {
        limit = {
            AND = {
                var:emyn_i_firith_corruption_value >= corruption_whispers_in_the_leaves_limit
                var:emyn_i_firith_corruption_value <= corruption_withering_shade_limit
            }
        }
        every_situation_sub_region = {
            limit = {
                situation_sub_region_has_county = title:c_amarthrynd
            }
            change_phase = { phase = the_withering_shade }
        }
    }
    else_if = {
        limit = {
            AND = {
                var:emyn_i_firith_corruption_value >= corruption_withering_shade_limit
                var:emyn_i_firith_corruption_value <= corruption_shadows_grasp_limit
            }
        }
        every_situation_sub_region = {
            limit = {
                situation_sub_region_has_county = title:c_amarthrynd
            }
            change_phase = { phase = shadows_grasp }
        }
    }
    else_if = {
        limit = {
            AND = {
                var:emyn_i_firith_corruption_value >= corruption_shadows_grasp_limit
                var:emyn_i_firith_corruption_value <= corruption_web_of_night_limit
            }
        }
        every_situation_sub_region = {
            limit = {
                situation_sub_region_has_county = title:c_amarthrynd
            }
            change_phase = { phase = the_web_of_night }
        }
    }
}

update_nivrim_phase_effect = {
    if = {
        limit = {
            var:nivrim_corruption_value <= corruption_untainted_limit
        }
        every_situation_sub_region = {
            limit = {
                situation_sub_region_has_county = title:c_girchirion
            }
            change_phase = { phase = untainted_wood }
        }
    }
    else_if = {
        limit = {
            AND = {
                var:nivrim_corruption_value >= corruption_untainted_limit
                var:nivrim_corruption_value <= corruption_whispers_in_the_leaves_limit
            }
        }
        every_situation_sub_region = {
            limit = {
                situation_sub_region_has_county = title:c_girchirion
            }
            change_phase = { phase = whispers_in_the_leaves }
        }
    }
    else_if = {
        limit = {
            AND = {
                var:nivrim_corruption_value >= corruption_whispers_in_the_leaves_limit
                var:nivrim_corruption_value <= corruption_withering_shade_limit
            }
        }
        every_situation_sub_region = {
            limit = {
                situation_sub_region_has_county = title:c_girchirion
            }
            change_phase = { phase = the_withering_shade }
        }
    }
    else_if = {
        limit = {
            AND = {
                var:nivrim_corruption_value >= corruption_withering_shade_limit
                var:nivrim_corruption_value <= corruption_shadows_grasp_limit
            }
        }
        every_situation_sub_region = {
            limit = {
                situation_sub_region_has_county = title:c_girchirion
            }
            change_phase = { phase = shadows_grasp }
        }
    }
    else_if = {
        limit = {
            AND = {
                var:nivrim_corruption_value >= corruption_shadows_grasp_limit
                var:nivrim_corruption_value <= corruption_web_of_night_limit
            }
        }
        every_situation_sub_region = {
            limit = {
                situation_sub_region_has_county = title:c_girchirion
            }
            change_phase = { phase = the_web_of_night }
        }
    }
}

update_dundaedelu_phase_effect = {
    if = {
        limit = {
            var:dundaedelu_corruption_value <= corruption_untainted_limit
        }
        every_situation_sub_region = {
            limit = {
                situation_sub_region_has_county = title:c_taurongobel
            }
            change_phase = { phase = untainted_wood }
        }
    }
    else_if = {
        limit = {
            AND = {
                var:dundaedelu_corruption_value >= corruption_untainted_limit
                var:dundaedelu_corruption_value <= corruption_whispers_in_the_leaves_limit
            }
        }
        every_situation_sub_region = {
            limit = {
                situation_sub_region_has_county = title:c_taurongobel
            }
            change_phase = { phase = whispers_in_the_leaves }
        }
    }
    else_if = {
        limit = {
            AND = {
                var:dundaedelu_corruption_value >= corruption_whispers_in_the_leaves_limit
                var:dundaedelu_corruption_value <= corruption_withering_shade_limit
            }
        }
        every_situation_sub_region = {
            limit = {
                situation_sub_region_has_county = title:c_taurongobel
            }
            change_phase = { phase = the_withering_shade }
        }
    }
    else_if = {
        limit = {
            AND = {
                var:dundaedelu_corruption_value >= corruption_withering_shade_limit
                var:dundaedelu_corruption_value <= corruption_shadows_grasp_limit
            }
        }
        every_situation_sub_region = {
            limit = {
                situation_sub_region_has_county = title:c_taurongobel
            }
            change_phase = { phase = shadows_grasp }
        }
    }
    else_if = {
        limit = {
            AND = {
                var:dundaedelu_corruption_value >= corruption_shadows_grasp_limit
                var:dundaedelu_corruption_value <= corruption_web_of_night_limit
            }
        }
        every_situation_sub_region = {
            limit = {
                situation_sub_region_has_county = title:c_taurongobel
            }
            change_phase = { phase = the_web_of_night }
        }
    }
}

update_angaladh_rhunen_phase_effect = {
    if = {
        limit = {
            var:angaladh_rhunen_corruption_value <= corruption_untainted_limit
        }
        every_situation_sub_region = {
            limit = {
                situation_sub_region_has_county = title:c_eryn_aelin
            }
            change_phase = { phase = untainted_wood }
        }
    }
    else_if = {
        limit = {
            AND = {
                var:angaladh_rhunen_corruption_value >= corruption_untainted_limit
                var:angaladh_rhunen_corruption_value <= corruption_whispers_in_the_leaves_limit
            }
        }
        every_situation_sub_region = {
            limit = {
                situation_sub_region_has_county = title:c_eryn_aelin
            }
            change_phase = { phase = whispers_in_the_leaves }
        }
    }
    else_if = {
        limit = {
            AND = {
                var:angaladh_rhunen_corruption_value >= corruption_whispers_in_the_leaves_limit
                var:angaladh_rhunen_corruption_value <= corruption_withering_shade_limit
            }
        }
        every_situation_sub_region = {
            limit = {
                situation_sub_region_has_county = title:c_eryn_aelin
            }
            change_phase = { phase = the_withering_shade }
        }
    }
    else_if = {
        limit = {
            AND = {
                var:angaladh_rhunen_corruption_value >= corruption_withering_shade_limit
                var:angaladh_rhunen_corruption_value <= corruption_shadows_grasp_limit
            }
        }
        every_situation_sub_region = {
            limit = {
                situation_sub_region_has_county = title:c_eryn_aelin
            }
            change_phase = { phase = shadows_grasp }
        }
    }
    else_if = {
        limit = {
            AND = {
                var:angaladh_rhunen_corruption_value >= corruption_shadows_grasp_limit
                var:angaladh_rhunen_corruption_value <= corruption_web_of_night_limit
            }
        }
        every_situation_sub_region = {
            limit = {
                situation_sub_region_has_county = title:c_eryn_aelin
            }
            change_phase = { phase = the_web_of_night }
        }
    }
}

update_men_i_naugrim_phase_effect = {
    if = {
        limit = {
            var:men_i_naugrim_corruption_value <= corruption_untainted_limit
        }
        every_situation_sub_region = {
            limit = {
                situation_sub_region_has_county = title:c_senn_i_naugrim
            }
            change_phase = { phase = untainted_wood }
        }
    }
    else_if = {
        limit = {
            AND = {
                var:men_i_naugrim_corruption_value >= corruption_untainted_limit
                var:men_i_naugrim_corruption_value <= corruption_whispers_in_the_leaves_limit
            }
        }
        every_situation_sub_region = {
            limit = {
                situation_sub_region_has_county = title:c_senn_i_naugrim
            }
            change_phase = { phase = whispers_in_the_leaves }
        }
    }
    else_if = {
        limit = {
            AND = {
                var:men_i_naugrim_corruption_value >= corruption_whispers_in_the_leaves_limit
                var:men_i_naugrim_corruption_value <= corruption_withering_shade_limit
            }
        }
        every_situation_sub_region = {
            limit = {
                situation_sub_region_has_county = title:c_senn_i_naugrim
            }
            change_phase = { phase = the_withering_shade }
        }
    }
    else_if = {
        limit = {
            AND = {
                var:men_i_naugrim_corruption_value >= corruption_withering_shade_limit
                var:men_i_naugrim_corruption_value <= corruption_shadows_grasp_limit
            }
        }
        every_situation_sub_region = {
            limit = {
                situation_sub_region_has_county = title:c_senn_i_naugrim
            }
            change_phase = { phase = shadows_grasp }
        }
    }
    else_if = {
        limit = {
            AND = {
                var:men_i_naugrim_corruption_value >= corruption_shadows_grasp_limit
                var:men_i_naugrim_corruption_value <= corruption_web_of_night_limit
            }
        }
        every_situation_sub_region = {
            limit = {
                situation_sub_region_has_county = title:c_senn_i_naugrim
            }
            change_phase = { phase = the_web_of_night }
        }
    }
}

update_gwath_anglennol_phase_effect = {
    if = {
        limit = {
            var:gwath_anglennol_corruption_value <= corruption_untainted_limit
        }
        every_situation_sub_region = {
            limit = {
                situation_sub_region_has_county = title:c_gwathrad
            }
            change_phase = { phase = untainted_wood }
        }
    }
    else_if = {
        limit = {
            AND = {
                var:gwath_anglennol_corruption_value >= corruption_untainted_limit
                var:gwath_anglennol_corruption_value <= corruption_whispers_in_the_leaves_limit
            }
        }
        every_situation_sub_region = {
            limit = {
                situation_sub_region_has_county = title:c_gwathrad
            }
            change_phase = { phase = whispers_in_the_leaves }
        }
    }
    else_if = {
        limit = {
            AND = {
                var:gwath_anglennol_corruption_value >= corruption_whispers_in_the_leaves_limit
                var:gwath_anglennol_corruption_value <= corruption_withering_shade_limit
            }
        }
        every_situation_sub_region = {
            limit = {
                situation_sub_region_has_county = title:c_gwathrad
            }
            change_phase = { phase = the_withering_shade }
        }
    }
    else_if = {
        limit = {
            AND = {
                var:gwath_anglennol_corruption_value >= corruption_withering_shade_limit
                var:gwath_anglennol_corruption_value <= corruption_shadows_grasp_limit
            }
        }
        every_situation_sub_region = {
            limit = {
                situation_sub_region_has_county = title:c_gwathrad
            }
            change_phase = { phase = shadows_grasp }
        }
    }
    else_if = {
        limit = {
            AND = {
                var:gwath_anglennol_corruption_value >= corruption_shadows_grasp_limit
                var:gwath_anglennol_corruption_value <= corruption_web_of_night_limit
            }
        }
        every_situation_sub_region = {
            limit = {
                situation_sub_region_has_county = title:c_gwathrad
            }
            change_phase = { phase = the_web_of_night }
        }
    }
}

update_taur_e_ndaedlos_phase_effect = {
    if = {
        limit = {
            var:taur_e_ndaedlos_corruption_value <= corruption_untainted_limit
        }
        every_situation_sub_region = {
            limit = {
                situation_sub_region_has_county = title:c_galbrethin
            }
            change_phase = { phase = untainted_wood }
        }
    }
    else_if = {
        limit = {
            AND = {
                var:taur_e_ndaedlos_corruption_value >= corruption_untainted_limit
                var:taur_e_ndaedlos_corruption_value <= corruption_whispers_in_the_leaves_limit
            }
        }
        every_situation_sub_region = {
            limit = {
                situation_sub_region_has_county = title:c_galbrethin
            }
            change_phase = { phase = whispers_in_the_leaves }
        }
    }
    else_if = {
        limit = {
            AND = {
                var:taur_e_ndaedlos_corruption_value >= corruption_whispers_in_the_leaves_limit
                var:taur_e_ndaedlos_corruption_value <= corruption_withering_shade_limit
            }
        }
        every_situation_sub_region = {
            limit = {
                situation_sub_region_has_county = title:c_galbrethin
            }
            change_phase = { phase = the_withering_shade }
        }
    }
    else_if = {
        limit = {
            AND = {
                var:taur_e_ndaedlos_corruption_value >= corruption_withering_shade_limit
                var:taur_e_ndaedlos_corruption_value <= corruption_shadows_grasp_limit
            }
        }
        every_situation_sub_region = {
            limit = {
                situation_sub_region_has_county = title:c_galbrethin
            }
            change_phase = { phase = shadows_grasp }
        }
    }
    else_if = {
        limit = {
            AND = {
                var:taur_e_ndaedlos_corruption_value >= corruption_shadows_grasp_limit
                var:taur_e_ndaedlos_corruption_value <= corruption_web_of_night_limit
            }
        }
        every_situation_sub_region = {
            limit = {
                situation_sub_region_has_county = title:c_galbrethin
            }
            change_phase = { phase = the_web_of_night }
        }
    }
}

update_amon_lanc_phase_effect = {
    if = {
        limit = {
            var:amon_lanc_corruption_value <= corruption_untainted_limit
        }
        every_situation_sub_region = {
            limit = {
                situation_sub_region_has_county = title:c_galbrethin
            }
            change_phase = { phase = untainted_wood }
        }
    }
    else_if = {
        limit = {
            AND = {
                var:amon_lanc_corruption_value >= corruption_untainted_limit
                var:amon_lanc_corruption_value <= corruption_whispers_in_the_leaves_limit
            }
        }
        every_situation_sub_region = {
            limit = {
                situation_sub_region_has_county = title:c_amon_lanc
            }
            change_phase = { phase = whispers_in_the_leaves }
        }
    }
    else_if = {
        limit = {
            AND = {
                var:amon_lanc_corruption_value >= corruption_whispers_in_the_leaves_limit
                var:amon_lanc_corruption_value <= corruption_withering_shade_limit
            }
        }
        every_situation_sub_region = {
            limit = {
                situation_sub_region_has_county = title:c_amon_lanc
            }
            change_phase = { phase = the_withering_shade }
        }
    }
    else_if = {
        limit = {
            AND = {
                var:amon_lanc_corruption_value >= corruption_withering_shade_limit
                var:amon_lanc_corruption_value <= corruption_shadows_grasp_limit
            }
        }
        every_situation_sub_region = {
            limit = {
                situation_sub_region_has_county = title:c_amon_lanc
            }
            change_phase = { phase = shadows_grasp }
        }
    }
    else_if = {
        limit = {
            AND = {
                var:amon_lanc_corruption_value >= corruption_shadows_grasp_limit
                var:amon_lanc_corruption_value <= corruption_web_of_night_limit
            }
        }
        every_situation_sub_region = {
            limit = {
                situation_sub_region_has_county = title:c_amon_lanc
            }
            change_phase = { phase = the_web_of_night }
        }
    }
}