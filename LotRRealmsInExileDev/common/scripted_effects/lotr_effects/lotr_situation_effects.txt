####################################
###									 ###
###		Elven Situation Effects	 ###
###									 ###
####################################

# Move situation to the next phase according to current hope threshold
update_lorien_phase_effect = { # Lorien & Imladris
	if = {
		limit = {
			var:lorien_hope_value <= 20
		}
		every_situation_sub_region = {
			limit = {							
				situation_sub_region_has_county = title:c_caras_galadhon
			}
			change_phase = { phase = situation_elven_fading }
		}
	}
	else_if = {
		limit = {
			AND = {
				var:lorien_hope_value <= 40
				var:lorien_hope_value > 20
			}
		}
		every_situation_sub_region = {
			limit = {							
				situation_sub_region_has_county = title:c_caras_galadhon
			}
			change_phase = { phase = situation_elven_waning }
		}
	}
	else_if = {
		limit = {
			AND = {
				var:lorien_hope_value <= 60
				var:lorien_hope_value > 40
			}
		}
		every_situation_sub_region = {
			limit = {							
				situation_sub_region_has_county = title:c_caras_galadhon
			}
			change_phase = { phase = situation_elven_enduring }
		}
	}
	else_if = {
		limit = {
			AND = {
				var:lorien_hope_value <= 80
				var:lorien_hope_value > 60
			}
		}
		every_situation_sub_region = {
			limit = {							
				situation_sub_region_has_county = title:c_caras_galadhon
			}
			change_phase = { phase = situation_elven_renewing }
		}
	}
	else_if = {
		limit = {
			AND = {
				var:lorien_hope_value <= 100
				var:lorien_hope_value > 80
			}
		}
		every_situation_sub_region = {
			limit = {							
				situation_sub_region_has_county = title:c_caras_galadhon
			}
			change_phase = { phase = situation_elven_thriving }
		}
	}
}

update_lindon_phase_effect = { # Lindon
	if = {
		limit = {
			var:lindon_hope_value <= 20
		}
		every_situation_sub_region = {
			limit = {							
				situation_sub_region_has_county = title:c_mithrhulond
			}
			change_phase = { phase = situation_elven_fading }
		}
	}
	else_if = {
		limit = {
			AND = {
				var:lindon_hope_value <= 40
				var:lindon_hope_value > 20
			}
		}
		every_situation_sub_region = {
			limit = {							
				situation_sub_region_has_county = title:c_mithrhulond
			}
			change_phase = { phase = situation_elven_waning }
		}
	}
	else_if = {
		limit = {
			AND = {
				var:lindon_hope_value <= 60
				var:lindon_hope_value > 40
			}
		}
		every_situation_sub_region = {
			limit = {							
				situation_sub_region_has_county = title:c_mithrhulond
			}
			change_phase = { phase = situation_elven_enduring }
		}
	}
	else_if = {
		limit = {
			AND = {
				var:lindon_hope_value <= 80
				var:lindon_hope_value > 60
			}
		}
		every_situation_sub_region = {
			limit = {							
				situation_sub_region_has_county = title:c_mithrhulond
			}
			change_phase = { phase = situation_elven_renewing }
		}
	}
	else_if = {
		limit = {
			AND = {
				var:lindon_hope_value <= 100
				var:lindon_hope_value > 80
			}
		}
		every_situation_sub_region = {
			limit = {							
				situation_sub_region_has_county = title:c_mithrhulond
			}
			change_phase = { phase = situation_elven_thriving }
		}
	}
}

update_greenwood_phase_effect = { # Greenwood
	if = {
		limit = {
			var:greenwood_hope_value <= 20
		}
		every_situation_sub_region = {
			limit = {							
				situation_sub_region_has_county = title:c_aradhrynd
			}
			change_phase = { phase = situation_elven_fading }
		}
	}
	else_if = {
		limit = {
			AND = {
				var:greenwood_hope_value <= 40
				var:greenwood_hope_value > 20
			}
		}
		every_situation_sub_region = {
			limit = {							
				situation_sub_region_has_county = title:c_aradhrynd
			}
			change_phase = { phase = situation_elven_waning }
		}
	}
	else_if = {
		limit = {
			AND = {
				var:greenwood_hope_value <= 60
				var:greenwood_hope_value > 40
			}
		}
		every_situation_sub_region = {
			limit = {							
				situation_sub_region_has_county = title:c_aradhrynd
			}
			change_phase = { phase = situation_elven_enduring }
		}
	}
	else_if = {
		limit = {
			AND = {
				var:greenwood_hope_value <= 80
				var:greenwood_hope_value > 60
			}
		}
		every_situation_sub_region = {
			limit = {							
				situation_sub_region_has_county = title:c_aradhrynd
			}
			change_phase = { phase = situation_elven_renewing }
		}
	}
	else_if = {
		limit = {
			AND = {
				var:greenwood_hope_value <= 100
				var:greenwood_hope_value > 80
			}
		}
		every_situation_sub_region = {
			limit = {							
				situation_sub_region_has_county = title:c_aradhrynd
			}
			change_phase = { phase = situation_elven_thriving }
		}
	}
}

# Remove excess hope 
remove_excess_hope_effect = {
	if = {
		limit = {
			var:lorien_hope_value > 100
		}
		set_variable = {
			name = lorien_hope_value
			value = 100
		}
	}
	if = {
		limit = {
			var:lindon_hope_value > 100
		}
		set_variable = {
			name = lindon_hope_value
			value = 100
		}
	}
	if = {
		limit = {
			var:greenwood_hope_value > 100
		}
		set_variable = {
			name = greenwood_hope_value
			value = 100
		}
	}	
}

# Add hope through effect 
add_elven_hope_effect = {
	custom_description = { text = add_elven_hope_desc }
	if = {
		limit = {
			capital_county.title_province = {
				OR = {
					geographical_region = middleearth_west_rhovanion_lothlorien
					geographical_region = middleearth_west_eregion
				}
			}
		}
		every_character_situation = {
			limit = {
				has_variable = lorien_hope_value
			}
			change_variable = {
				name = lorien_hope_value
				add = $VALUE$
			}
		}
	}
	else_if = {
		limit = {
			capital_county.title_province = {
				geographical_region = middleearth_west_beleriand
			}
		}
		every_character_situation = {
			limit = {
				has_variable = lindon_hope_value
			}
			change_variable = {
				name = lindon_hope_value
				add = $VALUE$
			}
		}
	}
	else_if = {
		limit = {
			capital_county.title_province = {
				geographical_region = middleearth_west_rhovanion_mirkwood
			}
		}
		every_character_situation = {
			limit = {
				has_variable = greenwood_hope_value
			}
			change_variable = {
				name = greenwood_hope_value
				add = $VALUE$
			}
		}
	}
}
