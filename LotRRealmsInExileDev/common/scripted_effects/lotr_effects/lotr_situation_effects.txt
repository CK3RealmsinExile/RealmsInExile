###################################
###								  ###
###		Elven Situation Effects	  ###
###								  ###
###################################

# Move situation to the next phase according to current hope threshold
update_lorien_phase_effect = { # Lorien & Imladris
    if = {
        limit = {
            var:lorien_hope_value <= elven_fading_limit
        }
        every_situation_sub_region = {
            limit = {
                situation_sub_region_has_county = title:c_caras_galadhon
            }
            change_phase = { phase = situation_elven_fading }
        }
    }
    else_if = {
        limit = {
            AND = {
                var:lorien_hope_value <= elven_fading_limit
                var:lorien_hope_value > elven_waning_limit
            }
        }
        every_situation_sub_region = {
            limit = {
                situation_sub_region_has_county = title:c_caras_galadhon
            }
            change_phase = { phase = situation_elven_waning }
        }
    }
    else_if = {
        limit = {
            AND = {
                var:lorien_hope_value <= elven_enduring_limit
                var:lorien_hope_value > elven_waning_limit
            }
        }
        every_situation_sub_region = {
            limit = {
                situation_sub_region_has_county = title:c_caras_galadhon
            }
            change_phase = { phase = situation_elven_enduring }
        }
    }
    else_if = {
        limit = {
            AND = {
                var:lorien_hope_value <= elven_renewing_limit
                var:lorien_hope_value > elven_enduring_limit
            }
        }
        every_situation_sub_region = {
            limit = {
                situation_sub_region_has_county = title:c_caras_galadhon
            }
            change_phase = { phase = situation_elven_renewing }
        }
    }
    else_if = {
        limit = {
            AND = {
                var:lorien_hope_value <= elven_thriving_limit
                var:lorien_hope_value > elven_renewing_limit
            }
        }
        every_situation_sub_region = {
            limit = {
                situation_sub_region_has_county = title:c_caras_galadhon
            }
            change_phase = { phase = situation_elven_thriving }
        }
    }
}

update_lindon_phase_effect = { # Lindon
    if = {
        limit = {
            var:lindon_hope_value <= elven_fading_limit
        }
        every_situation_sub_region = {
            limit = {
                situation_sub_region_has_county = title:c_mithrhulond
            }
            change_phase = { phase = situation_elven_fading }
        }
    }
    else_if = {
        limit = {
            AND = {
                var:lindon_hope_value <= elven_waning_limit
                var:lindon_hope_value > elven_fading_limit
            }
        }
        every_situation_sub_region = {
            limit = {
                situation_sub_region_has_county = title:c_mithrhulond
            }
            change_phase = { phase = situation_elven_waning }
        }
    }
    else_if = {
        limit = {
            AND = {
                var:lindon_hope_value <= elven_enduring_limit
                var:lindon_hope_value > elven_waning_limit
            }
        }
        every_situation_sub_region = {
            limit = {
                situation_sub_region_has_county = title:c_mithrhulond
            }
            change_phase = { phase = situation_elven_enduring }
        }
    }
    else_if = {
        limit = {
            AND = {
                var:lindon_hope_value <= elven_renewing_limit
                var:lindon_hope_value > elven_enduring_limit
            }
        }
        every_situation_sub_region = {
            limit = {
                situation_sub_region_has_county = title:c_mithrhulond
            }
            change_phase = { phase = situation_elven_renewing }
        }
    }
    else_if = {
        limit = {
            AND = {
                var:lindon_hope_value <= elven_thriving_limit
                var:lindon_hope_value > elven_renewing_limit
            }
        }
        every_situation_sub_region = {
            limit = {
                situation_sub_region_has_county = title:c_mithrhulond
            }
            change_phase = { phase = situation_elven_thriving }
        }
    }
}

update_greenwood_phase_effect = { # Greenwood
    if = {
        limit = {
            var:greenwood_hope_value <= elven_fading_limit
        }
        every_situation_sub_region = {
            limit = {
                situation_sub_region_has_county = title:c_aradhrynd
            }
            change_phase = { phase = situation_elven_fading }
        }
    }
    else_if = {
        limit = {
            AND = {
                var:greenwood_hope_value <= elven_waning_limit
                var:greenwood_hope_value > elven_fading_limit
            }
        }
        every_situation_sub_region = {
            limit = {
                situation_sub_region_has_county = title:c_aradhrynd
            }
            change_phase = { phase = situation_elven_waning }
        }
    }
    else_if = {
        limit = {
            AND = {
                var:greenwood_hope_value <= elven_enduring_limit
                var:greenwood_hope_value > elven_waning_limit
            }
        }
        every_situation_sub_region = {
            limit = {
                situation_sub_region_has_county = title:c_aradhrynd
            }
            change_phase = { phase = situation_elven_enduring }
        }
    }
    else_if = {
        limit = {
            AND = {
                var:greenwood_hope_value <= elven_renewing_limit
                var:greenwood_hope_value > elven_enduring_limit
            }
        }
        every_situation_sub_region = {
            limit = {
                situation_sub_region_has_county = title:c_aradhrynd
            }
            change_phase = { phase = situation_elven_renewing }
        }
    }
    else_if = {
        limit = {
            AND = {
                var:greenwood_hope_value <= elven_thriving_limit
                var:greenwood_hope_value > elven_renewing_limit
            }
        }
        every_situation_sub_region = {
            limit = {
                situation_sub_region_has_county = title:c_aradhrynd
            }
            change_phase = { phase = situation_elven_thriving }
        }
    }
}

# Remove excess hope
remove_excess_hope_effect = {
    if = {
        limit = {
            var:lorien_hope_value > elven_thriving_limit
        }
        set_variable = {
            name = lorien_hope_value
            value = elven_thriving_limit
        }
    }
    if = {
        limit = {
            var:lindon_hope_value > elven_thriving_limit
        }
        set_variable = {
            name = lindon_hope_value
            value = elven_thriving_limit
        }
    }
    if = {
        limit = {
            var:greenwood_hope_value > elven_thriving_limit
        }
        set_variable = {
            name = greenwood_hope_value
            value = elven_thriving_limit
        }
    }
}

# Add hope through effect
add_elven_hope_effect = {
    every_character_situation = {
        limit = { has_variable = lorien_hope_value }
        save_scope_as = lorien_situation
    }
    every_character_situation = {
        limit = { has_variable = lindon_hope_value }
        save_scope_as = lindon_situation
    }
    every_character_situation = {
        limit = { has_variable = greenwood_hope_value }
        save_scope_as = greenwood_situation
    }

    if = {
        limit = {
            capital_county.title_province = {
                OR = {
                    geographical_region = middleearth_west_rhovanion_lothlorien
                    geographical_region = middleearth_west_eregion
                }
            }
        }
        scope:lorien_situation = {
            change_variable = {
                name = lorien_hope_value
                add = $VALUE$
            }
        }
        create_elven_catalyst_for_history = {
            VALUE = $VALUE$
            HOPE_EFFECT = $HOPE_EFFECT$
            SITUATION_REGION = lorien_situation
            POSITIVE_OR_NEGATIVE = positive_effect
        }
    }
    else_if = {
        limit = {
            capital_county.title_province = {
                geographical_region = middleearth_west_beleriand
            }
        }
        scope:lindon_situation = {
            change_variable = {
                name = lindon_hope_value
                add = $VALUE$
            }
        }
        create_elven_catalyst_for_history = {
            VALUE = $VALUE$
            HOPE_EFFECT = $HOPE_EFFECT$
            SITUATION_REGION = lindon_situation
            POSITIVE_OR_NEGATIVE = positive_effect
        }
    }
    else_if = {
        limit = {
            capital_county.title_province = {
                geographical_region = middleearth_west_rhovanion_mirkwood
            }
        }
        scope:greenwood_situation = {
            change_variable = {
                name = greenwood_hope_value
                add = $VALUE$
            }
        }
        create_elven_catalyst_for_history = {
            VALUE = $VALUE$
            HOPE_EFFECT = $HOPE_EFFECT$
            SITUATION_REGION = greenwood_situation
            POSITIVE_OR_NEGATIVE = positive_effect
        }
    }
    custom_description = { text = add_elven_hope_desc value = $VALUE$ }
}

# Subtract hope through effect
subtract_elven_hope_effect = {
    every_character_situation = {
        limit = { has_variable = lorien_hope_value }
        save_scope_as = lorien_situation
    }
    every_character_situation = {
        limit = { has_variable = lindon_hope_value }
        save_scope_as = lindon_situation
    }
    every_character_situation = {
        limit = { has_variable = greenwood_hope_value }
        save_scope_as = greenwood_situation
    }


    if = {
        limit = {
            capital_county.title_province = {
                OR = {
                    geographical_region = middleearth_west_rhovanion_lothlorien
                    geographical_region = middleearth_west_eregion
                }
            }
        }
        scope:lorien_situation = {
            change_variable = {
                name = lorien_hope_value
                subtract = $VALUE$
            }
        }
        create_elven_catalyst_for_history = {
            VALUE = $VALUE$
            HOPE_EFFECT = $HOPE_EFFECT$
            SITUATION_REGION = lorien_situation
            POSITIVE_OR_NEGATIVE = negative_effect
        }
    }
    else_if = {
        limit = {
            capital_county.title_province = {
                geographical_region = middleearth_west_beleriand
            }
        }
        scope:lindon_situation = {
            change_variable = {
                name = lindon_hope_value
                subtract = $VALUE$
            }
        }
        create_elven_catalyst_for_history = {
            VALUE = $VALUE$
            HOPE_EFFECT = $HOPE_EFFECT$
            SITUATION_REGION = lindon_situation
            POSITIVE_OR_NEGATIVE = negative_effect
        }
    }
    else_if = {
        limit = {
            capital_county.title_province = {
                geographical_region = middleearth_west_rhovanion_mirkwood
            }
        }
        scope:greenwood_situation = {
            change_variable = {
                name = greenwood_hope_value
                subtract = $VALUE$
            }
            add_to_variable_list = {
                name = greenwood_hope_changes
                target = $HOPE_EFFECT$
            }
        }
        create_elven_catalyst_for_history = {
            VALUE = $VALUE$
            HOPE_EFFECT = $HOPE_EFFECT$
            SITUATION_REGION = greenwood_situation
            POSITIVE_OR_NEGATIVE = negative_effect
        }
    }
    custom_description = { text = subtract_elven_hope_desc value = $VALUE$ }
}

# Apply development penalty when hope is low
check_elven_development_penalties_effect = {
    every_situation_sub_region = {
        every_situation_sub_region_participant = {
            limit = { is_independent_ruler = yes }
            trigger_event = {
                id = elven_hope.0020
                months = { 2 10 }
            }
        }
    }
}

create_elven_catalyst_for_history = {
    set_variable = {
        name = elven_hope_catalyst_loc_value
        value = $VALUE$
    }
    set_variable = {
        name = elven_hope_catalyst_loc_key
        value = flag:$HOPE_EFFECT$
    }
    set_variable = {
        name = elven_hope_catalyst_specific_situation
        value = scope:$SITUATION_REGION$
    }
    set_variable = {
        name = elven_hope_catalyst_positive_or_negative
        value = flag:$POSITIVE_OR_NEGATIVE$
    }

    create_story = story_elven_hope_catalyst
    random_owned_story = {
        limit = {
            save_temporary_scope_as = this_story

            NOT = {
                scope:$SITUATION_REGION$ = {
                    is_target_in_variable_list = {
                        name = region_$SITUATION_REGION$_localization
                        target = scope:this_story
                    }
                }
            }
        }
        scope:$SITUATION_REGION$ = {
            add_to_variable_list = {
                name = region_$SITUATION_REGION$_localization
                target = prev
                years = 5
            }
        }
    }
    remove_variable = elven_hope_catalyst_loc_key
    remove_variable = elven_hope_catalyst_loc_value
    remove_variable = elven_hope_catalyst_specific_situation
}

### Debug Effects ###

add_elven_hope_debug = {
    subtract_elven_hope_effect = { VALUE = 100 HOPE_EFFECT = effect_elven_very_high_hope }
}


###################################
###								  ###
###   Mirkwood Situation Effects  ###
###								  ###
###################################

update_mirkwood_monthly_phase_effect = {
    update_aradhrynd_phase_effect = yes
    update_taurduin_phase_effect = yes
    update_taurnufuin_phase_effect = yes
    update_emynifirith_phase_effect = yes
    update_nivrim_phase_effect = yes
    update_dundaedelu_phase_effect = yes
    update_angaladhrhunen_phase_effect = yes
    update_meninaugrim_phase_effect = yes
    update_gwathanglennol_phase_effect = yes
    update_taurendaedlos_phase_effect = yes
    update_amonlanc_phase_effect = yes
}

set_mirkwood_initial_phase_values_7033 = {
    set_variable = {
        name = aradhrynd_corruption_value
        value = 100
    }
    set_variable = {
        name = taurduin_corruption_value
        value = 100
    }
    set_variable = {
        name = taurnufuin_corruption_value
        value = 100
    }
    set_variable = {
        name = emynifirith_corruption_value
        value = 400
    }
    set_variable = {
        name = nivrim_corruption_value
        value = 200
    }
    set_variable = {
        name = dundaedelu_corruption_value
        value = 300
    }
    set_variable = {
        name = angaladhrhunen_corruption_value
        value = 400
    }
    set_variable = {
        name = meninaugrim_corruption_value
        value = 300
    }
    set_variable = {
        name = gwathanglennol_corruption_value
        value = 500
    }
    set_variable = {
        name = taurendaedlos_corruption_value
        value = 500
    }
    set_variable = {
        name = amonlanc_corruption_value
        value = 500
    }
    add_manual_participant = character:nazgul2
    add_manual_participant = character:lineofradagast
    add_manual_participant = character:lineoforopher3
}

update_aradhrynd_phase_effect = {
    if = {
        limit = {
            var:aradhrynd_corruption_value <= corruption_untainted_limit
        }
        every_situation_sub_region = {
            limit = {
                situation_sub_region_has_county = title:c_aradhrynd
            }
            change_phase = { phase = untainted_wood }
        }
    }
    else_if = {
        limit = {
            AND = {
                var:aradhrynd_corruption_value <= corruption_untainted_limit
                var:aradhrynd_corruption_value > corruption_whispers_in_the_leaves_limit
            }
        }
        every_situation_sub_region = {
            limit = {
                situation_sub_region_has_county = title:c_aradhrynd
            }
            change_phase = { phase = whispers_in_the_leaves }
        }
    }
    else_if = {
        limit = {
            AND = {
                var:aradhrynd_corruption_value <= corruption_whispers_in_the_leaves_limit
                var:aradhrynd_corruption_value > corruption_withering_shade_limit
            }
        }
        every_situation_sub_region = {
            limit = {
                situation_sub_region_has_county = title:c_aradhrynd
            }
            change_phase = { phase = the_withering_shade }
        }
    }
    else_if = {
        limit = {
            AND = {
                var:aradhrynd_corruption_value <= corruption_withering_shade_limit
                var:aradhrynd_corruption_value > corruption_shadows_grasp_limit
            }
        }
        every_situation_sub_region = {
            limit = {
                situation_sub_region_has_county = title:c_aradhrynd
            }
            change_phase = { phase = shadows_grasp }
        }
    }
    else_if = {
        limit = {
            AND = {
                var:aradhrynd_corruption_value <= corruption_shadows_grasp_limit
                var:aradhrynd_corruption_value > corruption_web_of_night_limit
            }
        }
        every_situation_sub_region = {
            limit = {
                situation_sub_region_has_county = title:c_aradhrynd
            }
            change_phase = { phase = the_web_of_night }
        }
    }
}

update_taurduin_phase_effect = {
    if = {
        limit = {
            var:taurduin_corruption_value <= corruption_untainted_limit
        }
        every_situation_sub_region = {
            limit = {
                situation_sub_region_has_county = title:c_haudh_en_aiganaur
            }
            change_phase = { phase = untainted_wood }
        }
    }
    else_if = {
        limit = {
            AND = {
                var:taurduin_corruption_value <= corruption_untainted_limit
                var:taurduin_corruption_value > corruption_whispers_in_the_leaves_limit
            }
        }
        every_situation_sub_region = {
            limit = {
                situation_sub_region_has_county = title:c_haudh_en_aiganaur
            }
            change_phase = { phase = whispers_in_the_leaves }
        }
    }
    else_if = {
        limit = {
            AND = {
                var:taurduin_corruption_value <= corruption_whispers_in_the_leaves_limit
                var:taurduin_corruption_value > corruption_withering_shade_limit
            }
        }
        every_situation_sub_region = {
            limit = {
                situation_sub_region_has_county = title:c_haudh_en_aiganaur
            }
            change_phase = { phase = the_withering_shade }
        }
    }
    else_if = {
        limit = {
            AND = {
                var:taurduin_corruption_value <= corruption_withering_shade_limit
                var:taurduin_corruption_value > corruption_shadows_grasp_limit
            }
        }
        every_situation_sub_region = {
            limit = {
                situation_sub_region_has_county = title:c_haudh_en_aiganaur
            }
            change_phase = { phase = shadows_grasp }
        }
    }
    else_if = {
        limit = {
            AND = {
                var:taurduin_corruption_value <= corruption_shadows_grasp_limit
                var:taurduin_corruption_value > corruption_web_of_night_limit
            }
        }
        every_situation_sub_region = {
            limit = {
                situation_sub_region_has_county = title:c_haudh_en_aiganaur
            }
            change_phase = { phase = the_web_of_night }
        }
    }
}

update_taurnufuin_phase_effect = {
    if = {
        limit = {
            var:taurnufuin_corruption_value <= corruption_untainted_limit
        }
        every_situation_sub_region = {
            limit = {
                situation_sub_region_has_county = title:c_caras_tilion
            }
            change_phase = { phase = untainted_wood }
        }
    }
    else_if = {
        limit = {
            AND = {
                var:taurnufuin_corruption_value <= corruption_untainted_limit
                var:taurnufuin_corruption_value > corruption_whispers_in_the_leaves_limit
            }
        }
        every_situation_sub_region = {
            limit = {
                situation_sub_region_has_county = title:c_caras_tilion
            }
            change_phase = { phase = whispers_in_the_leaves }
        }
    }
    else_if = {
        limit = {
            AND = {
                var:taurnufuin_corruption_value <= corruption_whispers_in_the_leaves_limit
                var:taurnufuin_corruption_value > corruption_withering_shade_limit
            }
        }
        every_situation_sub_region = {
            limit = {
                situation_sub_region_has_county = title:c_caras_tilion
            }
            change_phase = { phase = the_withering_shade }
        }
    }
    else_if = {
        limit = {
            AND = {
                var:taurnufuin_corruption_value <= corruption_withering_shade_limit
                var:taurnufuin_corruption_value > corruption_shadows_grasp_limit
            }
        }
        every_situation_sub_region = {
            limit = {
                situation_sub_region_has_county = title:c_caras_tilion
            }
            change_phase = { phase = shadows_grasp }
        }
    }
    else_if = {
        limit = {
            AND = {
                var:taurnufuin_corruption_value <= corruption_shadows_grasp_limit
                var:taurnufuin_corruption_value > corruption_web_of_night_limit
            }
        }
        every_situation_sub_region = {
            limit = {
                situation_sub_region_has_county = title:c_caras_tilion
            }
            change_phase = { phase = the_web_of_night }
        }
    }
}

update_emynifirith_phase_effect = {
    if = {
        limit = {
            var:emynifirith_corruption_value <= corruption_untainted_limit
        }
        every_situation_sub_region = {
            limit = {
                situation_sub_region_has_county = title:c_amarthrynd
            }
            change_phase = { phase = untainted_wood }
        }
    }
    else_if = {
        limit = {
            AND = {
                var:emynifirith_corruption_value <= corruption_untainted_limit
                var:emynifirith_corruption_value > corruption_whispers_in_the_leaves_limit
            }
        }
        every_situation_sub_region = {
            limit = {
                situation_sub_region_has_county = title:c_amarthrynd
            }
            change_phase = { phase = whispers_in_the_leaves }
        }
    }
    else_if = {
        limit = {
            AND = {
                var:emynifirith_corruption_value <= corruption_whispers_in_the_leaves_limit
                var:emynifirith_corruption_value > corruption_withering_shade_limit
            }
        }
        every_situation_sub_region = {
            limit = {
                situation_sub_region_has_county = title:c_amarthrynd
            }
            change_phase = { phase = the_withering_shade }
        }
    }
    else_if = {
        limit = {
            AND = {
                var:emynifirith_corruption_value <= corruption_withering_shade_limit
                var:emynifirith_corruption_value > corruption_shadows_grasp_limit
            }
        }
        every_situation_sub_region = {
            limit = {
                situation_sub_region_has_county = title:c_amarthrynd
            }
            change_phase = { phase = shadows_grasp }
        }
    }
    else_if = {
        limit = {
            AND = {
                var:emynifirith_corruption_value <= corruption_shadows_grasp_limit
                var:emynifirith_corruption_value > corruption_web_of_night_limit
            }
        }
        every_situation_sub_region = {
            limit = {
                situation_sub_region_has_county = title:c_amarthrynd
            }
            change_phase = { phase = the_web_of_night }
        }
    }
}

update_nivrim_phase_effect = {
    if = {
        limit = {
            var:nivrim_corruption_value <= corruption_untainted_limit
        }
        every_situation_sub_region = {
            limit = {
                situation_sub_region_has_county = title:c_girchirion
            }
            change_phase = { phase = untainted_wood }
        }
    }
    else_if = {
        limit = {
            AND = {
                var:nivrim_corruption_value <= corruption_untainted_limit
                var:nivrim_corruption_value > corruption_whispers_in_the_leaves_limit
            }
        }
        every_situation_sub_region = {
            limit = {
                situation_sub_region_has_county = title:c_girchirion
            }
            change_phase = { phase = whispers_in_the_leaves }
        }
    }
    else_if = {
        limit = {
            AND = {
                var:nivrim_corruption_value <= corruption_whispers_in_the_leaves_limit
                var:nivrim_corruption_value > corruption_withering_shade_limit
            }
        }
        every_situation_sub_region = {
            limit = {
                situation_sub_region_has_county = title:c_girchirion
            }
            change_phase = { phase = the_withering_shade }
        }
    }
    else_if = {
        limit = {
            AND = {
                var:nivrim_corruption_value <= corruption_withering_shade_limit
                var:nivrim_corruption_value > corruption_shadows_grasp_limit
            }
        }
        every_situation_sub_region = {
            limit = {
                situation_sub_region_has_county = title:c_girchirion
            }
            change_phase = { phase = shadows_grasp }
        }
    }
    else_if = {
        limit = {
            AND = {
                var:nivrim_corruption_value <= corruption_shadows_grasp_limit
                var:nivrim_corruption_value > corruption_web_of_night_limit
            }
        }
        every_situation_sub_region = {
            limit = {
                situation_sub_region_has_county = title:c_girchirion
            }
            change_phase = { phase = the_web_of_night }
        }
    }
}

update_dundaedelu_phase_effect = {
    if = {
        limit = {
            var:dundaedelu_corruption_value <= corruption_untainted_limit
        }
        every_situation_sub_region = {
            limit = {
                situation_sub_region_has_county = title:c_taurongobel
            }
            change_phase = { phase = untainted_wood }
        }
    }
    else_if = {
        limit = {
            AND = {
                var:dundaedelu_corruption_value <= corruption_untainted_limit
                var:dundaedelu_corruption_value > corruption_whispers_in_the_leaves_limit
            }
        }
        every_situation_sub_region = {
            limit = {
                situation_sub_region_has_county = title:c_taurongobel
            }
            change_phase = { phase = whispers_in_the_leaves }
        }
    }
    else_if = {
        limit = {
            AND = {
                var:dundaedelu_corruption_value <= corruption_whispers_in_the_leaves_limit
                var:dundaedelu_corruption_value > corruption_withering_shade_limit
            }
        }
        every_situation_sub_region = {
            limit = {
                situation_sub_region_has_county = title:c_taurongobel
            }
            change_phase = { phase = the_withering_shade }
        }
    }
    else_if = {
        limit = {
            AND = {
                var:dundaedelu_corruption_value <= corruption_withering_shade_limit
                var:dundaedelu_corruption_value > corruption_shadows_grasp_limit
            }
        }
        every_situation_sub_region = {
            limit = {
                situation_sub_region_has_county = title:c_taurongobel
            }
            change_phase = { phase = shadows_grasp }
        }
    }
    else_if = {
        limit = {
            AND = {
                var:dundaedelu_corruption_value <= corruption_shadows_grasp_limit
                var:dundaedelu_corruption_value > corruption_web_of_night_limit
            }
        }
        every_situation_sub_region = {
            limit = {
                situation_sub_region_has_county = title:c_taurongobel
            }
            change_phase = { phase = the_web_of_night }
        }
    }
}

update_angaladhrhunen_phase_effect = {
    if = {
        limit = {
            var:angaladhrhunen_corruption_value <= corruption_untainted_limit
        }
        every_situation_sub_region = {
            limit = {
                situation_sub_region_has_county = title:c_angaladh_rhunen
            }
            change_phase = { phase = untainted_wood }
        }
    }
    else_if = {
        limit = {
            AND = {
                var:angaladhrhunen_corruption_value <= corruption_untainted_limit
                var:angaladhrhunen_corruption_value > corruption_whispers_in_the_leaves_limit
            }
        }
        every_situation_sub_region = {
            limit = {
                situation_sub_region_has_county = title:c_angaladh_rhunen
            }
            change_phase = { phase = whispers_in_the_leaves }
        }
    }
    else_if = {
        limit = {
            AND = {
                var:angaladhrhunen_corruption_value <= corruption_whispers_in_the_leaves_limit
                var:angaladhrhunen_corruption_value > corruption_withering_shade_limit
            }
        }
        every_situation_sub_region = {
            limit = {
                situation_sub_region_has_county = title:c_angaladh_rhunen
            }
            change_phase = { phase = the_withering_shade }
        }
    }
    else_if = {
        limit = {
            AND = {
                var:angaladhrhunen_corruption_value <= corruption_withering_shade_limit
                var:angaladhrhunen_corruption_value > corruption_shadows_grasp_limit
            }
        }
        every_situation_sub_region = {
            limit = {
                situation_sub_region_has_county = title:c_angaladh_rhunen
            }
            change_phase = { phase = shadows_grasp }
        }
    }
    else_if = {
        limit = {
            AND = {
                var:angaladhrhunen_corruption_value <= corruption_shadows_grasp_limit
                var:angaladhrhunen_corruption_value > corruption_web_of_night_limit
            }
        }
        every_situation_sub_region = {
            limit = {
                situation_sub_region_has_county = title:c_angaladh_rhunen
            }
            change_phase = { phase = the_web_of_night }
        }
    }
}

update_meninaugrim_phase_effect = {
    if = {
        limit = {
            var:meninaugrim_corruption_value <= corruption_untainted_limit
        }
        every_situation_sub_region = {
            limit = {
                situation_sub_region_has_county = title:c_senn_i_naugrim
            }
            change_phase = { phase = untainted_wood }
        }
    }
    else_if = {
        limit = {
            AND = {
                var:meninaugrim_corruption_value <= corruption_untainted_limit
                var:meninaugrim_corruption_value > corruption_whispers_in_the_leaves_limit
            }
        }
        every_situation_sub_region = {
            limit = {
                situation_sub_region_has_county = title:c_senn_i_naugrim
            }
            change_phase = { phase = whispers_in_the_leaves }
        }
    }
    else_if = {
        limit = {
            AND = {
                var:meninaugrim_corruption_value <= corruption_whispers_in_the_leaves_limit
                var:meninaugrim_corruption_value > corruption_withering_shade_limit
            }
        }
        every_situation_sub_region = {
            limit = {
                situation_sub_region_has_county = title:c_senn_i_naugrim
            }
            change_phase = { phase = the_withering_shade }
        }
    }
    else_if = {
        limit = {
            AND = {
                var:meninaugrim_corruption_value <= corruption_withering_shade_limit
                var:meninaugrim_corruption_value > corruption_shadows_grasp_limit
            }
        }
        every_situation_sub_region = {
            limit = {
                situation_sub_region_has_county = title:c_senn_i_naugrim
            }
            change_phase = { phase = shadows_grasp }
        }
    }
    else_if = {
        limit = {
            AND = {
                var:meninaugrim_corruption_value <= corruption_shadows_grasp_limit
                var:meninaugrim_corruption_value > corruption_web_of_night_limit
            }
        }
        every_situation_sub_region = {
            limit = {
                situation_sub_region_has_county = title:c_senn_i_naugrim
            }
            change_phase = { phase = the_web_of_night }
        }
    }
}

update_gwathanglennol_phase_effect = {
    if = {
        limit = {
            var:gwathanglennol_corruption_value <= corruption_untainted_limit
        }
        every_situation_sub_region = {
            limit = {
                situation_sub_region_has_county = title:c_gwathrad
            }
            change_phase = { phase = untainted_wood }
        }
    }
    else_if = {
        limit = {
            AND = {
                var:gwathanglennol_corruption_value <= corruption_untainted_limit
                var:gwathanglennol_corruption_value > corruption_whispers_in_the_leaves_limit
            }
        }
        every_situation_sub_region = {
            limit = {
                situation_sub_region_has_county = title:c_gwathrad
            }
            change_phase = { phase = whispers_in_the_leaves }
        }
    }
    else_if = {
        limit = {
            AND = {
                var:gwathanglennol_corruption_value <= corruption_whispers_in_the_leaves_limit
                var:gwathanglennol_corruption_value > corruption_withering_shade_limit
            }
        }
        every_situation_sub_region = {
            limit = {
                situation_sub_region_has_county = title:c_gwathrad
            }
            change_phase = { phase = the_withering_shade }
        }
    }
    else_if = {
        limit = {
            AND = {
                var:gwathanglennol_corruption_value <= corruption_withering_shade_limit
                var:gwathanglennol_corruption_value > corruption_shadows_grasp_limit
            }
        }
        every_situation_sub_region = {
            limit = {
                situation_sub_region_has_county = title:c_gwathrad
            }
            change_phase = { phase = shadows_grasp }
        }
    }
    else_if = {
        limit = {
            AND = {
                var:gwathanglennol_corruption_value <= corruption_shadows_grasp_limit
                var:gwathanglennol_corruption_value > corruption_web_of_night_limit
            }
        }
        every_situation_sub_region = {
            limit = {
                situation_sub_region_has_county = title:c_gwathrad
            }
            change_phase = { phase = the_web_of_night }
        }
    }
}

update_taurendaedlos_phase_effect = {
    if = {
        limit = {
            var:taurendaedlos_corruption_value <= corruption_untainted_limit
        }
        every_situation_sub_region = {
            limit = {
                situation_sub_region_has_county = title:c_galbrethin
            }
            change_phase = { phase = untainted_wood }
        }
    }
    else_if = {
        limit = {
            AND = {
                var:taurendaedlos_corruption_value <= corruption_untainted_limit
                var:taurendaedlos_corruption_value > corruption_whispers_in_the_leaves_limit
            }
        }
        every_situation_sub_region = {
            limit = {
                situation_sub_region_has_county = title:c_galbrethin
            }
            change_phase = { phase = whispers_in_the_leaves }
        }
    }
    else_if = {
        limit = {
            AND = {
                var:taurendaedlos_corruption_value <= corruption_whispers_in_the_leaves_limit
                var:taurendaedlos_corruption_value > corruption_withering_shade_limit
            }
        }
        every_situation_sub_region = {
            limit = {
                situation_sub_region_has_county = title:c_galbrethin
            }
            change_phase = { phase = the_withering_shade }
        }
    }
    else_if = {
        limit = {
            AND = {
                var:taurendaedlos_corruption_value <= corruption_withering_shade_limit
                var:taurendaedlos_corruption_value > corruption_shadows_grasp_limit
            }
        }
        every_situation_sub_region = {
            limit = {
                situation_sub_region_has_county = title:c_galbrethin
            }
            change_phase = { phase = shadows_grasp }
        }
    }
    else_if = {
        limit = {
            AND = {
                var:taurendaedlos_corruption_value <= corruption_shadows_grasp_limit
                var:taurendaedlos_corruption_value > corruption_web_of_night_limit
            }
        }
        every_situation_sub_region = {
            limit = {
                situation_sub_region_has_county = title:c_galbrethin
            }
            change_phase = { phase = the_web_of_night }
        }
    }
}

update_amonlanc_phase_effect = {
    if = {
        limit = {
            var:amonlanc_corruption_value <= corruption_untainted_limit
        }
        every_situation_sub_region = {
            limit = {
                situation_sub_region_has_county = title:c_galbrethin
            }
            change_phase = { phase = untainted_wood }
        }
    }
    else_if = {
        limit = {
            AND = {
                var:amonlanc_corruption_value <= corruption_untainted_limit
                var:amonlanc_corruption_value > corruption_whispers_in_the_leaves_limit
            }
        }
        every_situation_sub_region = {
            limit = {
                situation_sub_region_has_county = title:c_amon_lanc
            }
            change_phase = { phase = whispers_in_the_leaves }
        }
    }
    else_if = {
        limit = {
            AND = {
                var:amonlanc_corruption_value <= corruption_whispers_in_the_leaves_limit
                var:amonlanc_corruption_value > corruption_withering_shade_limit
            }
        }
        every_situation_sub_region = {
            limit = {
                situation_sub_region_has_county = title:c_amon_lanc
            }
            change_phase = { phase = the_withering_shade }
        }
    }
    else_if = {
        limit = {
            AND = {
                var:amonlanc_corruption_value <= corruption_withering_shade_limit
                var:amonlanc_corruption_value > corruption_shadows_grasp_limit
            }
        }
        every_situation_sub_region = {
            limit = {
                situation_sub_region_has_county = title:c_amon_lanc
            }
            change_phase = { phase = shadows_grasp }
        }
    }
    else_if = {
        limit = {
            AND = {
                var:amonlanc_corruption_value <= corruption_shadows_grasp_limit
                var:amonlanc_corruption_value > corruption_web_of_night_limit
            }
        }
        every_situation_sub_region = {
            limit = {
                situation_sub_region_has_county = title:c_amon_lanc
            }
            change_phase = { phase = the_web_of_night }
        }
    }
}