### Tamska System
make_former_tamska_effect = {
	remove_trait = tamska
	add_trait = former_tamska
}

make_generated_tamskangi_interesting_effect = {
	hidden_effect = { # Post-Creation make them interesting!
	    if = { # They shouldnt be all that sinful
	        limit = {
	            num_sinful_traits >= 1
	        }
	        flip_sinful_trait_effect = yes
	    }
		random = { # Odd birth circumstance
			chance = 5
	    	if = {
	    	    limit = {
	    	        faith = { has_doctrine = doctrine_bastardry_none }
	    	    }
				add_trait = wild_oat
			}
			else = {
				add_trait = bastard
			}
		}
		random = { # Maybe they have something genetic!
			chance = 20
			random_list = {
				30 = { add_trait = beauty_good_1 }
				20 = { add_trait = beauty_good_2 }
				10 = { add_trait = beauty_good_3 }
				30 = { add_trait = intellect_good_1 }
				20 = { add_trait = intellect_good_2 }
				10 = { add_trait = intellect_good_3 }
				30 = { add_trait = physique_good_1 }
				20 = { add_trait = physique_good_2 }
				10 = { add_trait = physique_good_3 }
				20 = { add_trait = fecund }
				20 = { add_trait = strong }
				20 = { add_trait = shrewd }
				20 = { add_trait = giant }
				10 = { add_trait = possessed_genetic }
	            
	            # Certain traits may appear, but are much less likely
				10 = { add_trait = beauty_bad_1 }
				5 = { add_trait = beauty_bad_2 }
				10 = { add_trait = intellect_bad_1 }
				10 = { add_trait = physique_bad_1 }
				10 = { add_trait = weak }
				5 = { add_trait = dull }
				5 = { add_trait = lisping }
				5 = { add_trait = stuttering }
				20 = { add_trait = impotent }
				10 = { add_trait = infertile }
				5 = { add_trait = lunatic_genetic }
				5 = { add_trait = wheezing }
				5 = { add_trait = clubfooted }
				1 = { add_trait = hunchbacked }
				1 = { add_trait = spindly }
				1 = { add_trait = scaly }
				1 = { add_trait = bleeder }
				1 = { add_trait = albino }
				1 = { add_trait = dwarf }
			}
		}
	    if = { # They could be a Child miracle worker!
	        limit = {
	            faith = { has_doctrine_parameter = mystic_birthright_active }
	        }
	        random = {
	            chance = 20
	            add_trait = lifestyle_mystic
	        }
	    }
	    if = { # They keep in touch with their origins
	        limit = {
	            is_lowborn = yes
	        }
	        random = {
	            chance = 5
	            add_trait = peasant_leader
	        }
	    }
	    if = { # Maybe they carry some ancient blessing?
	        limit = {
	            lotr_has_numenorean_culture_trigger = yes
	        }
	        random = {
	            chance = 5
	            add_trait = blood_of_numenor_1
	        }
	    }
	}
}

become_tamskangi_effect = {
	# TBD: Save former house, parents and bastardry traits for un-tamskangi-ing
	if = {
		limit = { has_trait = former_tamska }
		remove_trait = former_tamska
	}
	if = {
		limit = { has_trait = tamska }
		remove_trait = tamska
	}
	hidden_effect = {
		remove_trait = bastard
		remove_trait = legitimized_bastard
		remove_trait = bastard_founder
		remove_trait = disputed_heritage
		remove_trait = disinherited
		remove_trait = denounced
		remove_trait = gallivanter
		remove_trait = devoted
	}
	add_trait = tamska_heir
	set_house = root.house
	if = {
		limit = { NOT = { faith = ROOT.faith } }
   		set_character_faith = ROOT.faith
	}
	ROOT = {
		adopt = scope:tamska_heir
		set_designated_heir = scope:tamska_heir
        create_character_memory = {
            type = adopted_a_child
            participants = {
                child = scope:tamska_heir
            }
        }
	}
}

become_tamska_effect = {
	if = {
		limit = { has_trait = former_tamska }
		remove_trait = former_tamska
	}
	if = {
		limit = { has_trait = tamska_heir }
		remove_trait = tamska_heir
	}
	add_trait = tamska
	every_child = {
		limit = { NOT = { has_trait = child_of_tamska } }
		add_trait = child_of_tamska
	}
}

set_children_as_tamksa_dynasty = {
	house ?= { save_scope_as = tamska_old_house }
	if = {
		limit = {
			exists = scope:tamska_old_house
		}
		every_child = {
			limit = { house = scope:tamska_old_house }
			set_house = character:linetamska1.house

			if = {
				limit = {
					can_have_children = yes
					any_child = { count > 0 }
				}
				every_child = {
					limit = { house = scope:tamska_old_house }
					set_house = character:linetamska1.house

					if = {
						limit = {
							can_have_children = yes
							any_child = { count > 0 }
						}
					}
					every_child = {
						limit = { house = scope:tamska_old_house }
						set_house = character:linetamska1.house

						if = {
							limit = {
								can_have_children = yes
								any_child = { count > 0 }
							}
						}
						every_child = {
							limit = { house = scope:tamska_old_house }
							set_house = character:linetamska1.house

							if = {
								limit = {
									can_have_children = yes
									any_child = { count > 0 }
								}
							}
						}
					}
				}
			}
		}
	}
}
