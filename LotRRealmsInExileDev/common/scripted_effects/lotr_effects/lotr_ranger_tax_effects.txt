lotr_rc_recalc_subject_effect = {
    # scope: tributary subject
    remove_character_modifier = ranger_tax_subject_lvl1
    remove_character_modifier = ranger_tax_subject_lvl2
    remove_character_modifier = ranger_tax_subject_lvl3
    remove_character_modifier = ranger_tax_subject_lvl4

    if = { limit = { root.liege = { prestige_level >= 4 } } add_character_modifier = { modifier = ranger_tax_subject_lvl4 days = 40 } }
    else_if = { limit = { root.liege = { prestige_level >= 3 } } add_character_modifier = { modifier = ranger_tax_subject_lvl3 days = 40 } }
    else_if = { limit = { root.liege = { prestige_level >= 2 } } add_character_modifier = { modifier = ranger_tax_subject_lvl2 days = 40 } }
    else = { add_character_modifier = { modifier = ranger_tax_subject_lvl1 days = 40 } }
}

lotr_rc_recalc_liege_effect = {
    # scope: liege
    # 1) count eligible vassals
    set_variable = { name = lotr_rc_count value = 0 }
    every_vassal = {
        limit = { vassal_contract_has_flag = has_ranger_camp_contract }
        change_variable = { name = lotr_rc_count add = 1 }
    }

    # 2) clear existing cumulative cost modifiers
    remove_character_modifier = ranger_tax_liege_lvl1
    remove_character_modifier = ranger_tax_liege_lvl2
    remove_character_modifier = ranger_tax_liege_lvl3
    remove_character_modifier = ranger_tax_liege_lvl4

    # 3) apply the single correct one based on prestige tier & count
    if = { limit = { prestige_level >= 4 } add_character_modifier = { modifier = ranger_tax_liege_lvl4 days = 40 }}
    else_if = { limit = { prestige_level >= 3 } add_character_modifier = { modifier = ranger_tax_liege_lvl3 days = 40 } }
    else_if = { limit = { prestige_level >= 2 } add_character_modifier = { modifier = ranger_tax_liege_lvl2 days = 40 } }
    else = { add_character_modifier = { modifier = ranger_tax_liege_lvl1 days = 40 } }
    remove_variable = lotr_rc_count
}