#################################################
# EFFECT LIST 									#
#################################################
#
# Inspiration Generation Effects
#	grant_inspiration_to_character_effect 			- Creates a new Inspiration and gives it to the scope character. Type of inspiration is weighted based on character skills and personality.
#	grant_new_inspiration_in_character_realm_effect - Selects a random Pool character from the scope character's realm, then runs the above effect on them. Afterwards, move to visit the scope character's court.
#	grant_new_inspiration_in_region_effect			- Selects a random Royal Court in a given $GEOLOGICAL_REGION$. The Court's owner then has the above effect run on them.
# 	grant_new_inspiration_in_world_effect			- Selects a random geological region in the world. The selected region then has the above effect run on it.
#
# Inspired Character Movement Effects
#   inspired_character_travel_to_court_effect			- Moves $INSPIRED_CHARACTER$ to the court of $NEW_HOST$.
#	inspired_character_seek_out_new_royal_court_effect 	- Forces the scope character to look for a new, different Royal Court to visit as a guest. If one is found, uses the above effect to move there.

#################################################
# Inspiration Generation Effects 				#
#################################################

grant_inspiration_to_character_effect = {
	$CHARACTER$ = { 
		if = { 
			limit = { NOT = { exists = inspiration } }
			# More likely to get an certain Inspiration type if we will produce higher quality Artifacts of that type.
			random_list = {
				10 = {
					compare_modifier = {
						value = weapon_inspiration_average_skill_value
						multiplier = 6
					}
					modifier = { #Some cultures are more likely to pick this vocation than others
						add = 5
						culture = {
							has_cultural_tradition = tradition_metal_craftsmanship
						}
					}
					create_inspiration = weapon_inspiration
				}
				10 = { # =Slightly increased weight due to a low number of Armorers appearing in the world.
					compare_modifier = {
						value = armor_inspiration_average_skill_value
						multiplier = 7.2 # A character with an average of 20 in relevant skills will receive a +120 bonus
					}
					modifier = { #Some cultures are more likely to pick this vocation than others
						add = 5
						culture = {
							has_cultural_tradition = tradition_frugal_armorsmiths
						}
					}
					create_inspiration = armor_inspiration
				}
				17 = { #Adventurers will on average produce better quality items, handle with care.
					compare_modifier = {
						value = adventure_inspiration_average_skill_value
						multiplier = 9
					}
					modifier = {
						add = 5
						culture = { #Some cultures are more likely to pick this vocation than others
							OR = {
								has_cultural_parameter = more_likely_to_leave_court #Swords for Hire & Caravaneers
								has_cultural_tradition = tradition_chivalry
							}
						}
					}
					create_inspiration = adventure_inspiration
				}
				12 = { # Significantly increased weight due to the wide variety of artifact types this inspiration can produce (regalia, crown, trinket).
					compare_modifier = {
						value = smith_inspiration_average_skill_value
						multiplier = 15
					}
					modifier = { #Some cultures are more likely to pick this vocation than others
						add = 10
						culture = {
							OR = {
								has_cultural_tradition = tradition_metal_craftsmanship
								has_cultural_tradition = tradition_ancient_miners
							}
						}
					}
					create_inspiration = smith_inspiration
				}
				10 = {
					compare_modifier = {
						value = book_inspiration_average_skill_value
						multiplier = 6
					}
					modifier = {
						has_court_position = court_poet_court_position
						add = 15
					}
					modifier = {
						culture = { #Some cultures are more likely to pick this vocation than others
							OR = {
								has_cultural_tradition = tradition_language_scholars
								has_cultural_tradition = tradition_philosopher_culture
								has_cultural_tradition = tradition_legalistic
							}
						}
						add = 5
					}
					create_inspiration = book_inspiration
				}
				11 = { # Increased weight due to a low number of Weavers appearing in the world (probably a lack of high-diplomacy courtiers).
					compare_modifier = {
						value = weaver_inspiration_average_skill_value
						multiplier = 8.4
					}
					modifier = {
						culture = { #Some cultures are more likely to pick this vocation than others
							has_cultural_parameter = improved_weaver_inspiration
						}
						add = 10
					}
					create_inspiration = weaver_inspiration
				}
				14 = { # Moderately increased weight due to the variety of artifact types this inspiration can produce (throne, sculpture). 
					compare_modifier = {
						value = artisan_inspiration_average_skill_value
						multiplier = 12
					}
					modifier = {
						has_court_position = court_poet_court_position
						add = 5
					}
					modifier = {
						culture = { #Some cultures are more likely to pick this vocation than others
							has_cultural_parameter = improved_artisan_inspiration
						}
						add = 15
					}
					create_inspiration = artisan_inspiration
				}
				1 = {
					modifier = {
						add = 30
						has_trait = lifestyle_mystic
					}
					# modifier = { #Alchemy arrived to Europe in the 13th century, but existed basically everywhere else before that
						# add = -20
						# culture_has_european_heritage_pillar_trigger = yes
					# }
					compare_modifier = {
						value = learning
						multiplier = 2
					}
					create_inspiration = alchemy_inspiration
				}
			}
		}
	}
}

grant_inspiration_to_character_no_court_artifacts_effect = {
	$CHARACTER$ = { 
		if = { 
			limit = { NOT = { exists = inspiration } }
			# More likely to get an certain Inspiration type if we will produce higher quality Artifacts of that type.
			random_list = {
				10 = {
					compare_modifier = {
						value = weapon_inspiration_average_skill_value
						multiplier = 5
					}
					modifier = { #Some cultures are more likely to pick this vocation than others
						add = 5
						culture = {
							has_cultural_tradition = tradition_metal_craftsmanship
						}
					}
					create_inspiration = weapon_inspiration
				}
				10 = {
					compare_modifier = {
						value = armor_inspiration_average_skill_value
						multiplier = 5
					}
					modifier = { #Some cultures are more likely to pick this vocation than others
						add = 5
						culture = {
							has_cultural_tradition = tradition_frugal_armorsmiths
						}
					}
					create_inspiration = armor_inspiration
				}
				5 = {
					compare_modifier = {
						value = smith_inspiration_average_skill_value
						multiplier = 5
					}
					modifier = { #Some cultures are more likely to pick this vocation than others
						add = 10
						culture = {
							OR = {
								has_cultural_tradition = tradition_metal_craftsmanship
								has_cultural_tradition = tradition_ancient_miners
							}
						}
					}
					create_inspiration = smith_inspiration
				}
				5 = {
					compare_modifier = {
						value = book_inspiration_average_skill_value
						multiplier = 5
					}
					modifier = {
						has_court_position = court_poet_court_position
						add = 15
					}
					modifier = {
						culture = { #Some cultures are more likely to pick this vocation than others
							OR = {
								has_cultural_tradition = tradition_language_scholars
								has_cultural_tradition = tradition_philosopher_culture
								has_cultural_tradition = tradition_legalistic
							}
						}
						add = 5
					}
					create_inspiration = book_inspiration
				}
				1 = {
					modifier = {
						add = 30
						has_trait = lifestyle_mystic
					}
					modifier = { #Alchemy arrived to Europe in the 13th century, but existed basically everywhere else before that
						add = -20
						culture_has_european_heritage_pillar_trigger = yes
					}
					compare_modifier = {
						value = learning
						multiplier = 2
					}
					create_inspiration = alchemy_inspiration
				}
			}
		}
	}
}

grant_new_inspiration_in_character_realm_effect = {
	save_scope_as = royal_court_owner
	every_sub_realm_barony = {
		title_province = {
			every_pool_character = {
				province = this
				limit = {
					ep1_is_valid_character_for_inspiration_trigger = yes
					same_race = { TARGET = scope:royal_court_owner }
				}
				add_to_list = potential_inspired_people
			}
		}
	}

	random_in_list = {
		list = potential_inspired_people
		weight = {
			base = 1

			modifier = { #Poets are more likely to become inspired
				add = 40
				has_trait = poet
			}

			# More learned characters have a greater pool to draw from for their inspirations.
			compare_modifier = {
				value = learning
				multiplier = 5
			}

			# Older characters are more likely to be inspired from their life's experience.
			compare_modifier = {
				value = age
			}

			# We don't want character dropping dead from old age, injuries, or disease right after they begin work on a project!
			compare_modifier = {
				value = health
				multiplier = 20
			}

			# 'Ambitious' characters are more likely to get an inspiration/seek patronage
			ai_value_modifier = {
				ai_greed = 0.25
				ai_boldness = 0.25
				ai_sociability = 0.10
				ai_rationality = 0.10
			}
		}
		save_scope_as = inspired_person
	}

	# If we were unable to find a valid pool character, create one.
	if = {
		limit = {
			NOT = { exists = scope:inspired_person }
		}
		create_character = {
			template = inspired_template
			location = scope:royal_court_owner.capital_province
			faith = scope:royal_court_owner.faith
			culture = scope:royal_court_owner.culture
			gender_female_chance = 50 
			save_scope_as = inspired_person
		}
	}
	# Clear the list in case this effect gets re-used in the same scope.
	every_in_list = {
		list = potential_inspired_people
		remove_from_list = potential_inspired_people
	}

	scope:inspired_person = {
		grant_inspiration_to_character_effect = { CHARACTER = this }
		# Travel to the new host's court.
		inspired_character_travel_to_court_effect = {
			INSPIRED_CHARACTER = scope:inspired_person
			NEW_HOST = scope:royal_court_owner
		}
	}
	
}

grant_new_inspiration_in_region_effect = {
	random_character_with_royal_court = {
		limit = {
			exists = capital_province 
			capital_province = {
				geographical_region = $GEOGRAPHICAL_REGION$
			}
			save_temporary_scope_as = tmp_royal_court_owner # Used in 'inspiration_kingdom_modifier' to calculate draw towards this specific court in the region.
		}

		weight = {
			base = 1
			inspiration_royal_court_grandeur_attraction_modifier = yes
			inspiration_royal_court_oversaturation_penalty_modifier = yes
		}

		grant_new_inspiration_in_character_realm_effect = yes
	}
}

grant_new_inspiration_in_world_effect = {
	# When generating new inspired characters, the following criteria are taken into account:
	#  - The specified region *must* be the home of at least 1 royal court to be eligible.
	#  - Increased chance for regions which have multiple royal courts.
	#  - Increased chance for regions which have incredibly prestigious royal courts.
	#  - Greatly reduced chance for regions which already have multiple inspired people wandering around within them.

	random_list = {
	   # Beleriand
		1 = {
			trigger = { any_character_with_royal_court = { exists = capital_province capital_province = { geographical_region = middleearth_beleriand_forlindon } } }
			inspiration_region_court_grandeur_attraction_modifier = { GEOGRAPHICAL_REGION = middleearth_beleriand_forlindon }
			inspiration_region_oversaturation_penalty_modifier = { GEOGRAPHICAL_REGION = middleearth_beleriand_forlindon }
			grant_new_inspiration_in_region_effect = { GEOGRAPHICAL_REGION = middleearth_beleriand_forlindon }
		}
		1 = {
			trigger = { any_character_with_royal_court = { exists = capital_province capital_province = { geographical_region = middleearth_beleriand_harlindon } } }
			inspiration_region_court_grandeur_attraction_modifier = { GEOGRAPHICAL_REGION = middleearth_beleriand_harlindon }
			inspiration_region_oversaturation_penalty_modifier = { GEOGRAPHICAL_REGION = middleearth_beleriand_harlindon }
			grant_new_inspiration_in_region_effect = { GEOGRAPHICAL_REGION = middleearth_beleriand_harlindon }
		}
		1 = {
			trigger = { any_character_with_royal_court = { exists = capital_province capital_province = { geographical_region = middleearth_beleriand_mithlond } } }
			inspiration_region_court_grandeur_attraction_modifier = { GEOGRAPHICAL_REGION = middleearth_beleriand_mithlond }
			inspiration_region_oversaturation_penalty_modifier = { GEOGRAPHICAL_REGION = middleearth_beleriand_mithlond }
			grant_new_inspiration_in_region_effect = { GEOGRAPHICAL_REGION = middleearth_beleriand_mithlond }
		}
		
	   # Orrostar Noldoro
		1 = {
			trigger = { any_character_with_royal_court = { exists = capital_province capital_province = { geographical_region = middleearth_orrostar_noldoro_eregion } } }
			inspiration_region_court_grandeur_attraction_modifier = { GEOGRAPHICAL_REGION = middleearth_orrostar_noldoro_eregion }
			inspiration_region_oversaturation_penalty_modifier = { GEOGRAPHICAL_REGION = middleearth_orrostar_noldoro_eregion }
			grant_new_inspiration_in_region_effect = { GEOGRAPHICAL_REGION = middleearth_orrostar_noldoro_eregion }
		}
		1 = {
			trigger = { any_character_with_royal_court = { exists = capital_province capital_province = { geographical_region = middleearth_orrostar_noldoro_imladris } } }
			inspiration_region_court_grandeur_attraction_modifier = { GEOGRAPHICAL_REGION = middleearth_orrostar_noldoro_imladris }
			inspiration_region_oversaturation_penalty_modifier = { GEOGRAPHICAL_REGION = middleearth_orrostar_noldoro_imladris }
			grant_new_inspiration_in_region_effect = { GEOGRAPHICAL_REGION = middleearth_orrostar_noldoro_imladris }
		}
		
	   # Arnor
		1 = {
			trigger = { any_character_with_royal_court = { exists = capital_province capital_province = { geographical_region = middleearth_west_arnor_arthedain } } }
			inspiration_region_court_grandeur_attraction_modifier = { GEOGRAPHICAL_REGION = middleearth_west_arnor_arthedain }
			inspiration_region_oversaturation_penalty_modifier = { GEOGRAPHICAL_REGION = middleearth_west_arnor_arthedain }
			grant_new_inspiration_in_region_effect = { GEOGRAPHICAL_REGION = middleearth_west_arnor_arthedain }
		}
		1 = {
			trigger = { any_character_with_royal_court = { exists = capital_province capital_province = { geographical_region = middleearth_west_arnor_cardolan } } }
			inspiration_region_court_grandeur_attraction_modifier = { GEOGRAPHICAL_REGION = middleearth_west_arnor_cardolan }
			inspiration_region_oversaturation_penalty_modifier = { GEOGRAPHICAL_REGION = middleearth_west_arnor_cardolan }
			grant_new_inspiration_in_region_effect = { GEOGRAPHICAL_REGION = middleearth_west_arnor_cardolan }
		}
		1 = {
			trigger = { any_character_with_royal_court = { exists = capital_province capital_province = { geographical_region = middleearth_west_arnor_rhudaur } } }
			inspiration_region_court_grandeur_attraction_modifier = { GEOGRAPHICAL_REGION = middleearth_west_arnor_rhudaur }
			inspiration_region_oversaturation_penalty_modifier = { GEOGRAPHICAL_REGION = middleearth_west_arnor_rhudaur }
			grant_new_inspiration_in_region_effect = { GEOGRAPHICAL_REGION = middleearth_west_arnor_rhudaur }
		}
	
	   # Westlands
		1 = {
			trigger = { any_character_with_royal_court = { exists = capital_province capital_province = { geographical_region = middleearth_west_enedhwaith } } }
			inspiration_region_court_grandeur_attraction_modifier = { GEOGRAPHICAL_REGION = middleearth_west_enedhwaith }
			inspiration_region_oversaturation_penalty_modifier = { GEOGRAPHICAL_REGION = middleearth_west_enedhwaith }
			grant_new_inspiration_in_region_effect = { GEOGRAPHICAL_REGION = middleearth_west_enedhwaith }
		}
		1 = {
			trigger = { any_character_with_royal_court = { exists = capital_province capital_province = { geographical_region = middleearth_west_isengard } } }
			inspiration_region_court_grandeur_attraction_modifier = { GEOGRAPHICAL_REGION = middleearth_west_isengard }
			inspiration_region_oversaturation_penalty_modifier = { GEOGRAPHICAL_REGION = middleearth_west_isengard }
			grant_new_inspiration_in_region_effect = { GEOGRAPHICAL_REGION = middleearth_west_isengard }
		}
		1 = {
			trigger = { any_character_with_royal_court = { exists = capital_province capital_province = { geographical_region = middleearth_west_rohan } } }
			inspiration_region_court_grandeur_attraction_modifier = { GEOGRAPHICAL_REGION = middleearth_west_rohan }
			inspiration_region_oversaturation_penalty_modifier = { GEOGRAPHICAL_REGION = middleearth_west_rohan }
			grant_new_inspiration_in_region_effect = { GEOGRAPHICAL_REGION = middleearth_west_rohan }
		}
		1 = {
			trigger = { any_character_with_royal_court = { exists = capital_province capital_province = { geographical_region = middleearth_west_lothlorien } } }
			inspiration_region_court_grandeur_attraction_modifier = { GEOGRAPHICAL_REGION = middleearth_west_lothlorien }
			inspiration_region_oversaturation_penalty_modifier = { GEOGRAPHICAL_REGION = middleearth_west_lothlorien }
			grant_new_inspiration_in_region_effect = { GEOGRAPHICAL_REGION = middleearth_west_lothlorien }
		}
		
	   # Rhovanion
		1 = {
			trigger = { any_character_with_royal_court = { exists = capital_province capital_province = { geographical_region = middleearth_west_rhovanion_anduin } } }
			inspiration_region_court_grandeur_attraction_modifier = { GEOGRAPHICAL_REGION = middleearth_west_rhovanion_anduin }
			inspiration_region_oversaturation_penalty_modifier = { GEOGRAPHICAL_REGION = middleearth_west_rhovanion_anduin }
			grant_new_inspiration_in_region_effect = { GEOGRAPHICAL_REGION = middleearth_west_rhovanion_anduin }
		}
		1 = {
			trigger = { any_character_with_royal_court = { exists = capital_province capital_province = { geographical_region = middleearth_west_rhovanion_brownlands } } }
			inspiration_region_court_grandeur_attraction_modifier = { GEOGRAPHICAL_REGION = middleearth_west_rhovanion_brownlands }
			inspiration_region_oversaturation_penalty_modifier = { GEOGRAPHICAL_REGION = middleearth_west_rhovanion_brownlands }
			grant_new_inspiration_in_region_effect = { GEOGRAPHICAL_REGION = middleearth_west_rhovanion_brownlands }
		}
		1 = {
			trigger = { any_character_with_royal_court = { exists = capital_province capital_province = { geographical_region = middleearth_west_rhovanion_dalelands } } }
			inspiration_region_court_grandeur_attraction_modifier = { GEOGRAPHICAL_REGION = middleearth_west_rhovanion_dalelands }
			inspiration_region_oversaturation_penalty_modifier = { GEOGRAPHICAL_REGION = middleearth_west_rhovanion_dalelands }
			grant_new_inspiration_in_region_effect = { GEOGRAPHICAL_REGION = middleearth_west_rhovanion_dalelands }
		}
		1 = {
			trigger = { any_character_with_royal_court = { exists = capital_province capital_province = { geographical_region = middleearth_west_rhovanion_mirkwood } } }
			inspiration_region_court_grandeur_attraction_modifier = { GEOGRAPHICAL_REGION = middleearth_west_rhovanion_mirkwood }
			inspiration_region_oversaturation_penalty_modifier = { GEOGRAPHICAL_REGION = middleearth_west_rhovanion_mirkwood }
			grant_new_inspiration_in_region_effect = { GEOGRAPHICAL_REGION = middleearth_west_rhovanion_mirkwood }
		}

	   # Gondor
		1 = {
			trigger = { any_character_with_royal_court = { exists = capital_province capital_province = { geographical_region = middleearth_west_gondor_andrast } } }
			inspiration_region_court_grandeur_attraction_modifier = { GEOGRAPHICAL_REGION = middleearth_west_gondor_andrast }
			inspiration_region_oversaturation_penalty_modifier = { GEOGRAPHICAL_REGION = middleearth_west_gondor_andrast }
			grant_new_inspiration_in_region_effect = { GEOGRAPHICAL_REGION = middleearth_west_gondor_andrast }
		}
		1 = {
			trigger = { any_character_with_royal_court = { exists = capital_province capital_province = { geographical_region = middleearth_west_gondor_whitemountains } } }
			inspiration_region_court_grandeur_attraction_modifier = { GEOGRAPHICAL_REGION = middleearth_west_gondor_whitemountains }
			inspiration_region_oversaturation_penalty_modifier = { GEOGRAPHICAL_REGION = middleearth_west_gondor_whitemountains }
			grant_new_inspiration_in_region_effect = { GEOGRAPHICAL_REGION = middleearth_west_gondor_whitemountains }
		}
		1 = {
			trigger = { any_character_with_royal_court = { exists = capital_province capital_province = { geographical_region = middleearth_west_gondor_centralfiefdoms } } }
			inspiration_region_court_grandeur_attraction_modifier = { GEOGRAPHICAL_REGION = middleearth_west_gondor_centralfiefdoms }
			inspiration_region_oversaturation_penalty_modifier = { GEOGRAPHICAL_REGION = middleearth_west_gondor_centralfiefdoms }
			grant_new_inspiration_in_region_effect = { GEOGRAPHICAL_REGION = middleearth_west_gondor_centralfiefdoms }
		}
		1 = {
			trigger = { any_character_with_royal_court = { exists = capital_province capital_province = { geographical_region = middleearth_west_gondor_easternfiefdoms } } }
			inspiration_region_court_grandeur_attraction_modifier = { GEOGRAPHICAL_REGION = middleearth_west_gondor_easternfiefdoms }
			inspiration_region_oversaturation_penalty_modifier = { GEOGRAPHICAL_REGION = middleearth_west_gondor_easternfiefdoms }
			grant_new_inspiration_in_region_effect = { GEOGRAPHICAL_REGION = middleearth_west_gondor_easternfiefdoms }
		}
		1 = {
			trigger = { any_character_with_royal_court = { exists = capital_province capital_province = { geographical_region = middleearth_west_gondor_ithilien } } }
			inspiration_region_court_grandeur_attraction_modifier = { GEOGRAPHICAL_REGION = middleearth_west_gondor_ithilien }
			inspiration_region_oversaturation_penalty_modifier = { GEOGRAPHICAL_REGION = middleearth_west_gondor_ithilien }
			grant_new_inspiration_in_region_effect = { GEOGRAPHICAL_REGION = middleearth_west_gondor_ithilien }
		}	

	   # Near Harad
		1 = {
			trigger = { any_character_with_royal_court = { exists = capital_province capital_province = { geographical_region = middleearth_haradwaith_harondor } } }
			inspiration_region_court_grandeur_attraction_modifier = { GEOGRAPHICAL_REGION = middleearth_haradwaith_harondor }
			inspiration_region_oversaturation_penalty_modifier = { GEOGRAPHICAL_REGION = middleearth_haradwaith_harondor }
			grant_new_inspiration_in_region_effect = { GEOGRAPHICAL_REGION = middleearth_haradwaith_harondor }
		}
		1 = {
			trigger = { any_character_with_royal_court = { exists = capital_province capital_province = { geographical_region = middleearth_haradwaith_near } } }
			inspiration_region_court_grandeur_attraction_modifier = { GEOGRAPHICAL_REGION = middleearth_haradwaith_near }
			inspiration_region_oversaturation_penalty_modifier = { GEOGRAPHICAL_REGION = middleearth_haradwaith_near }
			grant_new_inspiration_in_region_effect = { GEOGRAPHICAL_REGION = middleearth_haradwaith_near }
		}
		1 = {
			trigger = { any_character_with_royal_court = { exists = capital_province capital_province = { geographical_region = middleearth_haradwaith_umbar } } }
			inspiration_region_court_grandeur_attraction_modifier = { GEOGRAPHICAL_REGION = middleearth_haradwaith_umbar }
			inspiration_region_oversaturation_penalty_modifier = { GEOGRAPHICAL_REGION = middleearth_haradwaith_umbar }
			grant_new_inspiration_in_region_effect = { GEOGRAPHICAL_REGION = middleearth_haradwaith_umbar }
		}
		
	   # Far Harad
		1 = {
			trigger = { any_character_with_royal_court = { exists = capital_province capital_province = { geographical_region = middleearth_haradwaith_far_mardruak } } }
			inspiration_region_court_grandeur_attraction_modifier = { GEOGRAPHICAL_REGION = middleearth_haradwaith_far_mardruak }
			inspiration_region_oversaturation_penalty_modifier = { GEOGRAPHICAL_REGION = middleearth_haradwaith_far_mardruak }
			grant_new_inspiration_in_region_effect = { GEOGRAPHICAL_REGION = middleearth_haradwaith_far_mardruak }
		}
		1 = {
			trigger = { any_character_with_royal_court = { exists = capital_province capital_province = { geographical_region = middleearth_haradwaith_far_bellakar } } }
			inspiration_region_court_grandeur_attraction_modifier = { GEOGRAPHICAL_REGION = middleearth_haradwaith_far_bellakar }
			inspiration_region_oversaturation_penalty_modifier = { GEOGRAPHICAL_REGION = middleearth_haradwaith_far_bellakar }
			grant_new_inspiration_in_region_effect = { GEOGRAPHICAL_REGION = middleearth_haradwaith_far_bellakar }
		}
		1 = {
			trigger = { any_character_with_royal_court = { exists = capital_province capital_province = { geographical_region = middleearth_haradwaith_far_dune_sea } } }
			inspiration_region_court_grandeur_attraction_modifier = { GEOGRAPHICAL_REGION = middleearth_haradwaith_far_dune_sea }
			inspiration_region_oversaturation_penalty_modifier = { GEOGRAPHICAL_REGION = middleearth_haradwaith_far_dune_sea }
			grant_new_inspiration_in_region_effect = { GEOGRAPHICAL_REGION = middleearth_haradwaith_far_dune_sea }
		}
		1 = {
			trigger = { any_character_with_royal_court = { exists = capital_province capital_province = { geographical_region = middleearth_haradwaith_far_abrakhan } } }
			inspiration_region_court_grandeur_attraction_modifier = { GEOGRAPHICAL_REGION = middleearth_haradwaith_far_abrakhan }
			inspiration_region_oversaturation_penalty_modifier = { GEOGRAPHICAL_REGION = middleearth_haradwaith_far_abrakhan }
			grant_new_inspiration_in_region_effect = { GEOGRAPHICAL_REGION = middleearth_haradwaith_far_abrakhan }
		}
		1 = {
			trigger = { any_character_with_royal_court = { exists = capital_province capital_province = { geographical_region = middleearth_haradwaith_far_jungle } } }
			inspiration_region_court_grandeur_attraction_modifier = { GEOGRAPHICAL_REGION = middleearth_haradwaith_far_jungle }
			inspiration_region_oversaturation_penalty_modifier = { GEOGRAPHICAL_REGION = middleearth_haradwaith_far_jungle }
			grant_new_inspiration_in_region_effect = { GEOGRAPHICAL_REGION = middleearth_haradwaith_far_jungle }
		}

	   # Mordor
		1 = {
			trigger = { any_character_with_royal_court = { exists = capital_province capital_province = { geographical_region = middleearth_mordor } } }
			inspiration_region_court_grandeur_attraction_modifier = { GEOGRAPHICAL_REGION = middleearth_mordor }
			inspiration_region_oversaturation_penalty_modifier = { GEOGRAPHICAL_REGION = middleearth_mordor }
			grant_new_inspiration_in_region_effect = { GEOGRAPHICAL_REGION = middleearth_mordor }
		}

	   # Forodwaith
		1 = {
			trigger = { any_character_with_royal_court = { exists = capital_province capital_province = { geographical_region = middleearth_forodwaith } } }
			inspiration_region_court_grandeur_attraction_modifier = { GEOGRAPHICAL_REGION = middleearth_forodwaith }
			inspiration_region_oversaturation_penalty_modifier = { GEOGRAPHICAL_REGION = middleearth_forodwaith }
			grant_new_inspiration_in_region_effect = { GEOGRAPHICAL_REGION = middleearth_forodwaith }
		}

	   # Rhûn
		1 = {
			trigger = { any_character_with_royal_court = { exists = capital_province capital_province = { geographical_region = middleearth_rhun_seaofrhun } } }
			inspiration_region_court_grandeur_attraction_modifier = { GEOGRAPHICAL_REGION = middleearth_rhun_seaofrhun }
			inspiration_region_oversaturation_penalty_modifier = { GEOGRAPHICAL_REGION = middleearth_rhun_seaofrhun }
			grant_new_inspiration_in_region_effect = { GEOGRAPHICAL_REGION = middleearth_rhun_seaofrhun }
		}
		1 = {
			trigger = { any_character_with_royal_court = { exists = capital_province capital_province = { geographical_region = middleearth_rhun_dorwinion } } }
			inspiration_region_court_grandeur_attraction_modifier = { GEOGRAPHICAL_REGION = middleearth_rhun_dorwinion }
			inspiration_region_oversaturation_penalty_modifier = { GEOGRAPHICAL_REGION = middleearth_rhun_dorwinion }
			grant_new_inspiration_in_region_effect = { GEOGRAPHICAL_REGION = middleearth_rhun_dorwinion }
		}
		1 = {
			trigger = { any_character_with_royal_court = { exists = capital_province capital_province = { geographical_region = middleearth_rhun_khand } } }
			inspiration_region_court_grandeur_attraction_modifier = { GEOGRAPHICAL_REGION = middleearth_rhun_khand }
			inspiration_region_oversaturation_penalty_modifier = { GEOGRAPHICAL_REGION = middleearth_rhun_khand }
			grant_new_inspiration_in_region_effect = { GEOGRAPHICAL_REGION = middleearth_rhun_khand }
		}
		1 = {
			trigger = { any_character_with_royal_court = { exists = capital_province capital_province = { geographical_region = middleearth_rhun_nurunkizdin } } }
			inspiration_region_court_grandeur_attraction_modifier = { GEOGRAPHICAL_REGION = middleearth_rhun_nurunkizdin }
			inspiration_region_oversaturation_penalty_modifier = { GEOGRAPHICAL_REGION = middleearth_rhun_nurunkizdin }
			grant_new_inspiration_in_region_effect = { GEOGRAPHICAL_REGION = middleearth_rhun_nurunkizdin }
		}
		
	   # Blue Mountains
		1 = {
			trigger = { any_character_with_royal_court = { exists = capital_province capital_province = { geographical_region = middleearth_blue_mountains_buzra_dum } } }
			inspiration_region_court_grandeur_attraction_modifier = { GEOGRAPHICAL_REGION = middleearth_blue_mountains_buzra_dum }
			inspiration_region_oversaturation_penalty_modifier = { GEOGRAPHICAL_REGION = middleearth_blue_mountains_buzra_dum }
			grant_new_inspiration_in_region_effect = { GEOGRAPHICAL_REGION = middleearth_blue_mountains_buzra_dum }
		}
		1 = {
			trigger = { any_character_with_royal_court = { exists = capital_province capital_province = { geographical_region = middleearth_blue_mountains_nogrod } } }
			inspiration_region_court_grandeur_attraction_modifier = { GEOGRAPHICAL_REGION = middleearth_blue_mountains_nogrod }
			inspiration_region_oversaturation_penalty_modifier = { GEOGRAPHICAL_REGION = middleearth_blue_mountains_nogrod }
			grant_new_inspiration_in_region_effect = { GEOGRAPHICAL_REGION = middleearth_blue_mountains_nogrod }
		}
		1 = {
			trigger = { any_character_with_royal_court = { exists = capital_province capital_province = { geographical_region = middleearth_blue_mountains_belegost } } }
			inspiration_region_court_grandeur_attraction_modifier = { GEOGRAPHICAL_REGION = middleearth_blue_mountains_belegost }
			inspiration_region_oversaturation_penalty_modifier = { GEOGRAPHICAL_REGION = middleearth_blue_mountains_belegost }
			grant_new_inspiration_in_region_effect = { GEOGRAPHICAL_REGION = middleearth_blue_mountains_belegost }
		}
		
	   # Misty Mountains
		1 = {
			trigger = { any_character_with_royal_court = { exists = capital_province capital_province = { geographical_region = middleearth_misty_mountains_khazad_dum } } }
			inspiration_region_court_grandeur_attraction_modifier = { GEOGRAPHICAL_REGION = middleearth_misty_mountains_khazad_dum }
			inspiration_region_oversaturation_penalty_modifier = { GEOGRAPHICAL_REGION = middleearth_misty_mountains_khazad_dum }
			grant_new_inspiration_in_region_effect = { GEOGRAPHICAL_REGION = middleearth_misty_mountains_khazad_dum }
		}
		1 = {
			trigger = { any_character_with_royal_court = { exists = capital_province capital_province = { geographical_region = middleearth_misty_mountains_high_pass } } }
			inspiration_region_court_grandeur_attraction_modifier = { GEOGRAPHICAL_REGION = middleearth_misty_mountains_high_pass }
			inspiration_region_oversaturation_penalty_modifier = { GEOGRAPHICAL_REGION = middleearth_misty_mountains_high_pass }
			grant_new_inspiration_in_region_effect = { GEOGRAPHICAL_REGION = middleearth_misty_mountains_high_pass }
		}
		1 = {
			trigger = { any_character_with_royal_court = { exists = capital_province capital_province = { geographical_region = middleearth_misty_mountains_gundabad } } }
			inspiration_region_court_grandeur_attraction_modifier = { GEOGRAPHICAL_REGION = middleearth_misty_mountains_gundabad }
			inspiration_region_oversaturation_penalty_modifier = { GEOGRAPHICAL_REGION = middleearth_misty_mountains_gundabad }
			grant_new_inspiration_in_region_effect = { GEOGRAPHICAL_REGION = middleearth_misty_mountains_gundabad }
		}
		
	   # Iron Mountains
		1 = {
			trigger = { any_character_with_royal_court = { exists = capital_province capital_province = { geographical_region = middleearth_iron_mountains_grey_mountains } } }
			inspiration_region_court_grandeur_attraction_modifier = { GEOGRAPHICAL_REGION = middleearth_iron_mountains_grey_mountains }
			inspiration_region_oversaturation_penalty_modifier = { GEOGRAPHICAL_REGION = middleearth_iron_mountains_grey_mountains }
			grant_new_inspiration_in_region_effect = { GEOGRAPHICAL_REGION = middleearth_iron_mountains_grey_mountains }
		}
		1 = {
			trigger = { any_character_with_royal_court = { exists = capital_province capital_province = { geographical_region = middleearth_iron_mountains_iron_hills } } }
			inspiration_region_court_grandeur_attraction_modifier = { GEOGRAPHICAL_REGION = middleearth_iron_mountains_iron_hills }
			inspiration_region_oversaturation_penalty_modifier = { GEOGRAPHICAL_REGION = middleearth_iron_mountains_iron_hills }
			grant_new_inspiration_in_region_effect = { GEOGRAPHICAL_REGION = middleearth_iron_mountains_iron_hills }
		}
		1 = {
			trigger = { any_character_with_royal_court = { exists = capital_province capital_province = { geographical_region = middleearth_iron_mountains_erebor } } }
			inspiration_region_court_grandeur_attraction_modifier = { GEOGRAPHICAL_REGION = middleearth_iron_mountains_erebor }
			inspiration_region_oversaturation_penalty_modifier = { GEOGRAPHICAL_REGION = middleearth_iron_mountains_erebor }
			grant_new_inspiration_in_region_effect = { GEOGRAPHICAL_REGION = middleearth_iron_mountains_erebor }
		}

	   # Utter South
		1 = {
			trigger = { any_character_with_royal_court = { exists = capital_province capital_province = { geographical_region = middleearth_utter_south_upper_thani_hazad } } }
			inspiration_region_court_grandeur_attraction_modifier = { GEOGRAPHICAL_REGION = middleearth_utter_south_upper_thani_hazad }
			inspiration_region_oversaturation_penalty_modifier = { GEOGRAPHICAL_REGION = middleearth_utter_south_upper_thani_hazad }
			grant_new_inspiration_in_region_effect = { GEOGRAPHICAL_REGION = middleearth_utter_south_upper_thani_hazad }
		}
		1 = {
			trigger = { any_character_with_royal_court = { exists = capital_province capital_province = { geographical_region = middleearth_utter_south_lower_thani_hazad } } }
			inspiration_region_court_grandeur_attraction_modifier = { GEOGRAPHICAL_REGION = middleearth_utter_south_lower_thani_hazad }
			inspiration_region_oversaturation_penalty_modifier = { GEOGRAPHICAL_REGION = middleearth_utter_south_lower_thani_hazad }
			grant_new_inspiration_in_region_effect = { GEOGRAPHICAL_REGION = middleearth_utter_south_lower_thani_hazad }
		}
		1 = {
			trigger = { any_character_with_royal_court = { exists = capital_province capital_province = { geographical_region = middleearth_utter_south_twin_kingdoms } } }
			inspiration_region_court_grandeur_attraction_modifier = { GEOGRAPHICAL_REGION = middleearth_utter_south_twin_kingdoms }
			inspiration_region_oversaturation_penalty_modifier = { GEOGRAPHICAL_REGION = middleearth_utter_south_twin_kingdoms }
			grant_new_inspiration_in_region_effect = { GEOGRAPHICAL_REGION = middleearth_utter_south_twin_kingdoms }
		}
	   # Usakan
	    1 = {
			trigger = { any_character_with_royal_court = { exists = capital_province capital_province = { geographical_region = middleearth_usakan } } }
			inspiration_region_court_grandeur_attraction_modifier = { GEOGRAPHICAL_REGION = middleearth_usakan }
			inspiration_region_oversaturation_penalty_modifier = { GEOGRAPHICAL_REGION = middleearth_usakan }
			grant_new_inspiration_in_region_effect = { GEOGRAPHICAL_REGION = middleearth_usakan }
		}
	   # Yellow Mountains
		1 = {
			trigger = { any_character_with_royal_court = { exists = capital_province capital_province = { geographical_region = middleearth_eastern_yellow_mountains } } }
			inspiration_region_court_grandeur_attraction_modifier = { GEOGRAPHICAL_REGION = middleearth_eastern_yellow_mountains }
			inspiration_region_oversaturation_penalty_modifier = { GEOGRAPHICAL_REGION = middleearth_eastern_yellow_mountains }
			grant_new_inspiration_in_region_effect = { GEOGRAPHICAL_REGION = middleearth_eastern_yellow_mountains }
		}
		1 = {
			trigger = { any_character_with_royal_court = { exists = capital_province capital_province = { geographical_region = middleearth_western_yellow_mountains } } }
			inspiration_region_court_grandeur_attraction_modifier = { GEOGRAPHICAL_REGION = middleearth_western_yellow_mountains }
			inspiration_region_oversaturation_penalty_modifier = { GEOGRAPHICAL_REGION = middleearth_western_yellow_mountains }
			grant_new_inspiration_in_region_effect = { GEOGRAPHICAL_REGION = middleearth_western_yellow_mountains }
		}
	}
}

#################################################
# Inspired Character Movement Effects 			#
#################################################

inspired_character_travel_to_court_effect = {
	$INSPIRED_CHARACTER$ = {
		save_scope_as = ttc_inspired_character
		inspiration = { save_scope_as = ttc_inspiration }
		#Save our current host (so we don't return to their court too quickly!).
		if = {
			limit = { exists = host }
			set_variable = {
				name = last_visited_ruler
				value = this.host
				days = 1825
			}
		}
		# If no current host, save as dummy character so we at least have something to compare to.
		else = {
			set_variable = {
				name = last_visited_ruler
				value = dummy_female
				days = 1825
			}
		}

		visit_court_of = $NEW_HOST$
		add_character_flag = {
			flag = inspired_character_recent_arrival
			months = inspired_character_recent_arrival_duration_value
		}
	}

	$NEW_HOST$ = {
		# TODO_CD: Disable for now due to the addition of an Alert to replace this ( action_has_courtier_or_guest_with_inspiration )
		# Check if this message is no longer necessary and can be deleted outright.
		#send_interface_message = {
		#	type = event_generic_good
		#	title = ttc_inspired_guest_arrival_title
		#	right_icon = scope:ttc_inspired_character
		#	custom_tooltip = ttc_inspired_guest_arrival_desc			
		#}
	}
}

inspired_character_seek_out_new_royal_court_effect = {
	save_scope_as = inspired_character

	# Look to see if there is a nearby court we can visit that might fund our inspiration.
	random_character_with_royal_court = {
		limit = {
			# Do not travel outside of diplomatic range in a single 'jump'
			in_diplomatic_range = scope:inspired_character

			# Do not visit the ruler we had just left, unless at least 5 years have passed.
			trigger_if = {
				limit = { scope:inspired_character = { has_variable = last_visited_ruler } }
				NOT = { scope:inspired_character.var:last_visited_ruler = this }
			}

			# Only visit rulers who do not consider our faith to be hostile, if possible.
			faith = {
				faith_hostility_level = {
					target = scope:inspired_character.faith
					value <= faith_hostile_level
				}
			}
			
			#LotR trigger : prefer same race character
			same_race = { TARGET = scope:inspired_character }
			
			exists = capital_province
			save_temporary_scope_as = tmp_royal_court_owner # Used in 'inspiration_kingdom_modifier' to calculate draw towards this specific court in the region.
		}
		alternative_limit = {
			in_diplomatic_range = scope:inspired_character
			trigger_if = {
				limit = { scope:inspired_character = { has_variable = last_visited_ruler } }
				NOT = { scope:inspired_character.var:last_visited_ruler = this }
			}
			trigger_if = { #Avoid Elven artisans running around human courts
				limit = { scope:inspired_character = { is_elf = yes } }
				is_elf = yes
			}
			# Failing that, if possible do not visit rulers who consider our faith to be outright evil.
			faith = {
				faith_hostility_level = {
					target = scope:inspired_character.faith
					value <= faith_evil_level
				}
			}
			
			exists = capital_province
			save_temporary_scope_as = tmp_royal_court_owner
		}
		alternative_limit = {
			# Failing that, we can visit anyone else in range. 
			in_diplomatic_range = scope:inspired_character
			trigger_if = {
				limit = { scope:inspired_character = { has_variable = last_visited_ruler } }
				NOT = { scope:inspired_character.var:last_visited_ruler = this }
			}
			trigger_if = { #LotR trigger : avoid Elven artisans running around human courts
				limit = { scope:inspired_character = { is_elf = yes } }
				is_elf = yes
			}
			trigger_if = { #LotR trigger : avoid Orc artisans running around non-evil courts
				limit = { scope:inspired_character = { is_orc = yes } }
				faith_is_evil = yes
			}
			
			exists = capital_province
			save_temporary_scope_as = tmp_royal_court_owner
		}

		weight = {
			base = 10
			inspiration_royal_court_grandeur_attraction_modifier = yes
			inspiration_royal_court_oversaturation_penalty_modifier = yes

			# Prefer visiting royal courts which are physically closer to us
			modifier = {
				factor = 0.9 # Total 90.0% weight
				capital_province = {
					squared_distance = {
						target = scope:inspired_character.location
						value >= squared_distance_small #150 map-pixels. Roughly one Wales away (top to bottom).
					}
				}
			}
			modifier = {
				factor = 0.8 # Total 72.0% weight
				capital_province = {
					squared_distance = {
						target = scope:inspired_character.location
						value >= squared_distance_medium #250 map-pixels. Roughly one Ireland away (top to bottom).
					}
				}
			}
			modifier = {
				factor = 0.6 # Total 43.2% weight
				capital_province = {			
					squared_distance = {		
						target = scope:inspired_character.location
						value >= squared_distance_large #650 map-pixels. Roughly one France away (top to bottom).
					}
				}
			}
			modifier = {
				factor = 0.3 # Total 12.9% weight
				capital_province = {			
					squared_distance = {
						target = scope:inspired_character.location
						value >= squared_distance_huge #850 map-pixels. Roughly one Holy Roman Empire away (left to right).
					}
				}
			}
			
			# Down-prioritize courts with a lot of inspired people already
			modifier = {
				factor = 0.9
				any_courtier_or_guest = {
					count >= 2
					exists = inspiration
				}
			}
			modifier = {
				factor = 0.8
				any_courtier_or_guest = {
					count >= 3
					exists = inspiration
				}
			}
			modifier = {
				factor = 0.7
				any_courtier_or_guest = {
					count >= 4
					exists = inspiration
				}
			}
			modifier = {
				factor = 0.6
				any_courtier_or_guest = {
					count >= 5
					exists = inspiration
				}
			}
			modifier = {
				factor = 0.001
				any_courtier_or_guest = {
					count >= 6
					exists = inspiration
				}
			}
			#Limiting Dwarf artisans running around human courts
			modifier = {
				factor = 0.3
				and = {
					is_dwarf = no
					scope:inspired_character = { is_dwarf = yes }
				}
			}
		}
		save_scope_as = new_host
	}

	# If we have successfully located a new host...
	if = {
		limit = {
			exists = scope:new_host
		}

		# ...travel to the new host's court.
		inspired_character_travel_to_court_effect = {
			INSPIRED_CHARACTER = scope:inspired_character
			NEW_HOST = scope:new_host
		}
	}	
}
