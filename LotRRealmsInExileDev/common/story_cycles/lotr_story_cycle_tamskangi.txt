story_cycle_tamskangi = {

	on_setup = {
	}

	on_end = {
	}

	on_owner_death = {
		story_owner = {
			if = { # Ensure that the next Tamska is set as the designated heir if they're their child
				limit = {
					trigger_if = {
						limit = { exists = title:d_tamska_main.holder }
						has_title = title:d_tamska_main
					} trigger_else = { always = no }
					exists = title:d_tamska_main.current_heir
					any_child = {
						this = title:d_tamska_main.current_heir
						NOT = {
							this = root.player_heir
						}
					}
				}
				random_child = {
					limit = {
						this = title:d_tamska_main.current_heir
						NOT = {
							this = root.player_heir
						}
					}
					save_scope_as = designated_tamska_heir
				}
				set_designated_heir = scope:designated_tamska_heir
			}
			if = { # If, somehow, the heir is male - we generate a new Tamska
				limit = {
					trigger_if = {
						limit = { exists = title:d_tamska_main.holder }
						has_title = title:d_tamska_main
					} trigger_else = { always = no }
					exists = title:d_tamska_main.current_heir
					title:d_tamska_main.current_heir = {
						is_male = yes
					}
				}
				create_character = {
					template = pool_repopulate_learning
					gender_female_chance = 100
					age = { 4 9 }
					culture = root.culture
					faith = root.faith
					location = root.location
					dynasty = none
					save_scope_as = tamska_heir
				}
				scope:tamska_heir = {
					add_trait = tamska_heir
					set_house = root.house
				}
				adopt = scope:tamska_heir
				set_designated_heir = scope:tamska_heir
			}
		}
		make_story_owner = story_owner.player_heir
	}

	# A new Tamskangi has been identified
	effect_group = {
		days = { 270 450 }
		chance = 20 # Expected average time of around 5 years to find one
	
		triggered_effect = {
			trigger = {
				story_owner = {
					any_child = {
						count = 0
						has_trait = tamska_heir
						is_alive = yes
					}
				}
			}
			effect = {
				story_owner = {
					trigger_event = tamska.0002
				}
			}
		}
	}

	effect_group = {
		days = 7

		triggered_effect = {
			trigger = {
				story_owner = {
					has_title = title:d_tamska_main
				}
			}
			effect = {
				story_owner = {
					trigger_event = tamska.0001
				}
			}
		}
	}

}
