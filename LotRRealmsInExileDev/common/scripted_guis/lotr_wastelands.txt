## GUI (MANUAL) TRIGGER OF COLONISATION
## For AI random events for colonisation, check_
## - yearly_on_actions.txt
## - lotr_wasteland_events.txt
## - lotr_wasteland_effects.txt

gui_not_is_character_wastelands = {
	scope = character
	is_shown = {
		NOT = {
			has_culture = culture:wastelands
		}
	}
}

gui_not_is_province_wastelands = {
	scope = province
	is_shown = {
		NOT = {
			culture = culture:wastelands
		}
	}
}


gui_is_character_wastelands = {
	scope = character
	is_shown = {
		has_culture = culture:wastelands
	}
}

gui_is_province_wastelands = {
	scope = province
	is_shown = {
		culture = culture:wastelands
		is_county_capital = yes
	}
}

gui_can_colonise = {
	scope = character
	# save_scope_as = wastelands #This errors, which means it doesn't get executed anyway. What is this supposed to do?
	
	# Triggered at yearly_on_action.txt -> and then wastelands.006 at lotr_wastelands_events.txt
	ai_is_valid = {	always = no }
	
	is_valid = {
		exists = root

		gold >= colonise_cost_val

		trigger_if = {
			limit = { 
				AND = {
					scope:wastelands = { terrain = halls } 
					NOR = {
						is_dwarf = yes
						is_orc = yes
					}
				}
			}
			always = no
		}

		is_independent_ruler = yes
		
		# Only surrounding lands
		any_sub_realm_county = {
			any_title_to_title_neighboring_and_across_water_county = {
				this = scope:wastelands.county
			}
		}
	}

	## Check lotr_wastelands_effects.txt
	effect = {
		if = { # Islands
			limit = {
				OR = {
					title:d_andunaloni = {
						any_in_de_jure_hierarchy = {
							this = scope:wastelands.county
						}
					}
					title:d_tolfalas = {
						any_in_de_jure_hierarchy = {
							this = scope:wastelands.county
						}
					}
				}
			}
			custom_tooltip = colonise_island_desc
			hidden_effect = { ai_colonisation_effect = { WASTELANDS = scope:wastelands } }
		}
		else_if = { # Underground
			limit = { scope:wastelands = { terrain = halls } }
			custom_tooltip = colonise_underground_desc
			hidden_effect = { ai_colonisation_effect = { WASTELANDS = scope:wastelands } }
		}
		else = { # Mainland
			custom_tooltip = colonise_land_desc
			hidden_effect = { ai_colonisation_effect = { WASTELANDS = scope:wastelands } }
		}
	}
}