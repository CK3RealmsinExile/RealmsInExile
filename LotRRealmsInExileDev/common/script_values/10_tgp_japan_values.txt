
# DOMICILES
japanese_manor_move_cooldown_value = 180
### JAPANESE MANOR building cost values
# External base
japanese_manor_external_building_normal_base_cost_value = 45
japanese_manor_external_building_high_base_cost_value = 90
# External building costs - normal
japanese_manor_external_building_normal_cost_tier_1_value = {
	value = japanese_manor_external_building_normal_base_cost_value
	multiply = japanese_manor_location_cost_modifier_value
}
japanese_manor_external_building_normal_cost_tier_2_value = {
	value = {
		value = japanese_manor_external_building_normal_base_cost_value
		multiply = 1.5
	}
	multiply = japanese_manor_location_cost_modifier_value
}
japanese_manor_external_building_normal_cost_tier_3_value = {
	value = {
		value = japanese_manor_external_building_normal_base_cost_value
		multiply = 2.25
	}
	multiply = japanese_manor_location_cost_modifier_value
}
japanese_manor_external_building_normal_cost_tier_4_value = {
	value = {
		value = japanese_manor_external_building_normal_base_cost_value
		multiply = 3
	}
	multiply = japanese_manor_location_cost_modifier_value
}
japanese_manor_external_building_normal_cost_tier_5_value = {
	value = {
		value = japanese_manor_external_building_normal_base_cost_value
		multiply = 4.25
	}
	multiply = japanese_manor_location_cost_modifier_value
}
japanese_manor_external_building_normal_cost_tier_6_value = {
	value = {
		value = japanese_manor_external_building_normal_base_cost_value
		multiply = 6
	}
	multiply = japanese_manor_location_cost_modifier_value
}
# External building costs - high
japanese_manor_external_building_high_cost_tier_1_value = {
	value = japanese_manor_external_building_high_base_cost_value
	multiply = japanese_manor_location_cost_modifier_value
}
japanese_manor_external_building_high_cost_tier_2_value = {
	value = {
		value = japanese_manor_external_building_high_base_cost_value
		multiply = 1.5
	}
	multiply = japanese_manor_location_cost_modifier_value
}
japanese_manor_external_building_high_cost_tier_3_value = {
	value = {
		value = japanese_manor_external_building_high_base_cost_value
		multiply = 2.25
	}
	multiply = japanese_manor_location_cost_modifier_value
}
japanese_manor_external_building_high_cost_tier_4_value = {
	value = {
		value = japanese_manor_external_building_high_base_cost_value
		multiply = 3
	}
	multiply = japanese_manor_location_cost_modifier_value
}
japanese_manor_external_building_high_cost_tier_5_value = {
	value = {
		value = japanese_manor_external_building_high_base_cost_value
		multiply = 4.25
	}
	multiply = japanese_manor_location_cost_modifier_value
}
japanese_manor_external_building_high_cost_tier_6_value = {
	value = {
		value = japanese_manor_external_building_high_base_cost_value
		multiply = 6
	}
	multiply = japanese_manor_location_cost_modifier_value
}
japanese_manor_external_building_high_cost_tier_7_value = {
	value = {
		value = japanese_manor_external_building_high_base_cost_value
		multiply = 7.5
	}
	multiply = japanese_manor_location_cost_modifier_value
}
# Internal base
japanese_manor_internal_building_normal_base_cost_value = 25
japanese_manor_internal_building_high_base_cost_value = 50
# Internal building costs - normal
japanese_manor_internal_building_normal_cost_tier_1_value = {
	value = japanese_manor_internal_building_normal_base_cost_value
	multiply = japanese_manor_location_cost_modifier_value
}
japanese_manor_internal_building_normal_cost_tier_2_value = {
	value = {
		value = japanese_manor_internal_building_normal_base_cost_value
		multiply = 2
	}
	multiply = japanese_manor_location_cost_modifier_value
}
japanese_manor_internal_building_normal_cost_tier_3_value = {
	value = {
		value = japanese_manor_internal_building_normal_base_cost_value
		multiply = 3
	}
	multiply = japanese_manor_location_cost_modifier_value
}
japanese_manor_internal_building_normal_cost_tier_4_value = {
	value = {
		value = japanese_manor_internal_building_normal_base_cost_value
		multiply = 4
	}
	multiply = japanese_manor_location_cost_modifier_value
}
japanese_manor_internal_building_normal_cost_tier_5_value = {
	value = {
		value = japanese_manor_internal_building_normal_base_cost_value
		multiply = 5
	}
	multiply = japanese_manor_location_cost_modifier_value
}
japanese_manor_internal_building_normal_cost_tier_6_value = {
	value = {
		value = japanese_manor_internal_building_normal_base_cost_value
		multiply = 6
	}
	multiply = japanese_manor_location_cost_modifier_value
}

# Internal building costs - high
japanese_manor_internal_building_high_cost_tier_1_value = {
	value = japanese_manor_internal_building_high_base_cost_value
	multiply = japanese_manor_location_cost_modifier_value
}
japanese_manor_internal_building_high_cost_tier_2_value = {
	value = {
		value = japanese_manor_internal_building_high_base_cost_value
		multiply = 2
	}
	multiply = japanese_manor_location_cost_modifier_value
}
japanese_manor_internal_building_high_cost_tier_3_value = {
	value = {
		value = japanese_manor_internal_building_high_base_cost_value
		multiply = 3
	}
	multiply = japanese_manor_location_cost_modifier_value
}
japanese_manor_internal_building_high_cost_tier_4_value = {
	value = {
		value = japanese_manor_internal_building_high_base_cost_value
		multiply = 4
	}
	multiply = japanese_manor_location_cost_modifier_value
}
japanese_manor_internal_building_high_cost_tier_5_value = {
	value = {
		value = japanese_manor_internal_building_high_base_cost_value
		multiply = 5
	}
	multiply = japanese_manor_location_cost_modifier_value
}
japanese_manor_internal_building_high_cost_tier_6_value = {
	value = {
		value = japanese_manor_internal_building_high_base_cost_value
		multiply = 6
	}
	multiply = japanese_manor_location_cost_modifier_value
}
# Manor location modifier value
japanese_manor_location_cost_modifier_value = {
	value = 1
	if = { # Everything is a bit more expensive in the capital
		limit = { domicile.domicile_location = top_liege.capital_province }
		add = 0.2
	}
}
### Japanese Manor building AI values
japanese_manor_building_ai_modifier_value = {
	if = {
		limit = { # Some characters should want to build in their manor before they construct buildings in holdings
			scope:owner = {
				OR = {
					has_trait = arbitrary
					has_trait = gluttonous
					has_trait = greedy
				}
			}
		}
		add = 10
	}
	if = { # Character's loyal to the realm should very slightly favor constructing buildings in holdings first
		limit = {
			scope:owner = {
				has_trait = loyal
				OR = {
					has_trait = diligent
					has_trait = just
				}
			}
		}
		add = -1 # This will generally (though not guaranteed) make the AI build estate buildings one tier later than normal
	}
}

### KAMPAKU
japanese_kampaku_house_past_kampaku_value = {
	value = 0
	add = {
		value = 0
		if = {
			limit = { exists = dynasty }
			dynasty = { save_temporary_scope_as = dynasty_temp }
			top_liege.primary_title ?= {
				every_past_holder = {
					limit = { dynasty = scope:dynasty_temp }
					add = 1
				}
			}
		}
	}
}

japanese_kampaku_house_past_kampaku_value_actual = {
	value = 0
	add = {
		value = 0
		if = {
			limit = { exists = dynasty }
			dynasty = { save_temporary_scope_as = dynasty_temp }
			house = { save_temporary_scope_as = house_temp }
			top_liege.primary_title ?= {
				every_past_holder = {
					limit = { dynasty = scope:dynasty_temp }
					add = 5
				}
				every_past_holder = {
					limit = { house = scope:house_temp }
					add = 5
				}
			}
		}
	}
}

# Number of House children with Imperial dynasty parents
japanese_kampaku_house_imperial_parent_score_value = {
	value = 5
	multiply = japanese_kampaku_house_imperial_parent_value
}

japanese_kampaku_house_imperial_parent_value = {
	value = 0
	add = {
		value = 0
		if = {
			limit = {
				exists = house
				exists = top_liege.primary_title.var:administrative_ui_special_title.holder.house
			}
			top_liege.primary_title.var:administrative_ui_special_title.holder.house = { save_temporary_scope_as = imperial_house_temp }
			house = {
				every_house_member = {
					limit = {
						any_parent = {
							even_if_dead = yes
							house ?= scope:imperial_house_temp
						}
					}
					add = 1
				}
			}
		}
	}
}

japanese_kampaku_house_imperial_parent_value_actual = {
	value = japanese_kampaku_house_imperial_parent_value
	multiply = 3
}

# Number of Imperial dynasty members with House parents
japanese_kampaku_house_imperial_child_score_value = {
	value = 5
	multiply = japanese_kampaku_house_imperial_child_value
}

japanese_kampaku_house_imperial_child_value = {
	value = 0
	add = {
		value = 0
		if = {
			limit = {
				tgp_realm_has_ceremonial_liege_trigger = yes
				tgp_is_in_ceremonial_house_trigger = no
			}
			house = { save_temporary_scope_as = candidate_house_temp }
			top_liege.primary_title.var:administrative_ui_special_title.holder.house ?= {
				every_house_member = {
					limit = {
						any_parent = {
							even_if_dead = yes
							house ?= scope:candidate_house_temp
						}
					}
					add = 1
				}
			}
		}
	}
}

# Number of spouses of Emperor
japanese_kampaku_imperial_spouse_score_value = {
	value = 15
	multiply = japanese_kampaku_imperial_spouse_value
}

japanese_kampaku_imperial_spouse_value = {
	value = 0
	add = {
		value = 0
		if = {
			limit = {
				tgp_realm_has_ceremonial_liege_trigger = yes
				tgp_is_in_ceremonial_house_trigger = no
			}
			house = { save_temporary_scope_as = candidate_house_temp }
			top_liege.primary_title.var:administrative_ui_special_title.holder ?= {
				every_spouse = {
					even_if_dead = yes
					limit = { house ?= scope:candidate_house_temp }
					add = 1
				}
			}
		}
	}
}

# Number of Imperial dynasty members married to House members
japanese_kampaku_house_imperial_spouse_score_value = {
	value = 5
	multiply = japanese_kampaku_house_imperial_spouse_value
}

japanese_kampaku_house_imperial_spouse_value = {
	value = 0
	add = {
		value = 0
		if = {
			limit = {
				tgp_realm_has_ceremonial_liege_trigger = yes
				tgp_is_in_ceremonial_house_trigger = no
			}
			house ?= { save_temporary_scope_as = candidate_house_temp }
			top_liege.primary_title.var:administrative_ui_special_title.holder.house ?= {
				every_house_member = {
					limit = {
						NOT = { top_liege.primary_title.var:administrative_ui_special_title.holder ?= this }
						any_spouse = {
							even_if_dead = yes
							exists = house
							scope:candidate_house_temp ?= house
						}
					}
					add = 1
				}
			}
		}
	}
}

# Number of Governorships held by House
japanese_kampaku_house_governorship_score_value = {
	value = 5
	multiply = japanese_kampaku_house_governorship_value
}

japanese_kampaku_house_governorship_value = {
	value = 0
	add = {
		value = 0
		house ?= {
			if = {
				limit = { tgp_is_in_ceremonial_house_trigger = no }
				every_house_member = {
					limit = { is_governor = yes }
					add = 1
				}
			}
		}
	}
}

# Number of Devoted House members
japanese_kampaku_house_devoted_score_value = {
	value = 3
	multiply = japanese_kampaku_house_devoted_value
}

japanese_kampaku_house_devoted_value = {
	value = 0
	add = {
		value = 0
		if = {
			limit = { exists = house }
			house = {
				every_house_member = {
					limit = { has_trait = devoted }
					add = 1
				}
			}
		}
	}
}

japanese_house_power_value = {
	value = 0
	add = {
		house = {
			if = {
				limit = { is_powerful_family = yes }
				add = 1
			}
			if = {
				limit = { is_dominant_family = yes }
				add = 2
			}
		}
	}
}

# The standard amount for a powerful or dominant family pledging their loyalty
pledge_loyalty_to_liege_grant_legitimacy_value = {
	value = 5
	multiply = japanese_house_power_value
}

japanese_shogun_opposition_vassals_value = {
	value = 0
	#add = { # LotR
	#	title:e_japan.holder ?= {
	#		every_vassal = {
	#			limit = {
	#				NOR = {
	#					this = root
	#					is_allied_to = root
	#					house = root.house
	#				}
	#				current_strength_with_allies_value > root.current_strength_with_allies_fifty_percent_value
	#			}
	#			add = 1
	#		}
	#	}
	#}
}

# House Aspirations Service Aspiration

service_house_governor_efficiency_bonus_value = 0.05

japanese_manor_local_theme_cost_reduction_value = -0.25

tgp_bloc_house_head_average_opinion_value = {
	value = 0
	save_temporary_scope_as = opinion_target_temp
	confederation ?= {
		every_confederation_member_house = {
			add = {
				value = "house_head.opinion(scope:opinion_target_temp)"
			}
		}
	}
	divide = scope:opinion_target_temp.tgp_bloc_member_count_value
}

tgp_bloc_house_head_average_opinion_reversed_value = {
	value = 0
	save_temporary_scope_as = opinion_haver_temp
	confederation ?= {
		every_confederation_member_house = {
			add = {
				value = "house_head.reverse_opinion(scope:opinion_haver_temp)"
			}
		}
	}
	divide = scope:opinion_haver_temp.tgp_bloc_member_count_value
}

tgp_bloc_member_count_value = {
	value = 0
	confederation ?= {
		every_confederation_member_house = { add = 1 }
	}
	min = 1
}

japanese_kampaku_house_bloc_size_score_value = {
	value = 0
	add = {
		value = 0
		if = {
			limit = {
				is_independent_ruler = no
				is_house_head = yes
				house.house_confederation.leading_house ?= house
			}
			house.house_confederation = {
				every_confederation_member_house = { add = 5 }
			}
		}
	}
}

japanese_kampaku_house_bloc_size_heir_score_value = {
	value = 0
	add = {
		value = 0
		if = {
			limit = {
				save_temporary_scope_as = heir_temp
				house = {
					house_confederation.leading_house ?= house
					house_head = {
						is_independent_ruler = yes
						any_held_title = {
							is_noble_family_title = yes
							current_heir = scope:heir_temp
						}
					}
				}
			}
			house.house_confederation = {
				every_confederation_member_house = { add = 5 }
			}
		}
	}
}

tgp_leave_house_bloc_cooldown_years_value = 5
tgp_leave_house_bloc_truce_years_value = 5

tgp_bloc_house_member_count_value = {
	value = 0
	if = {
		limit = {  exists = house_confederation }
		save_temporary_scope_as = house_temp
		house_head.top_liege = {
			every_sub_realm_county = {
				limit = {
					holder.house ?= scope:house_temp
					holder.house.house_head.confederation ?= scope:house_temp.house_confederation
				}
				add = 1
			}
		}
	}
}

tgp_bloc_member_house_count_value = {
	value = 0
	every_confederation_member_house = { add = 1 }
}
