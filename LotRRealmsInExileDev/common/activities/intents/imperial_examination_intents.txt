### Examination Intents

imperial_exam_taker_intent = {
	icon = intent_study_hard

	auto_complete = yes

	on_invalidated = { trigger_event = activity_system.0090 }

	is_valid = {
		custom_tooltip = {
			text = already_taken_exam_tooltip
			NOT = { has_character_flag = passed_palace_exam }
		}
		custom_tooltip = {
			text = already_landed_tooltip
			is_landed = no
			NOT = { has_character_flag = passed_palace_exam }
		}
	}

	ai_will_do = {
		value = 100
		# Let's make absolute sure relevant characters take this.
		if = {
			limit = {
				NOT = {
					has_character_flag = passed_metropolitan_exam
				}
			}
			add = 5000
		}
	}

	scripted_animation = {
		animation = writing
	}
}

local_exam_taker_intent = {
	icon = intent_study_hard

	auto_complete = yes

	on_invalidated = { trigger_event = activity_system.0090 }

	is_valid = {
		is_landed = no
		custom_tooltip = {
			text = already_taken_exam_tooltip
			NOT = {
				has_character_flag = passed_provincial_exam
			}			
		}
	}

	ai_will_do = {
		value = 100
		# Let's make absolute sure relevant characters take this.
		if = {
			limit = {
				NOT = {
					has_character_flag = passed_provincial_exam
				}
			}
			add = 5000
		}
	}

	scripted_animation = {
		animation = writing
	}
}

imperial_exam_support_entrants_intent = {
	icon = intent_influence

	auto_complete = yes

	on_invalidated = { trigger_event = activity_system.0090 }

	is_valid = {
		OR = {
			is_landed = yes
			AND = {
				is_landed = no
				has_character_flag = passed_metropolitan_exam
			}
		}
		custom_tooltip = {
			text = no_available_family_candidates
			trigger_if = {
				limit = {
					exists = involved_activity
				}
				OR = {
					involved_activity = {
						any_attending_character = {
							this != root
		                	tgp_gender_can_be_exam_entrant_trigger = yes
							OR = {
								is_close_or_extended_family_of = root
								has_relation_disciple = root
								this = root.primary_spouse
							}
							is_landed = no
							NOT = { has_character_flag = passed_palace_exam }
							court_owner = root
							bannable_serving_diarch_trigger = no
						}
					}
					current_travel_plan ?= {
						any_entourage_character = {
							this != root
		                	tgp_gender_can_be_exam_entrant_trigger = yes
							OR = {
								is_close_or_extended_family_of = root
								has_relation_disciple = root
								this = root.primary_spouse
							}
							is_landed = no
							NOT = { has_character_flag = passed_palace_exam }
							court_owner = root
							bannable_serving_diarch_trigger = no
						}
					}
				}
			}
		}
	}

	ai_will_do = {
		value = 100
	}

	scripted_animation = {
		animation = admiration
	}
}

local_exam_support_entrants_intent = {
	icon = intent_influence

	auto_complete = yes

	on_invalidated = { trigger_event = activity_system.0090 }

	is_valid = {
		OR = {
			is_landed = yes
			AND = {
				is_landed = no
				has_character_flag = passed_provincial_exam
			}
		}
		custom_tooltip = {
			text = no_available_family_candidates
			trigger_if = {
				limit = { exists = involved_activity }
				OR = {
					involved_activity = {
						any_attending_character = {
							tgp_gender_can_be_exam_entrant_trigger = yes
							NOR = {
								has_character_flag = passed_metropolitan_exam
								has_character_flag = passed_provincial_exam
							}
							is_landed = no
							court_owner = root
							this != root
							OR = {
								is_close_family_of = root
								has_relation_disciple = root
								this = root.primary_spouse
							}
						}
					}
					current_travel_plan ?= {
						any_entourage_character = {
							tgp_gender_can_be_exam_entrant_trigger = yes
							NOR = {
								has_character_flag = passed_metropolitan_exam
								has_character_flag = passed_provincial_exam
							}
							is_landed = no
							court_owner = root
							this != root
							OR = {
								is_close_family_of = root
								has_relation_disciple = root
								this = root.primary_spouse
							}
						}
					}
				}
			}
		}
	}

	ai_will_do = {
		value = 100
	}

	scripted_animation = { animation = admiration }
}

exam_assist_exam_intent = {
	icon = intent_storyteller

	auto_complete = yes

	on_invalidated = { trigger_event = activity_system.0090 }

	ai_will_do = {
		value = 10
		if = {
			limit = {
				is_landed = no
				AND = {
					has_character_flag = passed_metropolitan_exam
					has_character_flag = passed_palace_exam
				}
			}
			if = {
				limit = { has_trait = scholar }
				add = 30
			}
			if = {
				limit = { has_trait = diligent }
				add = 20
			}
			if = {
				limit = {
					#has_religion = religion:confucianism_religion #LotR
					has_trait = zealous
				}
				add = 50
			}
			# else_if = {
			# 	limit = {
			# 		has_religion = religion:confucianism_religion #LotR
			# 	}
			# 	add = 20
			# }
		}
	}

	scripted_animation = {
		animation = holding_scrolls
	}
}

exam_recruit_courtiers_intent = {
	icon = scout_talent_intent

	auto_complete = yes

	on_invalidated = { trigger_event = activity_system.0090 }

	ai_will_do = {
		value = 10
		if = {
			limit = {
				has_trait = diligent
			}
			add = 50
		}
		if = {
			limit = {
				has_trait = zealous
			}
			add = 30
		}
		if = {
			limit = {
				has_trait = lazy
			}
			add = -30
		}
		if = {
			limit = {
				has_trait = gregarious
			}
			add = 50
		}
		if = {
			limit = {
				has_trait = ambitious
			}
			add = 50
		}
		if = {
			limit = {
				has_trait = shy
			}
			add = -30
		}
	}

	scripted_animation = {
		animation = admiration
	}
}

exam_give_favor_intent = {
	icon = favoritism_intent

	auto_complete = yes

	on_invalidated = {
		trigger_event = activity_system.0090
	}

	ai_will_do = {
		value = 10
		if = {
			limit = {
				has_trait = diligent
			}
			add = -50
		}
		if = {
			limit = {
				has_trait = zealous
			}
			add = 50
		}
		if = {
			limit = {
				has_trait = lazy
			}
			add = -30
		}
		if = {
			limit = {
				has_trait = gregarious
			}
			add = 50
		}
		if = {
			limit = {
				has_trait = ambitious
			}
			add = 50
		}
		if = {
			limit = {
				has_trait = shy
			}
			add = -30
		}
	}

	scripted_animation = {
		animation = admiration
	}
}
